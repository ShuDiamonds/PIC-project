MP2COD 4.00, COFF to COD File Converter
Copyright (c) 2005 Microchip Technology Inc.
Listing File Generated: Sun Nov 06 22:50:15 2005


Address  Value    Disassembly              Source                                                                           File
-------  -------  -----------------------  -------------------------------------------------------------------------------  -----
                                           /*********************************************************************           E:\usb20\lighting2\main.c
                                           *                                                                                E:\usb20\lighting2\main.c
                                           *　USB接続 フルカラー照明                                                        E:\usb20\lighting2\main.c
                                           *	USBフレームワーク修正情報                                                      E:\usb20\lighting2\main.c
                                           *　　コンフィギュレーションの設定変更                                            E:\usb20\lighting2\main.c
                                           *　　main.c　の変更　初期化削除　IO設定変更                                      E:\usb20\lighting2\main.c
                                           *　　io_cfg.hの変更　LED削除　IOモニタ削除                                       E:\usb20\lighting2\main.c
                                           *　　user.cの変更　　実行内容削除                                                E:\usb20\lighting2\main.c
                                           *　　usbcfg.hの変更　IOモニタ削除                                                E:\usb20\lighting2\main.c
                                           *                                                                                E:\usb20\lighting2\main.c
                                           *********************************************************************            E:\usb20\lighting2\main.c
                                           /** I N C L U D E S *************************************************/           E:\usb20\lighting2\main.c
                                           #include <p18cxxx.h>                                                             E:\usb20\lighting2\main.c
                                           #include "system\typedefs.h"                        // Required                  E:\usb20\lighting2\main.c
                                           #include "system\usb\usb.h"                         // Required                  E:\usb20\lighting2\main.c
                                           #include "io_cfg.h"                                 // Required                  E:\usb20\lighting2\main.c
                                           #include "system\usb\usb_compile_time_validation.h" // Optional                  E:\usb20\lighting2\main.c
                                           #include	"delays.h"                                                              E:\usb20\lighting2\main.c
                                           #include "stdlib.h"                                                              E:\usb20\lighting2\main.c
                                                                                                                            E:\usb20\lighting2\main.c
                                           /*** Configuration *******/                                                      E:\usb20\lighting2\main.c
                                           #pragma config FOSC = HSPLL_HS                                                   E:\usb20\lighting2\main.c
                                           #pragma config WDT = OFF                                                         E:\usb20\lighting2\main.c
                                           #pragma config PLLDIV = 5                                                        E:\usb20\lighting2\main.c
                                           #pragma config CPUDIV = OSC1_PLL2                                                E:\usb20\lighting2\main.c
                                           #pragma config USBDIV = 2                                                        E:\usb20\lighting2\main.c
                                           #pragma config PWRT = ON                                                         E:\usb20\lighting2\main.c
                                           #pragma config BOR = ON                                                          E:\usb20\lighting2\main.c
                                           #pragma config BORV = 43                                                         E:\usb20\lighting2\main.c
                                           #pragma config LVP = OFF                                                         E:\usb20\lighting2\main.c
                                           #pragma config VREGEN = ON                                                       E:\usb20\lighting2\main.c
                                           #pragma config MCLRE = ON                                                        E:\usb20\lighting2\main.c
                                           #pragma config PBADEN = OFF                                                      E:\usb20\lighting2\main.c
                                                                                                                            E:\usb20\lighting2\main.c
                                           /** V A R I A B L E S ***********************************************/           E:\usb20\lighting2\main.c
                                           #pragma udata                                                                    E:\usb20\lighting2\main.c
                                           char input_buffer[64];					// USB入力バッファ                                    E:\usb20\lighting2\main.c
                                           char output_buffer[64];					// USB出力バッファ                                   E:\usb20\lighting2\main.c
                                                                                                                            E:\usb20\lighting2\main.c
                                           struct PWMCont                                                                   E:\usb20\lighting2\main.c
                                           {                                                                                E:\usb20\lighting2\main.c
                                           	char	UpDown;						// 上昇下降フラグ                                             E:\usb20\lighting2\main.c
                                           	unsigned int Value;					// PWM値                                                E:\usb20\lighting2\main.c
                                           };                                                                               E:\usb20\lighting2\main.c
                                           struct PWMCont PWM[6];					// 6色分                                              E:\usb20\lighting2\main.c
                                                                                                                            E:\usb20\lighting2\main.c
                                           unsigned int		Period;					// PWM周期                                             E:\usb20\lighting2\main.c
                                           unsigned int		Count;                                                             E:\usb20\lighting2\main.c
                                           unsigned int		Interval;				// 色更新周期                                         E:\usb20\lighting2\main.c
                                           char 			Flag;					// 色更新フラグ                                                E:\usb20\lighting2\main.c
                                           char			Color;					// 色相値                                                      E:\usb20\lighting2\main.c
                                           char			ColorIndex = 0;			// 色相値取得インデックス                               E:\usb20\lighting2\main.c
                                           unsigned int		Max = 1023;				// 色更限界値設定                                   E:\usb20\lighting2\main.c
                                           unsigned int		Min = 1;                                                           E:\usb20\lighting2\main.c
                                           unsigned int		ChangeInterval = 10;		// 色相更新周期                              E:\usb20\lighting2\main.c
                                           char			ChangeFlag = 0;			// 色相変更指示フラグ                                   E:\usb20\lighting2\main.c
                                           unsigned int		Random;                                                            E:\usb20\lighting2\main.c
                                                                                                                            E:\usb20\lighting2\main.c
                                           unsigned char MsgOK[3] = "OK";                                                   E:\usb20\lighting2\main.c
                                                                                                                            E:\usb20\lighting2\main.c
                                           /** P R I V A T E  P R O T O T Y P E S *******************************/          E:\usb20\lighting2\main.c
                                           void ISRProcess(void);                                                           E:\usb20\lighting2\main.c
                                           void Illuminate(void);                                                           E:\usb20\lighting2\main.c
                                           unsigned char EERead(unsigned char adrs);                                        E:\usb20\lighting2\main.c
                                           void EEWrite(unsigned char adrs, unsigned char data);                            E:\usb20\lighting2\main.c
                                           void InitEEPROM(void);                                                           E:\usb20\lighting2\main.c
                                           void Setup(void);                                                                E:\usb20\lighting2\main.c
                                                                                                                            E:\usb20\lighting2\main.c
                                           /** V E C T O R  M A P P I N G ***********************************/              E:\usb20\lighting2\main.c
                                           #pragma code high_vector=0x08                                                    E:\usb20\lighting2\main.c
                                           void interrupt_at_high_vector(void)                                              E:\usb20\lighting2\main.c
                                           {                                                                                E:\usb20\lighting2\main.c
000008   ef22     GOTO      0x44               _asm goto ISRProcess _endasm                                                 E:\usb20\lighting2\main.c
00000a   f000                                                                                                               
00000c   0012     RETURN    0x0            }                                                                                E:\usb20\lighting2\main.c
                                           #pragma code                                                                     E:\usb20\lighting2\main.c
                                                                                                                            E:\usb20\lighting2\main.c
                                           ////// Timer0 Interrupt Process                                                  E:\usb20\lighting2\main.c
                                           ////// 20msec Interval                                                           E:\usb20\lighting2\main.c
                                           #pragma interrupt ISRProcess                                                     E:\usb20\lighting2\main.c
000044   cfda     MOVFF     0xfda,0xfe4    void ISRProcess(void)                                                            E:\usb20\lighting2\main.c
000046   ffe4                                                                                                               
000048   cfe2     MOVFF     0xfe2,0xfda                                                                                     
00004a   ffda                                                                                                               
00004c   cfe9     MOVFF     0xfe9,0xfe4                                                                                     
00004e   ffe4                                                                                                               
000050   cfea     MOVFF     0xfea,0xfe4                                                                                     
000052   ffe4                                                                                                               
000054   cff6     MOVFF     0xff6,0xfe4                                                                                     
000056   ffe4                                                                                                               
000058   cff7     MOVFF     0xff7,0xfe4                                                                                     
00005a   ffe4                                                                                                               
00005c   cff5     MOVFF     0xff5,0xfe4                                                                                     
00005e   ffe4                                                                                                               
000060   cff3     MOVFF     0xff3,0xfe4                                                                                     
000062   ffe4                                                                                                               
000064   cff4     MOVFF     0xff4,0xfe4                                                                                     
000066   ffe4                                                                                                               
000068   cffa     MOVFF     0xffa,0xfe4                                                                                     
00006a   ffe4                                                                                                               
00006c   ee00     LFSR      0x0,0x0                                                                                         
00006e   f000                                                                                                               
000070   0e14     MOVLW     0x14                                                                                            
000072   04e8     DECF      0xe8,0x0,0x0                                                                                    
000074   e303     BNC       0x7c                                                                                            
000076   cfee     MOVFF     0xfee,0xfe4                                                                                     
000078   ffe4                                                                                                               
00007a   d7fb     BRA       0x72                                                                                            
00007c   ee00     LFSR      0x0,0x16                                                                                        
00007e   f016                                                                                                               
000080   0e02     MOVLW     0x2                                                                                             
000082   04e8     DECF      0xe8,0x0,0x0                                                                                    
000084   e303     BNC       0x8c                                                                                            
000086   cfee     MOVFF     0xfee,0xfe4                                                                                     
000088   ffe4                                                                                                               
00008a   d7fb     BRA       0x82                                                                                            
00008c   52e6     MOVF      0xe6,0x1,0x0                                                                                    
                                           {                                                                                E:\usb20\lighting2\main.c
00008e   94f2     BCF       0xf2,0x2,0x0   	INTCONbits.TMR0IF = 0;							// Interrupt Flag Clear                            E:\usb20\lighting2\main.c
000090   0ef1     MOVLW     0xf1           	TMR0H = 0xF1;									//                                                        E:\usb20\lighting2\main.c
000092   6ed7     MOVWF     0xd7,0x0                                                                                        
000094   0e59     MOVLW     0x59           	TMR0L = 0x59;	                                                                  E:\usb20\lighting2\main.c
000096   6ed6     MOVWF     0xd6,0x0                                                                                        
000098   0100     MOVLB     0x0            	if(Interval > 0)								// PWM更新時期か？                                      E:\usb20\lighting2\main.c
00009a   0e00     MOVLW     0x0                                                                                             
00009c   80d8     BSF       0xd8,0x0,0x0                                                                                    
00009e   55f6     SUBFWB    0xf6,0x0,0x1                                                                                    
0000a0   0e00     MOVLW     0x0                                                                                             
0000a2   55f7     SUBFWB    0xf7,0x0,0x1                                                                                    
0000a4   e204     BC        0xae                                                                                            
0000a6   07f6     DECF      0xf6,0x1,0x1   		Interval--;								// PWM更新周期-1	                                           E:\usb20\lighting2\main.c
0000a8   0e00     MOVLW     0x0                                                                                             
0000aa   5bf7     SUBWFB    0xf7,0x1,0x1                                                                                    
0000ac   d037     BRA       0x11c          	else	                                                                           E:\usb20\lighting2\main.c
                                           	{                                                                               E:\usb20\lighting2\main.c
0000ae   0e02     MOVLW     0x2            		Interval = (unsigned int)EERead(2)*256 + (unsigned int)EERead(3);              E:\usb20\lighting2\main.c
0000b0   6ee6     MOVWF     0xe6,0x0                                                                                        
0000b2   ec59     CALL      0x8b2,0x0                                                                                       
0000b4   f004                                                                                                               
0000b6   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0000b8   6e14     MOVWF     0x14,0x0                                                                                        
0000ba   6a15     CLRF      0x15,0x0                                                                                        
0000bc   c014     MOVFF     0x14,0x15                                                                                       
0000be   f015                                                                                                               
0000c0   6a14     CLRF      0x14,0x0                                                                                        
0000c2   0e03     MOVLW     0x3                                                                                             
0000c4   6ee6     MOVWF     0xe6,0x0                                                                                        
0000c6   ec59     CALL      0x8b2,0x0                                                                                       
0000c8   f004                                                                                                               
0000ca   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0000cc   0100     MOVLB     0x0                                                                                             
0000ce   2414     ADDWF     0x14,0x0,0x0                                                                                    
0000d0   6ff6     MOVWF     0xf6,0x1                                                                                        
0000d2   0e00     MOVLW     0x0                                                                                             
0000d4   2015     ADDWFC    0x15,0x0,0x0                                                                                    
0000d6   6ff7     MOVWF     0xf7,0x1                                                                                        
0000d8   0e01     MOVLW     0x1            		Flag = 1;                                                                      E:\usb20\lighting2\main.c
0000da   6ff8     MOVWF     0xf8,0x1                                                                                        
                                           		// 色相更新                                                                    E:\usb20\lighting2\main.c
0000dc   0101     MOVLB     0x1            		if(ChangeInterval > 0)						// 色相更新時期か？                                E:\usb20\lighting2\main.c
0000de   0e00     MOVLW     0x0                                                                                             
0000e0   80d8     BSF       0xd8,0x0,0x0                                                                                    
0000e2   5520     SUBFWB    0x20,0x0,0x1                                                                                    
0000e4   0e00     MOVLW     0x0                                                                                             
0000e6   5521     SUBFWB    0x21,0x0,0x1                                                                                    
0000e8   e204     BC        0xf2                                                                                            
0000ea   0720     DECF      0x20,0x1,0x1   	  		ChangeInterval--;						// 			                                               E:\usb20\lighting2\main.c
0000ec   0e00     MOVLW     0x0                                                                                             
0000ee   5b21     SUBWFB    0x21,0x1,0x1                                                                                    
0000f0   d015     BRA       0x11c          		else                                                                           E:\usb20\lighting2\main.c
                                           		{                                                                              E:\usb20\lighting2\main.c
0000f2   0e0a     MOVLW     0xa            			ChangeInterval = (unsigned int)EERead(0xA)*256 + (unsigned int)EERead(0xB);   E:\usb20\lighting2\main.c
0000f4   6ee6     MOVWF     0xe6,0x0                                                                                        
0000f6   dbdd     RCALL     0x8b2                                                                                           
0000f8   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0000fa   6e14     MOVWF     0x14,0x0                                                                                        
0000fc   6a15     CLRF      0x15,0x0                                                                                        
0000fe   c014     MOVFF     0x14,0x15                                                                                       
000100   f015                                                                                                               
000102   6a14     CLRF      0x14,0x0                                                                                        
000104   0e0b     MOVLW     0xb                                                                                             
000106   6ee6     MOVWF     0xe6,0x0                                                                                        
000108   dbd4     RCALL     0x8b2                                                                                           
00010a   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00010c   0101     MOVLB     0x1                                                                                             
00010e   2414     ADDWF     0x14,0x0,0x0                                                                                    
000110   6f20     MOVWF     0x20,0x1                                                                                        
000112   0e00     MOVLW     0x0                                                                                             
000114   2015     ADDWFC    0x15,0x0,0x0                                                                                    
000116   6f21     MOVWF     0x21,0x1                                                                                        
000118   0e01     MOVLW     0x1            			ChangeFlag = 1;                                                               E:\usb20\lighting2\main.c
00011a   6f22     MOVWF     0x22,0x1                                                                                        
                                           		}                                                                              E:\usb20\lighting2\main.c
                                           	}                                                                               E:\usb20\lighting2\main.c
00011c   52e5     MOVF      0xe5,0x1,0x0   }                                                                                E:\usb20\lighting2\main.c
00011e   ee00     LFSR      0x0,0x17                                                                                        
000120   f017                                                                                                               
000122   0e02     MOVLW     0x2                                                                                             
000124   04e8     DECF      0xe8,0x0,0x0                                                                                    
000126   e303     BNC       0x12e                                                                                           
000128   cfe5     MOVFF     0xfe5,0xfed                                                                                     
00012a   ffed                                                                                                               
00012c   d7fb     BRA       0x124                                                                                           
00012e   ee00     LFSR      0x0,0x13                                                                                        
000130   f013                                                                                                               
000132   0e14     MOVLW     0x14                                                                                            
000134   04e8     DECF      0xe8,0x0,0x0                                                                                    
000136   e303     BNC       0x13e                                                                                           
000138   cfe5     MOVFF     0xfe5,0xfed                                                                                     
00013a   ffed                                                                                                               
00013c   d7fb     BRA       0x134                                                                                           
00013e   cfe5     MOVFF     0xfe5,0xffa                                                                                     
000140   fffa                                                                                                               
000142   cfe5     MOVFF     0xfe5,0xff4                                                                                     
000144   fff4                                                                                                               
000146   cfe5     MOVFF     0xfe5,0xff3                                                                                     
000148   fff3                                                                                                               
00014a   cfe5     MOVFF     0xfe5,0xff5                                                                                     
00014c   fff5                                                                                                               
00014e   cfe5     MOVFF     0xfe5,0xff7                                                                                     
000150   fff7                                                                                                               
000152   cfe5     MOVFF     0xfe5,0xff6                                                                                     
000154   fff6                                                                                                               
000156   cfe5     MOVFF     0xfe5,0xfea                                                                                     
000158   ffea                                                                                                               
00015a   cfe5     MOVFF     0xfe5,0xfe9                                                                                     
00015c   ffe9                                                                                                               
00015e   cfe5     MOVFF     0xfe5,0xfda                                                                                     
000160   ffda                                                                                                               
000162   0011     RETFIE    0x1                                                                                             
                                           	                                                                                E:\usb20\lighting2\main.c
                                           #pragma code                                                                     E:\usb20\lighting2\main.c
                                           /*********************************************************************           E:\usb20\lighting2\main.c
                                            * Function:        void main(void)                                              E:\usb20\lighting2\main.c
                                            ********************************************************************/           E:\usb20\lighting2\main.c
000164   cfd9     MOVFF     0xfd9,0xfe6    void main(void)                                                                  E:\usb20\lighting2\main.c
000166   ffe6                                                                                                               
000168   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
00016a   ffd9                                                                                                               
00016c   52e6     MOVF      0xe6,0x1,0x0                                                                                    
                                           {                                                                                E:\usb20\lighting2\main.c
                                           	char i;                                                                         E:\usb20\lighting2\main.c
                                           	                                                                                E:\usb20\lighting2\main.c
00016e   0e07     MOVLW     0x7            	CMCON = 0x07;						// コンパレータオフ                                          E:\usb20\lighting2\main.c
000170   6eb4     MOVWF     0xb4,0x0                                                                                        
000172   6a8a     CLRF      0x8a,0x0          	LATB = 0;						// LED全消去                                                  E:\usb20\lighting2\main.c
000174   0e03     MOVLW     0x3              	LATC  = 0x03;						// LED off                                                 E:\usb20\lighting2\main.c
000176   6e8b     MOVWF     0x8b,0x0                                                                                        
000178   6e92     MOVWF     0x92,0x0        	TRISA = 0x03;						//                                                          E:\usb20\lighting2\main.c
00017a   6a93     CLRF      0x93,0x0       	TRISB = 0x0;						// 液晶表示                                                   E:\usb20\lighting2\main.c
00017c   0e30     MOVLW     0x30            	TRISC = 0x30;						// LED Output Mode                                          E:\usb20\lighting2\main.c
00017e   6e94     MOVWF     0x94,0x0                                                                                        
                                           	// Timer0 初期化                                                                E:\usb20\lighting2\main.c
000180   0e85     MOVLW     0x85           	T0CON = 0x85;						// Internal 1/64                                             E:\usb20\lighting2\main.c
000182   6ed5     MOVWF     0xd5,0x0                                                                                        
000184   0ef1     MOVLW     0xf1           	TMR0H = 0xF1;						// 12MHz/64/3750=50Hz                                        E:\usb20\lighting2\main.c
000186   6ed7     MOVWF     0xd7,0x0                                                                                        
000188   0e59     MOVLW     0x59           	TMR0L = 0x59;                                                                   E:\usb20\lighting2\main.c
00018a   6ed6     MOVWF     0xd6,0x0                                                                                        
                                            	// A/D初期設定                                                                 E:\usb20\lighting2\main.c
00018c   0e0b     MOVLW     0xb             	ADCON1 = 0x0B;					// AN0-AN1 Analog Input                                     E:\usb20\lighting2\main.c
00018e   6ec1     MOVWF     0xc1,0x0                                                                                        
000190   0e95     MOVLW     0x95            	ADCON2 = 0x95;					// 4Tad, Fosc/16                                            E:\usb20\lighting2\main.c
000192   6ec0     MOVWF     0xc0,0x0                                                                                        
000194   0e01     MOVLW     0x1             	ADCON0 = 0x01;					// AD on                                                    E:\usb20\lighting2\main.c
000196   6ec2     MOVWF     0xc2,0x0                                                                                        
                                           	/// USB初期化                                                                   E:\usb20\lighting2\main.c
000198   0e14     MOVLW     0x14           	mInitializeUSBDriver();         	// See usbdrv.h                                E:\usb20\lighting2\main.c
00019a   6e6f     MOVWF     0x6f,0x0                                                                                        
00019c   0100     MOVLB     0x0                                                                                             
00019e   6bfc     CLRF      0xfc,0x1                                                                                        
0001a0   0100     MOVLB     0x0                                                                                             
0001a2   6bfd     CLRF      0xfd,0x1                                                                                        
0001a4   0100     MOVLB     0x0                                                                                             
0001a6   6bfe     CLRF      0xfe,0x1                                                                                        
                                           	/// EEPROMデフォルト設定（デバッグ用）                                          E:\usb20\lighting2\main.c
                                           //	InitEEPROM();                                                                 E:\usb20\lighting2\main.c
                                           	/// 変数初期化 EEPROMから読み出し                                               E:\usb20\lighting2\main.c
0001a8   d9e9     RCALL     0x57c          	Setup();                                                                        E:\usb20\lighting2\main.c
                                           	/// 割り込み許可                                                                E:\usb20\lighting2\main.c
0001aa   8af2     BSF       0xf2,0x5,0x0   	INTCONbits.TMR0IE = 1;                                                          E:\usb20\lighting2\main.c
0001ac   8ef2     BSF       0xf2,0x7,0x0   	INTCONbits.GIE = 1;                                                             E:\usb20\lighting2\main.c
                                               /// メインループ                                                             E:\usb20\lighting2\main.c
00030c   d750     BRA       0x1ae              while(1)                                                                     E:\usb20\lighting2\main.c
                                               {                                                                            E:\usb20\lighting2\main.c
0001ae   ece4     CALL      0x13c8,0x0         		USBCheckBusStatus();        					// USB接続チェック                        E:\usb20\lighting2\main.c
0001b0   f009                                                                                                               
0001b2   be6f     BTFSC     0x6f,0x7,0x0       		if(UCFGbits.UTEYE!=1)							// アイパターンモードオフか                    E:\usb20\lighting2\main.c
0001b4   d002     BRA       0x1ba                                                                                           
0001b6   ec03     CALL      0x1406,0x0             		USBDriverService();						// USBイベントポーリング                      E:\usb20\lighting2\main.c
0001b8   f00a                                                                                                               
0001ba   ec67     CALL      0xcce,0x0      		CDCTxService();								// クラス送受信実行                                     E:\usb20\lighting2\main.c
0001bc   f006                                                                                                               
                                           		/// 受信データの処理実行                                                       E:\usb20\lighting2\main.c
0001be   0e06     MOVLW     0x6            		if((usb_device_state >= CONFIGURED_STATE)&&(UCONbits.SUSPND==0))               E:\usb20\lighting2\main.c
0001c0   0100     MOVLB     0x0                                                                                             
0001c2   5dfc     SUBWF     0xfc,0x0,0x1                                                                                    
0001c4   e34a     BNC       0x25a                                                                                           
0001c6   506d     MOVF      0x6d,0x0,0x0                                                                                    
0001c8   0b02     ANDLW     0x2                                                                                             
0001ca   e147     BNZ       0x25a                                                                                           
                                           		{                                                                              E:\usb20\lighting2\main.c
0001cc   0e40     MOVLW     0x40               			if(getsUSBUSART(input_buffer,64))			// データ受信ポール                   E:\usb20\lighting2\main.c
0001ce   6ee6     MOVWF     0xe6,0x0                                                                                        
0001d0   0e60     MOVLW     0x60                                                                                            
0001d2   6ee6     MOVWF     0xe6,0x0                                                                                        
0001d4   0e00     MOVLW     0x0                                                                                             
0001d6   6ee6     MOVWF     0xe6,0x0                                                                                        
0001d8   ecac     CALL      0xb58,0x0                                                                                       
0001da   f005                                                                                                               
0001dc   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0001de   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0001e0   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0001e2   0900     IORLW     0x0                                                                                             
0001e4   e03a     BZ        0x25a                                                                                           
                                               			{                                                                         E:\usb20\lighting2\main.c
0001e6   708b     BTG       0x8b,0x0,0x0               		LATCbits.LATC0 = !LATCbits.LATC0;		// LED反転                      E:\usb20\lighting2\main.c
0001e8   0100     MOVLB     0x0            	    			switch(input_buffer[0])				// 最初の１文字チェック                       E:\usb20\lighting2\main.c
0001ea   5160     MOVF      0x60,0x0,0x1                                                                                    
0001ec   0a39     XORLW     0x39                                                                                            
0001ee   e032     BZ        0x254                                                                                           
0001f0   0a08     XORLW     0x8                                                                                             
0001f2   e00f     BZ        0x212                                                                                           
0001f4   0a01     XORLW     0x1                                                                                             
0001f6   e001     BZ        0x1fa                                                                                           
                                           	    			{                                                                        E:\usb20\lighting2\main.c
                                           		    			case '0':						// OK応答                                                E:\usb20\lighting2\main.c
0001fa   0101     MOVLB     0x1            						if(mUSBUSARTIsTxTrfReady())                                                E:\usb20\lighting2\main.c
0001fc   5101     MOVF      0x1,0x0,0x1                                                                                     
0001fe   e108     BNZ       0x210                                                                                           
000200   0e38     MOVLW     0x38           							putrsUSBUSART("OK");                                                      E:\usb20\lighting2\main.c
000202   6ee6     MOVWF     0xe6,0x0                                                                                        
000204   0e17     MOVLW     0x17                                                                                            
000206   6ee6     MOVWF     0xe6,0x0                                                                                        
000208   ec29     CALL      0xc52,0x0                                                                                       
00020a   f006                                                                                                               
00020c   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00020e   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000210   d024     BRA       0x25a                    			 	break;                                                            E:\usb20\lighting2\main.c
                                           					case '1':                                                                   E:\usb20\lighting2\main.c
000212   6adf     CLRF      0xdf,0x0       						for(i=0; i<0x1F; i++)			// Write except Random                             E:\usb20\lighting2\main.c
000214   cfdf     MOVFF     0xfdf,0x16                                                                                      
000216   f016                                                                                                               
000218   0e1f     MOVLW     0x1f                                                                                            
00021a   6ee7     MOVWF     0xe7,0x0                                                                                        
00021c   1816     XORWF     0x16,0x0,0x0                                                                                    
00021e   aee8     BTFSS     0xe8,0x7,0x0                                                                                    
000220   d002     BRA       0x226                                                                                           
000222   34e7     RLCF      0xe7,0x0,0x0                                                                                    
000224   d002     BRA       0x22a                                                                                           
000226   50e7     MOVF      0xe7,0x0,0x0                                                                                    
000228   5c16     SUBWF     0x16,0x0,0x0                                                                                    
00022a   e213     BC        0x252                                                                                           
00024e   2adf     INCF      0xdf,0x1,0x0                                                                                    
000250   d7e1     BRA       0x214                                                                                           
                                           						{                                                                          E:\usb20\lighting2\main.c
00022c   28df     INCF      0xdf,0x0,0x0   							EEWrite(i, input_buffer[i+1]);                                            E:\usb20\lighting2\main.c
00022e   6ee9     MOVWF     0xe9,0x0                                                                                        
000230   6aea     CLRF      0xea,0x0                                                                                        
000232   bee9     BTFSC     0xe9,0x7,0x0                                                                                    
000234   68ea     SETF      0xea,0x0                                                                                        
000236   0e60     MOVLW     0x60                                                                                            
000238   26e9     ADDWF     0xe9,0x1,0x0                                                                                    
00023a   0e00     MOVLW     0x0                                                                                             
00023c   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
00023e   50ef     MOVF      0xef,0x0,0x0                                                                                    
000240   6ee6     MOVWF     0xe6,0x0                                                                                        
000242   cfdf     MOVFF     0xfdf,0xfe6                                                                                     
000244   ffe6                                                                                                               
000246   db1c     RCALL     0x880                                                                                           
000248   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00024a   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00024c   d997     RCALL     0x57c          							Setup();                                                                  E:\usb20\lighting2\main.c
                                           						}                                                                          E:\usb20\lighting2\main.c
000252   d003     BRA       0x25a          						break;                                                                     E:\usb20\lighting2\main.c
                                           					case '9':                                                                   E:\usb20\lighting2\main.c
000254   db3e     RCALL     0x8d2          		    				InitEEPROM();                                                          E:\usb20\lighting2\main.c
000256   d992     RCALL     0x57c          		    				Setup();				                                                           E:\usb20\lighting2\main.c
000258   d000     BRA       0x25a          						break;						                                                               E:\usb20\lighting2\main.c
0001f8   d030     BRA       0x25a          		    			default: break;                                                         E:\usb20\lighting2\main.c
                                           		    		}                                                                        E:\usb20\lighting2\main.c
                                               			}                                                                         E:\usb20\lighting2\main.c
                                               		}                                                                          E:\usb20\lighting2\main.c
                                              		/// PWM制御（Countを＋１しMaxで最初に戻る） 		                              E:\usb20\lighting2\main.c
00025a   0100     MOVLB     0x0                		Count++;										// PWMステップアップ                                     E:\usb20\lighting2\main.c
00025c   2bf4     INCF      0xf4,0x1,0x1                                                                                    
00025e   0e00     MOVLW     0x0                                                                                             
000260   23f5     ADDWFC    0xf5,0x1,0x1                                                                                    
000262   51f2     MOVF      0xf2,0x0,0x1       		if(Count == Period)							// 周期終わりか？                                E:\usb20\lighting2\main.c
000264   19f4     XORWF     0xf4,0x0,0x1                                                                                    
000266   e102     BNZ       0x26c                                                                                           
000268   51f3     MOVF      0xf3,0x0,0x1                                                                                    
00026a   19f5     XORWF     0xf5,0x0,0x1                                                                                    
00026c   e124     BNZ       0x2b6                                                                                           
                                               		{                                                                          E:\usb20\lighting2\main.c
00026e   6bf4     CLRF      0xf4,0x1       	    		Count = 0;								// 周期最初に戻す                                       E:\usb20\lighting2\main.c
000270   6bf5     CLRF      0xf5,0x1                                                                                        
000272   6ae6     CLRF      0xe6,0x0       	    		Period = (unsigned int)EERead(0)*256 + (unsigned int)EERead(1);           E:\usb20\lighting2\main.c
000274   db1e     RCALL     0x8b2                                                                                           
000276   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000278   6e16     MOVWF     0x16,0x0                                                                                        
00027a   6a17     CLRF      0x17,0x0                                                                                        
00027c   c016     MOVFF     0x16,0x17                                                                                       
00027e   f017                                                                                                               
000280   6a16     CLRF      0x16,0x0                                                                                        
000282   c016     MOVFF     0x16,0xfe6                                                                                      
000284   ffe6                                                                                                               
000286   c017     MOVFF     0x17,0xfe6                                                                                      
000288   ffe6                                                                                                               
00028a   0e01     MOVLW     0x1                                                                                             
00028c   6ee6     MOVWF     0xe6,0x0                                                                                        
00028e   db11     RCALL     0x8b2                                                                                           
000290   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000292   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000294   cfe7     MOVFF     0xfe7,0x17                                                                                      
000296   f017                                                                                                               
000298   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00029a   cfe7     MOVFF     0xfe7,0x16                                                                                      
00029c   f016                                                                                                               
00029e   0100     MOVLB     0x0                                                                                             
0002a0   2416     ADDWF     0x16,0x0,0x0                                                                                    
0002a2   6ff2     MOVWF     0xf2,0x1                                                                                        
0002a4   0e00     MOVLW     0x0                                                                                             
0002a6   2017     ADDWFC    0x17,0x0,0x0                                                                                    
0002a8   6ff3     MOVWF     0xf3,0x1                                                                                        
0002aa   0e3f     MOVLW     0x3f             			LATB = 0x3F;								// 全LEDオン                                            E:\usb20\lighting2\main.c
0002ac   6e8a     MOVWF     0x8a,0x0                                                                                        
                                             			// PWM幅更新周期ならPWM更新（Interval)                                      E:\usb20\lighting2\main.c
0002ae   51f8     MOVF      0xf8,0x0,0x1   			if(Flag)									// 更新周期か？                                              E:\usb20\lighting2\main.c
0002b0   e002     BZ        0x2b6                                                                                           
                                           			{                                                                             E:\usb20\lighting2\main.c
0002b2   6bf8     CLRF      0xf8,0x1       				Flag = 0;							// 色更新フラグオフ                                          E:\usb20\lighting2\main.c
0002b4   d831     RCALL     0x318          				Illuminate();							// イルミネーション実行                                  E:\usb20\lighting2\main.c
                                           			}                                                                             E:\usb20\lighting2\main.c
                                            		}                                                                             E:\usb20\lighting2\main.c
                                           		//// PWMオフ制御　（CountとPWM値が一致）                                       E:\usb20\lighting2\main.c
0002b6   0100     MOVLB     0x0            		if(Count == PWM[0].Value)                                                      E:\usb20\lighting2\main.c
0002b8   51e1     MOVF      0xe1,0x0,0x1                                                                                    
0002ba   19f4     XORWF     0xf4,0x0,0x1                                                                                    
0002bc   e102     BNZ       0x2c2                                                                                           
0002be   51e2     MOVF      0xe2,0x0,0x1                                                                                    
0002c0   19f5     XORWF     0xf5,0x0,0x1                                                                                    
0002c2   e101     BNZ       0x2c6                                                                                           
0002c4   908a     BCF       0x8a,0x0,0x0   			LEDR1 = 0;                                                                    E:\usb20\lighting2\main.c
0002c6   51e4     MOVF      0xe4,0x0,0x1   		if(Count == PWM[1].Value)                                                      E:\usb20\lighting2\main.c
0002c8   19f4     XORWF     0xf4,0x0,0x1                                                                                    
0002ca   e102     BNZ       0x2d0                                                                                           
0002cc   51e5     MOVF      0xe5,0x0,0x1                                                                                    
0002ce   19f5     XORWF     0xf5,0x0,0x1                                                                                    
0002d0   e101     BNZ       0x2d4                                                                                           
0002d2   928a     BCF       0x8a,0x1,0x0   			LEDG1 = 0;                                                                    E:\usb20\lighting2\main.c
0002d4   51e7     MOVF      0xe7,0x0,0x1   		if(Count == PWM[2].Value)                                                      E:\usb20\lighting2\main.c
0002d6   19f4     XORWF     0xf4,0x0,0x1                                                                                    
0002d8   e102     BNZ       0x2de                                                                                           
0002da   51e8     MOVF      0xe8,0x0,0x1                                                                                    
0002dc   19f5     XORWF     0xf5,0x0,0x1                                                                                    
0002de   e101     BNZ       0x2e2                                                                                           
0002e0   948a     BCF       0x8a,0x2,0x0   			LEDB1 = 0;                                                                    E:\usb20\lighting2\main.c
0002e2   51ea     MOVF      0xea,0x0,0x1   		if(Count == PWM[3].Value)                                                      E:\usb20\lighting2\main.c
0002e4   19f4     XORWF     0xf4,0x0,0x1                                                                                    
0002e6   e102     BNZ       0x2ec                                                                                           
0002e8   51eb     MOVF      0xeb,0x0,0x1                                                                                    
0002ea   19f5     XORWF     0xf5,0x0,0x1                                                                                    
0002ec   e101     BNZ       0x2f0                                                                                           
0002ee   968a     BCF       0x8a,0x3,0x0   			LEDR2 = 0;                                                                    E:\usb20\lighting2\main.c
0002f0   51ed     MOVF      0xed,0x0,0x1   		if(Count == PWM[4].Value)                                                      E:\usb20\lighting2\main.c
0002f2   19f4     XORWF     0xf4,0x0,0x1                                                                                    
0002f4   e102     BNZ       0x2fa                                                                                           
0002f6   51ee     MOVF      0xee,0x0,0x1                                                                                    
0002f8   19f5     XORWF     0xf5,0x0,0x1                                                                                    
0002fa   e101     BNZ       0x2fe                                                                                           
0002fc   988a     BCF       0x8a,0x4,0x0   			LEDG2 = 0;                                                                    E:\usb20\lighting2\main.c
0002fe   51f0     MOVF      0xf0,0x0,0x1   		if(Count == PWM[5].Value)                                                      E:\usb20\lighting2\main.c
000300   19f4     XORWF     0xf4,0x0,0x1                                                                                    
000302   e102     BNZ       0x308                                                                                           
000304   51f1     MOVF      0xf1,0x0,0x1                                                                                    
000306   19f5     XORWF     0xf5,0x0,0x1                                                                                    
000308   e101     BNZ       0x30c                                                                                           
00030a   9a8a     BCF       0x8a,0x5,0x0   			LEDB2 = 0;                                                                    E:\usb20\lighting2\main.c
                                                }                                                                           E:\usb20\lighting2\main.c
00030e   52e5     MOVF      0xe5,0x1,0x0   }                                                                                E:\usb20\lighting2\main.c
000310   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000312   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
000314   ffd9                                                                                                               
000316   0012     RETURN    0x0                                                                                             
                                                                                                                            E:\usb20\lighting2\main.c
                                           //// イルミネート実行関数                                                        E:\usb20\lighting2\main.c
000318   cfd9     MOVFF     0xfd9,0xfe6    void Illuminate(void)                                                            E:\usb20\lighting2\main.c
00031a   ffe6                                                                                                               
00031c   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
00031e   ffd9                                                                                                               
000320   0e02     MOVLW     0x2                                                                                             
000322   26e1     ADDWF     0xe1,0x1,0x0                                                                                    
                                           {                                                                                E:\usb20\lighting2\main.c
                                           	char i, Mask;                                                                   E:\usb20\lighting2\main.c
                                           	                                                                                E:\usb20\lighting2\main.c
000324   52de     MOVF      0xde,0x1,0x0   	Mask = 1;                                                                       E:\usb20\lighting2\main.c
000326   0e01     MOVLW     0x1                                                                                             
000328   6edd     MOVWF     0xdd,0x0                                                                                        
00032a   6adf     CLRF      0xdf,0x0       	for(i=0; i<6; i++) {                                                            E:\usb20\lighting2\main.c
00032c   cfdf     MOVFF     0xfdf,0x16                                                                                      
00032e   f016                                                                                                               
000330   0e06     MOVLW     0x6                                                                                             
000332   6ee7     MOVWF     0xe7,0x0                                                                                        
000334   1816     XORWF     0x16,0x0,0x0                                                                                    
000336   aee8     BTFSS     0xe8,0x7,0x0                                                                                    
000338   d002     BRA       0x33e                                                                                           
00033a   34e7     RLCF      0xe7,0x0,0x0                                                                                    
00033c   d002     BRA       0x342                                                                                           
00033e   50e7     MOVF      0xe7,0x0,0x0                                                                                    
000340   5c16     SUBWF     0x16,0x0,0x0                                                                                    
000342   e301     BNC       0x346                                                                                           
000344   d10f     BRA       0x564                                                                                           
000560   2adf     INCF      0xdf,0x1,0x0                                                                                    
000562   d6e4     BRA       0x32c                                                                                           
000346   0e01     MOVLW     0x1            		if(Color & Mask) {							// 色指定ありか？                                     E:\usb20\lighting2\main.c
000348   50db     MOVF      0xdb,0x0,0x0                                                                                    
00034a   0100     MOVLB     0x0                                                                                             
00034c   15f9     ANDWF     0xf9,0x0,0x1                                                                                    
00034e   e101     BNZ       0x352                                                                                           
000350   d0ea     BRA       0x526                                                                                           
000352   cfdf     MOVFF     0xfdf,0xfe9    			if(PWM[i].UpDown) {						// 上昇中か？                                        E:\usb20\lighting2\main.c
000354   ffe9                                                                                                               
000356   6aea     CLRF      0xea,0x0                                                                                        
000358   bee9     BTFSC     0xe9,0x7,0x0                                                                                    
00035a   68ea     SETF      0xea,0x0                                                                                        
00035c   0e03     MOVLW     0x3                                                                                             
00035e   02ea     MULWF     0xea,0x0                                                                                        
000360   cff3     MOVFF     0xff3,0xfea                                                                                     
000362   ffea                                                                                                               
000364   02e9     MULWF     0xe9,0x0                                                                                        
000366   cff3     MOVFF     0xff3,0xfe9                                                                                     
000368   ffe9                                                                                                               
00036a   50f4     MOVF      0xf4,0x0,0x0                                                                                    
00036c   26ea     ADDWF     0xea,0x1,0x0                                                                                    
00036e   0ee0     MOVLW     0xe0                                                                                            
000370   26e9     ADDWF     0xe9,0x1,0x0                                                                                    
000372   0e00     MOVLW     0x0                                                                                             
000374   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
000376   50ef     MOVF      0xef,0x0,0x0                                                                                    
000378   e05e     BZ        0x436                                                                                           
00037a   cfdf     MOVFF     0xfdf,0xfe9    				PWM[i].Value++;						// PWM幅アップ                                          E:\usb20\lighting2\main.c
00037c   ffe9                                                                                                               
00037e   6aea     CLRF      0xea,0x0                                                                                        
000380   bee9     BTFSC     0xe9,0x7,0x0                                                                                    
000382   68ea     SETF      0xea,0x0                                                                                        
000384   0e03     MOVLW     0x3                                                                                             
000386   02ea     MULWF     0xea,0x0                                                                                        
000388   cff3     MOVFF     0xff3,0xfea                                                                                     
00038a   ffea                                                                                                               
00038c   02e9     MULWF     0xe9,0x0                                                                                        
00038e   cff3     MOVFF     0xff3,0xfe9                                                                                     
000390   ffe9                                                                                                               
000392   50f4     MOVF      0xf4,0x0,0x0                                                                                    
000394   26ea     ADDWF     0xea,0x1,0x0                                                                                    
000396   0ee0     MOVLW     0xe0                                                                                            
000398   26e9     ADDWF     0xe9,0x1,0x0                                                                                    
00039a   0e00     MOVLW     0x0                                                                                             
00039c   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
00039e   52ee     MOVF      0xee,0x1,0x0                                                                                    
0003a0   2aee     INCF      0xee,0x1,0x0                                                                                    
0003a2   0e00     MOVLW     0x0                                                                                             
0003a4   22ef     ADDWFC    0xef,0x1,0x0                                                                                    
0003a6   cfdf     MOVFF     0xfdf,0xfe9    				if(PWM[i].Value >= Max) {				// 最大値まで到達か？                           E:\usb20\lighting2\main.c
0003a8   ffe9                                                                                                               
0003aa   6aea     CLRF      0xea,0x0                                                                                        
0003ac   bee9     BTFSC     0xe9,0x7,0x0                                                                                    
0003ae   68ea     SETF      0xea,0x0                                                                                        
0003b0   0e03     MOVLW     0x3                                                                                             
0003b2   02ea     MULWF     0xea,0x0                                                                                        
0003b4   cff3     MOVFF     0xff3,0xfea                                                                                     
0003b6   ffea                                                                                                               
0003b8   02e9     MULWF     0xe9,0x0                                                                                        
0003ba   cff3     MOVFF     0xff3,0xfe9                                                                                     
0003bc   ffe9                                                                                                               
0003be   50f4     MOVF      0xf4,0x0,0x0                                                                                    
0003c0   26ea     ADDWF     0xea,0x1,0x0                                                                                    
0003c2   0ee0     MOVLW     0xe0                                                                                            
0003c4   26e9     ADDWF     0xe9,0x1,0x0                                                                                    
0003c6   0e00     MOVLW     0x0                                                                                             
0003c8   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
0003ca   52ee     MOVF      0xee,0x1,0x0                                                                                    
0003cc   cfee     MOVFF     0xfee,0x16                                                                                      
0003ce   f016                                                                                                               
0003d0   cfef     MOVFF     0xfef,0x17                                                                                      
0003d2   f017                                                                                                               
0003d4   0101     MOVLB     0x1                                                                                             
0003d6   511c     MOVF      0x1c,0x0,0x1                                                                                    
0003d8   5c16     SUBWF     0x16,0x0,0x0                                                                                    
0003da   511d     MOVF      0x1d,0x0,0x1                                                                                    
0003dc   5817     SUBWFB    0x17,0x0,0x0                                                                                    
0003de   e32a     BNC       0x434                                                                                           
0003e0   cfdf     MOVFF     0xfdf,0xfe9    					PWM[i].Value = Max;				// 最大値で制限                                      E:\usb20\lighting2\main.c
0003e2   ffe9                                                                                                               
0003e4   6aea     CLRF      0xea,0x0                                                                                        
0003e6   bee9     BTFSC     0xe9,0x7,0x0                                                                                    
0003e8   68ea     SETF      0xea,0x0                                                                                        
0003ea   0e03     MOVLW     0x3                                                                                             
0003ec   02ea     MULWF     0xea,0x0                                                                                        
0003ee   cff3     MOVFF     0xff3,0xfea                                                                                     
0003f0   ffea                                                                                                               
0003f2   02e9     MULWF     0xe9,0x0                                                                                        
0003f4   cff3     MOVFF     0xff3,0xfe9                                                                                     
0003f6   ffe9                                                                                                               
0003f8   50f4     MOVF      0xf4,0x0,0x0                                                                                    
0003fa   26ea     ADDWF     0xea,0x1,0x0                                                                                    
0003fc   0ee0     MOVLW     0xe0                                                                                            
0003fe   26e9     ADDWF     0xe9,0x1,0x0                                                                                    
000400   0e00     MOVLW     0x0                                                                                             
000402   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
000404   52ee     MOVF      0xee,0x1,0x0                                                                                    
000406   c11c     MOVFF     0x11c,0xfee                                                                                     
000408   ffee                                                                                                               
00040a   c11d     MOVFF     0x11d,0xfed                                                                                     
00040c   ffed                                                                                                               
00040e   cfdf     MOVFF     0xfdf,0xfe9    					PWM[i].UpDown = 0;				// 下降に変更                                         E:\usb20\lighting2\main.c
000410   ffe9                                                                                                               
000412   6aea     CLRF      0xea,0x0                                                                                        
000414   bee9     BTFSC     0xe9,0x7,0x0                                                                                    
000416   68ea     SETF      0xea,0x0                                                                                        
000418   0e03     MOVLW     0x3                                                                                             
00041a   02ea     MULWF     0xea,0x0                                                                                        
00041c   cff3     MOVFF     0xff3,0xfea                                                                                     
00041e   ffea                                                                                                               
000420   02e9     MULWF     0xe9,0x0                                                                                        
000422   cff3     MOVFF     0xff3,0xfe9                                                                                     
000424   ffe9                                                                                                               
000426   50f4     MOVF      0xf4,0x0,0x0                                                                                    
000428   26ea     ADDWF     0xea,0x1,0x0                                                                                    
00042a   0ee0     MOVLW     0xe0                                                                                            
00042c   26e9     ADDWF     0xe9,0x1,0x0                                                                                    
00042e   0e00     MOVLW     0x0                                                                                             
000430   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
000432   6aef     CLRF      0xef,0x0                                                                                        
                                           				}                                                                            E:\usb20\lighting2\main.c
                                           			}                                                                             E:\usb20\lighting2\main.c
000434   d077     BRA       0x524          			else {									// PWM下降中                                                   E:\usb20\lighting2\main.c
000436   cfdf     MOVFF     0xfdf,0xfe9    				PWM[i].Value--;						// PWM値ダウン                                          E:\usb20\lighting2\main.c
000438   ffe9                                                                                                               
00043a   6aea     CLRF      0xea,0x0                                                                                        
00043c   bee9     BTFSC     0xe9,0x7,0x0                                                                                    
00043e   68ea     SETF      0xea,0x0                                                                                        
000440   0e03     MOVLW     0x3                                                                                             
000442   02ea     MULWF     0xea,0x0                                                                                        
000444   cff3     MOVFF     0xff3,0xfea                                                                                     
000446   ffea                                                                                                               
000448   02e9     MULWF     0xe9,0x0                                                                                        
00044a   cff3     MOVFF     0xff3,0xfe9                                                                                     
00044c   ffe9                                                                                                               
00044e   50f4     MOVF      0xf4,0x0,0x0                                                                                    
000450   26ea     ADDWF     0xea,0x1,0x0                                                                                    
000452   0ee0     MOVLW     0xe0                                                                                            
000454   26e9     ADDWF     0xe9,0x1,0x0                                                                                    
000456   0e00     MOVLW     0x0                                                                                             
000458   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
00045a   52ee     MOVF      0xee,0x1,0x0                                                                                    
00045c   06ee     DECF      0xee,0x1,0x0                                                                                    
00045e   0e00     MOVLW     0x0                                                                                             
000460   5aef     SUBWFB    0xef,0x1,0x0                                                                                    
000462   cfdf     MOVFF     0xfdf,0xfe9    				if(PWM[i].Value <= Min) {				// 最小値まで達したか？                         E:\usb20\lighting2\main.c
000464   ffe9                                                                                                               
000466   6aea     CLRF      0xea,0x0                                                                                        
000468   bee9     BTFSC     0xe9,0x7,0x0                                                                                    
00046a   68ea     SETF      0xea,0x0                                                                                        
00046c   0e03     MOVLW     0x3                                                                                             
00046e   02ea     MULWF     0xea,0x0                                                                                        
000470   cff3     MOVFF     0xff3,0xfea                                                                                     
000472   ffea                                                                                                               
000474   02e9     MULWF     0xe9,0x0                                                                                        
000476   cff3     MOVFF     0xff3,0xfe9                                                                                     
000478   ffe9                                                                                                               
00047a   50f4     MOVF      0xf4,0x0,0x0                                                                                    
00047c   26ea     ADDWF     0xea,0x1,0x0                                                                                    
00047e   0ee0     MOVLW     0xe0                                                                                            
000480   26e9     ADDWF     0xe9,0x1,0x0                                                                                    
000482   0e00     MOVLW     0x0                                                                                             
000484   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
000486   52ee     MOVF      0xee,0x1,0x0                                                                                    
000488   cfee     MOVFF     0xfee,0x16                                                                                      
00048a   f016                                                                                                               
00048c   cfef     MOVFF     0xfef,0x17                                                                                      
00048e   f017                                                                                                               
000490   0101     MOVLB     0x1                                                                                             
000492   5016     MOVF      0x16,0x0,0x0                                                                                    
000494   5d1e     SUBWF     0x1e,0x0,0x1                                                                                    
000496   5017     MOVF      0x17,0x0,0x0                                                                                    
000498   591f     SUBWFB    0x1f,0x0,0x1                                                                                    
00049a   e344     BNC       0x524                                                                                           
00049c   cfdf     MOVFF     0xfdf,0xfe9    					PWM[i].Value = Min;				// 最小値で制限                                      E:\usb20\lighting2\main.c
00049e   ffe9                                                                                                               
0004a0   6aea     CLRF      0xea,0x0                                                                                        
0004a2   bee9     BTFSC     0xe9,0x7,0x0                                                                                    
0004a4   68ea     SETF      0xea,0x0                                                                                        
0004a6   0e03     MOVLW     0x3                                                                                             
0004a8   02ea     MULWF     0xea,0x0                                                                                        
0004aa   cff3     MOVFF     0xff3,0xfea                                                                                     
0004ac   ffea                                                                                                               
0004ae   02e9     MULWF     0xe9,0x0                                                                                        
0004b0   cff3     MOVFF     0xff3,0xfe9                                                                                     
0004b2   ffe9                                                                                                               
0004b4   50f4     MOVF      0xf4,0x0,0x0                                                                                    
0004b6   26ea     ADDWF     0xea,0x1,0x0                                                                                    
0004b8   0ee0     MOVLW     0xe0                                                                                            
0004ba   26e9     ADDWF     0xe9,0x1,0x0                                                                                    
0004bc   0e00     MOVLW     0x0                                                                                             
0004be   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
0004c0   52ee     MOVF      0xee,0x1,0x0                                                                                    
0004c2   c11e     MOVFF     0x11e,0xfee                                                                                     
0004c4   ffee                                                                                                               
0004c6   c11f     MOVFF     0x11f,0xfed                                                                                     
0004c8   ffed                                                                                                               
0004ca   cfdf     MOVFF     0xfdf,0xfe9    					PWM[i].UpDown = 1;				// 上昇に変更                                         E:\usb20\lighting2\main.c
0004cc   ffe9                                                                                                               
0004ce   6aea     CLRF      0xea,0x0                                                                                        
0004d0   bee9     BTFSC     0xe9,0x7,0x0                                                                                    
0004d2   68ea     SETF      0xea,0x0                                                                                        
0004d4   0e03     MOVLW     0x3                                                                                             
0004d6   02ea     MULWF     0xea,0x0                                                                                        
0004d8   cff3     MOVFF     0xff3,0xfea                                                                                     
0004da   ffea                                                                                                               
0004dc   02e9     MULWF     0xe9,0x0                                                                                        
0004de   cff3     MOVFF     0xff3,0xfe9                                                                                     
0004e0   ffe9                                                                                                               
0004e2   50f4     MOVF      0xf4,0x0,0x0                                                                                    
0004e4   26ea     ADDWF     0xea,0x1,0x0                                                                                    
0004e6   0ee0     MOVLW     0xe0                                                                                            
0004e8   26e9     ADDWF     0xe9,0x1,0x0                                                                                    
0004ea   0e00     MOVLW     0x0                                                                                             
0004ec   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
0004ee   0e01     MOVLW     0x1                                                                                             
0004f0   6eef     MOVWF     0xef,0x0                                                                                        
0004f2   0522     DECF      0x22,0x0,0x1   					if(ChangeFlag == 1) {				// 色相変更指示ありか？                            E:\usb20\lighting2\main.c
0004f4   e117     BNZ       0x524                                                                                           
0004f6   6b22     CLRF      0x22,0x1       						ChangeFlag = 0;				// 指示クリア                                           E:\usb20\lighting2\main.c
0004f8   2b1b     INCF      0x1b,0x1,0x1   						ColorIndex++;					// 色相インデックス更新                                  E:\usb20\lighting2\main.c
0004fa   c11b     MOVFF     0x11b,0xfe6    						Color = EERead(ColorIndex);	// 色相取得                                    E:\usb20\lighting2\main.c
0004fc   ffe6                                                                                                               
0004fe   d9d9     RCALL     0x8b2                                                                                           
000500   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000502   0100     MOVLB     0x0                                                                                             
000504   6ff9     MOVWF     0xf9,0x1                                                                                        
000506   51f9     MOVF      0xf9,0x0,0x1   						if((Color == 0) ||(ColorIndex > 0x20))                                     E:\usb20\lighting2\main.c
000508   e00c     BZ        0x522                                                                                           
00050a   0e20     MOVLW     0x20                                                                                            
00050c   0101     MOVLB     0x1                                                                                             
00050e   6ee7     MOVWF     0xe7,0x0                                                                                        
000510   191b     XORWF     0x1b,0x0,0x1                                                                                    
000512   aee8     BTFSS     0xe8,0x7,0x0                                                                                    
000514   d002     BRA       0x51a                                                                                           
000516   351b     RLCF      0x1b,0x0,0x1                                                                                    
000518   d003     BRA       0x520                                                                                           
00051a   50e7     MOVF      0xe7,0x0,0x0                                                                                    
00051c   80d8     BSF       0xd8,0x0,0x0                                                                                    
00051e   551b     SUBFWB    0x1b,0x0,0x1                                                                                    
000520   e201     BC        0x524                                                                                           
000522   d82c     RCALL     0x57c          							Setup();					// 色相初期化				                                            E:\usb20\lighting2\main.c
                                           					}								                                                                   E:\usb20\lighting2\main.c
                                           				}                                                                            E:\usb20\lighting2\main.c
                                           			}                                                                             E:\usb20\lighting2\main.c
                                           		}                                                                              E:\usb20\lighting2\main.c
000524   d017     BRA       0x554          		else										// 色指定無しの場合                                              E:\usb20\lighting2\main.c
000526   cfdf     MOVFF     0xfdf,0xfe9    			PWM[i].Value = Min;						// MIN値に設定                                       E:\usb20\lighting2\main.c
000528   ffe9                                                                                                               
00052a   6aea     CLRF      0xea,0x0                                                                                        
00052c   bee9     BTFSC     0xe9,0x7,0x0                                                                                    
00052e   68ea     SETF      0xea,0x0                                                                                        
000530   0e03     MOVLW     0x3                                                                                             
000532   02ea     MULWF     0xea,0x0                                                                                        
000534   cff3     MOVFF     0xff3,0xfea                                                                                     
000536   ffea                                                                                                               
000538   02e9     MULWF     0xe9,0x0                                                                                        
00053a   cff3     MOVFF     0xff3,0xfe9                                                                                     
00053c   ffe9                                                                                                               
00053e   50f4     MOVF      0xf4,0x0,0x0                                                                                    
000540   26ea     ADDWF     0xea,0x1,0x0                                                                                    
000542   0ee0     MOVLW     0xe0                                                                                            
000544   26e9     ADDWF     0xe9,0x1,0x0                                                                                    
000546   0e00     MOVLW     0x0                                                                                             
000548   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
00054a   52ee     MOVF      0xee,0x1,0x0                                                                                    
00054c   c11e     MOVFF     0x11e,0xfee                                                                                     
00054e   ffee                                                                                                               
000550   c11f     MOVFF     0x11f,0xfed                                                                                     
000552   ffed                                                                                                               
000554   0e01     MOVLW     0x1            		Mask = Mask * 2;								// 色指定ビットマスク更新                              E:\usb20\lighting2\main.c
000556   50db     MOVF      0xdb,0x0,0x0                                                                                    
000558   0d02     MULLW     0x2                                                                                             
00055a   0e01     MOVLW     0x1                                                                                             
00055c   cff3     MOVFF     0xff3,0xfdb                                                                                     
00055e   ffdb                                                                                                               
                                           	}                                                                               E:\usb20\lighting2\main.c
000564   6ef5     MOVWF     0xf5,0x0       }	                                                                               E:\usb20\lighting2\main.c
000566   0e02     MOVLW     0x2                                                                                             
000568   5ce1     SUBWF     0xe1,0x0,0x0                                                                                    
00056a   e202     BC        0x570                                                                                           
00056c   6ae1     CLRF      0xe1,0x0                                                                                        
00056e   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000570   6ee1     MOVWF     0xe1,0x0                                                                                        
000572   50f5     MOVF      0xf5,0x0,0x0                                                                                    
000574   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000576   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
000578   ffd9                                                                                                               
00057a   0012     RETURN    0x0                                                                                             
                                                                                                                            E:\usb20\lighting2\main.c
                                           //// EEPROMからパラメータ設定（初期スタート時）                                  E:\usb20\lighting2\main.c
00057c   cfd9     MOVFF     0xfd9,0xfe6    void Setup(void)                                                                 E:\usb20\lighting2\main.c
00057e   ffe6                                                                                                               
000580   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
000582   ffd9                                                                                                               
000584   52e6     MOVF      0xe6,0x1,0x0                                                                                    
                                           {                                                                                E:\usb20\lighting2\main.c
                                           	char i;                                                                         E:\usb20\lighting2\main.c
                                           	                                                                                E:\usb20\lighting2\main.c
000586   6ae6     CLRF      0xe6,0x0       	Period = (unsigned int)EERead(0)*256 + (unsigned int)EERead(1);                 E:\usb20\lighting2\main.c
000588   d994     RCALL     0x8b2                                                                                           
00058a   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00058c   6e16     MOVWF     0x16,0x0                                                                                        
00058e   6a17     CLRF      0x17,0x0                                                                                        
000590   c016     MOVFF     0x16,0x17                                                                                       
000592   f017                                                                                                               
000594   6a16     CLRF      0x16,0x0                                                                                        
000596   c016     MOVFF     0x16,0xfe6                                                                                      
000598   ffe6                                                                                                               
00059a   c017     MOVFF     0x17,0xfe6                                                                                      
00059c   ffe6                                                                                                               
00059e   0e01     MOVLW     0x1                                                                                             
0005a0   6ee6     MOVWF     0xe6,0x0                                                                                        
0005a2   d987     RCALL     0x8b2                                                                                           
0005a4   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0005a6   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0005a8   cfe7     MOVFF     0xfe7,0x17                                                                                      
0005aa   f017                                                                                                               
0005ac   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0005ae   cfe7     MOVFF     0xfe7,0x16                                                                                      
0005b0   f016                                                                                                               
0005b2   0100     MOVLB     0x0                                                                                             
0005b4   2416     ADDWF     0x16,0x0,0x0                                                                                    
0005b6   6ff2     MOVWF     0xf2,0x1                                                                                        
0005b8   0e00     MOVLW     0x0                                                                                             
0005ba   2017     ADDWFC    0x17,0x0,0x0                                                                                    
0005bc   6ff3     MOVWF     0xf3,0x1                                                                                        
0005be   0e02     MOVLW     0x2            	Interval =(unsigned int)EERead(2)*256 + (unsigned int)EERead(3);                E:\usb20\lighting2\main.c
0005c0   6ee6     MOVWF     0xe6,0x0                                                                                        
0005c2   d977     RCALL     0x8b2                                                                                           
0005c4   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0005c6   6e16     MOVWF     0x16,0x0                                                                                        
0005c8   6a17     CLRF      0x17,0x0                                                                                        
0005ca   c016     MOVFF     0x16,0x17                                                                                       
0005cc   f017                                                                                                               
0005ce   6a16     CLRF      0x16,0x0                                                                                        
0005d0   c016     MOVFF     0x16,0xfe6                                                                                      
0005d2   ffe6                                                                                                               
0005d4   c017     MOVFF     0x17,0xfe6                                                                                      
0005d6   ffe6                                                                                                               
0005d8   0e03     MOVLW     0x3                                                                                             
0005da   6ee6     MOVWF     0xe6,0x0                                                                                        
0005dc   d96a     RCALL     0x8b2                                                                                           
0005de   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0005e0   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0005e2   cfe7     MOVFF     0xfe7,0x17                                                                                      
0005e4   f017                                                                                                               
0005e6   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0005e8   cfe7     MOVFF     0xfe7,0x16                                                                                      
0005ea   f016                                                                                                               
0005ec   0100     MOVLB     0x0                                                                                             
0005ee   2416     ADDWF     0x16,0x0,0x0                                                                                    
0005f0   6ff6     MOVWF     0xf6,0x1                                                                                        
0005f2   0e00     MOVLW     0x0                                                                                             
0005f4   2017     ADDWFC    0x17,0x0,0x0                                                                                    
0005f6   6ff7     MOVWF     0xf7,0x1                                                                                        
0005f8   0e04     MOVLW     0x4            	Max = (unsigned int)EERead(4)*256 + (unsigned int)EERead(5);                    E:\usb20\lighting2\main.c
0005fa   6ee6     MOVWF     0xe6,0x0                                                                                        
0005fc   d95a     RCALL     0x8b2                                                                                           
0005fe   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000600   6e16     MOVWF     0x16,0x0                                                                                        
000602   6a17     CLRF      0x17,0x0                                                                                        
000604   c016     MOVFF     0x16,0x17                                                                                       
000606   f017                                                                                                               
000608   6a16     CLRF      0x16,0x0                                                                                        
00060a   c016     MOVFF     0x16,0xfe6                                                                                      
00060c   ffe6                                                                                                               
00060e   c017     MOVFF     0x17,0xfe6                                                                                      
000610   ffe6                                                                                                               
000612   0e05     MOVLW     0x5                                                                                             
000614   6ee6     MOVWF     0xe6,0x0                                                                                        
000616   d94d     RCALL     0x8b2                                                                                           
000618   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00061a   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00061c   cfe7     MOVFF     0xfe7,0x17                                                                                      
00061e   f017                                                                                                               
000620   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000622   cfe7     MOVFF     0xfe7,0x16                                                                                      
000624   f016                                                                                                               
000626   0101     MOVLB     0x1                                                                                             
000628   2416     ADDWF     0x16,0x0,0x0                                                                                    
00062a   6f1c     MOVWF     0x1c,0x1                                                                                        
00062c   0e00     MOVLW     0x0                                                                                             
00062e   2017     ADDWFC    0x17,0x0,0x0                                                                                    
000630   6f1d     MOVWF     0x1d,0x1                                                                                        
000632   511c     MOVF      0x1c,0x0,0x1   	if(Max > Period) {                                                              E:\usb20\lighting2\main.c
000634   0100     MOVLB     0x0                                                                                             
000636   5df2     SUBWF     0xf2,0x0,0x1                                                                                    
000638   0101     MOVLB     0x1                                                                                             
00063a   511d     MOVF      0x1d,0x0,0x1                                                                                    
00063c   0100     MOVLB     0x0                                                                                             
00063e   59f3     SUBWFB    0xf3,0x0,0x1                                                                                    
000640   e218     BC        0x672                                                                                           
000642   c0f2     MOVFF     0xf2,0x11c     		Max = Period;                                                                  E:\usb20\lighting2\main.c
000644   f11c                                                                                                               
000646   c0f3     MOVFF     0xf3,0x11d                                                                                      
000648   f11d                                                                                                               
00064a   c11d     MOVFF     0x11d,0xfe6    		EEWrite(4, (unsigned char)(Max / 256));		// 修正                               E:\usb20\lighting2\main.c
00064c   ffe6                                                                                                               
00064e   0e04     MOVLW     0x4                                                                                             
000650   6ee6     MOVWF     0xe6,0x0                                                                                        
000652   d916     RCALL     0x880                                                                                           
000654   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000656   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000658   c11c     MOVFF     0x11c,0x16     		EEWrite(5, (unsigned char)(Max % 256));                                        E:\usb20\lighting2\main.c
00065a   f016                                                                                                               
00065c   c11d     MOVFF     0x11d,0x17                                                                                      
00065e   f017                                                                                                               
000660   0100     MOVLB     0x0                                                                                             
000662   6a17     CLRF      0x17,0x0                                                                                        
000664   5016     MOVF      0x16,0x0,0x0                                                                                    
000666   6ee6     MOVWF     0xe6,0x0                                                                                        
000668   0e05     MOVLW     0x5                                                                                             
00066a   6ee6     MOVWF     0xe6,0x0                                                                                        
00066c   d909     RCALL     0x880                                                                                           
00066e   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000670   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                           	}                                                                               E:\usb20\lighting2\main.c
000672   0e08     MOVLW     0x8            	Min = (unsigned int)EERead(8)*256 + (unsigned int)EERead(9);                    E:\usb20\lighting2\main.c
000674   6ee6     MOVWF     0xe6,0x0                                                                                        
000676   d91d     RCALL     0x8b2                                                                                           
000678   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00067a   6e16     MOVWF     0x16,0x0                                                                                        
00067c   6a17     CLRF      0x17,0x0                                                                                        
00067e   c016     MOVFF     0x16,0x17                                                                                       
000680   f017                                                                                                               
000682   6a16     CLRF      0x16,0x0                                                                                        
000684   c016     MOVFF     0x16,0xfe6                                                                                      
000686   ffe6                                                                                                               
000688   c017     MOVFF     0x17,0xfe6                                                                                      
00068a   ffe6                                                                                                               
00068c   0e09     MOVLW     0x9                                                                                             
00068e   6ee6     MOVWF     0xe6,0x0                                                                                        
000690   d910     RCALL     0x8b2                                                                                           
000692   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000694   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000696   cfe7     MOVFF     0xfe7,0x17                                                                                      
000698   f017                                                                                                               
00069a   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00069c   cfe7     MOVFF     0xfe7,0x16                                                                                      
00069e   f016                                                                                                               
0006a0   0101     MOVLB     0x1                                                                                             
0006a2   2416     ADDWF     0x16,0x0,0x0                                                                                    
0006a4   6f1e     MOVWF     0x1e,0x1                                                                                        
0006a6   0e00     MOVLW     0x0                                                                                             
0006a8   2017     ADDWFC    0x17,0x0,0x0                                                                                    
0006aa   6f1f     MOVWF     0x1f,0x1                                                                                        
0006ac   0e01     MOVLW     0x1            	if((Min < 1) || (Min > 255)) {                                                  E:\usb20\lighting2\main.c
0006ae   5d1e     SUBWF     0x1e,0x0,0x1                                                                                    
0006b0   0e00     MOVLW     0x0                                                                                             
0006b2   591f     SUBWFB    0x1f,0x0,0x1                                                                                    
0006b4   e306     BNC       0x6c2                                                                                           
0006b6   0eff     MOVLW     0xff                                                                                            
0006b8   80d8     BSF       0xd8,0x0,0x0                                                                                    
0006ba   551e     SUBFWB    0x1e,0x0,0x1                                                                                    
0006bc   0e00     MOVLW     0x0                                                                                             
0006be   551f     SUBFWB    0x1f,0x0,0x1                                                                                    
0006c0   e217     BC        0x6f0                                                                                           
0006c2   0e01     MOVLW     0x1            		Min = 1;                                                                       E:\usb20\lighting2\main.c
0006c4   6f1e     MOVWF     0x1e,0x1                                                                                        
0006c6   6b1f     CLRF      0x1f,0x1                                                                                        
0006c8   c11f     MOVFF     0x11f,0xfe6    		EEWrite(8, (unsigned char)(Min / 256));		// 修正                               E:\usb20\lighting2\main.c
0006ca   ffe6                                                                                                               
0006cc   0e08     MOVLW     0x8                                                                                             
0006ce   6ee6     MOVWF     0xe6,0x0                                                                                        
0006d0   d8d7     RCALL     0x880                                                                                           
0006d2   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0006d4   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0006d6   c11e     MOVFF     0x11e,0x16     		EEWrite(9, (unsigned char)(Min % 256));                                        E:\usb20\lighting2\main.c
0006d8   f016                                                                                                               
0006da   c11f     MOVFF     0x11f,0x17                                                                                      
0006dc   f017                                                                                                               
0006de   0100     MOVLB     0x0                                                                                             
0006e0   6a17     CLRF      0x17,0x0                                                                                        
0006e2   5016     MOVF      0x16,0x0,0x0                                                                                    
0006e4   6ee6     MOVWF     0xe6,0x0                                                                                        
0006e6   0e09     MOVLW     0x9                                                                                             
0006e8   6ee6     MOVWF     0xe6,0x0                                                                                        
0006ea   d8ca     RCALL     0x880                                                                                           
0006ec   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0006ee   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                           	}		                                                                             E:\usb20\lighting2\main.c
0006f0   0e0a     MOVLW     0xa            	ChangeInterval = (unsigned int)EERead(0x0A)*256 + (unsigned int)EERead(0x0B);   E:\usb20\lighting2\main.c
0006f2   6ee6     MOVWF     0xe6,0x0                                                                                        
0006f4   d8de     RCALL     0x8b2                                                                                           
0006f6   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0006f8   6e16     MOVWF     0x16,0x0                                                                                        
0006fa   6a17     CLRF      0x17,0x0                                                                                        
0006fc   c016     MOVFF     0x16,0x17                                                                                       
0006fe   f017                                                                                                               
000700   6a16     CLRF      0x16,0x0                                                                                        
000702   c016     MOVFF     0x16,0xfe6                                                                                      
000704   ffe6                                                                                                               
000706   c017     MOVFF     0x17,0xfe6                                                                                      
000708   ffe6                                                                                                               
00070a   0e0b     MOVLW     0xb                                                                                             
00070c   6ee6     MOVWF     0xe6,0x0                                                                                        
00070e   d8d1     RCALL     0x8b2                                                                                           
000710   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000712   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000714   cfe7     MOVFF     0xfe7,0x17                                                                                      
000716   f017                                                                                                               
000718   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00071a   cfe7     MOVFF     0xfe7,0x16                                                                                      
00071c   f016                                                                                                               
00071e   0101     MOVLB     0x1                                                                                             
000720   2416     ADDWF     0x16,0x0,0x0                                                                                    
000722   6f20     MOVWF     0x20,0x1                                                                                        
000724   0e00     MOVLW     0x0                                                                                             
000726   2017     ADDWFC    0x17,0x0,0x0                                                                                    
000728   6f21     MOVWF     0x21,0x1                                                                                        
00072a   0e10     MOVLW     0x10           	ColorIndex = 0x10;                                                              E:\usb20\lighting2\main.c
00072c   6f1b     MOVWF     0x1b,0x1                                                                                        
00072e   c11b     MOVFF     0x11b,0xfe6    	Color = EERead(ColorIndex);                                                     E:\usb20\lighting2\main.c
000730   ffe6                                                                                                               
000732   d8bf     RCALL     0x8b2                                                                                           
000734   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000736   0100     MOVLB     0x0                                                                                             
000738   6ff9     MOVWF     0xf9,0x1                                                                                        
00073a   6bf4     CLRF      0xf4,0x1       	Count = 0;                                                                      E:\usb20\lighting2\main.c
00073c   6bf5     CLRF      0xf5,0x1                                                                                        
                                           	/// PWM初期値ランダム設定（記憶値から設定）                                     E:\usb20\lighting2\main.c
00073e   0e30     MOVLW     0x30           	Random = (unsigned int)EERead(0x30)*256 + (unsigned int)EERead(0x31);           E:\usb20\lighting2\main.c
000740   6ee6     MOVWF     0xe6,0x0                                                                                        
000742   d8b7     RCALL     0x8b2                                                                                           
000744   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000746   6e16     MOVWF     0x16,0x0                                                                                        
000748   6a17     CLRF      0x17,0x0                                                                                        
00074a   c016     MOVFF     0x16,0x17                                                                                       
00074c   f017                                                                                                               
00074e   6a16     CLRF      0x16,0x0                                                                                        
000750   c016     MOVFF     0x16,0xfe6                                                                                      
000752   ffe6                                                                                                               
000754   c017     MOVFF     0x17,0xfe6                                                                                      
000756   ffe6                                                                                                               
000758   0e31     MOVLW     0x31                                                                                            
00075a   6ee6     MOVWF     0xe6,0x0                                                                                        
00075c   d8aa     RCALL     0x8b2                                                                                           
00075e   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000760   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000762   cfe7     MOVFF     0xfe7,0x17                                                                                      
000764   f017                                                                                                               
000766   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000768   cfe7     MOVFF     0xfe7,0x16                                                                                      
00076a   f016                                                                                                               
00076c   0100     MOVLB     0x0                                                                                             
00076e   2416     ADDWF     0x16,0x0,0x0                                                                                    
000770   6ffa     MOVWF     0xfa,0x1                                                                                        
000772   0e00     MOVLW     0x0                                                                                             
000774   2017     ADDWFC    0x17,0x0,0x0                                                                                    
000776   6ffb     MOVWF     0xfb,0x1                                                                                        
000778   0e0a     MOVLW     0xa            	Random = Random + 10;								// ランダム基数更新                                E:\usb20\lighting2\main.c
00077a   25fa     ADDWF     0xfa,0x0,0x1                                                                                    
00077c   6ffa     MOVWF     0xfa,0x1                                                                                        
00077e   0e00     MOVLW     0x0                                                                                             
000780   21fb     ADDWFC    0xfb,0x0,0x1                                                                                    
000782   6ffb     MOVWF     0xfb,0x1                                                                                        
000784   c0f2     MOVFF     0xf2,0x16      	if(Random > Period-10)                                                          E:\usb20\lighting2\main.c
000786   f016                                                                                                               
000788   c0f3     MOVFF     0xf3,0x17                                                                                       
00078a   f017                                                                                                               
00078c   0e0a     MOVLW     0xa                                                                                             
00078e   5e16     SUBWF     0x16,0x1,0x0                                                                                    
000790   0e00     MOVLW     0x0                                                                                             
000792   5a17     SUBWFB    0x17,0x1,0x0                                                                                    
000794   51fa     MOVF      0xfa,0x0,0x1                                                                                    
000796   5c16     SUBWF     0x16,0x0,0x0                                                                                    
000798   51fb     MOVF      0xfb,0x0,0x1                                                                                    
00079a   5817     SUBWFB    0x17,0x0,0x0                                                                                    
00079c   e203     BC        0x7a4                                                                                           
00079e   0e0a     MOVLW     0xa            		Random = 10;                                                                   E:\usb20\lighting2\main.c
0007a0   6ffa     MOVWF     0xfa,0x1                                                                                        
0007a2   6bfb     CLRF      0xfb,0x1                                                                                        
0007a4   c0fb     MOVFF     0xfb,0xfe6     	EEWrite(0x30, (unsigned char)(Random / 256));		// ランダム基数記憶              E:\usb20\lighting2\main.c
0007a6   ffe6                                                                                                               
0007a8   0e30     MOVLW     0x30                                                                                            
0007aa   6ee6     MOVWF     0xe6,0x0                                                                                        
0007ac   d869     RCALL     0x880                                                                                           
0007ae   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0007b0   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0007b2   c0fa     MOVFF     0xfa,0x16      	EEWrite(0x31, (unsigned char)(Random % 256));	                                  E:\usb20\lighting2\main.c
0007b4   f016                                                                                                               
0007b6   c0fb     MOVFF     0xfb,0x17                                                                                       
0007b8   f017                                                                                                               
0007ba   0100     MOVLB     0x0                                                                                             
0007bc   6a17     CLRF      0x17,0x0                                                                                        
0007be   5016     MOVF      0x16,0x0,0x0                                                                                    
0007c0   6ee6     MOVWF     0xe6,0x0                                                                                        
0007c2   0e31     MOVLW     0x31                                                                                            
0007c4   6ee6     MOVWF     0xe6,0x0                                                                                        
0007c6   d85c     RCALL     0x880                                                                                           
0007c8   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0007ca   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0007cc   6adf     CLRF      0xdf,0x0       	for(i=0; i<6; i++)                                                              E:\usb20\lighting2\main.c
0007ce   cfdf     MOVFF     0xfdf,0x16                                                                                      
0007d0   f016                                                                                                               
0007d2   0e06     MOVLW     0x6                                                                                             
0007d4   6ee7     MOVWF     0xe7,0x0                                                                                        
0007d6   1816     XORWF     0x16,0x0,0x0                                                                                    
0007d8   aee8     BTFSS     0xe8,0x7,0x0                                                                                    
0007da   d002     BRA       0x7e0                                                                                           
0007dc   34e7     RLCF      0xe7,0x0,0x0                                                                                    
0007de   d002     BRA       0x7e4                                                                                           
0007e0   50e7     MOVF      0xe7,0x0,0x0                                                                                    
0007e2   5c16     SUBWF     0x16,0x0,0x0                                                                                    
0007e4   e248     BC        0x876                                                                                           
000872   2adf     INCF      0xdf,0x1,0x0                                                                                    
000874   d7ac     BRA       0x7ce                                                                                           
                                           	{                                                                               E:\usb20\lighting2\main.c
0007e6   0100     MOVLB     0x0            		srand(Random++);								// PWM値ランダム設定                                   E:\usb20\lighting2\main.c
0007e8   c0fa     MOVFF     0xfa,0x16                                                                                       
0007ea   f016                                                                                                               
0007ec   c0fb     MOVFF     0xfb,0x17                                                                                       
0007ee   f017                                                                                                               
0007f0   2bfa     INCF      0xfa,0x1,0x1                                                                                    
0007f2   0e00     MOVLW     0x0                                                                                             
0007f4   23fb     ADDWFC    0xfb,0x1,0x1                                                                                    
0007f6   c016     MOVFF     0x16,0xfe6                                                                                      
0007f8   ffe6                                                                                                               
0007fa   c017     MOVFF     0x17,0xfe6                                                                                      
0007fc   ffe6                                                                                                               
0007fe   ec54     CALL      0x16a8,0x0                                                                                      
000800   f00b                                                                                                               
000802   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000804   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000806   ec5b     CALL      0x16b6,0x0     		PWM[i].Value = rand() >> 6;                                                    E:\usb20\lighting2\main.c
000808   f00b                                                                                                               
00080a   cff3     MOVFF     0xff3,0x16                                                                                      
00080c   f016                                                                                                               
00080e   cff4     MOVFF     0xff4,0x17                                                                                      
000810   f017                                                                                                               
000812   0e06     MOVLW     0x6                                                                                             
000814   90d8     BCF       0xd8,0x0,0x0                                                                                    
000816   3217     RRCF      0x17,0x1,0x0                                                                                    
000818   3216     RRCF      0x16,0x1,0x0                                                                                    
00081a   04e8     DECF      0xe8,0x0,0x0                                                                                    
00081c   e1fb     BNZ       0x814                                                                                           
00081e   cfdf     MOVFF     0xfdf,0xfe9                                                                                     
000820   ffe9                                                                                                               
000822   6aea     CLRF      0xea,0x0                                                                                        
000824   bee9     BTFSC     0xe9,0x7,0x0                                                                                    
000826   68ea     SETF      0xea,0x0                                                                                        
000828   0e03     MOVLW     0x3                                                                                             
00082a   02ea     MULWF     0xea,0x0                                                                                        
00082c   cff3     MOVFF     0xff3,0xfea                                                                                     
00082e   ffea                                                                                                               
000830   02e9     MULWF     0xe9,0x0                                                                                        
000832   cff3     MOVFF     0xff3,0xfe9                                                                                     
000834   ffe9                                                                                                               
000836   50f4     MOVF      0xf4,0x0,0x0                                                                                    
000838   26ea     ADDWF     0xea,0x1,0x0                                                                                    
00083a   0ee0     MOVLW     0xe0                                                                                            
00083c   26e9     ADDWF     0xe9,0x1,0x0                                                                                    
00083e   0e00     MOVLW     0x0                                                                                             
000840   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
000842   52ee     MOVF      0xee,0x1,0x0                                                                                    
000844   c016     MOVFF     0x16,0xfee                                                                                      
000846   ffee                                                                                                               
000848   c017     MOVFF     0x17,0xfed                                                                                      
00084a   ffed                                                                                                               
                                           //		PWM[i].Value = 1;							// for Debug                                         E:\usb20\lighting2\main.c
00084c   cfdf     MOVFF     0xfdf,0xfe9    		PWM[i].UpDown = 0;                                                             E:\usb20\lighting2\main.c
00084e   ffe9                                                                                                               
000850   6aea     CLRF      0xea,0x0                                                                                        
000852   bee9     BTFSC     0xe9,0x7,0x0                                                                                    
000854   68ea     SETF      0xea,0x0                                                                                        
000856   0e03     MOVLW     0x3                                                                                             
000858   02ea     MULWF     0xea,0x0                                                                                        
00085a   cff3     MOVFF     0xff3,0xfea                                                                                     
00085c   ffea                                                                                                               
00085e   02e9     MULWF     0xe9,0x0                                                                                        
000860   cff3     MOVFF     0xff3,0xfe9                                                                                     
000862   ffe9                                                                                                               
000864   50f4     MOVF      0xf4,0x0,0x0                                                                                    
000866   26ea     ADDWF     0xea,0x1,0x0                                                                                    
000868   0ee0     MOVLW     0xe0                                                                                            
00086a   26e9     ADDWF     0xe9,0x1,0x0                                                                                    
00086c   0e00     MOVLW     0x0                                                                                             
00086e   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
000870   6aef     CLRF      0xef,0x0                                                                                        
                                           	}                                                                               E:\usb20\lighting2\main.c
000876   52e5     MOVF      0xe5,0x1,0x0   }                                                                                E:\usb20\lighting2\main.c
000878   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00087a   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
00087c   ffd9                                                                                                               
00087e   0012     RETURN    0x0                                                                                             
                                           	                                                                                E:\usb20\lighting2\main.c
                                           /// EEPROM書き込み関数                                                           E:\usb20\lighting2\main.c
000880   cfd9     MOVFF     0xfd9,0xfe6    void EEWrite(unsigned char adrs, unsigned char data)                             E:\usb20\lighting2\main.c
000882   ffe6                                                                                                               
000884   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
000886   ffd9                                                                                                               
                                           {	                                                                               E:\usb20\lighting2\main.c
000888   9ea6     BCF       0xa6,0x7,0x0    	EECON1bits.EEPGD = 0;                                                          E:\usb20\lighting2\main.c
00088a   9ca6     BCF       0xa6,0x6,0x0    	EECON1bits.CFGS = 0;                                                           E:\usb20\lighting2\main.c
00088c   0efe     MOVLW     0xfe             	EEADR = adrs;                                                                 E:\usb20\lighting2\main.c
00088e   50db     MOVF      0xdb,0x0,0x0                                                                                    
000890   6ea9     MOVWF     0xa9,0x0                                                                                        
000892   0efd     MOVLW     0xfd             	EEDATA = data;                                                                E:\usb20\lighting2\main.c
000894   50db     MOVF      0xdb,0x0,0x0                                                                                    
000896   6ea8     MOVWF     0xa8,0x0                                                                                        
000898   84a6     BSF       0xa6,0x2,0x0     	EECON1bits.WREN = 1;                                                          E:\usb20\lighting2\main.c
00089a   0e55     MOVLW     0x55             	EECON2 = 0x55; 				// 書き込みシーケンス                                      E:\usb20\lighting2\main.c
00089c   6ea7     MOVWF     0xa7,0x0                                                                                        
00089e   0eaa     MOVLW     0xaa             	EECON2 = 0xaa;                                                                E:\usb20\lighting2\main.c
0008a0   6ea7     MOVWF     0xa7,0x0                                                                                        
0008a2   82a6     BSF       0xa6,0x1,0x0     	EECON1bits.WR = 1;                                                            E:\usb20\lighting2\main.c
0008a4   b2a6     BTFSC     0xa6,0x1,0x0     	while (EECON1bits.WR);                                                        E:\usb20\lighting2\main.c
0008a6   d7fe     BRA       0x8a4                                                                                           
0008a8   98a1     BCF       0xa1,0x4,0x0     	PIR2bits.EEIF = 0;                                                            E:\usb20\lighting2\main.c
0008aa   52e5     MOVF      0xe5,0x1,0x0   }                                                                                E:\usb20\lighting2\main.c
0008ac   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
0008ae   ffd9                                                                                                               
0008b0   0012     RETURN    0x0                                                                                             
                                           /// EEPROM読み出し関数                                                           E:\usb20\lighting2\main.c
0008b2   cfd9     MOVFF     0xfd9,0xfe6    unsigned char EERead(unsigned char adrs)                                         E:\usb20\lighting2\main.c
0008b4   ffe6                                                                                                               
0008b6   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
0008b8   ffd9                                                                                                               
                                           {                                                                                E:\usb20\lighting2\main.c
0008ba   9ea6     BCF       0xa6,0x7,0x0     	EECON1bits.EEPGD = 0;                                                         E:\usb20\lighting2\main.c
0008bc   9ca6     BCF       0xa6,0x6,0x0   	EECON1bits.CFGS = 0;  	                                                         E:\usb20\lighting2\main.c
0008be   0efe     MOVLW     0xfe             	EEADR = adrs;                                                                 E:\usb20\lighting2\main.c
0008c0   50db     MOVF      0xdb,0x0,0x0                                                                                    
0008c2   6ea9     MOVWF     0xa9,0x0                                                                                        
0008c4   80a6     BSF       0xa6,0x0,0x0     	EECON1bits.RD = 1;                                                            E:\usb20\lighting2\main.c
0008c6   50a8     MOVF      0xa8,0x0,0x0     	return(EEDATA);                                                               E:\usb20\lighting2\main.c
0008c8   d000     BRA       0x8ca                                                                                           
0008ca   52e5     MOVF      0xe5,0x1,0x0   }                                                                                E:\usb20\lighting2\main.c
0008cc   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
0008ce   ffd9                                                                                                               
0008d0   0012     RETURN    0x0                                                                                             
                                                                                                                            E:\usb20\lighting2\main.c
                                           ///// EEPROMデフォルト値設定                                                     E:\usb20\lighting2\main.c
                                           void InitEEPROM(void)                                                            E:\usb20\lighting2\main.c
                                           {                                                                                E:\usb20\lighting2\main.c
0008d2   0e03     MOVLW     0x3            	EEWrite(0, 0x03);				// Period                                                  E:\usb20\lighting2\main.c
0008d4   6ee6     MOVWF     0xe6,0x0                                                                                        
0008d6   6ae6     CLRF      0xe6,0x0                                                                                        
0008d8   dfd3     RCALL     0x880                                                                                           
0008da   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0008dc   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0008de   68e6     SETF      0xe6,0x0       	EEWrite(1, 0xFF);                                                               E:\usb20\lighting2\main.c
0008e0   0e01     MOVLW     0x1                                                                                             
0008e2   6ee6     MOVWF     0xe6,0x0                                                                                        
0008e4   dfcd     RCALL     0x880                                                                                           
0008e6   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0008e8   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0008ea   6ae6     CLRF      0xe6,0x0       	EEWrite(2, 0x00);				// Interval                                                E:\usb20\lighting2\main.c
0008ec   0e02     MOVLW     0x2                                                                                             
0008ee   6ee6     MOVWF     0xe6,0x0                                                                                        
0008f0   dfc7     RCALL     0x880                                                                                           
0008f2   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0008f4   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0008f6   0e01     MOVLW     0x1            	EEWrite(3, 0x01);                                                               E:\usb20\lighting2\main.c
0008f8   6ee6     MOVWF     0xe6,0x0                                                                                        
0008fa   0e03     MOVLW     0x3                                                                                             
0008fc   6ee6     MOVWF     0xe6,0x0                                                                                        
0008fe   dfc0     RCALL     0x880                                                                                           
000900   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000902   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000904   0e01     MOVLW     0x1            	EEWrite(4, 0x01);				// Max                                                     E:\usb20\lighting2\main.c
000906   6ee6     MOVWF     0xe6,0x0                                                                                        
000908   0e04     MOVLW     0x4                                                                                             
00090a   6ee6     MOVWF     0xe6,0x0                                                                                        
00090c   dfb9     RCALL     0x880                                                                                           
00090e   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000910   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000912   68e6     SETF      0xe6,0x0       	EEWrite(5, 0xFF);                                                               E:\usb20\lighting2\main.c
000914   0e05     MOVLW     0x5                                                                                             
000916   6ee6     MOVWF     0xe6,0x0                                                                                        
000918   dfb3     RCALL     0x880                                                                                           
00091a   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00091c   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00091e   6ae6     CLRF      0xe6,0x0       	EEWrite(6, 0x00);				//                                                         E:\usb20\lighting2\main.c
000920   0e06     MOVLW     0x6                                                                                             
000922   6ee6     MOVWF     0xe6,0x0                                                                                        
000924   dfad     RCALL     0x880                                                                                           
000926   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000928   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00092a   68e6     SETF      0xe6,0x0       	EEWrite(7, 0xFF);                                                               E:\usb20\lighting2\main.c
00092c   0e07     MOVLW     0x7                                                                                             
00092e   6ee6     MOVWF     0xe6,0x0                                                                                        
000930   dfa7     RCALL     0x880                                                                                           
000932   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000934   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000936   6ae6     CLRF      0xe6,0x0       	EEWrite(8, 0x00);				// Min                                                     E:\usb20\lighting2\main.c
000938   0e08     MOVLW     0x8                                                                                             
00093a   6ee6     MOVWF     0xe6,0x0                                                                                        
00093c   dfa1     RCALL     0x880                                                                                           
00093e   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000940   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000942   0e01     MOVLW     0x1            	EEWrite(9, 0x01);                                                               E:\usb20\lighting2\main.c
000944   6ee6     MOVWF     0xe6,0x0                                                                                        
000946   0e09     MOVLW     0x9                                                                                             
000948   6ee6     MOVWF     0xe6,0x0                                                                                        
00094a   df9a     RCALL     0x880                                                                                           
00094c   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00094e   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000950   0e04     MOVLW     0x4            	EEWrite(0x0A, 0x04);			// ChangeInterval                                        E:\usb20\lighting2\main.c
000952   6ee6     MOVWF     0xe6,0x0                                                                                        
000954   0e0a     MOVLW     0xa                                                                                             
000956   6ee6     MOVWF     0xe6,0x0                                                                                        
000958   df93     RCALL     0x880                                                                                           
00095a   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00095c   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00095e   68e6     SETF      0xe6,0x0       	EEWrite(0x0B, 0xFF);                                                            E:\usb20\lighting2\main.c
000960   0e0b     MOVLW     0xb                                                                                             
000962   6ee6     MOVWF     0xe6,0x0                                                                                        
000964   df8d     RCALL     0x880                                                                                           
000966   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000968   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00096a   0e09     MOVLW     0x9            	EEWrite(0x10, 0x09);			// pattern0                                              E:\usb20\lighting2\main.c
00096c   6ee6     MOVWF     0xe6,0x0                                                                                        
00096e   0e10     MOVLW     0x10                                                                                            
000970   6ee6     MOVWF     0xe6,0x0                                                                                        
000972   df86     RCALL     0x880                                                                                           
000974   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000976   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000978   0e12     MOVLW     0x12           	EEWrite(0x11, 0x12);			// pattern1                                              E:\usb20\lighting2\main.c
00097a   6ee6     MOVWF     0xe6,0x0                                                                                        
00097c   0e11     MOVLW     0x11                                                                                            
00097e   6ee6     MOVWF     0xe6,0x0                                                                                        
000980   df7f     RCALL     0x880                                                                                           
000982   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000984   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000986   0e24     MOVLW     0x24           	EEWrite(0x12, 0x24);			// pattern2                                              E:\usb20\lighting2\main.c
000988   6ee6     MOVWF     0xe6,0x0                                                                                        
00098a   0e12     MOVLW     0x12                                                                                            
00098c   6ee6     MOVWF     0xe6,0x0                                                                                        
00098e   df78     RCALL     0x880                                                                                           
000990   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000992   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000994   0e1b     MOVLW     0x1b           	EEWrite(0x13, 0x1B);			// pattern3                                              E:\usb20\lighting2\main.c
000996   6ee6     MOVWF     0xe6,0x0                                                                                        
000998   0e13     MOVLW     0x13                                                                                            
00099a   6ee6     MOVWF     0xe6,0x0                                                                                        
00099c   df71     RCALL     0x880                                                                                           
00099e   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0009a0   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0009a2   0e1e     MOVLW     0x1e           	EEWrite(0x14, 0x1E);			// pattern4                                              E:\usb20\lighting2\main.c
0009a4   6ee6     MOVWF     0xe6,0x0                                                                                        
0009a6   0e14     MOVLW     0x14                                                                                            
0009a8   6ee6     MOVWF     0xe6,0x0                                                                                        
0009aa   df6a     RCALL     0x880                                                                                           
0009ac   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0009ae   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0009b0   0e36     MOVLW     0x36           	EEWrite(0x15, 0x36);			// pattern5                                              E:\usb20\lighting2\main.c
0009b2   6ee6     MOVWF     0xe6,0x0                                                                                        
0009b4   0e15     MOVLW     0x15                                                                                            
0009b6   6ee6     MOVWF     0xe6,0x0                                                                                        
0009b8   df63     RCALL     0x880                                                                                           
0009ba   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0009bc   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0009be   0e2d     MOVLW     0x2d           	EEWrite(0x16, 0x2D);			// pattern6                                              E:\usb20\lighting2\main.c
0009c0   6ee6     MOVWF     0xe6,0x0                                                                                        
0009c2   0e16     MOVLW     0x16                                                                                            
0009c4   6ee6     MOVWF     0xe6,0x0                                                                                        
0009c6   df5c     RCALL     0x880                                                                                           
0009c8   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0009ca   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0009cc   0e3f     MOVLW     0x3f           	EEWrite(0x17, 0x3F);                                                            E:\usb20\lighting2\main.c
0009ce   6ee6     MOVWF     0xe6,0x0                                                                                        
0009d0   0e17     MOVLW     0x17                                                                                            
0009d2   6ee6     MOVWF     0xe6,0x0                                                                                        
0009d4   df55     RCALL     0x880                                                                                           
0009d6   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0009d8   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0009da   0e21     MOVLW     0x21           	EEWrite(0x18, 0x21);                                                            E:\usb20\lighting2\main.c
0009dc   6ee6     MOVWF     0xe6,0x0                                                                                        
0009de   0e18     MOVLW     0x18                                                                                            
0009e0   6ee6     MOVWF     0xe6,0x0                                                                                        
0009e2   df4e     RCALL     0x880                                                                                           
0009e4   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0009e6   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0009e8   0e14     MOVLW     0x14           	EEWrite(0x19, 0x14);                                                            E:\usb20\lighting2\main.c
0009ea   6ee6     MOVWF     0xe6,0x0                                                                                        
0009ec   0e19     MOVLW     0x19                                                                                            
0009ee   6ee6     MOVWF     0xe6,0x0                                                                                        
0009f0   df47     RCALL     0x880                                                                                           
0009f2   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0009f4   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0009f6   0e0c     MOVLW     0xc            	EEWrite(0x1A, 0x0C);                                                            E:\usb20\lighting2\main.c
0009f8   6ee6     MOVWF     0xe6,0x0                                                                                        
0009fa   0e1a     MOVLW     0x1a                                                                                            
0009fc   6ee6     MOVWF     0xe6,0x0                                                                                        
0009fe   df40     RCALL     0x880                                                                                           
000a00   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000a02   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000a04   0e33     MOVLW     0x33           	EEWrite(0x1B, 0x33);                                                            E:\usb20\lighting2\main.c
000a06   6ee6     MOVWF     0xe6,0x0                                                                                        
000a08   0e1b     MOVLW     0x1b                                                                                            
000a0a   6ee6     MOVWF     0xe6,0x0                                                                                        
000a0c   df39     RCALL     0x880                                                                                           
000a0e   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000a10   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000a12   6ae6     CLRF      0xe6,0x0       	EEWrite(0x1C, 0);                                                               E:\usb20\lighting2\main.c
000a14   0e1c     MOVLW     0x1c                                                                                            
000a16   6ee6     MOVWF     0xe6,0x0                                                                                        
000a18   df33     RCALL     0x880                                                                                           
000a1a   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000a1c   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000a1e   6ae6     CLRF      0xe6,0x0       	EEWrite(0x1D, 0);                                                               E:\usb20\lighting2\main.c
000a20   0e1d     MOVLW     0x1d                                                                                            
000a22   6ee6     MOVWF     0xe6,0x0                                                                                        
000a24   df2d     RCALL     0x880                                                                                           
000a26   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000a28   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000a2a   6ae6     CLRF      0xe6,0x0       	EEWrite(0x1E, 0);                                                               E:\usb20\lighting2\main.c
000a2c   0e1e     MOVLW     0x1e                                                                                            
000a2e   6ee6     MOVWF     0xe6,0x0                                                                                        
000a30   df27     RCALL     0x880                                                                                           
000a32   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000a34   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000a36   6ae6     CLRF      0xe6,0x0       	EEWrite(0x1F, 0);                                                               E:\usb20\lighting2\main.c
000a38   0e1f     MOVLW     0x1f                                                                                            
000a3a   6ee6     MOVWF     0xe6,0x0                                                                                        
000a3c   df21     RCALL     0x880                                                                                           
000a3e   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000a40   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000a42   0012     RETURN    0x0            }                                                                                E:\usb20\lighting2\main.c
                                           			                                                                              E:\usb20\lighting2\main.c
                                                                                                                            E:\usb20\lighting2\main.c
                                           /******** EEPROM Memory Map                                                      E:\usb20\lighting2\main.c
                                           	 0 : Period High                                                                E:\usb20\lighting2\main.c
                                           	 1 : Period Low                                                                 E:\usb20\lighting2\main.c
                                           	 2 : Interval High                                                              E:\usb20\lighting2\main.c
                                           	 3 : Interval Low                                                               E:\usb20\lighting2\main.c
                                           	 4 : Max High                                                                   E:\usb20\lighting2\main.c
                                           	 5 : Max Low                                                                    E:\usb20\lighting2\main.c
                                           	 6 :                                                                            E:\usb20\lighting2\main.c
                                           	 7 :                                                                            E:\usb20\lighting2\main.c
                                           	 8 : Min High                                                                   E:\usb20\lighting2\main.c
                                           	 9 : Min Low                                                                    E:\usb20\lighting2\main.c
                                           	 A : ChangeInterval High                                                        E:\usb20\lighting2\main.c
                                           	 B : ChangeInterval Low                                                         E:\usb20\lighting2\main.c
                                           	 C :                                                                            E:\usb20\lighting2\main.c
                                           	 D :                                                                            E:\usb20\lighting2\main.c
                                           	 E :                                                                            E:\usb20\lighting2\main.c
                                           	 F :	                                                                           E:\usb20\lighting2\main.c
                                           	10 : pattern[0]                                                                 E:\usb20\lighting2\main.c
                                           	11 : pattern[1]                                                                 E:\usb20\lighting2\main.c
                                           	12 : pattern[2]                                                                 E:\usb20\lighting2\main.c
                                           	13 : pattern[3]                                                                 E:\usb20\lighting2\main.c
                                           	14 : pattern[4]                                                                 E:\usb20\lighting2\main.c
                                           	-------                                                                         E:\usb20\lighting2\main.c
                                           	1F : pattern[16]                                                                E:\usb20\lighting2\main.c
                                           	30 : Random High                                                                E:\usb20\lighting2\main.c
                                           	31 : Random Low                                                                 E:\usb20\lighting2\main.c
                                           *************************************/                                           E:\usb20\lighting2\main.c
                                           /*********************************************************************           E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            *             Microchip USB C18 Firmware -  CDC Version 1.0                     E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            *********************************************************************           E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            * FileName:        cdc.c                                                        E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            * Dependencies:    See INCLUDES section below                                   E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            * Processor:       PIC18                                                        E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            * Compiler:        C18 2.30.01+                                                 E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            * Company:         Microchip Technology, Inc.                                   E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            * Software License Agreement                                                    E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            * The software supplied herewith by Microchip Technology Incorporated           E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            * (the 鼎ompany) for its PICmicroｮ Microcontroller is intended and             E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            * supplied to you, the Company痴 customer, for use solely and                   E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            * exclusively on Microchip PICmicro Microcontroller products. The               E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            * software is owned by the Company and/or its supplier, and is                  E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            * protected under applicable copyright laws. All rights are reserved.           E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            * Any use in violation of the foregoing restrictions may subject the            E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            * user to criminal sanctions under applicable laws, as well as to               E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            * civil liability for the breach of the terms and conditions of this            E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            * license.                                                                      E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            * THIS SOFTWARE IS PROVIDED IN AN 鄭S IS CONDITION. NO WARRANTIES,             E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            * WHETHER EXPRESS, IMPLIED OR STATUTORY, INCLUDING, BUT NOT LIMITED             E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            * TO, IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A                   E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            * PARTICULAR PURPOSE APPLY TO THIS SOFTWARE. THE COMPANY SHALL NOT,             E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            * IN ANY CIRCUMSTANCES, BE LIABLE FOR SPECIAL, INCIDENTAL OR                    E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            * CONSEQUENTIAL DAMAGES, FOR ANY REASON WHATSOEVER.                             E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            * Author               Date        Comment                                      E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            *~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~           E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            * Rawin Rojvanit       11/19/04    Original. RS-232 Emulation Subset            E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            ********************************************************************/           E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                                                                                            E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                           /** I N C L U D E S **********************************************************/  E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                           #include <p18cxxx.h>                                                             E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                           #include "system\typedefs.h"                                                     E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                           #include "system\usb\usb.h"                                                      E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                                                                                            E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                           #ifdef USB_USE_CDC                                                               E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                                                                                            E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                           /** V A R I A B L E S ********************************************************/  E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                           #pragma udata                                                                    E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                           byte cdc_rx_len;            // total rx length                                   E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                                                                                            E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                           byte cdc_trf_state;         // States are defined cdc.h                          E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                           POINTER pCDCSrc;            // Dedicated source pointer                          E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                           POINTER pCDCDst;            // Dedicated destination pointer                     E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                           byte cdc_tx_len;            // total tx length                                   E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                           byte cdc_mem_type;          // _ROM, _RAM                                        E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                                                                                            E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                           LINE_CODING line_coding;    // Buffer to store line coding information           E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                           CONTROL_SIGNAL_BITMAP control_signal_bitmap;                                     E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                                                                                            E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                           /*                                                                               E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            * SEND_ENCAPSULATED_COMMAND and GET_ENCAPSULATED_RESPONSE are required          E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            * requests according to the CDC specification.                                  E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            * However, it is not really being used here, therefore a dummy buffer is        E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            * used for conformance.                                                         E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            */                                                                              E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                           #define dummy_length    0x08                                                     E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                           byte dummy_encapsulated_cmd_response[dummy_length];                              E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                                                                                            E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                           /** P R I V A T E  P R O T O T Y P E S ***************************************/  E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                                                                                            E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                           /** D E C L A R A T I O N S **************************************************/  E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                           #pragma code                                                                     E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                                                                                            E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                           /** C L A S S  S P E C I F I C  R E Q ****************************************/  E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                           /******************************************************************************  E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            * Function:        void USBCheckCDCRequest(void)                                E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            * PreCondition:    None                                                         E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            * Input:           None                                                         E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            * Output:          None                                                         E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            * Side Effects:    None                                                         E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            * Overview:        This routine checks the setup data packet to see if it       E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            *                  knows how to handle it                                       E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            * Note:            None                                                         E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            *****************************************************************************/  E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                           void USBCheckCDCRequest(void)                                                    E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                           {                                                                                E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                               /*                                                                           E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                * If request recipient is not an interface then return                      E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                */                                                                          E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000a44   0104     MOVLB     0x4                if(SetupPkt.Recipient != RCPT_INTF) return;                                  E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000a46   5120     MOVF      0x20,0x0,0x1                                                                                    
000a48   0b1f     ANDLW     0x1f                                                                                            
000a4a   0801     SUBLW     0x1                                                                                             
000a4c   e001     BZ        0xa50                                                                                           
000a4e   d05b     BRA       0xb06                                                                                           
                                                                                                                            E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                               /*                                                                           E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                * If request type is not class-specific then return                         E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                */                                                                          E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000a50   5120     MOVF      0x20,0x0,0x1       if(SetupPkt.RequestType != CLASS) return;                                    E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000a52   0b60     ANDLW     0x60                                                                                            
000a54   42e8     RRNCF     0xe8,0x1,0x0                                                                                    
000a56   42e8     RRNCF     0xe8,0x1,0x0                                                                                    
000a58   42e8     RRNCF     0xe8,0x1,0x0                                                                                    
000a5a   42e8     RRNCF     0xe8,0x1,0x0                                                                                    
000a5c   42e8     RRNCF     0xe8,0x1,0x0                                                                                    
000a5e   0801     SUBLW     0x1                                                                                             
000a60   e001     BZ        0xa64                                                                                           
000a62   d051     BRA       0xb06                                                                                           
                                                                                                                            E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                               /*                                                                           E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                * Interface ID must match interface numbers associated with                 E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                * CDC class, else return                                                    E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                */                                                                          E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000a64   5124     MOVF      0x24,0x0,0x1       if((SetupPkt.bIntfID != CDC_COMM_INTF_ID)&&                                  E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000a66   e003     BZ        0xa6e                 (SetupPkt.bIntfID != CDC_DATA_INTF_ID)) return;                           E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000a68   0524     DECF      0x24,0x0,0x1                                                                                    
000a6a   e001     BZ        0xa6e                                                                                           
000a6c   d04c     BRA       0xb06                                                                                           
                                                                                                                            E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000a6e   5121     MOVF      0x21,0x0,0x1       switch(SetupPkt.bRequest)                                                    E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000a70   0a23     XORLW     0x23                                                                                            
000a72   e048     BZ        0xb04                                                                                           
000a74   0a01     XORLW     0x1                                                                                             
000a76   e040     BZ        0xaf8                                                                                           
000a78   0a03     XORLW     0x3                                                                                             
000a7a   e030     BZ        0xadc                                                                                           
000a7c   0a01     XORLW     0x1                                                                                             
000a7e   e025     BZ        0xaca                                                                                           
000a80   0a24     XORLW     0x24                                                                                            
000a82   e022     BZ        0xac8                                                                                           
000a84   0a07     XORLW     0x7                                                                                             
000a86   e01f     BZ        0xac6                                                                                           
000a88   0a01     XORLW     0x1                                                                                             
000a8a   e01c     BZ        0xac4                                                                                           
000a8c   0a03     XORLW     0x3                                                                                             
000a8e   e011     BZ        0xab2                                                                                           
000a90   0a01     XORLW     0x1                                                                                             
000a92   e001     BZ        0xa96                                                                                           
                                               {                                                                            E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                   case SEND_ENCAPSULATED_COMMAND:                                          E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000a96   0101     MOVLB     0x1                        ctrl_trf_session_owner = MUID_CDC;                                   E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000a98   0e03     MOVLW     0x3                                                                                             
000a9a   6f31     MOVWF     0x31,0x1                                                                                        
000a9c   0101     MOVLB     0x1                        pSrc.bRam = (byte*)&dummy_encapsulated_cmd_response;                 E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000a9e   0e13     MOVLW     0x13                                                                                            
000aa0   6f32     MOVWF     0x32,0x1                                                                                        
000aa2   0e01     MOVLW     0x1                                                                                             
000aa4   6f33     MOVWF     0x33,0x1                                                                                        
000aa6   0100     MOVLB     0x0                        usb_stat.ctrl_trf_mem = _RAM;                                        E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000aa8   93fd     BCF       0xfd,0x1,0x1                                                                                    
000aaa   0101     MOVLB     0x1                        LSB(wCount) = dummy_length;                                          E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000aac   0e08     MOVLW     0x8                                                                                             
000aae   6f36     MOVWF     0x36,0x1                                                                                        
000ab0   d02a     BRA       0xb06                      break;                                                               E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                   case GET_ENCAPSULATED_RESPONSE:                                          E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000ab2   0101     MOVLB     0x1                        ctrl_trf_session_owner = MUID_CDC;                                   E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000ab4   0e03     MOVLW     0x3                                                                                             
000ab6   6f31     MOVWF     0x31,0x1                                                                                        
                                                       // Populate dummy_encapsulated_cmd_response first.                   E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000ab8   0101     MOVLB     0x1                        pDst.bRam = (byte*)&dummy_encapsulated_cmd_response;                 E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000aba   0e13     MOVLW     0x13                                                                                            
000abc   6f34     MOVWF     0x34,0x1                                                                                        
000abe   0e01     MOVLW     0x1                                                                                             
000ac0   6f35     MOVWF     0x35,0x1                                                                                        
000ac2   d021     BRA       0xb06                      break;                                                               E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                   case SET_COMM_FEATURE:                  // Optional                      E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000ac4   d020     BRA       0xb06                      break;                                                               E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                   case GET_COMM_FEATURE:                  // Optional                      E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000ac6   d01f     BRA       0xb06                      break;                                                               E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                   case CLEAR_COMM_FEATURE:                // Optional                      E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000ac8   d01e     BRA       0xb06                      break;                                                               E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                   case SET_LINE_CODING:                                                    E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000aca   0101     MOVLB     0x1                        ctrl_trf_session_owner = MUID_CDC;                                   E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000acc   0e03     MOVLW     0x3                                                                                             
000ace   6f31     MOVWF     0x31,0x1                                                                                        
000ad0   0101     MOVLB     0x1                        pDst.bRam = (byte*)&line_coding;    // Set destination               E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000ad2   0e08     MOVLW     0x8                                                                                             
000ad4   6f34     MOVWF     0x34,0x1                                                                                        
000ad6   0e01     MOVLW     0x1                                                                                             
000ad8   6f35     MOVWF     0x35,0x1                                                                                        
000ada   d015     BRA       0xb06                      break;                                                               E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                   case GET_LINE_CODING:                                                    E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000adc   0101     MOVLB     0x1                        ctrl_trf_session_owner = MUID_CDC;                                   E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000ade   0e03     MOVLW     0x3                                                                                             
000ae0   6f31     MOVWF     0x31,0x1                                                                                        
000ae2   0101     MOVLB     0x1                        pSrc.bRam = (byte*)&line_coding;    // Set source                    E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000ae4   0e08     MOVLW     0x8                                                                                             
000ae6   6f32     MOVWF     0x32,0x1                                                                                        
000ae8   0e01     MOVLW     0x1                                                                                             
000aea   6f33     MOVWF     0x33,0x1                                                                                        
000aec   0100     MOVLB     0x0                        usb_stat.ctrl_trf_mem = _RAM;       // Set memory type               E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000aee   93fd     BCF       0xfd,0x1,0x1                                                                                    
000af0   0101     MOVLB     0x1                        LSB(wCount) = LINE_CODING_LENGTH;   // Set data count                E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000af2   0e07     MOVLW     0x7                                                                                             
000af4   6f36     MOVWF     0x36,0x1                                                                                        
000af6   d007     BRA       0xb06                      break;                                                               E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                   case SET_CONTROL_LINE_STATE:                                             E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000af8   0101     MOVLB     0x1                        ctrl_trf_session_owner = MUID_CDC;                                   E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000afa   0e03     MOVLW     0x3                                                                                             
000afc   6f31     MOVWF     0x31,0x1                                                                                        
000afe   c422     MOVFF     0x422,0x10f                control_signal_bitmap._byte = LSB(SetupPkt.W_Value);                 E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000b00   f10f                                                                                                               
000b02   d001     BRA       0xb06                      break;                                                               E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                   case SEND_BREAK:                        // Optional                      E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000b04   d000     BRA       0xb06                      break;                                                               E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                   default:                                                                 E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000a94   d038     BRA       0xb06                      break;                                                               E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                               }//end switch(SetupPkt.bRequest)                                             E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                                                                                            E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000b06   0012     RETURN    0x0            }//end USBCheckCDCRequest                                                        E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                                                                                            E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                           /** U S E R  A P I ***********************************************************/  E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                                                                                            E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                           /******************************************************************************  E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            * Function:        void CDCInitEP(void)                                         E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            * PreCondition:    None                                                         E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            * Input:           None                                                         E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            * Output:          None                                                         E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            * Side Effects:    None                                                         E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            * Overview:        CDCInitEP initializes CDC endpoints, buffer descriptors,     E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            *                  internal state-machine, and variables.                       E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            *                  It should be called after the USB host has sent out a        E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            *                  SET_CONFIGURATION request.                                   E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            *                  See USBStdSetCfgHandler() in usb9.c for examples.            E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            * Note:            None                                                         E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            *****************************************************************************/  E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                           void CDCInitEP(void)                                                             E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                           {                                                                                E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                               //Abstract line coding information                                           E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000b08   0101     MOVLB     0x1                line_coding.dwDTERate._dword = 115200;      // baud rate                     E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000b0a   6b08     CLRF      0x8,0x1                                                                                         
000b0c   0ec2     MOVLW     0xc2                                                                                            
000b0e   6f09     MOVWF     0x9,0x1                                                                                         
000b10   0e01     MOVLW     0x1                                                                                             
000b12   6f0a     MOVWF     0xa,0x1                                                                                         
000b14   6b0b     CLRF      0xb,0x1                                                                                         
000b16   6b0c     CLRF      0xc,0x1            line_coding.bCharFormat = 0x00;             // 1 stop bit                    E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000b18   6b0d     CLRF      0xd,0x1            line_coding.bParityType = 0x00;             // None                          E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000b1a   0e08     MOVLW     0x8                line_coding.bDataBits = 0x08;               // 5,6,7,8, or 16                E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000b1c   6f0e     MOVWF     0xe,0x1                                                                                         
                                                                                                                            E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000b1e   6b01     CLRF      0x1,0x1            cdc_trf_state = CDC_TX_READY;                                                E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000b20   6b00     CLRF      0x0,0x1            cdc_rx_len = 0;                                                              E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                                                                                            E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000b22   0e1a     MOVLW     0x1a               CDC_COMM_UEP = EP_IN|HSHK_EN;               // Enable 1 Comm pipe            E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000b24   6e72     MOVWF     0x72,0x0                                                                                        
000b26   0e1e     MOVLW     0x1e               CDC_DATA_UEP = EP_OUT_IN|HSHK_EN;           // Enable 2 data pipes           E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000b28   6e73     MOVWF     0x73,0x0                                                                                        
                                                                                                                            E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                               /*                                                                           E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                * Do not have to init Cnt of IN pipes here.                                 E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                * Reason:  Number of bytes to send to the host                              E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                *          varies from one transaction to                                   E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                *          another. Cnt should equal the exact                              E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                *          number of bytes to transmit for                                  E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                *          a given IN transaction.                                          E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                *          This number of bytes will only                                   E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                *          be known right before the data is                                E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                *          sent.                                                            E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                */                                                                          E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000b2a   0104     MOVLB     0x4                CDC_INT_BD_IN.ADR = (byte*)&cdc_notice;     // Set buffer address            E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000b2c   0e00     MOVLW     0x0                                                                                             
000b2e   6f16     MOVWF     0x16,0x1                                                                                        
000b30   0e05     MOVLW     0x5                                                                                             
000b32   6f17     MOVWF     0x17,0x1                                                                                        
000b34   0e40     MOVLW     0x40               CDC_INT_BD_IN.Stat._byte = _UCPU|_DAT1;     // Set status                    E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000b36   6f14     MOVWF     0x14,0x1                                                                                        
                                                                                                                            E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000b38   0104     MOVLB     0x4                CDC_BULK_BD_OUT.Cnt = sizeof(cdc_data_rx);  // Set buffer size               E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000b3a   6f19     MOVWF     0x19,0x1                                                                                        
000b3c   0e08     MOVLW     0x8                CDC_BULK_BD_OUT.ADR = (byte*)&cdc_data_rx;  // Set buffer address            E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000b3e   6f1a     MOVWF     0x1a,0x1                                                                                        
000b40   0e05     MOVLW     0x5                                                                                             
000b42   6f1b     MOVWF     0x1b,0x1                                                                                        
000b44   0e88     MOVLW     0x88               CDC_BULK_BD_OUT.Stat._byte = _USIE|_DAT0|_DTSEN;// Set status                E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000b46   6f18     MOVWF     0x18,0x1                                                                                        
                                                                                                                            E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000b48   0104     MOVLB     0x4                CDC_BULK_BD_IN.ADR = (byte*)&cdc_data_tx;   // Set buffer size               E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000b4a   0e48     MOVLW     0x48                                                                                            
000b4c   6f1e     MOVWF     0x1e,0x1                                                                                        
000b4e   0e05     MOVLW     0x5                                                                                             
000b50   6f1f     MOVWF     0x1f,0x1                                                                                        
000b52   0e40     MOVLW     0x40               CDC_BULK_BD_IN.Stat._byte = _UCPU|_DAT1;    // Set buffer address            E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000b54   6f1c     MOVWF     0x1c,0x1                                                                                        
                                                                                                                            E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000b56   0012     RETURN    0x0            }//end CDCInitEP                                                                 E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                                                                                            E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                           /******************************************************************************  E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            * Function:        byte getsUSBUSART(char *buffer,                              E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            *                                    byte len)                                  E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            * PreCondition:    Value of input argument 'len' should be smaller than the     E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            *                  maximum endpoint size responsible for receiving bulk         E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            *                  data from USB host for CDC class.                            E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            *                  Input argument 'buffer' should point to a buffer area that   E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            *                  is bigger or equal to the size specified by 'len'.           E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            * Input:           buffer  : Pointer to where received bytes are to be stored   E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            *                  len     : The number of bytes expected.                      E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            * Output:          The number of bytes copied to buffer.                        E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            * Side Effects:    Publicly accessible variable cdc_rx_len is updated with      E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            *                  the number of bytes copied to buffer.                        E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            *                  Once getsUSBUSART is called, subsequent retrieval of         E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            *                  cdc_rx_len can be done by calling macro mCDCGetRxLength().   E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            * Overview:        getsUSBUSART copies a string of bytes received through       E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            *                  USB CDC Bulk OUT endpoint to a user's specified location.    E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            *                  It is a non-blocking function. It does not wait              E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            *                  for data if there is no data available. Instead it returns   E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            *                  '0' to notify the caller that there is no data available.    E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            * Note:            If the actual number of bytes received is larger than the    E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            *                  number of bytes expected (len), only the expected number     E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            *                  of bytes specified will be copied to buffer.                 E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            *                  If the actual number of bytes received is smaller than the   E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            *                  number of bytes expected (len), only the actual number       E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            *                  of bytes received will be copied to buffer.                  E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            *****************************************************************************/  E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000b58   cfd9     MOVFF     0xfd9,0xfe6    byte getsUSBUSART(char *buffer, byte len)                                        E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000b5a   ffe6                                                                                                               
000b5c   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
000b5e   ffd9                                                                                                               
                                           {                                                                                E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000b60   0101     MOVLB     0x1                cdc_rx_len = 0;                                                              E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000b62   6b00     CLRF      0x0,0x1                                                                                         
                                                                                                                            E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000b64   0104     MOVLB     0x4                if(!mCDCUsartRxIsBusy())                                                     E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000b66   bf18     BTFSC     0x18,0x7,0x1                                                                                    
000b68   d030     BRA       0xbca                                                                                           
                                               {                                                                            E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                   /*                                                                       E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                    * Adjust the expected number of bytes to equal                          E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                    * the actual number of bytes received.                                  E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                    */                                                                      E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000b6a   0efc     MOVLW     0xfc                   if(len > CDC_BULK_BD_OUT.Cnt)                                            E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000b6c   cfdb     MOVFF     0xfdb,0x16                                                                                      
000b6e   f016                                                                                                               
000b70   5119     MOVF      0x19,0x0,0x1                                                                                    
000b72   80d8     BSF       0xd8,0x0,0x0                                                                                    
000b74   5416     SUBFWB    0x16,0x0,0x0                                                                                    
000b76   e203     BC        0xb7e                                                                                           
000b78   0efc     MOVLW     0xfc                       len = CDC_BULK_BD_OUT.Cnt;                                           E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000b7a   c419     MOVFF     0x419,0xfdb                                                                                     
000b7c   ffdb                                                                                                               
                                                                                                                            E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                   /*                                                                       E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                    * Copy data from dual-ram buffer to user's buffer                       E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                    */                                                                      E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000b7e   0101     MOVLB     0x1                    for(cdc_rx_len = 0; cdc_rx_len < len; cdc_rx_len++)                      E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000b80   6b00     CLRF      0x0,0x1                                                                                         
000b82   0efc     MOVLW     0xfc                                                                                            
000b84   50db     MOVF      0xdb,0x0,0x0                                                                                    
000b86   5d00     SUBWF     0x0,0x0,0x1                                                                                     
000b88   e219     BC        0xbbc                                                                                           
000bb8   2b00     INCF      0x0,0x1,0x1                                                                                     
000bba   d7e3     BRA       0xb82                                                                                           
000b8a   5100     MOVF      0x0,0x0,0x1                buffer[cdc_rx_len] = cdc_data_rx[cdc_rx_len];                        E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000b8c   6aea     CLRF      0xea,0x0                                                                                        
000b8e   0f08     ADDLW     0x8                                                                                             
000b90   6ee9     MOVWF     0xe9,0x0                                                                                        
000b92   0e05     MOVLW     0x5                                                                                             
000b94   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
000b96   50ef     MOVF      0xef,0x0,0x0                                                                                    
000b98   6ee6     MOVWF     0xe6,0x0                                                                                        
000b9a   5100     MOVF      0x0,0x0,0x1                                                                                     
000b9c   6ee7     MOVWF     0xe7,0x0                                                                                        
000b9e   0efd     MOVLW     0xfd                                                                                            
000ba0   cfdb     MOVFF     0xfdb,0xfe9                                                                                     
000ba2   ffe9                                                                                                               
000ba4   0efe     MOVLW     0xfe                                                                                            
000ba6   cfdb     MOVFF     0xfdb,0xfea                                                                                     
000ba8   ffea                                                                                                               
000baa   50e7     MOVF      0xe7,0x0,0x0                                                                                    
000bac   26e9     ADDWF     0xe9,0x1,0x0                                                                                    
000bae   0e00     MOVLW     0x0                                                                                             
000bb0   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
000bb2   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000bb4   50e7     MOVF      0xe7,0x0,0x0                                                                                    
000bb6   6eef     MOVWF     0xef,0x0                                                                                        
                                                                                                                            E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                   /*                                                                       E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                    * Prepare dual-ram buffer for next OUT transaction                      E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                    */                                                                      E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000bbc   0104     MOVLB     0x4                    CDC_BULK_BD_OUT.Cnt = sizeof(cdc_data_rx);                               E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000bbe   0e40     MOVLW     0x40                                                                                            
000bc0   6f19     MOVWF     0x19,0x1                                                                                        
000bc2   1718     ANDWF     0x18,0x1,0x1           mUSBBufferReady(CDC_BULK_BD_OUT);                                        E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000bc4   7d18     BTG       0x18,0x6,0x1                                                                                    
000bc6   0e88     MOVLW     0x88                                                                                            
000bc8   1318     IORWF     0x18,0x1,0x1                                                                                    
                                               }//end if                                                                    E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                                                                                            E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000bca   0101     MOVLB     0x1                return cdc_rx_len;                                                           E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000bcc   5100     MOVF      0x0,0x0,0x1                                                                                     
000bce   d000     BRA       0xbd0                                                                                           
                                                                                                                            E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000bd0   52e5     MOVF      0xe5,0x1,0x0   }//end getsUSBUSART                                                              E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000bd2   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
000bd4   ffd9                                                                                                               
000bd6   0012     RETURN    0x0                                                                                             
                                                                                                                            E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                           /******************************************************************************  E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            * Function:        void putsUSBUSART(char *data)                                E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            * PreCondition:    cdc_trf_state must be in the CDC_TX_READY state.             E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            *                  The string of characters pointed to by 'data' must equal     E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            *                  to or smaller than 255 bytes.                                E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            * Input:           data    : Pointer to a null-terminated string of data.       E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            *                            If a null character is not found, 255 bytes        E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            *                            of data will be transferred to the host.           E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            * Output:          None                                                         E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            * Side Effects:    None                                                         E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            * Overview:        putsUSBUSART writes a string of data to the USB including    E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            *                  the null character. Use this version, 'puts', to transfer    E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            *                  data located in data memory.                                 E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            * Note:            The transfer mechanism for device-to-host(put) is more       E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            *                  flexible than host-to-device(get). It can handle             E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            *                  a string of data larger than the maximum size of bulk IN     E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            *                  endpoint. A state machine is used to transfer a long         E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            *                  string of data over multiple USB transactions.               E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            *                  See CDCTxService() for more details.                         E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            *****************************************************************************/  E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000bd8   cfd9     MOVFF     0xfd9,0xfe6    void putsUSBUSART(char *data)                                                    E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000bda   ffe6                                                                                                               
000bdc   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
000bde   ffd9                                                                                                               
000be0   52e6     MOVF      0xe6,0x1,0x0                                                                                    
                                           {                                                                                E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                               byte len;                                                                    E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                                                                                            E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                               /*                                                                           E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                * User should have checked that cdc_trf_state is in CDC_TX_READY state      E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                * before calling this function.                                             E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                * As a safety precaution, this fuction checks the state one more time       E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                * to make sure it does not override any pending transactions.               E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                *                                                                           E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                * Currently it just quits the routine without reporting any errors back     E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                * to the user.                                                              E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                *                                                                           E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                * Bottomline: User MUST make sure that mUSBUSARTIsTxTrfReady()==1           E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                *             before calling this function!                                 E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                * Example:                                                                  E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                * if(mUSBUSARTIsTxTrfReady())                                               E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                *     putsUSBUSART(pData);                                                  E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                *                                                                           E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                * IMPORTANT: Never use the following blocking while loop to wait:           E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                * while(!mUSBUSARTIsTxTrfReady())                                           E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                *     putsUSBUSART(pData);                                                  E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                *                                                                           E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                * The whole firmware framework is written based on cooperative              E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                * multi-tasking and a blocking code is not acceptable.                      E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                * Use a state machine instead.                                              E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                */                                                                          E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000be2   0101     MOVLB     0x1                if(cdc_trf_state != CDC_TX_READY) return;                                    E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000be4   5101     MOVF      0x1,0x0,0x1                                                                                     
000be6   e001     BZ        0xbea                                                                                           
000be8   d02f     BRA       0xc48                                                                                           
                                                                                                                            E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                               /*                                                                           E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                * While loop counts the number of bytes to send including the               E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                * null character.                                                           E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                */                                                                          E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000bea   6adf     CLRF      0xdf,0x0           len = 0;                                                                     E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                               do                                                                           E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                               {                                                                            E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000bec   2adf     INCF      0xdf,0x1,0x0           len++;                                                                   E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000bee   50df     MOVF      0xdf,0x0,0x0           if(len == 255) break;       // Break loop once max len is reached.       E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000bf0   6e16     MOVWF     0x16,0x0                                                                                        
000bf2   6a17     CLRF      0x17,0x0                                                                                        
000bf4   0eff     MOVLW     0xff                                                                                            
000bf6   1816     XORWF     0x16,0x0,0x0                                                                                    
000bf8   e101     BNZ       0xbfc                                                                                           
000bfa   5017     MOVF      0x17,0x0,0x0                                                                                    
000bfc   e101     BNZ       0xc00                                                                                           
000bfe   d00b     BRA       0xc16                                                                                           
000c00   0efd     MOVLW     0xfd               }while(*data++);                                                             E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000c02   cfdb     MOVFF     0xfdb,0xfe9                                                                                     
000c04   ffe9                                                                                                               
000c06   2adb     INCF      0xdb,0x1,0x0                                                                                    
000c08   0efe     MOVLW     0xfe                                                                                            
000c0a   cfdb     MOVFF     0xfdb,0xfea                                                                                     
000c0c   ffea                                                                                                               
000c0e   e301     BNC       0xc12                                                                                           
000c10   2adb     INCF      0xdb,0x1,0x0                                                                                    
000c12   50ef     MOVF      0xef,0x0,0x0                                                                                    
000c14   e1eb     BNZ       0xbec                                                                                           
                                                                                                                            E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                               /*                                                                           E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                * Re-adjust pointer to its initial location                                 E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                */                                                                          E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000c16   50df     MOVF      0xdf,0x0,0x0       data-=len;                                                                   E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000c18   6e16     MOVWF     0x16,0x0                                                                                        
000c1a   6a17     CLRF      0x17,0x0                                                                                        
000c1c   50d9     MOVF      0xd9,0x0,0x0                                                                                    
000c1e   0ffd     ADDLW     0xfd                                                                                            
000c20   6ee9     MOVWF     0xe9,0x0                                                                                        
000c22   0eff     MOVLW     0xff                                                                                            
000c24   20da     ADDWFC    0xda,0x0,0x0                                                                                    
000c26   6eea     MOVWF     0xea,0x0                                                                                        
000c28   5016     MOVF      0x16,0x0,0x0                                                                                    
000c2a   5eee     SUBWF     0xee,0x1,0x0                                                                                    
000c2c   5017     MOVF      0x17,0x0,0x0                                                                                    
000c2e   5aed     SUBWFB    0xed,0x1,0x0                                                                                    
                                                                                                                            E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                               /*                                                                           E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                * Second piece of information (length of data to send) is ready.            E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                * Call mUSBUSARTTxRam to setup the transfer.                                E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                * The actual transfer process will be handled by CDCTxService(),            E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                * which should be called once per Main Program loop.                        E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                */                                                                          E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000c30   0efd     MOVLW     0xfd               mUSBUSARTTxRam((byte*)data,len);     // See cdc.h                            E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000c32   cfdb     MOVFF     0xfdb,0x102                                                                                     
000c34   f102                                                                                                               
000c36   0efe     MOVLW     0xfe                                                                                            
000c38   cfdb     MOVFF     0xfdb,0x103                                                                                     
000c3a   f103                                                                                                               
000c3c   cfdf     MOVFF     0xfdf,0x106                                                                                     
000c3e   f106                                                                                                               
000c40   0101     MOVLB     0x1                                                                                             
000c42   6b07     CLRF      0x7,0x1                                                                                         
000c44   0e01     MOVLW     0x1                                                                                             
000c46   6f01     MOVWF     0x1,0x1                                                                                         
000c48   52e5     MOVF      0xe5,0x1,0x0   }//end putsUSBUSART                                                              E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000c4a   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000c4c   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
000c4e   ffd9                                                                                                               
000c50   0012     RETURN    0x0                                                                                             
                                                                                                                            E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                           /******************************************************************************  E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            * Function:        void putrsUSBUSART(const rom char *data)                     E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            * PreCondition:    cdc_trf_state must be in the CDC_TX_READY state.             E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            *                  The string of characters pointed to by 'data' must equal     E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            *                  to or smaller than 255 bytes.                                E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            * Input:           data    : Pointer to a null-terminated string of data.       E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            *                            If a null character is not found, 255 bytes        E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            *                            of data will be transferred to the host.           E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            * Output:          None                                                         E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            * Side Effects:    None                                                         E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            * Overview:        putrsUSBUSART writes a string of data to the USB including   E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            *                  the null character. Use this version, 'putrs', to transfer   E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            *                  data literals and data located in program memory.            E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            * Note:            The transfer mechanism for device-to-host(put) is more       E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            *                  flexible than host-to-device(get). It can handle             E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            *                  a string of data larger than the maximum size of bulk IN     E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            *                  endpoint. A state machine is used to transfer a long         E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            *                  string of data over multiple USB transactions.               E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            *                  See CDCTxService() for more details.                         E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            *****************************************************************************/  E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000c52   cfd9     MOVFF     0xfd9,0xfe6    void putrsUSBUSART(const rom char *data)                                         E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000c54   ffe6                                                                                                               
000c56   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
000c58   ffd9                                                                                                               
000c5a   52e6     MOVF      0xe6,0x1,0x0                                                                                    
                                           {                                                                                E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                               byte len;                                                                    E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                                                                                            E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                               /*                                                                           E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                * User should have checked that cdc_trf_state is in CDC_TX_READY state      E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                * before calling this function.                                             E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                * As a safety precaution, this fuction checks the state one more time       E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                * to make sure it does not override any pending transactions.               E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                *                                                                           E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                * Currently it just quits the routine without reporting any errors back     E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                * to the user.                                                              E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                *                                                                           E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                * Bottomline: User MUST make sure that mUSBUSARTIsTxTrfReady()              E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                *             before calling this function!                                 E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                * Example:                                                                  E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                * if(mUSBUSARTIsTxTrfReady())                                               E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                *     putsUSBUSART(pData);                                                  E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                *                                                                           E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                * IMPORTANT: Never use the following blocking while loop to wait:           E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                * while(cdc_trf_state != CDC_TX_READY)                                      E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                *     putsUSBUSART(pData);                                                  E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                *                                                                           E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                * The whole firmware framework is written based on cooperative              E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                * multi-tasking and a blocking code is not acceptable.                      E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                * Use a state machine instead.                                              E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                */                                                                          E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000c5c   0101     MOVLB     0x1                if(cdc_trf_state != CDC_TX_READY) return;                                    E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000c5e   5101     MOVF      0x1,0x0,0x1                                                                                     
000c60   e001     BZ        0xc64                                                                                           
000c62   d030     BRA       0xcc4                                                                                           
                                                                                                                            E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                               /*                                                                           E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                * While loop counts the number of bytes to send including the               E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                * null character.                                                           E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                */                                                                          E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000c64   6adf     CLRF      0xdf,0x0           len = 0;                                                                     E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                               do                                                                           E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                               {                                                                            E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000c66   2adf     INCF      0xdf,0x1,0x0           len++;                                                                   E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000c68   50df     MOVF      0xdf,0x0,0x0           if(len == 255) break;       // Break loop once max len is reached.       E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000c6a   6e16     MOVWF     0x16,0x0                                                                                        
000c6c   6a17     CLRF      0x17,0x0                                                                                        
000c6e   0eff     MOVLW     0xff                                                                                            
000c70   1816     XORWF     0x16,0x0,0x0                                                                                    
000c72   e101     BNZ       0xc76                                                                                           
000c74   5017     MOVF      0x17,0x0,0x0                                                                                    
000c76   e101     BNZ       0xc7a                                                                                           
000c78   d00c     BRA       0xc92                                                                                           
000c7a   0efd     MOVLW     0xfd               }while(*data++);                                                             E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000c7c   cfdb     MOVFF     0xfdb,0xff6                                                                                     
000c7e   fff6                                                                                                               
000c80   2adb     INCF      0xdb,0x1,0x0                                                                                    
000c82   0efe     MOVLW     0xfe                                                                                            
000c84   cfdb     MOVFF     0xfdb,0xff7                                                                                     
000c86   fff7                                                                                                               
000c88   e301     BNC       0xc8c                                                                                           
000c8a   2adb     INCF      0xdb,0x1,0x0                                                                                    
000c8c   0008     TBLRD                                                                                                     
000c8e   50f5     MOVF      0xf5,0x0,0x0                                                                                    
000c90   e1ea     BNZ       0xc66                                                                                           
                                                                                                                            E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                               /*                                                                           E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                * Re-adjust pointer to its initial location                                 E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                */                                                                          E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000c92   50df     MOVF      0xdf,0x0,0x0       data-=len;                                                                   E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000c94   6e16     MOVWF     0x16,0x0                                                                                        
000c96   6a17     CLRF      0x17,0x0                                                                                        
000c98   50d9     MOVF      0xd9,0x0,0x0                                                                                    
000c9a   0ffd     ADDLW     0xfd                                                                                            
000c9c   6ee9     MOVWF     0xe9,0x0                                                                                        
000c9e   0eff     MOVLW     0xff                                                                                            
000ca0   20da     ADDWFC    0xda,0x0,0x0                                                                                    
000ca2   6eea     MOVWF     0xea,0x0                                                                                        
000ca4   5016     MOVF      0x16,0x0,0x0                                                                                    
000ca6   5eee     SUBWF     0xee,0x1,0x0                                                                                    
000ca8   5017     MOVF      0x17,0x0,0x0                                                                                    
000caa   5aed     SUBWFB    0xed,0x1,0x0                                                                                    
                                                                                                                            E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                               /*                                                                           E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                * Second piece of information (length of data to send) is ready.            E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                * Call mUSBUSARTTxRom to setup the transfer.                                E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                * The actual transfer process will be handled by CDCTxService(),            E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                * which should be called once per Main Program loop.                        E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                */                                                                          E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000cac   0efd     MOVLW     0xfd               mUSBUSARTTxRom((rom byte*)data,len); // See cdc.h                            E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000cae   cfdb     MOVFF     0xfdb,0x102                                                                                     
000cb0   f102                                                                                                               
000cb2   0efe     MOVLW     0xfe                                                                                            
000cb4   cfdb     MOVFF     0xfdb,0x103                                                                                     
000cb6   f103                                                                                                               
000cb8   cfdf     MOVFF     0xfdf,0x106                                                                                     
000cba   f106                                                                                                               
000cbc   0101     MOVLB     0x1                                                                                             
000cbe   0e01     MOVLW     0x1                                                                                             
000cc0   6f07     MOVWF     0x7,0x1                                                                                         
000cc2   6f01     MOVWF     0x1,0x1                                                                                         
                                                                                                                            E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000cc4   52e5     MOVF      0xe5,0x1,0x0   }//end putrsUSBUSART                                                             E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000cc6   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000cc8   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
000cca   ffd9                                                                                                               
000ccc   0012     RETURN    0x0                                                                                             
                                                                                                                            E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                           /******************************************************************************  E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            * Function:        void CDCTxService(void)                                      E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            * PreCondition:    None                                                         E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            * Input:           None                                                         E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            * Output:          None                                                         E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            * Side Effects:    None                                                         E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            * Overview:        CDCTxService handles device-to-host transaction(s).          E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            *                  This function should be called once per Main Program loop.   E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            * Note:            None                                                         E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                            *****************************************************************************/  E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000cce   cfd9     MOVFF     0xfd9,0xfe6    void CDCTxService(void)                                                          E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000cd0   ffe6                                                                                                               
000cd2   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
000cd4   ffd9                                                                                                               
000cd6   52e6     MOVF      0xe6,0x1,0x0                                                                                    
                                           {                                                                                E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                               byte byte_to_send;                                                           E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                                                                                            E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000cd8   0104     MOVLB     0x4                if(mCDCUsartTxIsBusy()) return;                                              E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000cda   bf1c     BTFSC     0x1c,0x7,0x1                                                                                    
000cdc   d06b     BRA       0xdb4                                                                                           
                                               /*                                                                           E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                * Completing stage is necessary while [ mCDCUSartTxIsBusy()==1 ].           E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                * By having this stage, user can always check cdc_trf_state,                E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                * and not having to call mCDCUsartTxIsBusy() directly.                      E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                */                                                                          E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000cde   0e03     MOVLW     0x3                if(cdc_trf_state == CDC_TX_COMPLETING)                                       E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000ce0   0101     MOVLB     0x1                                                                                             
000ce2   5d01     SUBWF     0x1,0x0,0x1                                                                                     
000ce4   e101     BNZ       0xce8                                                                                           
000ce6   6b01     CLRF      0x1,0x1                cdc_trf_state = CDC_TX_READY;                                            E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                                                                                            E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                               /*                                                                           E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                * If CDC_TX_READY state, nothing to do, just return.                        E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                */                                                                          E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000ce8   5101     MOVF      0x1,0x0,0x1        if(cdc_trf_state == CDC_TX_READY) return;                                    E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000cea   e101     BNZ       0xcee                                                                                           
000cec   d063     BRA       0xdb4                                                                                           
                                                                                                                            E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                               /*                                                                           E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                * If CDC_TX_BUSY_ZLP state, send zero length packet                         E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                */                                                                          E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000cee   0e02     MOVLW     0x2                if(cdc_trf_state == CDC_TX_BUSY_ZLP)                                         E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000cf0   5d01     SUBWF     0x1,0x0,0x1                                                                                     
000cf2   e106     BNZ       0xd00                                                                                           
                                               {                                                                            E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000cf4   0104     MOVLB     0x4                    CDC_BULK_BD_IN.Cnt = 0;                                                  E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000cf6   6b1d     CLRF      0x1d,0x1                                                                                        
000cf8   0101     MOVLB     0x1                    cdc_trf_state = CDC_TX_COMPLETING;                                       E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000cfa   0e03     MOVLW     0x3                                                                                             
000cfc   6f01     MOVWF     0x1,0x1                                                                                         
                                               }                                                                            E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000cfe   d054     BRA       0xda8              else if(cdc_trf_state == CDC_TX_BUSY)                                        E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000d00   0501     DECF      0x1,0x0,0x1                                                                                     
000d02   e152     BNZ       0xda8                                                                                           
                                               {                                                                            E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                   /*                                                                       E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                    * First, have to figure out how many byte of data to send.              E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                    */                                                                      E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000d04   0e40     MOVLW     0x40               	if(cdc_tx_len > sizeof(cdc_data_tx))                                        E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000d06   6e16     MOVWF     0x16,0x0                                                                                        
000d08   6a17     CLRF      0x17,0x0                                                                                        
000d0a   5106     MOVF      0x6,0x0,0x1                                                                                     
000d0c   5c16     SUBWF     0x16,0x0,0x0                                                                                    
000d0e   0e00     MOVLW     0x0                                                                                             
000d10   5817     SUBWFB    0x17,0x0,0x0                                                                                    
000d12   e203     BC        0xd1a                                                                                           
000d14   0e40     MOVLW     0x40               	    byte_to_send = sizeof(cdc_data_tx);                                     E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000d16   6edf     MOVWF     0xdf,0x0                                                                                        
000d18   d002     BRA       0xd1e              	else                                                                        E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000d1a   c106     MOVFF     0x106,0xfdf        	    byte_to_send = cdc_tx_len;                                              E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000d1c   ffdf                                                                                                               
                                                                                                                            E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                   /*                                                                       E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                    * Next, load the number of bytes to send to Cnt in buffer descriptor    E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                    */                                                                      E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000d1e   cfdf     MOVFF     0xfdf,0x41d            CDC_BULK_BD_IN.Cnt = byte_to_send;                                       E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000d20   f41d                                                                                                               
                                                                                                                            E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                   /*                                                                       E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                    * Subtract the number of bytes just about to be sent from the total.    E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                    */                                                                      E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000d22   50df     MOVF      0xdf,0x0,0x0       	cdc_tx_len = cdc_tx_len - byte_to_send;                                     E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000d24   5d06     SUBWF     0x6,0x0,0x1                                                                                     
000d26   6f06     MOVWF     0x6,0x1                                                                                         
                                               	                                                                            E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000d28   0e48     MOVLW     0x48                   pCDCDst.bRam = (byte*)&cdc_data_tx; // Set destination pointer           E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000d2a   6f04     MOVWF     0x4,0x1                                                                                         
000d2c   0e05     MOVLW     0x5                                                                                             
000d2e   6f05     MOVWF     0x5,0x1                                                                                         
                                                                                                                            E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000d30   0507     DECF      0x7,0x0,0x1            if(cdc_mem_type == _ROM)            // Determine type of memory source   E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000d32   e115     BNZ       0xd5e                                                                                           
                                                   {                                                                        E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000d34   50df     MOVF      0xdf,0x0,0x0               while(byte_to_send)                                                  E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000d36   e012     BZ        0xd5c                                                                                           
000d5a   d7ec     BRA       0xd34                                                                                           
                                                       {                                                                    E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000d38   c102     MOVFF     0x102,0xff6                    *pCDCDst.bRam = *pCDCSrc.bRom;                                   E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000d3a   fff6                                                                                                               
000d3c   c103     MOVFF     0x103,0xff7                                                                                     
000d3e   fff7                                                                                                               
000d40   0008     TBLRD                                                                                                     
000d42   50f5     MOVF      0xf5,0x0,0x0                                                                                    
000d44   c104     MOVFF     0x104,0xfe9                                                                                     
000d46   ffe9                                                                                                               
000d48   c105     MOVFF     0x105,0xfea                                                                                     
000d4a   ffea                                                                                                               
000d4c   6eef     MOVWF     0xef,0x0                                                                                        
000d4e   2b04     INCF      0x4,0x1,0x1                    pCDCDst.bRam++;                                                  E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000d50   0e00     MOVLW     0x0                                                                                             
000d52   2305     ADDWFC    0x5,0x1,0x1                                                                                     
000d54   2b02     INCF      0x2,0x1,0x1                    pCDCSrc.bRom++;                                                  E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000d56   2303     ADDWFC    0x3,0x1,0x1                                                                                     
000d58   06df     DECF      0xdf,0x1,0x0                   byte_to_send--;                                                  E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                       }//end while(byte_to_send)                                           E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                   }                                                                        E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000d5c   d013     BRA       0xd84                  else // _RAM                                                             E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                   {                                                                        E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000d5e   50df     MOVF      0xdf,0x0,0x0               while(byte_to_send)                                                  E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000d60   e011     BZ        0xd84                                                                                           
000d82   d7ed     BRA       0xd5e                                                                                           
                                                       {                                                                    E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000d62   c102     MOVFF     0x102,0xfe9                    *pCDCDst.bRam = *pCDCSrc.bRam;                                   E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000d64   ffe9                                                                                                               
000d66   c103     MOVFF     0x103,0xfea                                                                                     
000d68   ffea                                                                                                               
000d6a   50ef     MOVF      0xef,0x0,0x0                                                                                    
000d6c   c104     MOVFF     0x104,0xfe9                                                                                     
000d6e   ffe9                                                                                                               
000d70   c105     MOVFF     0x105,0xfea                                                                                     
000d72   ffea                                                                                                               
000d74   6eef     MOVWF     0xef,0x0                                                                                        
000d76   2b04     INCF      0x4,0x1,0x1                    pCDCDst.bRam++;                                                  E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000d78   0e00     MOVLW     0x0                                                                                             
000d7a   2305     ADDWFC    0x5,0x1,0x1                                                                                     
000d7c   2b02     INCF      0x2,0x1,0x1                    pCDCSrc.bRam++;                                                  E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000d7e   2303     ADDWFC    0x3,0x1,0x1                                                                                     
000d80   06df     DECF      0xdf,0x1,0x0                   byte_to_send--;                                                  E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                       }//end while(byte_to_send._word)                                     E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                   }//end if(cdc_mem_type...)                                               E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                                                                                            E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                   /*                                                                       E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                    * Lastly, determine if a zero length packet state is necessary.         E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                    * See explanation in USB Specification 2.0: Section 5.8.3               E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                    */                                                                      E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000d84   5106     MOVF      0x6,0x0,0x1            if(cdc_tx_len == 0)                                                      E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000d86   e110     BNZ       0xda8                                                                                           
                                                   {                                                                        E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000d88   0104     MOVLB     0x4                        if(CDC_BULK_BD_IN.Cnt == sizeof(cdc_data_tx))                        E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000d8a   511d     MOVF      0x1d,0x0,0x1                                                                                    
000d8c   6e16     MOVWF     0x16,0x0                                                                                        
000d8e   6a17     CLRF      0x17,0x0                                                                                        
000d90   0e40     MOVLW     0x40                                                                                            
000d92   1816     XORWF     0x16,0x0,0x0                                                                                    
000d94   e101     BNZ       0xd98                                                                                           
000d96   5017     MOVF      0x17,0x0,0x0                                                                                    
000d98   e104     BNZ       0xda2                                                                                           
000d9a   0101     MOVLB     0x1                            cdc_trf_state = CDC_TX_BUSY_ZLP;                                 E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000d9c   0e02     MOVLW     0x2                                                                                             
000d9e   6f01     MOVWF     0x1,0x1                                                                                         
000da0   d003     BRA       0xda8                      else                                                                 E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000da2   0101     MOVLB     0x1                            cdc_trf_state = CDC_TX_COMPLETING;                               E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000da4   0e03     MOVLW     0x3                                                                                             
000da6   6f01     MOVWF     0x1,0x1                                                                                         
                                                   }//end if(cdc_tx_len...)                                                 E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                                                                                            E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                               }//end if(cdc_tx_sate == CDC_TX_BUSY)                                        E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                                                                                            E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                               /*                                                                           E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                * Both CDC_TX_BUSY and CDC_TX_BUSY_ZLP states use the following macro       E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                */                                                                          E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000da8   0e40     MOVLW     0x40               mUSBBufferReady(CDC_BULK_BD_IN);                                             E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000daa   0104     MOVLB     0x4                                                                                             
000dac   171c     ANDWF     0x1c,0x1,0x1                                                                                    
000dae   7d1c     BTG       0x1c,0x6,0x1                                                                                    
000db0   0e88     MOVLW     0x88                                                                                            
000db2   131c     IORWF     0x1c,0x1,0x1                                                                                    
                                                                                                                            E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000db4   52e5     MOVF      0xe5,0x1,0x0   }//end CDCTxService                                                              E:\usb20\lighting2\system\usb\class\cdc\cdc.c
000db6   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000db8   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
000dba   ffd9                                                                                                               
000dbc   0012     RETURN    0x0                                                                                             
                                                                                                                            E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                           #endif //USB_USE_CDC                                                             E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                                                                                                            E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                           /** EOF cdc.c ****************************************************************/  E:\usb20\lighting2\system\usb\class\cdc\cdc.c
                                           /*********************************************************************           E:\usb20\lighting2\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usb9\usb9.c
                                            *                Microchip USB C18 Firmware Version 1.0                         E:\usb20\lighting2\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usb9\usb9.c
                                            *********************************************************************           E:\usb20\lighting2\system\usb\usb9\usb9.c
                                            * FileName:        usb9.c                                                       E:\usb20\lighting2\system\usb\usb9\usb9.c
                                            * Dependencies:    See INCLUDES section below                                   E:\usb20\lighting2\system\usb\usb9\usb9.c
                                            * Processor:       PIC18                                                        E:\usb20\lighting2\system\usb\usb9\usb9.c
                                            * Compiler:        C18 2.30.01+                                                 E:\usb20\lighting2\system\usb\usb9\usb9.c
                                            * Company:         Microchip Technology, Inc.                                   E:\usb20\lighting2\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usb9\usb9.c
                                            * Software License Agreement                                                    E:\usb20\lighting2\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usb9\usb9.c
                                            * The software supplied herewith by Microchip Technology Incorporated           E:\usb20\lighting2\system\usb\usb9\usb9.c
                                            * (the 鼎ompany・ for its PICmicroｮ Microcontroller is intended and             E:\usb20\lighting2\system\usb\usb9\usb9.c
                                            * supplied to you, the Company痴 customer, for use solely and                   E:\usb20\lighting2\system\usb\usb9\usb9.c
                                            * exclusively on Microchip PICmicro Microcontroller products. The               E:\usb20\lighting2\system\usb\usb9\usb9.c
                                            * software is owned by the Company and/or its supplier, and is                  E:\usb20\lighting2\system\usb\usb9\usb9.c
                                            * protected under applicable copyright laws. All rights are reserved.           E:\usb20\lighting2\system\usb\usb9\usb9.c
                                            * Any use in violation of the foregoing restrictions may subject the            E:\usb20\lighting2\system\usb\usb9\usb9.c
                                            * user to criminal sanctions under applicable laws, as well as to               E:\usb20\lighting2\system\usb\usb9\usb9.c
                                            * civil liability for the breach of the terms and conditions of this            E:\usb20\lighting2\system\usb\usb9\usb9.c
                                            * license.                                                                      E:\usb20\lighting2\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usb9\usb9.c
                                            * THIS SOFTWARE IS PROVIDED IN AN 鄭S IS・CONDITION. NO WARRANTIES,             E:\usb20\lighting2\system\usb\usb9\usb9.c
                                            * WHETHER EXPRESS, IMPLIED OR STATUTORY, INCLUDING, BUT NOT LIMITED             E:\usb20\lighting2\system\usb\usb9\usb9.c
                                            * TO, IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A                   E:\usb20\lighting2\system\usb\usb9\usb9.c
                                            * PARTICULAR PURPOSE APPLY TO THIS SOFTWARE. THE COMPANY SHALL NOT,             E:\usb20\lighting2\system\usb\usb9\usb9.c
                                            * IN ANY CIRCUMSTANCES, BE LIABLE FOR SPECIAL, INCIDENTAL OR                    E:\usb20\lighting2\system\usb\usb9\usb9.c
                                            * CONSEQUENTIAL DAMAGES, FOR ANY REASON WHATSOEVER.                             E:\usb20\lighting2\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usb9\usb9.c
                                            * Author               Date        Comment                                      E:\usb20\lighting2\system\usb\usb9\usb9.c
                                            *~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~           E:\usb20\lighting2\system\usb\usb9\usb9.c
                                            * Rawin Rojvanit       11/19/04    Original.                                    E:\usb20\lighting2\system\usb\usb9\usb9.c
                                            ********************************************************************/           E:\usb20\lighting2\system\usb\usb9\usb9.c
                                                                                                                            E:\usb20\lighting2\system\usb\usb9\usb9.c
                                           /** I N C L U D E S **********************************************************/  E:\usb20\lighting2\system\usb\usb9\usb9.c
                                           #include <p18cxxx.h>                                                             E:\usb20\lighting2\system\usb\usb9\usb9.c
                                           #include "system\typedefs.h"                                                     E:\usb20\lighting2\system\usb\usb9\usb9.c
                                           #include "system\usb\usb.h"                                                      E:\usb20\lighting2\system\usb\usb9\usb9.c
                                           #include "io_cfg.h"                     // Required for self_power status        E:\usb20\lighting2\system\usb\usb9\usb9.c
                                                                                                                            E:\usb20\lighting2\system\usb\usb9\usb9.c
                                           /** V A R I A B L E S ********************************************************/  E:\usb20\lighting2\system\usb\usb9\usb9.c
                                           #pragma udata                                                                    E:\usb20\lighting2\system\usb\usb9\usb9.c
                                                                                                                            E:\usb20\lighting2\system\usb\usb9\usb9.c
                                           /** P R I V A T E  P R O T O T Y P E S ***************************************/  E:\usb20\lighting2\system\usb\usb9\usb9.c
                                           void USBStdGetDscHandler(void);                                                  E:\usb20\lighting2\system\usb\usb9\usb9.c
                                           void USBStdSetCfgHandler(void);                                                  E:\usb20\lighting2\system\usb\usb9\usb9.c
                                           void USBStdGetStatusHandler(void);                                               E:\usb20\lighting2\system\usb\usb9\usb9.c
                                           void USBStdFeatureReqHandler(void);                                              E:\usb20\lighting2\system\usb\usb9\usb9.c
                                                                                                                            E:\usb20\lighting2\system\usb\usb9\usb9.c
                                           /** D E C L A R A T I O N S **************************************************/  E:\usb20\lighting2\system\usb\usb9\usb9.c
                                           #pragma code                                                                     E:\usb20\lighting2\system\usb\usb9\usb9.c
                                           /******************************************************************************  E:\usb20\lighting2\system\usb\usb9\usb9.c
                                            * Function:        void USBCheckStdRequest(void)                                E:\usb20\lighting2\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usb9\usb9.c
                                            * PreCondition:    None                                                         E:\usb20\lighting2\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usb9\usb9.c
                                            * Input:           None                                                         E:\usb20\lighting2\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usb9\usb9.c
                                            * Output:          None                                                         E:\usb20\lighting2\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usb9\usb9.c
                                            * Side Effects:    None                                                         E:\usb20\lighting2\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usb9\usb9.c
                                            * Overview:        This routine checks the setup data packet to see if it       E:\usb20\lighting2\system\usb\usb9\usb9.c
                                            *                  knows how to handle it                                       E:\usb20\lighting2\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usb9\usb9.c
                                            * Note:            None                                                         E:\usb20\lighting2\system\usb\usb9\usb9.c
                                            *****************************************************************************/  E:\usb20\lighting2\system\usb\usb9\usb9.c
                                           void USBCheckStdRequest(void)                                                    E:\usb20\lighting2\system\usb\usb9\usb9.c
                                           {                                                                                E:\usb20\lighting2\system\usb\usb9\usb9.c
000dbe   0104     MOVLB     0x4                if(SetupPkt.RequestType != STANDARD) return;                                 E:\usb20\lighting2\system\usb\usb9\usb9.c
000dc0   5120     MOVF      0x20,0x0,0x1                                                                                    
000dc2   0b60     ANDLW     0x60                                                                                            
000dc4   42e8     RRNCF     0xe8,0x1,0x0                                                                                    
000dc6   42e8     RRNCF     0xe8,0x1,0x0                                                                                    
000dc8   42e8     RRNCF     0xe8,0x1,0x0                                                                                    
000dca   42e8     RRNCF     0xe8,0x1,0x0                                                                                    
000dcc   42e8     RRNCF     0xe8,0x1,0x0                                                                                    
000dce   0900     IORLW     0x0                                                                                             
000dd0   e001     BZ        0xdd4                                                                                           
000dd2   d055     BRA       0xe7e                                                                                           
                                                                                                                            E:\usb20\lighting2\system\usb\usb9\usb9.c
000dd4   5121     MOVF      0x21,0x0,0x1       switch(SetupPkt.bRequest)                                                    E:\usb20\lighting2\system\usb\usb9\usb9.c
000dd6   0a07     XORLW     0x7                                                                                             
000dd8   e051     BZ        0xe7c                                                                                           
000dda   0a0b     XORLW     0xb                                                                                             
000ddc   e04f     BZ        0xe7c                                                                                           
000dde   0a07     XORLW     0x7                                                                                             
000de0   e040     BZ        0xe62                                                                                           
000de2   0a01     XORLW     0x1                                                                                             
000de4   e02c     BZ        0xe3e                                                                                           
000de6   0a0b     XORLW     0xb                                                                                             
000de8   e028     BZ        0xe3a                                                                                           
000dea   0a02     XORLW     0x2                                                                                             
000dec   e026     BZ        0xe3a                                                                                           
000dee   0a03     XORLW     0x3                                                                                             
000df0   e022     BZ        0xe36                                                                                           
000df2   0a08     XORLW     0x8                                                                                             
000df4   e012     BZ        0xe1a                                                                                           
000df6   0a01     XORLW     0x1                                                                                             
000df8   e00e     BZ        0xe16                                                                                           
000dfa   0a0f     XORLW     0xf                                                                                             
000dfc   e00a     BZ        0xe12                                                                                           
000dfe   0a03     XORLW     0x3                                                                                             
000e00   e001     BZ        0xe04                                                                                           
000e02   d03c     BRA       0xe7c                                                                                           
                                               {                                                                            E:\usb20\lighting2\system\usb\usb9\usb9.c
                                                   case SET_ADR:                                                            E:\usb20\lighting2\system\usb\usb9\usb9.c
000e04   0101     MOVLB     0x1                        ctrl_trf_session_owner = MUID_USB9;                                  E:\usb20\lighting2\system\usb\usb9\usb9.c
000e06   0e01     MOVLW     0x1                                                                                             
000e08   6f31     MOVWF     0x31,0x1                                                                                        
000e0a   0100     MOVLB     0x0                        usb_device_state = ADR_PENDING_STATE;       // Update state only     E:\usb20\lighting2\system\usb\usb9\usb9.c
000e0c   0e04     MOVLW     0x4                                                                                             
000e0e   6ffc     MOVWF     0xfc,0x1                                                                                        
                                                       /* See USBCtrlTrfInHandler() in usbctrltrf.c for the next step */    E:\usb20\lighting2\system\usb\usb9\usb9.c
000e10   d036     BRA       0xe7e                      break;                                                               E:\usb20\lighting2\system\usb\usb9\usb9.c
                                                   case GET_DSC:                                                            E:\usb20\lighting2\system\usb\usb9\usb9.c
000e12   d836     RCALL     0xe80                      USBStdGetDscHandler();                                               E:\usb20\lighting2\system\usb\usb9\usb9.c
000e14   d034     BRA       0xe7e                      break;                                                               E:\usb20\lighting2\system\usb\usb9\usb9.c
                                                   case SET_CFG:                                                            E:\usb20\lighting2\system\usb\usb9\usb9.c
000e16   d890     RCALL     0xf38                      USBStdSetCfgHandler();                                               E:\usb20\lighting2\system\usb\usb9\usb9.c
000e18   d032     BRA       0xe7e                      break;                                                               E:\usb20\lighting2\system\usb\usb9\usb9.c
                                                   case GET_CFG:                                                            E:\usb20\lighting2\system\usb\usb9\usb9.c
000e1a   0101     MOVLB     0x1                        ctrl_trf_session_owner = MUID_USB9;                                  E:\usb20\lighting2\system\usb\usb9\usb9.c
000e1c   0e01     MOVLW     0x1                                                                                             
000e1e   6f31     MOVWF     0x31,0x1                                                                                        
000e20   0101     MOVLB     0x1                        pSrc.bRam = (byte*)&usb_active_cfg;         // Set Source            E:\usb20\lighting2\system\usb\usb9\usb9.c
000e22   0efe     MOVLW     0xfe                                                                                            
000e24   6f32     MOVWF     0x32,0x1                                                                                        
000e26   0e00     MOVLW     0x0                                                                                             
000e28   6f33     MOVWF     0x33,0x1                                                                                        
000e2a   0100     MOVLB     0x0                        usb_stat.ctrl_trf_mem = _RAM;               // Set memory type       E:\usb20\lighting2\system\usb\usb9\usb9.c
000e2c   93fd     BCF       0xfd,0x1,0x1                                                                                    
000e2e   0101     MOVLB     0x1                        LSB(wCount) = 1;                            // Set data count        E:\usb20\lighting2\system\usb\usb9\usb9.c
000e30   0e01     MOVLW     0x1                                                                                             
000e32   6f36     MOVWF     0x36,0x1                                                                                        
000e34   d024     BRA       0xe7e                      break;                                                               E:\usb20\lighting2\system\usb\usb9\usb9.c
                                                   case GET_STATUS:                                                         E:\usb20\lighting2\system\usb\usb9\usb9.c
000e36   d8a8     RCALL     0xf88                      USBStdGetStatusHandler();                                            E:\usb20\lighting2\system\usb\usb9\usb9.c
000e38   d022     BRA       0xe7e                      break;                                                               E:\usb20\lighting2\system\usb\usb9\usb9.c
                                                   case CLR_FEATURE:                                                        E:\usb20\lighting2\system\usb\usb9\usb9.c
                                                   case SET_FEATURE:                                                        E:\usb20\lighting2\system\usb\usb9\usb9.c
000e3a   d8f4     RCALL     0x1024                     USBStdFeatureReqHandler();                                           E:\usb20\lighting2\system\usb\usb9\usb9.c
000e3c   d020     BRA       0xe7e                      break;                                                               E:\usb20\lighting2\system\usb\usb9\usb9.c
                                                   case GET_INTF:                                                           E:\usb20\lighting2\system\usb\usb9\usb9.c
000e3e   0101     MOVLB     0x1                        ctrl_trf_session_owner = MUID_USB9;                                  E:\usb20\lighting2\system\usb\usb9\usb9.c
000e40   0e01     MOVLW     0x1                                                                                             
000e42   6f31     MOVWF     0x31,0x1                                                                                        
000e44   0104     MOVLB     0x4                        pSrc.bRam = (byte*)&usb_alt_intf+SetupPkt.bIntfID;  // Set source    E:\usb20\lighting2\system\usb\usb9\usb9.c
000e46   5124     MOVF      0x24,0x0,0x1                                                                                    
000e48   0101     MOVLB     0x1                                                                                             
000e4a   6f32     MOVWF     0x32,0x1                                                                                        
000e4c   6b33     CLRF      0x33,0x1                                                                                        
000e4e   0eff     MOVLW     0xff                                                                                            
000e50   2732     ADDWF     0x32,0x1,0x1                                                                                    
000e52   0e00     MOVLW     0x0                                                                                             
000e54   2333     ADDWFC    0x33,0x1,0x1                                                                                    
000e56   0100     MOVLB     0x0                        usb_stat.ctrl_trf_mem = _RAM;               // Set memory type       E:\usb20\lighting2\system\usb\usb9\usb9.c
000e58   93fd     BCF       0xfd,0x1,0x1                                                                                    
000e5a   0101     MOVLB     0x1                        LSB(wCount) = 1;                            // Set data count        E:\usb20\lighting2\system\usb\usb9\usb9.c
000e5c   0e01     MOVLW     0x1                                                                                             
000e5e   6f36     MOVWF     0x36,0x1                                                                                        
000e60   d00e     BRA       0xe7e                      break;                                                               E:\usb20\lighting2\system\usb\usb9\usb9.c
                                                   case SET_INTF:                                                           E:\usb20\lighting2\system\usb\usb9\usb9.c
000e62   0101     MOVLB     0x1                        ctrl_trf_session_owner = MUID_USB9;                                  E:\usb20\lighting2\system\usb\usb9\usb9.c
000e64   0e01     MOVLW     0x1                                                                                             
000e66   6f31     MOVWF     0x31,0x1                                                                                        
000e68   0104     MOVLB     0x4                        usb_alt_intf[SetupPkt.bIntfID] = SetupPkt.bAltID;                    E:\usb20\lighting2\system\usb\usb9\usb9.c
000e6a   5124     MOVF      0x24,0x0,0x1                                                                                    
000e6c   6aea     CLRF      0xea,0x0                                                                                        
000e6e   0fff     ADDLW     0xff                                                                                            
000e70   6ee9     MOVWF     0xe9,0x0                                                                                        
000e72   0e00     MOVLW     0x0                                                                                             
000e74   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
000e76   c422     MOVFF     0x422,0xfef                                                                                     
000e78   ffef                                                                                                               
000e7a   d001     BRA       0xe7e                      break;                                                               E:\usb20\lighting2\system\usb\usb9\usb9.c
                                                   case SET_DSC:                                                            E:\usb20\lighting2\system\usb\usb9\usb9.c
                                                   case SYNCH_FRAME:                                                        E:\usb20\lighting2\system\usb\usb9\usb9.c
                                                   default:                                                                 E:\usb20\lighting2\system\usb\usb9\usb9.c
000e7c   d000     BRA       0xe7e                      break;                                                               E:\usb20\lighting2\system\usb\usb9\usb9.c
                                               }//end switch                                                                E:\usb20\lighting2\system\usb\usb9\usb9.c
                                                                                                                            E:\usb20\lighting2\system\usb\usb9\usb9.c
000e7e   0012     RETURN    0x0            }//end USBCheckStdRequest                                                        E:\usb20\lighting2\system\usb\usb9\usb9.c
                                                                                                                            E:\usb20\lighting2\system\usb\usb9\usb9.c
                                           /******************************************************************************  E:\usb20\lighting2\system\usb\usb9\usb9.c
                                            * Function:        void USBStdGetDscHandler(void)                               E:\usb20\lighting2\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usb9\usb9.c
                                            * PreCondition:    None                                                         E:\usb20\lighting2\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usb9\usb9.c
                                            * Input:           None                                                         E:\usb20\lighting2\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usb9\usb9.c
                                            * Output:          None                                                         E:\usb20\lighting2\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usb9\usb9.c
                                            * Side Effects:    None                                                         E:\usb20\lighting2\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usb9\usb9.c
                                            * Overview:        This routine handles the standard GET_DESCRIPTOR request.    E:\usb20\lighting2\system\usb\usb9\usb9.c
                                            *                  It utilizes tables dynamically looks up descriptor size.     E:\usb20\lighting2\system\usb\usb9\usb9.c
                                            *                  This routine should never have to be modified if the tables  E:\usb20\lighting2\system\usb\usb9\usb9.c
                                            *                  in usbdsc.c are declared correctly.                          E:\usb20\lighting2\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usb9\usb9.c
                                            * Note:            None                                                         E:\usb20\lighting2\system\usb\usb9\usb9.c
                                            *****************************************************************************/  E:\usb20\lighting2\system\usb\usb9\usb9.c
                                           void USBStdGetDscHandler(void)                                                   E:\usb20\lighting2\system\usb\usb9\usb9.c
                                           {                                                                                E:\usb20\lighting2\system\usb\usb9\usb9.c
000e80   0e80     MOVLW     0x80               if(SetupPkt.bmRequestType == 0x80)                                           E:\usb20\lighting2\system\usb\usb9\usb9.c
000e82   0104     MOVLB     0x4                                                                                             
000e84   5d20     SUBWF     0x20,0x0,0x1                                                                                    
000e86   e157     BNZ       0xf36                                                                                           
                                               {                                                                            E:\usb20\lighting2\system\usb\usb9\usb9.c
000e88   5123     MOVF      0x23,0x0,0x1           switch(SetupPkt.bDscType)                                                E:\usb20\lighting2\system\usb\usb9\usb9.c
000e8a   0a03     XORLW     0x3                                                                                             
000e8c   e034     BZ        0xef6                                                                                           
000e8e   0a01     XORLW     0x1                                                                                             
000e90   e010     BZ        0xeb2                                                                                           
000e92   0a03     XORLW     0x3                                                                                             
000e94   e001     BZ        0xe98                                                                                           
000e96   d04d     BRA       0xf32                                                                                           
                                                   {                                                                        E:\usb20\lighting2\system\usb\usb9\usb9.c
                                                       case DSC_DEV:                                                        E:\usb20\lighting2\system\usb\usb9\usb9.c
000e98   0101     MOVLB     0x1                            ctrl_trf_session_owner = MUID_USB9;                              E:\usb20\lighting2\system\usb\usb9\usb9.c
000e9a   0e01     MOVLW     0x1                                                                                             
000e9c   6f31     MOVWF     0x31,0x1                                                                                        
000e9e   0101     MOVLB     0x1                            pSrc.bRom = (rom byte*)&device_dsc;                              E:\usb20\lighting2\system\usb\usb9\usb9.c
000ea0   0e3c     MOVLW     0x3c                                                                                            
000ea2   6f32     MOVWF     0x32,0x1                                                                                        
000ea4   0e15     MOVLW     0x15                                                                                            
000ea6   6f33     MOVWF     0x33,0x1                                                                                        
000ea8   0e12     MOVLW     0x12                           wCount._word = sizeof(device_dsc);          // Set data count    E:\usb20\lighting2\system\usb\usb9\usb9.c
000eaa   0101     MOVLB     0x1                                                                                             
000eac   6f36     MOVWF     0x36,0x1                                                                                        
000eae   6b37     CLRF      0x37,0x1                                                                                        
000eb0   d040     BRA       0xf32                          break;                                                           E:\usb20\lighting2\system\usb\usb9\usb9.c
                                                       case DSC_CFG:                                                        E:\usb20\lighting2\system\usb\usb9\usb9.c
000eb2   0101     MOVLB     0x1                            ctrl_trf_session_owner = MUID_USB9;                              E:\usb20\lighting2\system\usb\usb9\usb9.c
000eb4   0e01     MOVLW     0x1                                                                                             
000eb6   6f31     MOVWF     0x31,0x1                                                                                        
000eb8   0104     MOVLB     0x4                            pSrc.bRom = *(USB_CD_Ptr+SetupPkt.bDscIndex);                    E:\usb20\lighting2\system\usb\usb9\usb9.c
000eba   5122     MOVF      0x22,0x0,0x1                                                                                    
000ebc   6ef6     MOVWF     0xf6,0x0                                                                                        
000ebe   6af7     CLRF      0xf7,0x0                                                                                        
000ec0   90d8     BCF       0xd8,0x0,0x0                                                                                    
000ec2   36f6     RLCF      0xf6,0x1,0x0                                                                                    
000ec4   36f7     RLCF      0xf7,0x1,0x0                                                                                    
000ec6   0efd     MOVLW     0xfd                                                                                            
000ec8   26f6     ADDWF     0xf6,0x1,0x0                                                                                    
000eca   0e15     MOVLW     0x15                                                                                            
000ecc   22f7     ADDWFC    0xf7,0x1,0x0                                                                                    
000ece   0009     TBLRDPOSTINC                                                                                              
000ed0   cff5     MOVFF     0xff5,0x132                                                                                     
000ed2   f132                                                                                                               
000ed4   000a     TBLRDPOSTDEC                                                                                              
000ed6   cff5     MOVFF     0xff5,0x133                                                                                     
000ed8   f133                                                                                                               
000eda   0e02     MOVLW     0x2                            wCount._word = *(pSrc.wRom+1);              // Set data count    E:\usb20\lighting2\system\usb\usb9\usb9.c
000edc   0101     MOVLB     0x1                                                                                             
000ede   6af7     CLRF      0xf7,0x0                                                                                        
000ee0   2532     ADDWF     0x32,0x0,0x1                                                                                    
000ee2   6ef6     MOVWF     0xf6,0x0                                                                                        
000ee4   5133     MOVF      0x33,0x0,0x1                                                                                    
000ee6   22f7     ADDWFC    0xf7,0x1,0x0                                                                                    
000ee8   0009     TBLRDPOSTINC                                                                                              
000eea   cff5     MOVFF     0xff5,0x136                                                                                     
000eec   f136                                                                                                               
000eee   000a     TBLRDPOSTDEC                                                                                              
000ef0   cff5     MOVFF     0xff5,0x137                                                                                     
000ef2   f137                                                                                                               
000ef4   d01e     BRA       0xf32                          break;                                                           E:\usb20\lighting2\system\usb\usb9\usb9.c
                                                       case DSC_STR:                                                        E:\usb20\lighting2\system\usb\usb9\usb9.c
000ef6   0101     MOVLB     0x1                            ctrl_trf_session_owner = MUID_USB9;                              E:\usb20\lighting2\system\usb\usb9\usb9.c
000ef8   0e01     MOVLW     0x1                                                                                             
000efa   6f31     MOVWF     0x31,0x1                                                                                        
000efc   0104     MOVLB     0x4                            pSrc.bRom = *(USB_SD_Ptr+SetupPkt.bDscIndex);                    E:\usb20\lighting2\system\usb\usb9\usb9.c
000efe   5122     MOVF      0x22,0x0,0x1                                                                                    
000f00   6ef6     MOVWF     0xf6,0x0                                                                                        
000f02   6af7     CLRF      0xf7,0x0                                                                                        
000f04   90d8     BCF       0xd8,0x0,0x0                                                                                    
000f06   36f6     RLCF      0xf6,0x1,0x0                                                                                    
000f08   36f7     RLCF      0xf7,0x1,0x0                                                                                    
000f0a   0e01     MOVLW     0x1                                                                                             
000f0c   26f6     ADDWF     0xf6,0x1,0x0                                                                                    
000f0e   0e16     MOVLW     0x16                                                                                            
000f10   22f7     ADDWFC    0xf7,0x1,0x0                                                                                    
000f12   0009     TBLRDPOSTINC                                                                                              
000f14   cff5     MOVFF     0xff5,0x132                                                                                     
000f16   f132                                                                                                               
000f18   000a     TBLRDPOSTDEC                                                                                              
000f1a   cff5     MOVFF     0xff5,0x133                                                                                     
000f1c   f133                                                                                                               
000f1e   c132     MOVFF     0x132,0xff6                    wCount._word = *pSrc.bRom;                  // Set data count    E:\usb20\lighting2\system\usb\usb9\usb9.c
000f20   fff6                                                                                                               
000f22   c133     MOVFF     0x133,0xff7                                                                                     
000f24   fff7                                                                                                               
000f26   0008     TBLRD                                                                                                     
000f28   50f5     MOVF      0xf5,0x0,0x0                                                                                    
000f2a   0101     MOVLB     0x1                                                                                             
000f2c   6f36     MOVWF     0x36,0x1                                                                                        
000f2e   6b37     CLRF      0x37,0x1                                                                                        
000f30   d000     BRA       0xf32                          break;                                                           E:\usb20\lighting2\system\usb\usb9\usb9.c
                                                   }//end switch                                                            E:\usb20\lighting2\system\usb\usb9\usb9.c
                                                                                                                            E:\usb20\lighting2\system\usb\usb9\usb9.c
000f32   0100     MOVLB     0x0                    usb_stat.ctrl_trf_mem = _ROM;                       // Set memory type   E:\usb20\lighting2\system\usb\usb9\usb9.c
000f34   83fd     BSF       0xfd,0x1,0x1                                                                                    
                                               }//end if                                                                    E:\usb20\lighting2\system\usb\usb9\usb9.c
000f36   0012     RETURN    0x0            }//end USBStdGetDscHandler                                                       E:\usb20\lighting2\system\usb\usb9\usb9.c
                                                                                                                            E:\usb20\lighting2\system\usb\usb9\usb9.c
                                           /******************************************************************************  E:\usb20\lighting2\system\usb\usb9\usb9.c
                                            * Function:        void USBStdSetCfgHandler(void)                               E:\usb20\lighting2\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usb9\usb9.c
                                            * PreCondition:    None                                                         E:\usb20\lighting2\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usb9\usb9.c
                                            * Input:           None                                                         E:\usb20\lighting2\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usb9\usb9.c
                                            * Output:          None                                                         E:\usb20\lighting2\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usb9\usb9.c
                                            * Side Effects:    None                                                         E:\usb20\lighting2\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usb9\usb9.c
                                            * Overview:        This routine first disables all endpoints by clearing        E:\usb20\lighting2\system\usb\usb9\usb9.c
                                            *                  UEP registers. It then configures (initializes) endpoints    E:\usb20\lighting2\system\usb\usb9\usb9.c
                                            *                  specified in the modifiable section.                         E:\usb20\lighting2\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usb9\usb9.c
                                            * Note:            None                                                         E:\usb20\lighting2\system\usb\usb9\usb9.c
                                            *****************************************************************************/  E:\usb20\lighting2\system\usb\usb9\usb9.c
                                           void USBStdSetCfgHandler(void)                                                   E:\usb20\lighting2\system\usb\usb9\usb9.c
                                           {                                                                                E:\usb20\lighting2\system\usb\usb9\usb9.c
000f38   0101     MOVLB     0x1                ctrl_trf_session_owner = MUID_USB9;                                          E:\usb20\lighting2\system\usb\usb9\usb9.c
000f3a   0e01     MOVLW     0x1                                                                                             
000f3c   6f31     MOVWF     0x31,0x1                                                                                        
000f3e   0e0f     MOVLW     0xf                mDisableEP1to15();                          // See usbdrv.h                  E:\usb20\lighting2\system\usb\usb9\usb9.c
000f40   6ee6     MOVWF     0xe6,0x0                                                                                        
000f42   0e71     MOVLW     0x71                                                                                            
000f44   6ee6     MOVWF     0xe6,0x0                                                                                        
000f46   0e0f     MOVLW     0xf                                                                                             
000f48   6ee6     MOVWF     0xe6,0x0                                                                                        
000f4a   ec89     CALL      0x1512,0x0                                                                                      
000f4c   f00a                                                                                                               
000f4e   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000f50   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000f52   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000f54   0e01     MOVLW     0x1                ClearArray((byte*)&usb_alt_intf,MAX_NUM_INT);                                E:\usb20\lighting2\system\usb\usb9\usb9.c
000f56   6ee6     MOVWF     0xe6,0x0                                                                                        
000f58   0eff     MOVLW     0xff                                                                                            
000f5a   6ee6     MOVWF     0xe6,0x0                                                                                        
000f5c   0e00     MOVLW     0x0                                                                                             
000f5e   6ee6     MOVWF     0xe6,0x0                                                                                        
000f60   ec89     CALL      0x1512,0x0                                                                                      
000f62   f00a                                                                                                               
000f64   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000f66   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000f68   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000f6a   c422     MOVFF     0x422,0xfe         usb_active_cfg = SetupPkt.bCfgValue;                                         E:\usb20\lighting2\system\usb\usb9\usb9.c
000f6c   f0fe                                                                                                               
000f6e   0104     MOVLB     0x4                if(SetupPkt.bCfgValue == 0)                                                  E:\usb20\lighting2\system\usb\usb9\usb9.c
000f70   5122     MOVF      0x22,0x0,0x1                                                                                    
000f72   e104     BNZ       0xf7c                                                                                           
000f74   0100     MOVLB     0x0                    usb_device_state = ADDRESS_STATE;                                        E:\usb20\lighting2\system\usb\usb9\usb9.c
000f76   0e05     MOVLW     0x5                                                                                             
000f78   6ffc     MOVWF     0xfc,0x1                                                                                        
000f7a   d005     BRA       0xf86              else                                                                         E:\usb20\lighting2\system\usb\usb9\usb9.c
                                               {                                                                            E:\usb20\lighting2\system\usb\usb9\usb9.c
000f7c   0100     MOVLB     0x0                    usb_device_state = CONFIGURED_STATE;                                     E:\usb20\lighting2\system\usb\usb9\usb9.c
000f7e   0e06     MOVLW     0x6                                                                                             
000f80   6ffc     MOVWF     0xfc,0x1                                                                                        
                                                                                                                            E:\usb20\lighting2\system\usb\usb9\usb9.c
                                                   /* Modifiable Section */                                                 E:\usb20\lighting2\system\usb\usb9\usb9.c
                                                                                                                            E:\usb20\lighting2\system\usb\usb9\usb9.c
                                                   #if defined(USB_USE_CDC)                // See autofiles\usbcfg.h        E:\usb20\lighting2\system\usb\usb9\usb9.c
000f82   ec84     CALL      0xb08,0x0              CDCInitEP();                                                             E:\usb20\lighting2\system\usb\usb9\usb9.c
000f84   f005                                                                                                               
                                                   #endif                                                                   E:\usb20\lighting2\system\usb\usb9\usb9.c
                                                                                                                            E:\usb20\lighting2\system\usb\usb9\usb9.c
                                                   /* End modifiable section */                                             E:\usb20\lighting2\system\usb\usb9\usb9.c
                                                                                                                            E:\usb20\lighting2\system\usb\usb9\usb9.c
                                               }//end if(SetupPkt.bcfgValue == 0)                                           E:\usb20\lighting2\system\usb\usb9\usb9.c
000f86   0012     RETURN    0x0            }//end USBStdSetCfgHandler                                                       E:\usb20\lighting2\system\usb\usb9\usb9.c
                                                                                                                            E:\usb20\lighting2\system\usb\usb9\usb9.c
                                           /******************************************************************************  E:\usb20\lighting2\system\usb\usb9\usb9.c
                                            * Function:        void USBStdGetStatusHandler(void)                            E:\usb20\lighting2\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usb9\usb9.c
                                            * PreCondition:    None                                                         E:\usb20\lighting2\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usb9\usb9.c
                                            * Input:           None                                                         E:\usb20\lighting2\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usb9\usb9.c
                                            * Output:          None                                                         E:\usb20\lighting2\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usb9\usb9.c
                                            * Side Effects:    None                                                         E:\usb20\lighting2\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usb9\usb9.c
                                            * Overview:        This routine handles the standard GET_STATUS request         E:\usb20\lighting2\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usb9\usb9.c
                                            * Note:            None                                                         E:\usb20\lighting2\system\usb\usb9\usb9.c
                                            *****************************************************************************/  E:\usb20\lighting2\system\usb\usb9\usb9.c
                                           void USBStdGetStatusHandler(void)                                                E:\usb20\lighting2\system\usb\usb9\usb9.c
                                           {                                                                                E:\usb20\lighting2\system\usb\usb9\usb9.c
000f88   0104     MOVLB     0x4                CtrlTrfData._byte0 = 0;                         // Initialize content        E:\usb20\lighting2\system\usb\usb9\usb9.c
000f8a   6b28     CLRF      0x28,0x1                                                                                        
000f8c   6b29     CLRF      0x29,0x1           CtrlTrfData._byte1 = 0;                                                      E:\usb20\lighting2\system\usb\usb9\usb9.c
                                                                                                                            E:\usb20\lighting2\system\usb\usb9\usb9.c
000f8e   0104     MOVLB     0x4                switch(SetupPkt.Recipient)                                                   E:\usb20\lighting2\system\usb\usb9\usb9.c
000f90   5120     MOVF      0x20,0x0,0x1                                                                                    
000f92   0b1f     ANDLW     0x1f                                                                                            
000f94   0a02     XORLW     0x2                                                                                             
000f96   e014     BZ        0xfc0                                                                                           
000f98   0a03     XORLW     0x3                                                                                             
000f9a   e00e     BZ        0xfb8                                                                                           
000f9c   0a01     XORLW     0x1                                                                                             
000f9e   e001     BZ        0xfa2                                                                                           
000fa0   d033     BRA       0x1008                                                                                          
                                               {                                                                            E:\usb20\lighting2\system\usb\usb9\usb9.c
                                                   case RCPT_DEV:                                                           E:\usb20\lighting2\system\usb\usb9\usb9.c
000fa2   0101     MOVLB     0x1                        ctrl_trf_session_owner = MUID_USB9;                                  E:\usb20\lighting2\system\usb\usb9\usb9.c
000fa4   0e01     MOVLW     0x1                                                                                             
000fa6   6f31     MOVWF     0x31,0x1                                                                                        
                                                       /*                                                                   E:\usb20\lighting2\system\usb\usb9\usb9.c
                                                        * _byte0: bit0: Self-Powered Status [0] Bus-Powered [1] Self-Powered E:\usb20\lighting2\system\usb\usb9\usb9.c
                                                        *         bit1: RemoteWakeup        [0] Disabled    [1] Enabled     E:\usb20\lighting2\system\usb\usb9\usb9.c
                                                        */                                                                  E:\usb20\lighting2\system\usb\usb9\usb9.c
                                                       if(self_power == 1)                     // self_power defined in io_cfg.h E:\usb20\lighting2\system\usb\usb9\usb9.c
000fa8   0104     MOVLB     0x4                            CtrlTrfData._byte0|=0b000000001;    // Set bit0                  E:\usb20\lighting2\system\usb\usb9\usb9.c
000faa   8128     BSF       0x28,0x0,0x1                                                                                    
                                                                                                                            E:\usb20\lighting2\system\usb\usb9\usb9.c
000fac   0100     MOVLB     0x0                        if(usb_stat.RemoteWakeup == 1)          // usb_stat defined in usbmmap.c E:\usb20\lighting2\system\usb\usb9\usb9.c
000fae   a1fd     BTFSS     0xfd,0x0,0x1                                                                                    
000fb0   d002     BRA       0xfb6                                                                                           
000fb2   0104     MOVLB     0x4                            CtrlTrfData._byte0|=0b00000010;     // Set bit1                  E:\usb20\lighting2\system\usb\usb9\usb9.c
000fb4   8328     BSF       0x28,0x1,0x1                                                                                    
000fb6   d028     BRA       0x1008                     break;                                                               E:\usb20\lighting2\system\usb\usb9\usb9.c
                                                   case RCPT_INTF:                                                          E:\usb20\lighting2\system\usb\usb9\usb9.c
000fb8   0101     MOVLB     0x1                        ctrl_trf_session_owner = MUID_USB9;     // No data to update         E:\usb20\lighting2\system\usb\usb9\usb9.c
000fba   0e01     MOVLW     0x1                                                                                             
000fbc   6f31     MOVWF     0x31,0x1                                                                                        
000fbe   d024     BRA       0x1008                     break;                                                               E:\usb20\lighting2\system\usb\usb9\usb9.c
                                                   case RCPT_EP:                                                            E:\usb20\lighting2\system\usb\usb9\usb9.c
000fc0   0101     MOVLB     0x1                        ctrl_trf_session_owner = MUID_USB9;                                  E:\usb20\lighting2\system\usb\usb9\usb9.c
000fc2   0e01     MOVLW     0x1                                                                                             
000fc4   6f31     MOVWF     0x31,0x1                                                                                        
                                                       /*                                                                   E:\usb20\lighting2\system\usb\usb9\usb9.c
                                                        * _byte0: bit0: Halt Status [0] Not Halted [1] Halted               E:\usb20\lighting2\system\usb\usb9\usb9.c
                                                        */                                                                  E:\usb20\lighting2\system\usb\usb9\usb9.c
000fc6   0104     MOVLB     0x4                        pDst.bRam = (byte*)&ep0Bo+(SetupPkt.EPNum*8)+(SetupPkt.EPDir*4);     E:\usb20\lighting2\system\usb\usb9\usb9.c
000fc8   5124     MOVF      0x24,0x0,0x1                                                                                    
000fca   0b0f     ANDLW     0xf                                                                                             
000fcc   0d08     MULLW     0x8                                                                                             
000fce   50f3     MOVF      0xf3,0x0,0x0                                                                                    
000fd0   6a17     CLRF      0x17,0x0                                                                                        
000fd2   0f00     ADDLW     0x0                                                                                             
000fd4   6e16     MOVWF     0x16,0x0                                                                                        
000fd6   0e04     MOVLW     0x4                                                                                             
000fd8   2217     ADDWFC    0x17,0x1,0x0                                                                                    
000fda   5124     MOVF      0x24,0x0,0x1                                                                                    
000fdc   0b80     ANDLW     0x80                                                                                            
000fde   e001     BZ        0xfe2                                                                                           
000fe0   0e01     MOVLW     0x1                                                                                             
000fe2   0d04     MULLW     0x4                                                                                             
000fe4   50f3     MOVF      0xf3,0x0,0x0                                                                                    
000fe6   0101     MOVLB     0x1                                                                                             
000fe8   2416     ADDWF     0x16,0x0,0x0                                                                                    
000fea   6f34     MOVWF     0x34,0x1                                                                                        
000fec   0e00     MOVLW     0x0                                                                                             
000fee   2017     ADDWFC    0x17,0x0,0x0                                                                                    
000ff0   6f35     MOVWF     0x35,0x1                                                                                        
000ff2   c134     MOVFF     0x134,0xfe9                if(*pDst.bRam & _BSTALL)    // Use _BSTALL as a bit mask             E:\usb20\lighting2\system\usb\usb9\usb9.c
000ff4   ffe9                                                                                                               
000ff6   c135     MOVFF     0x135,0xfea                                                                                     
000ff8   ffea                                                                                                               
000ffa   50ef     MOVF      0xef,0x0,0x0                                                                                    
000ffc   0b04     ANDLW     0x4                                                                                             
000ffe   e003     BZ        0x1006                                                                                          
001000   0104     MOVLB     0x4                            CtrlTrfData._byte0=0x01;// Set bit0                              E:\usb20\lighting2\system\usb\usb9\usb9.c
001002   0e01     MOVLW     0x1                                                                                             
001004   6f28     MOVWF     0x28,0x1                                                                                        
001006   d000     BRA       0x1008                     break;                                                               E:\usb20\lighting2\system\usb\usb9\usb9.c
                                               }//end switch                                                                E:\usb20\lighting2\system\usb\usb9\usb9.c
                                                                                                                            E:\usb20\lighting2\system\usb\usb9\usb9.c
001008   0101     MOVLB     0x1                if(ctrl_trf_session_owner == MUID_USB9)                                      E:\usb20\lighting2\system\usb\usb9\usb9.c
00100a   0531     DECF      0x31,0x0,0x1                                                                                    
00100c   e10a     BNZ       0x1022                                                                                          
                                               {                                                                            E:\usb20\lighting2\system\usb\usb9\usb9.c
00100e   0101     MOVLB     0x1                    pSrc.bRam = (byte*)&CtrlTrfData;            // Set Source                E:\usb20\lighting2\system\usb\usb9\usb9.c
001010   0e28     MOVLW     0x28                                                                                            
001012   6f32     MOVWF     0x32,0x1                                                                                        
001014   0e04     MOVLW     0x4                                                                                             
001016   6f33     MOVWF     0x33,0x1                                                                                        
001018   0100     MOVLB     0x0                    usb_stat.ctrl_trf_mem = _RAM;               // Set memory type           E:\usb20\lighting2\system\usb\usb9\usb9.c
00101a   93fd     BCF       0xfd,0x1,0x1                                                                                    
00101c   0101     MOVLB     0x1                    LSB(wCount) = 2;                            // Set data count            E:\usb20\lighting2\system\usb\usb9\usb9.c
00101e   0e02     MOVLW     0x2                                                                                             
001020   6f36     MOVWF     0x36,0x1                                                                                        
                                               }//end if(...)                                                               E:\usb20\lighting2\system\usb\usb9\usb9.c
001022   0012     RETURN    0x0            }//end USBStdGetStatusHandler                                                    E:\usb20\lighting2\system\usb\usb9\usb9.c
                                                                                                                            E:\usb20\lighting2\system\usb\usb9\usb9.c
                                           /******************************************************************************  E:\usb20\lighting2\system\usb\usb9\usb9.c
                                            * Function:        void USBStdFeatureReqHandler(void)                           E:\usb20\lighting2\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usb9\usb9.c
                                            * PreCondition:    None                                                         E:\usb20\lighting2\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usb9\usb9.c
                                            * Input:           None                                                         E:\usb20\lighting2\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usb9\usb9.c
                                            * Output:          None                                                         E:\usb20\lighting2\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usb9\usb9.c
                                            * Side Effects:    None                                                         E:\usb20\lighting2\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usb9\usb9.c
                                            * Overview:        This routine handles the standard SET & CLEAR FEATURES       E:\usb20\lighting2\system\usb\usb9\usb9.c
                                            *                  requests                                                     E:\usb20\lighting2\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usb9\usb9.c
                                            * Note:            None                                                         E:\usb20\lighting2\system\usb\usb9\usb9.c
                                            *****************************************************************************/  E:\usb20\lighting2\system\usb\usb9\usb9.c
                                           void USBStdFeatureReqHandler(void)                                               E:\usb20\lighting2\system\usb\usb9\usb9.c
                                           {                                                                                E:\usb20\lighting2\system\usb\usb9\usb9.c
001024   0104     MOVLB     0x4                if((SetupPkt.bFeature == DEVICE_REMOTE_WAKEUP)&&                             E:\usb20\lighting2\system\usb\usb9\usb9.c
001026   0522     DECF      0x22,0x0,0x1                                                                                    
001028   e110     BNZ       0x104a                (SetupPkt.Recipient == RCPT_DEV))                                         E:\usb20\lighting2\system\usb\usb9\usb9.c
00102a   5120     MOVF      0x20,0x0,0x1                                                                                    
00102c   0b1f     ANDLW     0x1f                                                                                            
00102e   0900     IORLW     0x0                                                                                             
001030   e10c     BNZ       0x104a                                                                                          
                                               {                                                                            E:\usb20\lighting2\system\usb\usb9\usb9.c
001032   0101     MOVLB     0x1                    ctrl_trf_session_owner = MUID_USB9;                                      E:\usb20\lighting2\system\usb\usb9\usb9.c
001034   0e01     MOVLW     0x1                                                                                             
001036   6f31     MOVWF     0x31,0x1                                                                                        
001038   0e03     MOVLW     0x3                    if(SetupPkt.bRequest == SET_FEATURE)                                     E:\usb20\lighting2\system\usb\usb9\usb9.c
00103a   0104     MOVLB     0x4                                                                                             
00103c   5d21     SUBWF     0x21,0x0,0x1                                                                                    
00103e   e103     BNZ       0x1046                                                                                          
001040   0100     MOVLB     0x0                        usb_stat.RemoteWakeup = 1;                                           E:\usb20\lighting2\system\usb\usb9\usb9.c
001042   81fd     BSF       0xfd,0x0,0x1                                                                                    
001044   d002     BRA       0x104a                 else                                                                     E:\usb20\lighting2\system\usb\usb9\usb9.c
001046   0100     MOVLB     0x0                        usb_stat.RemoteWakeup = 0;                                           E:\usb20\lighting2\system\usb\usb9\usb9.c
001048   91fd     BCF       0xfd,0x0,0x1                                                                                    
                                               }//end if                                                                    E:\usb20\lighting2\system\usb\usb9\usb9.c
                                                                                                                            E:\usb20\lighting2\system\usb\usb9\usb9.c
00104a   0104     MOVLB     0x4                if((SetupPkt.bFeature == ENDPOINT_HALT)&&                                    E:\usb20\lighting2\system\usb\usb9\usb9.c
00104c   5122     MOVF      0x22,0x0,0x1                                                                                    
00104e   e13a     BNZ       0x10c4                (SetupPkt.Recipient == RCPT_EP)&&                                         E:\usb20\lighting2\system\usb\usb9\usb9.c
001050   5120     MOVF      0x20,0x0,0x1                                                                                    
001052   0b1f     ANDLW     0x1f                                                                                            
001054   0802     SUBLW     0x2                                                                                             
001056   e136     BNZ       0x10c4                                                                                          
001058   5124     MOVF      0x24,0x0,0x1          (SetupPkt.EPNum != 0))                                                    E:\usb20\lighting2\system\usb\usb9\usb9.c
00105a   0b0f     ANDLW     0xf                                                                                             
00105c   0900     IORLW     0x0                                                                                             
00105e   e032     BZ        0x10c4                                                                                          
                                               {                                                                            E:\usb20\lighting2\system\usb\usb9\usb9.c
001060   0101     MOVLB     0x1                    ctrl_trf_session_owner = MUID_USB9;                                      E:\usb20\lighting2\system\usb\usb9\usb9.c
001062   0e01     MOVLW     0x1                                                                                             
001064   6f31     MOVWF     0x31,0x1                                                                                        
                                                   /* Must do address calculation here */                                   E:\usb20\lighting2\system\usb\usb9\usb9.c
001066   0104     MOVLB     0x4                    pDst.bRam = (byte*)&ep0Bo+(SetupPkt.EPNum*8)+(SetupPkt.EPDir*4);         E:\usb20\lighting2\system\usb\usb9\usb9.c
001068   5124     MOVF      0x24,0x0,0x1                                                                                    
00106a   0b0f     ANDLW     0xf                                                                                             
00106c   0d08     MULLW     0x8                                                                                             
00106e   50f3     MOVF      0xf3,0x0,0x0                                                                                    
001070   6a17     CLRF      0x17,0x0                                                                                        
001072   0f00     ADDLW     0x0                                                                                             
001074   6e16     MOVWF     0x16,0x0                                                                                        
001076   0e04     MOVLW     0x4                                                                                             
001078   2217     ADDWFC    0x17,0x1,0x0                                                                                    
00107a   5124     MOVF      0x24,0x0,0x1                                                                                    
00107c   0b80     ANDLW     0x80                                                                                            
00107e   e001     BZ        0x1082                                                                                          
001080   0e01     MOVLW     0x1                                                                                             
001082   0d04     MULLW     0x4                                                                                             
001084   50f3     MOVF      0xf3,0x0,0x0                                                                                    
001086   0101     MOVLB     0x1                                                                                             
001088   2416     ADDWF     0x16,0x0,0x0                                                                                    
00108a   6f34     MOVWF     0x34,0x1                                                                                        
00108c   0e00     MOVLW     0x0                                                                                             
00108e   2017     ADDWFC    0x17,0x0,0x0                                                                                    
001090   6f35     MOVWF     0x35,0x1                                                                                        
                                                                                                                            E:\usb20\lighting2\system\usb\usb9\usb9.c
001092   0e03     MOVLW     0x3                    if(SetupPkt.bRequest == SET_FEATURE)                                     E:\usb20\lighting2\system\usb\usb9\usb9.c
001094   0104     MOVLB     0x4                                                                                             
001096   5d21     SUBWF     0x21,0x0,0x1                                                                                    
001098   e107     BNZ       0x10a8                                                                                          
00109a   0e84     MOVLW     0x84                       *pDst.bRam = _USIE|_BSTALL;                                          E:\usb20\lighting2\system\usb\usb9\usb9.c
00109c   c134     MOVFF     0x134,0xfe9                                                                                     
00109e   ffe9                                                                                                               
0010a0   c135     MOVFF     0x135,0xfea                                                                                     
0010a2   ffea                                                                                                               
0010a4   6eef     MOVWF     0xef,0x0                                                                                        
0010a6   d00e     BRA       0x10c4                 else                                                                     E:\usb20\lighting2\system\usb\usb9\usb9.c
                                                   {                                                                        E:\usb20\lighting2\system\usb\usb9\usb9.c
0010a8   af24     BTFSS     0x24,0x7,0x1               if(SetupPkt.EPDir == 1) // IN                                        E:\usb20\lighting2\system\usb\usb9\usb9.c
0010aa   d006     BRA       0x10b8                                                                                          
0010ac   c134     MOVFF     0x134,0xfe9                    *pDst.bRam = _UCPU;                                              E:\usb20\lighting2\system\usb\usb9\usb9.c
0010ae   ffe9                                                                                                               
0010b0   c135     MOVFF     0x135,0xfea                                                                                     
0010b2   ffea                                                                                                               
0010b4   6aef     CLRF      0xef,0x0                                                                                        
0010b6   d006     BRA       0x10c4                     else                                                                 E:\usb20\lighting2\system\usb\usb9\usb9.c
0010b8   0e88     MOVLW     0x88                           *pDst.bRam = _USIE|_DAT0|_DTSEN;                                 E:\usb20\lighting2\system\usb\usb9\usb9.c
0010ba   c134     MOVFF     0x134,0xfe9                                                                                     
0010bc   ffe9                                                                                                               
0010be   c135     MOVFF     0x135,0xfea                                                                                     
0010c0   ffea                                                                                                               
0010c2   6eef     MOVWF     0xef,0x0                                                                                        
                                                   }//end if                                                                E:\usb20\lighting2\system\usb\usb9\usb9.c
                                               }//end if                                                                    E:\usb20\lighting2\system\usb\usb9\usb9.c
0010c4   0012     RETURN    0x0            }//end USBStdFeatureReqHandler                                                   E:\usb20\lighting2\system\usb\usb9\usb9.c
                                                                                                                            E:\usb20\lighting2\system\usb\usb9\usb9.c
                                           /** EOF usb9.c ***************************************************************/  E:\usb20\lighting2\system\usb\usb9\usb9.c
                                           /*********************************************************************           E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            *                Microchip USB C18 Firmware Version 1.0                         E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            *********************************************************************           E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            * FileName:        usbctrltrf.c                                                 E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            * Dependencies:    See INCLUDES section below                                   E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            * Processor:       PIC18                                                        E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            * Compiler:        C18 2.30.01+                                                 E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            * Company:         Microchip Technology, Inc.                                   E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            * Software License Agreement                                                    E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            * The software supplied herewith by Microchip Technology Incorporated           E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            * (the 鼎ompany) for its PICmicroｮ Microcontroller is intended and             E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            * supplied to you, the Company痴 customer, for use solely and                   E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            * exclusively on Microchip PICmicro Microcontroller products. The               E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            * software is owned by the Company and/or its supplier, and is                  E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            * protected under applicable copyright laws. All rights are reserved.           E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            * Any use in violation of the foregoing restrictions may subject the            E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            * user to criminal sanctions under applicable laws, as well as to               E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            * civil liability for the breach of the terms and conditions of this            E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            * license.                                                                      E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            * THIS SOFTWARE IS PROVIDED IN AN 鄭S IS CONDITION. NO WARRANTIES,             E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            * WHETHER EXPRESS, IMPLIED OR STATUTORY, INCLUDING, BUT NOT LIMITED             E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            * TO, IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A                   E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            * PARTICULAR PURPOSE APPLY TO THIS SOFTWARE. THE COMPANY SHALL NOT,             E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            * IN ANY CIRCUMSTANCES, BE LIABLE FOR SPECIAL, INCIDENTAL OR                    E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            * CONSEQUENTIAL DAMAGES, FOR ANY REASON WHATSOEVER.                             E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            * Author               Date        Comment                                      E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            *~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~           E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            * Rawin Rojvanit       11/19/04    Original.                                    E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            ********************************************************************/           E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                                                                                                            E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                           /** I N C L U D E S **********************************************************/  E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                           #include <p18cxxx.h>                                                             E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                           #include "system\typedefs.h"                                                     E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                           #include "system\usb\usb.h"                                                      E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                                                                                                            E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                           /** V A R I A B L E S ********************************************************/  E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                           #pragma udata                                                                    E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                           byte ctrl_trf_state;                // Control Transfer State                    E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                           byte ctrl_trf_session_owner;        // Current transfer session owner            E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                                                                                                            E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                           POINTER pSrc;                       // Data source pointer                       E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                           POINTER pDst;                       // Data destination pointer                  E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                           WORD wCount;                        // Data counter                              E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                                                                                                            E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                           /** P R I V A T E  P R O T O T Y P E S ***************************************/  E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                           void USBCtrlTrfSetupHandler(void);                                               E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                           void USBCtrlTrfOutHandler(void);                                                 E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                           void USBCtrlTrfInHandler(void);                                                  E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                                                                                                            E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                           /** D E C L A R A T I O N S **************************************************/  E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                           #pragma code                                                                     E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                           /******************************************************************************  E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            * Function:        void USBCtrlEPService(void)                                  E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            * PreCondition:    USTAT is loaded with a valid endpoint address.               E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            * Input:           None                                                         E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            * Output:          None                                                         E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            * Side Effects:    None                                                         E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            * Overview:        USBCtrlEPService checks for three transaction types that     E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  it knows how to service and services them:                   E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  1. EP0 SETUP                                                 E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  2. EP0 OUT                                                   E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  3. EP0 IN                                                    E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  It ignores all other types (i.e. EP1, EP2, etc.)             E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            * Note:            None                                                         E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            *****************************************************************************/  E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                           void USBCtrlEPService(void)                                                      E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                           {                                                                                E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
0010c6   506c     MOVF      0x6c,0x0,0x0       if(USTAT == EP00_OUT)                                                        E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
0010c8   e002     BZ        0x10ce                                                                                          
0010ca   0e00     MOVLW     0x0                                                                                             
0010cc   d001     BRA       0x10d0                                                                                          
0010ce   0e01     MOVLW     0x1                                                                                             
0010d0   0900     IORLW     0x0                                                                                             
0010d2   e00b     BZ        0x10ea                                                                                          
                                               {                                                                            E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
0010d4   0104     MOVLB     0x4                    if(ep0Bo.Stat.PID == SETUP_TOKEN)           // EP0 SETUP                 E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
0010d6   5100     MOVF      0x0,0x0,0x1                                                                                     
0010d8   0b3c     ANDLW     0x3c                                                                                            
0010da   42e8     RRNCF     0xe8,0x1,0x0                                                                                    
0010dc   42e8     RRNCF     0xe8,0x1,0x0                                                                                    
0010de   080d     SUBLW     0xd                                                                                             
0010e0   e102     BNZ       0x10e6                                                                                          
0010e2   d80c     RCALL     0x10fc                     USBCtrlTrfSetupHandler();                                            E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
0010e4   d001     BRA       0x10e8                 else                                        // EP0 OUT                   E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
0010e6   d840     RCALL     0x1168                     USBCtrlTrfOutHandler();                                              E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                               }                                                                            E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
0010e8   d008     BRA       0x10fa             else if(USTAT == EP00_IN)                       // EP0 IN                    E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
0010ea   506c     MOVF      0x6c,0x0,0x0                                                                                    
0010ec   e002     BZ        0x10f2                                                                                          
0010ee   0e00     MOVLW     0x0                                                                                             
0010f0   d001     BRA       0x10f4                                                                                          
0010f2   0e01     MOVLW     0x1                                                                                             
0010f4   0904     IORLW     0x4                                                                                             
0010f6   e001     BZ        0x10fa                                                                                          
0010f8   d847     RCALL     0x1188                 USBCtrlTrfInHandler();                                                   E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                                                                                                            E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
0010fa   0012     RETURN    0x0            }//end USBCtrlEPService                                                          E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                                                                                                            E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                           /******************************************************************************  E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            * Function:        void USBCtrlTrfSetupHandler(void)                            E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            * PreCondition:    SetupPkt buffer is loaded with valid USB Setup Data          E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            * Input:           None                                                         E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            * Output:          None                                                         E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            * Side Effects:    None                                                         E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            * Overview:        This routine is a task dispatcher and has 3 stages.          E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  1. It initializes the control transfer state machine.        E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  2. It calls on each of the module that may know how to       E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            *                     service the Setup Request from the host.                  E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            *                     Module Example: USB9, HID, CDC, MSD, ...                  E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            *                     As new classes are added, ClassReqHandler table in        E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            *                     usbdsc.c should be updated to call all available          E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            *                     class handlers.                                           E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  3. Once each of the modules has had a chance to check if     E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            *                     it is responsible for servicing the request, stage 3      E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            *                     then checks direction of the transfer to determine how    E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            *                     to prepare EP0 for the control transfer.                  E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            *                     Refer to USBCtrlEPServiceComplete() for more details.     E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            * Note:            Microchip USB Firmware has three different states for        E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  the control transfer state machine:                          E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  1. WAIT_SETUP                                                E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  2. CTRL_TRF_TX                                               E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  3. CTRL_TRF_RX                                               E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  Refer to firmware manual to find out how one state           E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  is transitioned to another.                                  E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  A Control Transfer is composed of many USB transactions.     E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  When transferring data over multiple transactions,           E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  it is important to keep track of data source, data           E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  destination, and data count. These three parameters are      E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  stored in pSrc,pDst, and wCount. A flag is used to           E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  note if the data source is from ROM or RAM.                  E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            *****************************************************************************/  E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
0010fc   cfd9     MOVFF     0xfd9,0xfe6    void USBCtrlTrfSetupHandler(void)                                                E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
0010fe   ffe6                                                                                                               
001100   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
001102   ffd9                                                                                                               
001104   52e6     MOVF      0xe6,0x1,0x0                                                                                    
                                           {                                                                                E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                               byte i;                                                                      E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                                                                                                            E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                               /* Stage 1 */                                                                E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
001106   0101     MOVLB     0x1                ctrl_trf_state = WAIT_SETUP;                                                 E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
001108   6b30     CLRF      0x30,0x1                                                                                        
00110a   6b31     CLRF      0x31,0x1           ctrl_trf_session_owner = MUID_NULL;     // Set owner to NULL                 E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
00110c   6b36     CLRF      0x36,0x1           wCount._word = 0;                                                            E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
00110e   6b37     CLRF      0x37,0x1                                                                                        
                                                                                                                            E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                               /* Stage 2 */                                                                E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
001110   ecdf     CALL      0xdbe,0x0          USBCheckStdRequest();                   // See system\usb9\usb9.c            E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
001112   f006                                                                                                               
                                                                                                                            E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
001114   6adf     CLRF      0xdf,0x0           for(i=0;i < (sizeof(ClassReqHandler)/sizeof(pFunc));i++)                     E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
001116   50df     MOVF      0xdf,0x0,0x0                                                                                    
001118   6e16     MOVWF     0x16,0x0                                                                                        
00111a   6a17     CLRF      0x17,0x0                                                                                        
00111c   0e01     MOVLW     0x1                                                                                             
00111e   5c16     SUBWF     0x16,0x0,0x0                                                                                    
001120   0e00     MOVLW     0x0                                                                                             
001122   5817     SUBWFB    0x17,0x0,0x0                                                                                    
001124   e21b     BC        0x115c                                                                                          
001158   2adf     INCF      0xdf,0x1,0x0                                                                                    
00115a   d7dd     BRA       0x1116                                                                                          
                                               {                                                                            E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
001126   0101     MOVLB     0x1                    if(ctrl_trf_session_owner != MUID_NULL)break;                            E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
001128   5131     MOVF      0x31,0x0,0x1                                                                                    
00112a   e001     BZ        0x112e                                                                                          
00112c   d017     BRA       0x115c                                                                                          
00112e   6af7     CLRF      0xf7,0x0               ClassReqHandler[i]();               // See autofiles\usbdsc.c            E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
001130   34df     RLCF      0xdf,0x0,0x0                                                                                    
001132   0bfe     ANDLW     0xfe                                                                                            
001134   36f7     RLCF      0xf7,0x1,0x0                                                                                    
001136   6ef6     MOVWF     0xf6,0x0                                                                                        
001138   0e07     MOVLW     0x7                                                                                             
00113a   26f6     ADDWF     0xf6,0x1,0x0                                                                                    
00113c   0e16     MOVLW     0x16                                                                                            
00113e   22f7     ADDWFC    0xf7,0x1,0x0                                                                                    
001140   0009     TBLRDPOSTINC                                                                                              
001142   cff5     MOVFF     0xff5,0x16                                                                                      
001144   f016                                                                                                               
001146   0008     TBLRD                                                                                                     
001148   cff5     MOVFF     0xff5,0x17                                                                                      
00114a   f017                                                                                                               
00114c   d004     BRA       0x1156                                                                                          
00114e   c017     MOVFF     0x17,0xffa                                                                                      
001150   fffa                                                                                                               
001152   5016     MOVF      0x16,0x0,0x0                                                                                    
001154   6ef9     MOVWF     0xf9,0x0                                                                                        
001156   dffb     RCALL     0x114e                                                                                          
                                               }//end while                                                                 E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                                                                                                            E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                               /* Stage 3 */                                                                E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
00115c   d8e1     RCALL     0x1320             USBCtrlEPServiceComplete();                                                  E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                                                                                                            E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
00115e   52e5     MOVF      0xe5,0x1,0x0   }//end USBCtrlTrfSetupHandler                                                    E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
001160   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001162   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
001164   ffd9                                                                                                               
001166   0012     RETURN    0x0                                                                                             
                                                                                                                            E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                           /******************************************************************************  E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            * Function:        void USBCtrlTrfOutHandler(void)                              E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            * PreCondition:    None                                                         E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            * Input:           None                                                         E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            * Output:          None                                                         E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            * Side Effects:    None                                                         E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            * Overview:        This routine handles an OUT transaction according to         E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  which control transfer state is currently active.            E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            * Note:            Note that if the the control transfer was from               E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  host to device, the session owner should be notified         E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  at the end of each OUT transaction to service the            E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  received data.                                               E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            *****************************************************************************/  E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                           void USBCtrlTrfOutHandler(void)                                                  E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                           {                                                                                E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
001168   0e02     MOVLW     0x2                if(ctrl_trf_state == CTRL_TRF_RX)                                            E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
00116a   0101     MOVLB     0x1                                                                                             
00116c   5d30     SUBWF     0x30,0x0,0x1                                                                                    
00116e   e10a     BNZ       0x1184                                                                                          
                                               {                                                                            E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
001170   d898     RCALL     0x12a2                 USBCtrlTrfRxService();                                                   E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                                                                                                            E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                                   /*                                                                       E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                                    * Don't have to worry about overwriting _KEEP bit                       E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                                    * because if _KEEP was set, TRNIF would not have been                   E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                                    * generated in the first place.                                         E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                                    */                                                                      E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
001172   0104     MOVLB     0x4                    if(ep0Bo.Stat.DTS == 0)                                                  E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
001174   bd00     BTFSC     0x0,0x6,0x1                                                                                     
001176   d003     BRA       0x117e                                                                                          
001178   0ec8     MOVLW     0xc8                       ep0Bo.Stat._byte = _USIE|_DAT1|_DTSEN;                               E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
00117a   6f00     MOVWF     0x0,0x1                                                                                         
00117c   d002     BRA       0x1182                 else                                                                     E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
00117e   0e88     MOVLW     0x88                       ep0Bo.Stat._byte = _USIE|_DAT0|_DTSEN;                               E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
001180   6f00     MOVWF     0x0,0x1                                                                                         
                                               }                                                                            E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
001182   d001     BRA       0x1186             else    // CTRL_TRF_TX                                                       E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
001184   d913     RCALL     0x13ac                 USBPrepareForNextSetupTrf();                                             E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                                                                                                            E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
001186   0012     RETURN    0x0            }//end USBCtrlTrfOutHandler                                                      E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                                                                                                            E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                           /******************************************************************************  E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            * Function:        void USBCtrlTrfInHandler(void)                               E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            * PreCondition:    None                                                         E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            * Input:           None                                                         E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            * Output:          None                                                         E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            * Side Effects:    None                                                         E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            * Overview:        This routine handles an IN transaction according to          E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  which control transfer state is currently active.            E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            * Note:            A Set Address Request must not change the acutal address     E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  of the device until the completion of the control            E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  transfer. The end of the control transfer for Set Address    E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  Request is an IN transaction. Therefore it is necessary      E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  to service this unique situation when the condition is       E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  right. Macro mUSBCheckAdrPendingState is defined in          E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  usb9.h and its function is to specifically service this      E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  event.                                                       E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            *****************************************************************************/  E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                           void USBCtrlTrfInHandler(void)                                                   E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                           {                                                                                E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
001188   0e04     MOVLW     0x4                mUSBCheckAdrPendingState();         // Must check if in ADR_PENDING_STATE    E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
00118a   0100     MOVLB     0x0                                                                                             
00118c   5dfc     SUBWF     0xfc,0x0,0x1                                                                                    
00118e   e10a     BNZ       0x11a4                                                                                          
001190   c422     MOVFF     0x422,0xf6e                                                                                     
001192   ff6e                                                                                                               
001194   506e     MOVF      0x6e,0x0,0x0                                                                                    
001196   0800     SUBLW     0x0                                                                                             
001198   e203     BC        0x11a0                                                                                          
00119a   0e05     MOVLW     0x5                                                                                             
00119c   6ffc     MOVWF     0xfc,0x1                                                                                        
00119e   d002     BRA       0x11a4                                                                                          
0011a0   0e03     MOVLW     0x3                                                                                             
0011a2   6ffc     MOVWF     0xfc,0x1                                                                                        
                                                                                                                            E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
0011a4   0101     MOVLB     0x1                if(ctrl_trf_state == CTRL_TRF_TX)                                            E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
0011a6   0530     DECF      0x30,0x0,0x1                                                                                    
0011a8   e10a     BNZ       0x11be                                                                                          
                                               {                                                                            E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
0011aa   d80b     RCALL     0x11c2                 USBCtrlTrfTxService();                                                   E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                                                                                                            E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
0011ac   0104     MOVLB     0x4                    if(ep0Bi.Stat.DTS == 0)                                                  E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
0011ae   bd04     BTFSC     0x4,0x6,0x1                                                                                     
0011b0   d003     BRA       0x11b8                                                                                          
0011b2   0ec8     MOVLW     0xc8                       ep0Bi.Stat._byte = _USIE|_DAT1|_DTSEN;                               E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
0011b4   6f04     MOVWF     0x4,0x1                                                                                         
0011b6   d002     BRA       0x11bc                 else                                                                     E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
0011b8   0e88     MOVLW     0x88                       ep0Bi.Stat._byte = _USIE|_DAT0|_DTSEN;                               E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
0011ba   6f04     MOVWF     0x4,0x1                                                                                         
                                               }                                                                            E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
0011bc   d001     BRA       0x11c0             else // CTRL_TRF_RX                                                          E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
0011be   d8f6     RCALL     0x13ac                 USBPrepareForNextSetupTrf();                                             E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                                                                                                            E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
0011c0   0012     RETURN    0x0            }//end USBCtrlTrfInHandler                                                       E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                                                                                                            E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                           /******************************************************************************  E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            * Function:        void USBCtrlTrfTxService(void)                               E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            * PreCondition:    pSrc, wCount, and usb_stat.ctrl_trf_mem are setup properly.  E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            * Input:           None                                                         E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            * Output:          None                                                         E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            * Side Effects:    None                                                         E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            * Overview:        This routine should be called from only two places.          E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  One from USBCtrlEPServiceComplete() and one from             E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  USBCtrlTrfInHandler(). It takes care of managing a           E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  transfer over multiple USB transactions.                     E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            * Note:            This routine works with isochronous endpoint larger than     E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  256 bytes and is shown here as an example of how to deal     E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  with BC9 and BC8. In reality, a control endpoint can never   E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  be larger than 64 bytes.                                     E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            *****************************************************************************/  E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
0011c2   cfd9     MOVFF     0xfd9,0xfe6    void USBCtrlTrfTxService(void)                                                   E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
0011c4   ffe6                                                                                                               
0011c6   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
0011c8   ffd9                                                                                                               
0011ca   0e02     MOVLW     0x2                                                                                             
0011cc   26e1     ADDWF     0xe1,0x1,0x0                                                                                    
                                           {                                                                                E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                               WORD byte_to_send;                                                           E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                                                                                                            E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                               /*                                                                           E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                                * First, have to figure out how many byte of data to send.                  E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                                */                                                                          E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
0011ce   0101     MOVLB     0x1                if(wCount._word < EP0_BUFF_SIZE)                                             E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
0011d0   0e08     MOVLW     0x8                                                                                             
0011d2   5d36     SUBWF     0x36,0x0,0x1                                                                                    
0011d4   0e00     MOVLW     0x0                                                                                             
0011d6   5937     SUBWFB    0x37,0x0,0x1                                                                                    
0011d8   e205     BC        0x11e4                                                                                          
0011da   c136     MOVFF     0x136,0xfde            byte_to_send._word = wCount._word;                                       E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
0011dc   ffde                                                                                                               
0011de   c137     MOVFF     0x137,0xfdd                                                                                     
0011e0   ffdd                                                                                                               
0011e2   d003     BRA       0x11ea             else                                                                         E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
0011e4   0e08     MOVLW     0x8                    byte_to_send._word = EP0_BUFF_SIZE;                                      E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
0011e6   6ede     MOVWF     0xde,0x0                                                                                        
0011e8   6add     CLRF      0xdd,0x0                                                                                        
                                                                                                                            E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                               /*                                                                           E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                                * Next, load the number of bytes to send to BC9..0 in buffer descriptor     E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                                */                                                                          E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
0011ea   0104     MOVLB     0x4                ep0Bi.Stat.BC9 = 0;                                                          E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
0011ec   9304     BCF       0x4,0x1,0x1                                                                                     
0011ee   9104     BCF       0x4,0x0,0x1        ep0Bi.Stat.BC8 = 0;                                                          E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
0011f0   0e01     MOVLW     0x1                ep0Bi.Stat._byte |= MSB(byte_to_send);                                       E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
0011f2   50db     MOVF      0xdb,0x0,0x0                                                                                    
0011f4   1304     IORWF     0x4,0x1,0x1                                                                                     
0011f6   cfdf     MOVFF     0xfdf,0x405        ep0Bi.Cnt = LSB(byte_to_send);                                               E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
0011f8   f405                                                                                                               
                                                                                                                            E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                               /*                                                                           E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                                * Subtract the number of bytes just about to be sent from the total.        E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                                */                                                                          E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
0011fa   0e00     MOVLW     0x0                wCount._word = wCount._word - byte_to_send._word;                            E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
0011fc   50db     MOVF      0xdb,0x0,0x0                                                                                    
0011fe   0101     MOVLB     0x1                                                                                             
001200   5f36     SUBWF     0x36,0x1,0x1                                                                                    
001202   0e01     MOVLW     0x1                                                                                             
001204   50db     MOVF      0xdb,0x0,0x0                                                                                    
001206   5b37     SUBWFB    0x37,0x1,0x1                                                                                    
                                                                                                                            E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
001208   0e28     MOVLW     0x28               pDst.bRam = (byte*)&CtrlTrfData;        // Set destination pointer           E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
00120a   6f34     MOVWF     0x34,0x1                                                                                        
00120c   0e04     MOVLW     0x4                                                                                             
00120e   6f35     MOVWF     0x35,0x1                                                                                        
                                                                                                                            E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
001210   0100     MOVLB     0x0                if(usb_stat.ctrl_trf_mem == _ROM)       // Determine type of memory source   E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
001212   a3fd     BTFSS     0xfd,0x1,0x1                                                                                    
001214   d01e     BRA       0x1252                                                                                          
                                               {                                                                            E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
001216   cfd9     MOVFF     0xfd9,0xfe9            while(byte_to_send._word)                                                E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
001218   ffe9                                                                                                               
00121a   cfda     MOVFF     0xfda,0xfea                                                                                     
00121c   ffea                                                                                                               
00121e   50ee     MOVF      0xee,0x0,0x0                                                                                    
001220   10ed     IORWF     0xed,0x0,0x0                                                                                    
001222   e016     BZ        0x1250                                                                                          
00124e   d7e3     BRA       0x1216                                                                                          
                                                   {                                                                        E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
001224   c132     MOVFF     0x132,0xff6                *pDst.bRam = *pSrc.bRom;                                             E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
001226   fff6                                                                                                               
001228   c133     MOVFF     0x133,0xff7                                                                                     
00122a   fff7                                                                                                               
00122c   0008     TBLRD                                                                                                     
00122e   50f5     MOVF      0xf5,0x0,0x0                                                                                    
001230   c134     MOVFF     0x134,0xfe9                                                                                     
001232   ffe9                                                                                                               
001234   c135     MOVFF     0x135,0xfea                                                                                     
001236   ffea                                                                                                               
001238   6eef     MOVWF     0xef,0x0                                                                                        
00123a   0101     MOVLB     0x1                        pDst.bRam++;                                                         E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
00123c   2b34     INCF      0x34,0x1,0x1                                                                                    
00123e   0e00     MOVLW     0x0                                                                                             
001240   2335     ADDWFC    0x35,0x1,0x1                                                                                    
001242   2b32     INCF      0x32,0x1,0x1               pSrc.bRom++;                                                         E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
001244   2333     ADDWFC    0x33,0x1,0x1                                                                                    
001246   06df     DECF      0xdf,0x1,0x0               byte_to_send._word--;                                                E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
001248   0e01     MOVLW     0x1                                                                                             
00124a   e201     BC        0x124e                                                                                          
00124c   06db     DECF      0xdb,0x1,0x0                                                                                    
                                                   }//end while(byte_to_send._word)                                         E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                               }                                                                            E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
001250   d01c     BRA       0x128a             else // RAM                                                                  E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                               {                                                                            E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
001252   cfd9     MOVFF     0xfd9,0xfe9            while(byte_to_send._word)                                                E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
001254   ffe9                                                                                                               
001256   cfda     MOVFF     0xfda,0xfea                                                                                     
001258   ffea                                                                                                               
00125a   50ee     MOVF      0xee,0x0,0x0                                                                                    
00125c   10ed     IORWF     0xed,0x0,0x0                                                                                    
00125e   e015     BZ        0x128a                                                                                          
001288   d7e4     BRA       0x1252                                                                                          
                                                   {                                                                        E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
001260   c132     MOVFF     0x132,0xfe9                *pDst.bRam = *pSrc.bRam;                                             E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
001262   ffe9                                                                                                               
001264   c133     MOVFF     0x133,0xfea                                                                                     
001266   ffea                                                                                                               
001268   50ef     MOVF      0xef,0x0,0x0                                                                                    
00126a   c134     MOVFF     0x134,0xfe9                                                                                     
00126c   ffe9                                                                                                               
00126e   c135     MOVFF     0x135,0xfea                                                                                     
001270   ffea                                                                                                               
001272   6eef     MOVWF     0xef,0x0                                                                                        
001274   0101     MOVLB     0x1                        pDst.bRam++;                                                         E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
001276   2b34     INCF      0x34,0x1,0x1                                                                                    
001278   0e00     MOVLW     0x0                                                                                             
00127a   2335     ADDWFC    0x35,0x1,0x1                                                                                    
00127c   2b32     INCF      0x32,0x1,0x1               pSrc.bRam++;                                                         E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
00127e   2333     ADDWFC    0x33,0x1,0x1                                                                                    
001280   06df     DECF      0xdf,0x1,0x0               byte_to_send._word--;                                                E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
001282   0e01     MOVLW     0x1                                                                                             
001284   e201     BC        0x1288                                                                                          
001286   06db     DECF      0xdb,0x1,0x0                                                                                    
                                                   }//end while(byte_to_send._word)                                         E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                               }//end if(usb_stat.ctrl_trf_mem == _ROM)                                     E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                                                                                                            E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
00128a   6ef5     MOVWF     0xf5,0x0       }//end USBCtrlTrfTxService                                                       E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
00128c   0e02     MOVLW     0x2                                                                                             
00128e   5ce1     SUBWF     0xe1,0x0,0x0                                                                                    
001290   e202     BC        0x1296                                                                                          
001292   6ae1     CLRF      0xe1,0x0                                                                                        
001294   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001296   6ee1     MOVWF     0xe1,0x0                                                                                        
001298   50f5     MOVF      0xf5,0x0,0x0                                                                                    
00129a   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00129c   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
00129e   ffd9                                                                                                               
0012a0   0012     RETURN    0x0                                                                                             
                                                                                                                            E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                           /******************************************************************************  E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            * Function:        void USBCtrlTrfRxService(void)                               E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            * PreCondition:    pDst and wCount are setup properly.                          E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  pSrc is always &CtrlTrfData                                  E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  usb_stat.ctrl_trf_mem is always _RAM.                        E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  wCount should be set to 0 at the start of each control       E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  transfer.                                                    E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            * Input:           None                                                         E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            * Output:          None                                                         E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            * Side Effects:    None                                                         E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            * Overview:        *** This routine is only partially complete. Check for       E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  new version of the firmware.                                 E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            * Note:            None                                                         E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            *****************************************************************************/  E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
0012a2   cfd9     MOVFF     0xfd9,0xfe6    void USBCtrlTrfRxService(void)                                                   E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
0012a4   ffe6                                                                                                               
0012a6   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
0012a8   ffd9                                                                                                               
0012aa   0e02     MOVLW     0x2                                                                                             
0012ac   26e1     ADDWF     0xe1,0x1,0x0                                                                                    
                                           {                                                                                E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                               WORD byte_to_read;                                                           E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                                                                                                            E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
0012ae   0e03     MOVLW     0x3                MSB(byte_to_read) = 0x03 & ep0Bo.Stat._byte;    // Filter out last 2 bits    E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
0012b0   0104     MOVLB     0x4                                                                                             
0012b2   1500     ANDWF     0x0,0x0,0x1                                                                                     
0012b4   6ee7     MOVWF     0xe7,0x0                                                                                        
0012b6   0e01     MOVLW     0x1                                                                                             
0012b8   cfe7     MOVFF     0xfe7,0xfdb                                                                                     
0012ba   ffdb                                                                                                               
0012bc   c401     MOVFF     0x401,0xfdf        LSB(byte_to_read) = ep0Bo.Cnt;                                               E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
0012be   ffdf                                                                                                               
                                                                                                                            E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                               /*                                                                           E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                                * Accumulate total number of bytes read                                     E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                                */                                                                          E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
0012c0   50de     MOVF      0xde,0x0,0x0       wCount._word = wCount._word + byte_to_read._word;                            E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
0012c2   0101     MOVLB     0x1                                                                                             
0012c4   2736     ADDWF     0x36,0x1,0x1                                                                                    
0012c6   50dd     MOVF      0xdd,0x0,0x0                                                                                    
0012c8   2337     ADDWFC    0x37,0x1,0x1                                                                                    
                                                                                                                            E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
0012ca   0e28     MOVLW     0x28               pSrc.bRam = (byte*)&CtrlTrfData;                                             E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
0012cc   6f32     MOVWF     0x32,0x1                                                                                        
0012ce   0e04     MOVLW     0x4                                                                                             
0012d0   6f33     MOVWF     0x33,0x1                                                                                        
                                                                                                                            E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
0012d2   cfd9     MOVFF     0xfd9,0xfe9        while(byte_to_read._word)                                                    E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
0012d4   ffe9                                                                                                               
0012d6   cfda     MOVFF     0xfda,0xfea                                                                                     
0012d8   ffea                                                                                                               
0012da   50ee     MOVF      0xee,0x0,0x0                                                                                    
0012dc   10ed     IORWF     0xed,0x0,0x0                                                                                    
0012de   e014     BZ        0x1308                                                                                          
001306   d7e5     BRA       0x12d2                                                                                          
                                               {                                                                            E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
0012e0   c132     MOVFF     0x132,0xfe9            *pDst.bRam = *pSrc.bRam;                                                 E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
0012e2   ffe9                                                                                                               
0012e4   c133     MOVFF     0x133,0xfea                                                                                     
0012e6   ffea                                                                                                               
0012e8   50ef     MOVF      0xef,0x0,0x0                                                                                    
0012ea   c134     MOVFF     0x134,0xfe9                                                                                     
0012ec   ffe9                                                                                                               
0012ee   c135     MOVFF     0x135,0xfea                                                                                     
0012f0   ffea                                                                                                               
0012f2   6eef     MOVWF     0xef,0x0                                                                                        
0012f4   2b34     INCF      0x34,0x1,0x1           pDst.bRam++;                                                             E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
0012f6   0e00     MOVLW     0x0                                                                                             
0012f8   2335     ADDWFC    0x35,0x1,0x1                                                                                    
0012fa   2b32     INCF      0x32,0x1,0x1           pSrc.bRam++;                                                             E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
0012fc   2333     ADDWFC    0x33,0x1,0x1                                                                                    
0012fe   06df     DECF      0xdf,0x1,0x0           byte_to_read._word--;                                                    E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
001300   0e01     MOVLW     0x1                                                                                             
001302   e201     BC        0x1306                                                                                          
001304   06db     DECF      0xdb,0x1,0x0                                                                                    
                                               }//end while(byte_to_read._word)                                             E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                                                                                                            E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
001308   6ef5     MOVWF     0xf5,0x0       }//end USBCtrlTrfRxService                                                       E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
00130a   0e02     MOVLW     0x2                                                                                             
00130c   5ce1     SUBWF     0xe1,0x0,0x0                                                                                    
00130e   e202     BC        0x1314                                                                                          
001310   6ae1     CLRF      0xe1,0x0                                                                                        
001312   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001314   6ee1     MOVWF     0xe1,0x0                                                                                        
001316   50f5     MOVF      0xf5,0x0,0x0                                                                                    
001318   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00131a   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
00131c   ffd9                                                                                                               
00131e   0012     RETURN    0x0                                                                                             
                                                                                                                            E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                           /******************************************************************************  E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            * Function:        void USBCtrlEPServiceComplete(void)                          E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            * PreCondition:    None                                                         E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            * Input:           None                                                         E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            * Output:          None                                                         E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            * Side Effects:    None                                                         E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            * Overview:        This routine wrap up the ramaining tasks in servicing        E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  a Setup Request. Its main task is to set the endpoint        E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  controls appropriately for a given situation. See code       E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  below.                                                       E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  There are three main scenarios:                              E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  a) There was no handler for the Request, in this case        E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            *                     a STALL should be sent out.                               E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  b) The host has requested a read control transfer,           E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            *                     endpoints are required to be setup in a specific way.     E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  c) The host has requested a write control transfer, or       E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            *                     a control data stage is not required, endpoints are       E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            *                     required to be setup in a specific way.                   E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  Packet processing is resumed by clearing PKTDIS bit.         E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            * Note:            None                                                         E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            *****************************************************************************/  E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                           void USBCtrlEPServiceComplete(void)                                              E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                           {                                                                                E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
001320   0101     MOVLB     0x1                if(ctrl_trf_session_owner == MUID_NULL)                                      E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
001322   5131     MOVF      0x31,0x0,0x1                                                                                    
001324   e10c     BNZ       0x133e                                                                                          
                                               {                                                                            E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                                   /*                                                                       E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                                    * If no one knows how to service this request then stall.               E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                                    * Must also prepare EP0 to receive the next SETUP transaction.          E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                                    */                                                                      E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
001326   0104     MOVLB     0x4                    ep0Bo.Cnt = EP0_BUFF_SIZE;                                               E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
001328   0e08     MOVLW     0x8                                                                                             
00132a   6f01     MOVWF     0x1,0x1                                                                                         
00132c   0e20     MOVLW     0x20                   ep0Bo.ADR = (byte*)&SetupPkt;                                            E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
00132e   6f02     MOVWF     0x2,0x1                                                                                         
001330   0e04     MOVLW     0x4                                                                                             
001332   6f03     MOVWF     0x3,0x1                                                                                         
                                                                                                                            E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
001334   0e84     MOVLW     0x84                   ep0Bo.Stat._byte = _USIE|_BSTALL;                                        E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
001336   6f00     MOVWF     0x0,0x1                                                                                         
001338   0104     MOVLB     0x4                    ep0Bi.Stat._byte = _USIE|_BSTALL;                                        E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
00133a   6f04     MOVWF     0x4,0x1                                                                                         
                                               }                                                                            E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
00133c   d035     BRA       0x13a8             else    // A module has claimed ownership of the control transfer session.   E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                               {                                                                            E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
00133e   0104     MOVLB     0x4                    if(SetupPkt.DataDir == DEV_TO_HOST)                                      E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
001340   af20     BTFSS     0x20,0x7,0x1                                                                                    
001342   d022     BRA       0x1388                                                                                          
                                                   {                                                                        E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
001344   0101     MOVLB     0x1                        if(SetupPkt.wLength < wCount._word)                                  E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
001346   5136     MOVF      0x36,0x0,0x1                                                                                    
001348   0104     MOVLB     0x4                                                                                             
00134a   5d26     SUBWF     0x26,0x0,0x1                                                                                    
00134c   0101     MOVLB     0x1                                                                                             
00134e   5137     MOVF      0x37,0x0,0x1                                                                                    
001350   0104     MOVLB     0x4                                                                                             
001352   5927     SUBWFB    0x27,0x0,0x1                                                                                    
001354   e204     BC        0x135e                                                                                          
001356   c426     MOVFF     0x426,0x136                    wCount._word = SetupPkt.wLength;                                 E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
001358   f136                                                                                                               
00135a   c427     MOVFF     0x427,0x137                                                                                     
00135c   f137                                                                                                               
00135e   df31     RCALL     0x11c2                     USBCtrlTrfTxService();                                               E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
001360   0101     MOVLB     0x1                        ctrl_trf_state = CTRL_TRF_TX;                                        E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
001362   0e01     MOVLW     0x1                                                                                             
001364   6f30     MOVWF     0x30,0x1                                                                                        
                                                       /*                                                                   E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                                        * Control Read:                                                     E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                                        * <SETUP[0]><IN[1]><IN[0]>...<OUT[1]> | <SETUP[0]>                  E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                                        * 1. Prepare OUT EP to respond to early termination                 E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                                        *                                                                   E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                                        * NOTE:                                                             E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                                        * If something went wrong during the control transfer,              E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                                        * the last status stage may not be sent by the host.                E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                                        * When this happens, two different things could happen              E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                                        * depending on the host.                                            E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                                        * a) The host could send out a RESET.                               E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                                        * b) The host could send out a new SETUP transaction                E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                                        *    without sending a RESET first.                                 E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                                        * To properly handle case (b), the OUT EP must be setup             E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                                        * to receive either a zero length OUT transaction, or a             E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                                        * new SETUP transaction.                                            E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                                        *                                                                   E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                                        * Since the SETUP transaction requires the DTS bit to be            E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                                        * DAT0 while the zero length OUT status requires the DTS            E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                                        * bit to be DAT1, the DTS bit check by the hardware should          E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                                        * be disabled. This way the SIE could accept either of              E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                                        * the two transactions.                                             E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                                        *                                                                   E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                                        * Furthermore, the Cnt byte should be set to prepare for            E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                                        * the SETUP data (8-byte or more), and the buffer address           E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                                        * should be pointed to SetupPkt.                                    E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                                        */                                                                  E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
001366   0104     MOVLB     0x4                        ep0Bo.Cnt = EP0_BUFF_SIZE;                                           E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
001368   0e08     MOVLW     0x8                                                                                             
00136a   6f01     MOVWF     0x1,0x1                                                                                         
00136c   0e20     MOVLW     0x20                       ep0Bo.ADR = (byte*)&SetupPkt;                                        E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
00136e   6f02     MOVWF     0x2,0x1                                                                                         
001370   0e04     MOVLW     0x4                                                                                             
001372   6f03     MOVWF     0x3,0x1                                                                                         
001374   0e80     MOVLW     0x80                       ep0Bo.Stat._byte = _USIE;           // Note: DTSEN is 0!             E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
001376   6f00     MOVWF     0x0,0x1                                                                                         
                                                                                                                            E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                                       /*                                                                   E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                                        * 2. Prepare IN EP to transfer data, Cnt should have                E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                                        *    been initialized by responsible request owner.                 E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                                        */                                                                  E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
001378   0104     MOVLB     0x4                        ep0Bi.ADR = (byte*)&CtrlTrfData;                                     E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
00137a   0e28     MOVLW     0x28                                                                                            
00137c   6f06     MOVWF     0x6,0x1                                                                                         
00137e   0e04     MOVLW     0x4                                                                                             
001380   6f07     MOVWF     0x7,0x1                                                                                         
001382   0ec8     MOVLW     0xc8                       ep0Bi.Stat._byte = _USIE|_DAT1|_DTSEN;                               E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
001384   6f04     MOVWF     0x4,0x1                                                                                         
                                                   }                                                                        E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
001386   d010     BRA       0x13a8                 else    // (SetupPkt.DataDir == HOST_TO_DEV)                             E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                                   {                                                                        E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
001388   0101     MOVLB     0x1                        ctrl_trf_state = CTRL_TRF_RX;                                        E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
00138a   0e02     MOVLW     0x2                                                                                             
00138c   6f30     MOVWF     0x30,0x1                                                                                        
                                                       /*                                                                   E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                                        * Control Write:                                                    E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                                        * <SETUP[0]><OUT[1]><OUT[0]>...<IN[1]> | <SETUP[0]>                 E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                                        *                                                                   E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                                        * 1. Prepare IN EP to respond to early termination                  E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                                        *                                                                   E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                                        *    This is the same as a Zero Length Packet Response              E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                                        *    for control transfer without a data stage                      E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                                        */                                                                  E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
00138e   0104     MOVLB     0x4                        ep0Bi.Cnt = 0;                                                       E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
001390   6b05     CLRF      0x5,0x1                                                                                         
001392   0ec8     MOVLW     0xc8                       ep0Bi.Stat._byte = _USIE|_DAT1|_DTSEN;                               E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
001394   6f04     MOVWF     0x4,0x1                                                                                         
                                                                                                                            E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                                       /*                                                                   E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                                        * 2. Prepare OUT EP to receive data.                                E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                                        */                                                                  E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
001396   0104     MOVLB     0x4                        ep0Bo.Cnt = EP0_BUFF_SIZE;                                           E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
001398   0e08     MOVLW     0x8                                                                                             
00139a   6f01     MOVWF     0x1,0x1                                                                                         
00139c   0e28     MOVLW     0x28                       ep0Bo.ADR = (byte*)&CtrlTrfData;                                     E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
00139e   6f02     MOVWF     0x2,0x1                                                                                         
0013a0   0e04     MOVLW     0x4                                                                                             
0013a2   6f03     MOVWF     0x3,0x1                                                                                         
0013a4   0ec8     MOVLW     0xc8                       ep0Bo.Stat._byte = _USIE|_DAT1|_DTSEN;                               E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
0013a6   6f00     MOVWF     0x0,0x1                                                                                         
                                                   }//end if(SetupPkt.DataDir == DEV_TO_HOST)                               E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                               }//end if(ctrl_trf_session_owner == MUID_NULL)                               E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                                                                                                            E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                               /*                                                                           E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                                * PKTDIS bit is set when a Setup Transaction is received.                   E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                                * Clear to resume packet processing.                                        E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                                */                                                                          E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
0013a8   986d     BCF       0x6d,0x4,0x0       UCONbits.PKTDIS = 0;                                                         E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                                                                                                            E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
0013aa   0012     RETURN    0x0            }//end USBCtrlEPServiceComplete                                                  E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                                                                                                            E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                           /******************************************************************************  E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            * Function:        void USBPrepareForNextSetupTrf(void)                         E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            * PreCondition:    None                                                         E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            * Input:           None                                                         E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            * Output:          None                                                         E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            * Side Effects:    None                                                         E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            * Overview:        The routine forces EP0 OUT to be ready for a new Setup       E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  transaction, and forces EP0 IN to be owned by CPU.           E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            * Note:            None                                                         E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                            *****************************************************************************/  E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                           void USBPrepareForNextSetupTrf(void)                                             E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                           {                                                                                E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
0013ac   0101     MOVLB     0x1                ctrl_trf_state = WAIT_SETUP;            // See usbctrltrf.h                  E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
0013ae   6b30     CLRF      0x30,0x1                                                                                        
0013b0   0104     MOVLB     0x4                ep0Bo.Cnt = EP0_BUFF_SIZE;              // Defined in usbcfg.h               E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
0013b2   0e08     MOVLW     0x8                                                                                             
0013b4   6f01     MOVWF     0x1,0x1                                                                                         
0013b6   0e20     MOVLW     0x20               ep0Bo.ADR = (byte*)&SetupPkt;                                                E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
0013b8   6f02     MOVWF     0x2,0x1                                                                                         
0013ba   0e04     MOVLW     0x4                                                                                             
0013bc   6f03     MOVWF     0x3,0x1                                                                                         
0013be   0e88     MOVLW     0x88               ep0Bo.Stat._byte = _USIE|_DAT0|_DTSEN;  // EP0 buff dsc init, see usbmmap.h  E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
0013c0   6f00     MOVWF     0x0,0x1                                                                                         
0013c2   0104     MOVLB     0x4                ep0Bi.Stat._byte = _UCPU;               // EP0 IN buffer initialization      E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
0013c4   6b04     CLRF      0x4,0x1                                                                                         
0013c6   0012     RETURN    0x0            }//end USBPrepareForNextSetupTrf                                                 E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                                                                                                            E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                           /** EOF usbctrltrf.c *********************************************************/  E:\usb20\lighting2\system\usb\usbctrltrf\usbctrltrf.c
                                           /*********************************************************************           E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                Microchip USB C18 Firmware Version 1.0                         E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *********************************************************************           E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            * FileName:        usbdrv.c                                                     E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            * Dependencies:    See INCLUDES section below                                   E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            * Processor:       PIC18                                                        E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            * Compiler:        C18 2.30.01+                                                 E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            * Company:         Microchip Technology, Inc.                                   E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            * Software License Agreement                                                    E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            * The software supplied herewith by Microchip Technology Incorporated           E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            * (the 鼎ompany・ for its PICmicroｮ Microcontroller is intended and             E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            * supplied to you, the Company痴 customer, for use solely and                   E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            * exclusively on Microchip PICmicro Microcontroller products. The               E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            * software is owned by the Company and/or its supplier, and is                  E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            * protected under applicable copyright laws. All rights are reserved.           E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            * Any use in violation of the foregoing restrictions may subject the            E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            * user to criminal sanctions under applicable laws, as well as to               E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            * civil liability for the breach of the terms and conditions of this            E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            * license.                                                                      E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            * THIS SOFTWARE IS PROVIDED IN AN 鄭S IS・CONDITION. NO WARRANTIES,             E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            * WHETHER EXPRESS, IMPLIED OR STATUTORY, INCLUDING, BUT NOT LIMITED             E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            * TO, IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A                   E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            * PARTICULAR PURPOSE APPLY TO THIS SOFTWARE. THE COMPANY SHALL NOT,             E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            * IN ANY CIRCUMSTANCES, BE LIABLE FOR SPECIAL, INCIDENTAL OR                    E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            * CONSEQUENTIAL DAMAGES, FOR ANY REASON WHATSOEVER.                             E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            * Author               Date        Comment                                      E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~           E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            * Rawin Rojvanit       11/19/04    Original.                                    E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            ********************************************************************/           E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                           /** I N C L U D E S **********************************************************/  E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                           #include <p18cxxx.h>                                                             E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                           #include "system\typedefs.h"                                                     E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                           #include "system\usb\usb.h"                                                      E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                           #include "io_cfg.h"             // Required for USBCheckBusStatus()              E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                           /** V A R I A B L E S ********************************************************/  E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                           #pragma udata                                                                    E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                           /** P R I V A T E  P R O T O T Y P E S ***************************************/  E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                           void USBModuleEnable(void);                                                      E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                           void USBModuleDisable(void);                                                     E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                           void USBSuspend(void);                                                           E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                           void USBWakeFromSuspend(void);                                                   E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                           void USBProtocolResetHandler(void);                                              E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                           void USB_SOF_Handler(void);                                                      E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                           void USBStallHandler(void);                                                      E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                           void USBErrorHandler(void);                                                      E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                           /** D E C L A R A T I O N S **************************************************/  E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                           #pragma code                                                                     E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                           /******************************************************************************  E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            * Function:        void USBCheckBusStatus(void)                                 E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            * PreCondition:    None                                                         E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            * Input:           None                                                         E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            * Output:          None                                                         E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            * Side Effects:    None                                                         E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            * Overview:        This routine enables/disables the USB module by monitoring   E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                  the USB power signal.                                        E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            * Note:            None                                                         E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *****************************************************************************/  E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                           void USBCheckBusStatus(void)                                                     E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                           {                                                                                E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                               /**************************************************************************  E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                                * Bus Attachment & Detachment Detection                                     E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                                * usb_bus_sense is an i/o pin defined in io_cfg.h                           E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                                *************************************************************************/  E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                               #define USB_BUS_ATTACHED    1                                                E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                               #define USB_BUS_DETACHED    0                                                E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                               if(usb_bus_sense == USB_BUS_ATTACHED)       // Is USB bus attached?          E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                               {                                                                            E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
0013c8   a66d     BTFSS     0x6d,0x3,0x0           if(UCONbits.USBEN == 0)                 // Is the module off?            E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
0013ca   d80f     RCALL     0x13ea                     USBModuleEnable();                  // Is off, enable it             E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                               }                                                                            E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
0013cc   d002     BRA       0x13d2             else                                                                         E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                               {                                                                            E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
0013ce   b66d     BTFSC     0x6d,0x3,0x0           if(UCONbits.USBEN == 1)                 // Is the module on?             E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
0013d0   d813     RCALL     0x13f8                     USBModuleDisable();                 // Is on, disable it             E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                               }//end if(usb_bus_sense...)                                                  E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                               /*                                                                           E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                                * After enabling the USB module, it takes some time for the voltage         E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                                * on the D+ or D- line to rise high enough to get out of the SE0 condition. E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                                * The USB Reset interrupt should not be unmasked until the SE0 condition is E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                                * cleared. This helps preventing the firmware from misinterpreting this     E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                                * unique event as a USB bus reset from the USB host.                        E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                                */                                                                          E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
0013d2   0100     MOVLB     0x0                if(usb_device_state == ATTACHED_STATE)                                       E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
0013d4   05fc     DECF      0xfc,0x0,0x1                                                                                    
0013d6   e108     BNZ       0x13e8                                                                                          
                                               {                                                                            E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
0013d8   ba6d     BTFSC     0x6d,0x5,0x0           if(!UCONbits.SE0)                                                        E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
0013da   d006     BRA       0x13e8                                                                                          
                                                   {                                                                        E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
0013dc   6a68     CLRF      0x68,0x0                   UIR = 0;                        // Clear all USB interrupts          E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
0013de   6a69     CLRF      0x69,0x0                   UIE = 0;                        // Mask all USB interrupts           E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
0013e0   8069     BSF       0x69,0x0,0x0               UIEbits.URSTIE = 1;             // Unmask RESET interrupt            E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
0013e2   8869     BSF       0x69,0x4,0x0               UIEbits.IDLEIE = 1;             // Unmask IDLE interrupt             E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
0013e4   0e02     MOVLW     0x2                        usb_device_state = POWERED_STATE;                                    E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
0013e6   6ffc     MOVWF     0xfc,0x1                                                                                        
                                                   }//end if                           // else wait until SE0 is cleared    E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                               }//end if(usb_device_state == ATTACHED_STATE)                                E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
0013e8   0012     RETURN    0x0            }//end USBCheckBusStatus                                                         E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                           /******************************************************************************  E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            * Function:        void USBModuleEnable(void)                                   E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            * PreCondition:    None                                                         E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            * Input:           None                                                         E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            * Output:          None                                                         E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            * Side Effects:    None                                                         E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            * Overview:        This routine enables the USB module.                         E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                  An end designer should never have to call this routine       E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                  manually. This routine should only be called from            E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                  USBCheckBusStatus().                                         E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            * Note:            See USBCheckBusStatus() for more information.                E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *****************************************************************************/  E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                           void USBModuleEnable(void)                                                       E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                           {                                                                                E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
0013ea   6a6d     CLRF      0x6d,0x0           UCON = 0;                                                                    E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
0013ec   6a69     CLRF      0x69,0x0           UIE = 0;                                // Mask all USB interrupts           E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
0013ee   866d     BSF       0x6d,0x3,0x0       UCONbits.USBEN = 1;                     // Enable module & attach to bus     E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
0013f0   0100     MOVLB     0x0                usb_device_state = ATTACHED_STATE;      // Defined in usbmmap.c & .h         E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
0013f2   0e01     MOVLW     0x1                                                                                             
0013f4   6ffc     MOVWF     0xfc,0x1                                                                                        
0013f6   0012     RETURN    0x0            }//end USBModuleEnable                                                           E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                           /******************************************************************************  E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            * Function:        void USBModuleDisable(void)                                  E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            * PreCondition:    None                                                         E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            * Input:           None                                                         E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            * Output:          None                                                         E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            * Side Effects:    None                                                         E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            * Overview:        This routine disables the USB module.                        E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                  An end designer should never have to call this routine       E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                  manually. This routine should only be called from            E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                  USBCheckBusStatus().                                         E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            * Note:            See USBCheckBusStatus() for more information.                E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *****************************************************************************/  E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                           void USBModuleDisable(void)                                                      E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                           {                                                                                E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
0013f8   6a6d     CLRF      0x6d,0x0           UCON = 0;                               // Disable module & detach from bus  E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
0013fa   6a69     CLRF      0x69,0x0           UIE = 0;                                // Mask all USB interrupts           E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
0013fc   0100     MOVLB     0x0                usb_device_state = DETACHED_STATE;      // Defined in usbmmap.c & .h         E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
0013fe   6bfc     CLRF      0xfc,0x1                                                                                        
001400   0012     RETURN    0x0            }//end USBModuleDisable                                                          E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                           /******************************************************************************  E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            * Function:        void USBSoftDetach(void)                                     E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            * PreCondition:    None                                                         E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            * Input:           None                                                         E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            * Output:          None                                                         E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            * Side Effects:    The device will have to be re-enumerated to function again.  E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            * Overview:        USBSoftDetach electrically disconnects the device from       E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                  the bus. This is done by stop supplying Vusb voltage to      E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                  pull-up resistor. The pull-down resistors on the host        E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                  side will pull both differential signal lines low and        E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                  the host registers the event as a disconnect.                E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                  Since the USB cable is not physically disconnected, the      E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                  power supply through the cable can still be sensed by        E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                  the device. The next time USBCheckBusStatus() function       E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                  is called, it will reconnect the device back to the bus.     E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            * Note:            None                                                         E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *****************************************************************************/  E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                           void USBSoftDetach(void)                                                         E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                           {                                                                                E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
001402   effc     GOTO      0x13f8             USBModuleDisable();                                                          E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
001404   f009                                                                                                               
                                           }//end USBSoftDetach                                                             E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                           /******************************************************************************  E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            * Function:        void USBDriverService(void)                                  E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            * PreCondition:    None                                                         E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            * Input:           None                                                         E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            * Output:          None                                                         E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            * Side Effects:    None                                                         E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            * Overview:        This routine is the heart of this firmware. It manages       E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                  all USB interrupts.                                          E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            * Note:            Device state transitions through the following stages:       E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                  DETACHED -> ATTACHED -> POWERED -> DEFAULT ->                E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                  ADDRESS_PENDING -> ADDRESSED -> CONFIGURED -> READY          E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *****************************************************************************/  E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                           void USBDriverService(void)                                                      E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                           {                                                                                E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                               /*                                                                           E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                                * Pointless to continue servicing if USB cable is not even attached.        E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                                */                                                                          E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
001406   0100     MOVLB     0x0                if(usb_device_state == DETACHED_STATE) return;                               E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
001408   51fc     MOVF      0xfc,0x0,0x1                                                                                    
00140a   e101     BNZ       0x140e                                                                                          
00140c   d03a     BRA       0x1482                                                                                          
                                                                                                                            E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                               /*                                                                           E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                                * Task A: Service USB Activity Interrupt                                    E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                                */                                                                          E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
00140e   5068     MOVF      0x68,0x0,0x0       if(UIRbits.ACTVIF && UIEbits.ACTVIE)    USBWakeFromSuspend();                E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
001410   0b04     ANDLW     0x4                                                                                             
001412   e004     BZ        0x141c                                                                                          
001414   5069     MOVF      0x69,0x0,0x0                                                                                    
001416   0b04     ANDLW     0x4                                                                                             
001418   e001     BZ        0x141c                                                                                          
00141a   d838     RCALL     0x148c                                                                                          
                                                                                                                            E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                               /*                                                                           E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                                * Pointless to continue servicing if the device is in suspend mode.         E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                                */                                                                          E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
00141c   b26d     BTFSC     0x6d,0x1,0x0       if(UCONbits.SUSPND==1) return;                                               E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
00141e   d031     BRA       0x1482                                                                                          
                                                                                                                            E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                               /*                                                                           E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                                * Task B: Service USB Bus Reset Interrupt.                                  E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                                * When bus reset is received during suspend, ACTVIF will be set first,      E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                                * once the UCONbits.SUSPND is clear, then the URSTIF bit will be asserted.  E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                                * This is why URSTIF is checked after ACTVIF.                               E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                                */                                                                          E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
001420   5068     MOVF      0x68,0x0,0x0       if(UIRbits.URSTIF && UIEbits.URSTIE)    USBProtocolResetHandler();           E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
001422   0b01     ANDLW     0x1                                                                                             
001424   e004     BZ        0x142e                                                                                          
001426   5069     MOVF      0x69,0x0,0x0                                                                                    
001428   0b01     ANDLW     0x1                                                                                             
00142a   e001     BZ        0x142e                                                                                          
00142c   d850     RCALL     0x14ce                                                                                          
                                                                                                                            E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                               /*                                                                           E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                                * Task C: Service other USB interrupts                                      E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                                */                                                                          E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
00142e   5068     MOVF      0x68,0x0,0x0       if(UIRbits.IDLEIF && UIEbits.IDLEIE)    USBSuspend();                        E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
001430   0b10     ANDLW     0x10                                                                                            
001432   e004     BZ        0x143c                                                                                          
001434   5069     MOVF      0x69,0x0,0x0                                                                                    
001436   0b10     ANDLW     0x10                                                                                            
001438   e001     BZ        0x143c                                                                                          
00143a   d824     RCALL     0x1484                                                                                          
00143c   5068     MOVF      0x68,0x0,0x0       if(UIRbits.SOFIF && UIEbits.SOFIE)      USB_SOF_Handler();                   E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
00143e   0b40     ANDLW     0x40                                                                                            
001440   e004     BZ        0x144a                                                                                          
001442   5069     MOVF      0x69,0x0,0x0                                                                                    
001444   0b40     ANDLW     0x40                                                                                            
001446   e001     BZ        0x144a                                                                                          
001448   d837     RCALL     0x14b8                                                                                          
00144a   5068     MOVF      0x68,0x0,0x0       if(UIRbits.STALLIF && UIEbits.STALLIE)  USBStallHandler();                   E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
00144c   0b20     ANDLW     0x20                                                                                            
00144e   e004     BZ        0x1458                                                                                          
001450   5069     MOVF      0x69,0x0,0x0                                                                                    
001452   0b20     ANDLW     0x20                                                                                            
001454   e001     BZ        0x1458                                                                                          
001456   d832     RCALL     0x14bc                                                                                          
001458   5068     MOVF      0x68,0x0,0x0       if(UIRbits.UERRIF && UIEbits.UERRIE)    USBErrorHandler();                   E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
00145a   0b02     ANDLW     0x2                                                                                             
00145c   e004     BZ        0x1466                                                                                          
00145e   5069     MOVF      0x69,0x0,0x0                                                                                    
001460   0b02     ANDLW     0x2                                                                                             
001462   e001     BZ        0x1466                                                                                          
001464   d832     RCALL     0x14ca                                                                                          
                                                                                                                            E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                               /*                                                                           E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                                * Pointless to continue servicing if the host has not sent a bus reset.     E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                                * Once bus reset is received, the device transitions into the DEFAULT       E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                                * state and is ready for communication.                                     E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                                */                                                                          E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
001466   0e03     MOVLW     0x3                if(usb_device_state < DEFAULT_STATE) return;                                 E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
001468   0100     MOVLB     0x0                                                                                             
00146a   5dfc     SUBWF     0xfc,0x0,0x1                                                                                    
00146c   e201     BC        0x1470                                                                                          
00146e   d009     BRA       0x1482                                                                                          
                                                                                                                            E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                               /*                                                                           E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                                * Task D: Servicing USB Transaction Complete Interrupt                      E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                                */                                                                          E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
001470   5068     MOVF      0x68,0x0,0x0       if(UIRbits.TRNIF && UIEbits.TRNIE)                                           E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
001472   0b08     ANDLW     0x8                                                                                             
001474   e006     BZ        0x1482                                                                                          
001476   5069     MOVF      0x69,0x0,0x0                                                                                    
001478   0b08     ANDLW     0x8                                                                                             
00147a   e003     BZ        0x1482                                                                                          
                                               {                                                                            E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                                   /*                                                                       E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                                    * USBCtrlEPService only services transactions over EP0.                 E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                                    * It ignores all other EP transactions.                                 E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                                    */                                                                      E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
00147c   ec63     CALL      0x10c6,0x0             USBCtrlEPService();                                                      E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
00147e   f008                                                                                                               
                                                                                                                            E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                                   /*                                                                       E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                                    * Other EP can be serviced later by responsible device class firmware.  E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                                    * Each device driver knows when an OUT or IN transaction is ready by    E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                                    * checking the buffer ownership bit.                                    E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                                    * An OUT EP should always be owned by SIE until the data is ready.      E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                                    * An IN EP should always be owned by CPU until the data is ready.       E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                                    *                                                                       E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                                    * Because of this logic, it is not necessary to save the USTAT value    E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                                    * of non-EP0 transactions.                                              E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                                    */                                                                      E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
001480   9668     BCF       0x68,0x3,0x0           UIRbits.TRNIF = 0;                                                       E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                               }//end if(UIRbits.TRNIF && UIEbits.TRNIE)                                    E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
001482   0012     RETURN    0x0            }//end USBDriverService                                                          E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                           /******************************************************************************  E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            * Function:        void USBSuspend(void)                                        E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            * PreCondition:    None                                                         E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            * Input:           None                                                         E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            * Output:          None                                                         E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            * Side Effects:    None                                                         E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            * Overview:                                                                     E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            * Note:            None                                                         E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *****************************************************************************/  E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                           void USBSuspend(void)                                                            E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                           {                                                                                E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                               /*                                                                           E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                                * NOTE: Do not clear UIRbits.ACTVIF here!                                   E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                                * Reason:                                                                   E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                                * ACTVIF is only generated once an IDLEIF has been generated.               E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                                * This is a 1:1 ratio interrupt generation.                                 E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                                * For every IDLEIF, there will be only one ACTVIF regardless of             E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                                * the number of subsequent bus transitions.                                 E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                                *                                                                           E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                                * If the ACTIF is cleared here, a problem could occur when:                 E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                                * [       IDLE       ][bus activity ->                                      E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                                * <--- 3 ms ----->     ^                                                    E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                                *                ^     ACTVIF=1                                             E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                                *                IDLEIF=1                                                   E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                                *  #           #           #           #   (#=Program polling flags)        E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                                *                          ^                                                E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                                *                          This polling loop will see both                  E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                                *                          IDLEIF=1 and ACTVIF=1.                           E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                                *                          However, the program services IDLEIF first       E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                                *                          because ACTIVIE=0.                               E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                                *                          If this routine clears the only ACTIVIF,         E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                                *                          then it can never get out of the suspend         E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                                *                          mode.                                            E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                                */                                                                          E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
001484   8469     BSF       0x69,0x2,0x0       UIEbits.ACTVIE = 1;                     // Enable bus activity interrupt     E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
001486   9868     BCF       0x68,0x4,0x0       UIRbits.IDLEIF = 0;                                                          E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
001488   826d     BSF       0x6d,0x1,0x0       UCONbits.SUSPND = 1;                    // Put USB module in power conserve  E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                                                                       // mode, SIE clock inactive          E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                               /*                                                                           E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                                * At this point the PIC can go into sleep,idle, or                          E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                                * switch to a slower clock, etc.                                            E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                                */                                                                          E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                               /* Modifiable Section */                                                     E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                               /* End Modifiable Section */                                                 E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
00148a   0012     RETURN    0x0            }//end USBSuspend                                                                E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                           /******************************************************************************  E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            * Function:        void USBWakeFromSuspend(void)                                E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            * PreCondition:    None                                                         E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            * Input:           None                                                         E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            * Output:          None                                                         E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            * Side Effects:    None                                                         E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            * Overview:                                                                     E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            * Note:            None                                                         E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *****************************************************************************/  E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                           void USBWakeFromSuspend(void)                                                    E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                           {                                                                                E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                               /*                                                                           E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                                * If using clock switching, this is the place to restore the                E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                                * original clock frequency.                                                 E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                                */                                                                          E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
00148c   926d     BCF       0x6d,0x1,0x0       UCONbits.SUSPND = 0;                                                         E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
00148e   9469     BCF       0x69,0x2,0x0       UIEbits.ACTVIE = 0;                                                          E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
001490   9468     BCF       0x68,0x2,0x0       UIRbits.ACTVIF = 0;                                                          E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
001492   0012     RETURN    0x0            }//end USBWakeFromSuspend                                                        E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                           /******************************************************************************  E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            * Function:        void USBRemoteWakeup(void)                                   E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            * PreCondition:    None                                                         E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            * Input:           None                                                         E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            * Output:          None                                                         E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            * Side Effects:    None                                                         E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            * Overview:        This function should be called by user when the device       E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                  is waken up by an external stimulus other than ACTIVIF.      E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                  Please read the note below to understand the limitations.    E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            * Note:            The modifiable section in this routine should be changed     E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                  to meet the application needs. Current implementation        E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                  temporary blocks other functions from executing for a        E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                  period of 1-13 ms depending on the core frequency.           E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                  According to USB 2.0 specification section 7.1.7.7,          E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                  "The remote wakeup device must hold the resume signaling     E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                  for at lest 1 ms but for no more than 15 ms."                E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                  The idea here is to use a delay counter loop, using a        E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                  common value that would work over a wide range of core       E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                  frequencies.                                                 E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                  That value selected is 1800. See table below:                E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                  ==========================================================   E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                  Core Freq(MHz)      MIP         RESUME Signal Period (ms)    E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                  ==========================================================   E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                      48              12          1.05                         E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                       4              1           12.6                         E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                  ==========================================================   E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                  * These timing could be incorrect when using code            E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                    optimization or extended instruction mode,                 E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                    or when having other interrupts enabled.                   E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                    Make sure to verify using the MPLAB SIM's Stopwatch        E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *****************************************************************************/  E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                           void USBRemoteWakeup(void)                                                       E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                           {                                                                                E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                               static word delay_count;                                                     E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
001494   0100     MOVLB     0x0                if(usb_stat.RemoteWakeup == 1)          // Check if RemoteWakeup function    E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
001496   a1fd     BTFSS     0xfd,0x0,0x1                                                                                    
001498   d00e     BRA       0x14b6                                                                                          
                                               {                                       // has been enabled by the host.     E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
00149a   dff8     RCALL     0x148c                 USBWakeFromSuspend();               // Unsuspend USB modue               E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
00149c   846d     BSF       0x6d,0x2,0x0           UCONbits.RESUME = 1;                // Start RESUME signaling            E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                                   /* Modifiable Section */                                                 E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
00149e   0101     MOVLB     0x1                    delay_count = 1800U;                // Set RESUME line for 1-13 ms       E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
0014a0   0e08     MOVLW     0x8                                                                                             
0014a2   6f3a     MOVWF     0x3a,0x1                                                                                        
0014a4   0e07     MOVLW     0x7                                                                                             
0014a6   6f3b     MOVWF     0x3b,0x1                                                                                        
                                                   do                                                                       E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                                   {                                                                        E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
0014a8   073a     DECF      0x3a,0x1,0x1               delay_count--;                                                       E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
0014aa   0e00     MOVLW     0x0                                                                                             
0014ac   5b3b     SUBWFB    0x3b,0x1,0x1                                                                                    
0014ae   513a     MOVF      0x3a,0x0,0x1           }while(delay_count);                                                     E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
0014b0   113b     IORWF     0x3b,0x0,0x1                                                                                    
0014b2   e1fa     BNZ       0x14a8                                                                                          
                                                                                                                            E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                                   /* End Modifiable Section */                                             E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
0014b4   946d     BCF       0x6d,0x2,0x0           UCONbits.RESUME = 0;                                                     E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                               }//endif                                                                     E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
0014b6   0012     RETURN    0x0            }//end USBRemoteWakeup                                                           E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                           /******************************************************************************  E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            * Function:        void USB_SOF_Handler(void)                                   E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            * PreCondition:    None                                                         E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            * Input:           None                                                         E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            * Output:          None                                                         E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            * Side Effects:    None                                                         E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            * Overview:        The USB host sends out a SOF packet to full-speed devices    E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                  every 1 ms. This interrupt may be useful for isochronous     E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                  pipes. End designers should implement callback routine       E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                  as necessary.                                                E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            * Note:            None                                                         E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *****************************************************************************/  E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                           void USB_SOF_Handler(void)                                                       E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                           {                                                                                E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                               /* Callback routine here */                                                  E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
0014b8   9c68     BCF       0x68,0x6,0x0       UIRbits.SOFIF = 0;                                                           E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
0014ba   0012     RETURN    0x0            }//end USB_SOF_Handler                                                           E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                           /******************************************************************************  E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            * Function:        void USBStallHandler(void)                                   E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            * PreCondition:    A STALL packet is sent to the host by the SIE.               E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            * Input:           None                                                         E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            * Output:          None                                                         E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            * Side Effects:    None                                                         E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            * Overview:        The STALLIF is set anytime the SIE sends out a STALL         E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                  packet regardless of which endpoint causes it.               E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                  A Setup transaction overrides the STALL function. A stalled  E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                  endpoint stops stalling once it receives a setup packet.     E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                  In this case, the SIE will accepts the Setup packet and      E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                  set the TRNIF flag to notify the firmware. STALL function    E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                  for that particular endpoint pipe will be automatically      E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                  disabled (direction specific).                               E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                  There are a few reasons for an endpoint to be stalled.       E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                  1. When a non-supported USB request is received.             E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                     Example: GET_DESCRIPTOR(DEVICE_QUALIFIER)                 E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                  2. When an endpoint is currently halted.                     E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                  3. When the device class specifies that an endpoint must     E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                     stall in response to a specific event.                    E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                     Example: Mass Storage Device Class                        E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                              If the CBW is not valid, the device shall        E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                              STALL the Bulk-In pipe.                          E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                              See USB Mass Storage Class Bulk-only Transport   E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                              Specification for more details.                  E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            * Note:            UEPn.EPSTALL can be scanned to see which endpoint causes     E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                  the stall event.                                             E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                  If                                                           E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *****************************************************************************/  E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                           void USBStallHandler(void)                                                       E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                           {                                                                                E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                               /*                                                                           E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                                * Does not really have to do anything here,                                 E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                                * even for the control endpoint.                                            E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                                * All BDs of Endpoint 0 are owned by SIE right now,                         E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                                * but once a Setup Transaction is received, the ownership                   E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                                * for EP0_OUT will be returned to CPU.                                      E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                                * When the Setup Transaction is serviced, the ownership                     E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                                * for EP0_IN will then be forced back to CPU by firmware.                   E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                                *                                                                           E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                                * NOTE: Above description is not quite true at this point.                  E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                                *       It seems the SIE never returns the UOWN bit to CPU,                 E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                                *       and a TRNIF is never generated upon successful                      E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                                *       reception of a SETUP transaction.                                   E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                                *       Firmware work-around is implemented below.                          E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                                */                                                                          E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
0014bc   a070     BTFSS     0x70,0x0,0x0       if(UEP0bits.EPSTALL == 1)                                                    E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
0014be   d003     BRA       0x14c6                                                                                          
                                               {                                                                            E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
0014c0   ecd6     CALL      0x13ac,0x0             USBPrepareForNextSetupTrf();        // Firmware Work-Around              E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
0014c2   f009                                                                                                               
0014c4   9070     BCF       0x70,0x0,0x0           UEP0bits.EPSTALL = 0;                                                    E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                               }                                                                            E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
0014c6   9a68     BCF       0x68,0x5,0x0       UIRbits.STALLIF = 0;                                                         E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
0014c8   0012     RETURN    0x0            }//end USBStallHandler                                                           E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                           /******************************************************************************  E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            * Function:        void USBErrorHandler(void)                                   E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            * PreCondition:    None                                                         E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            * Input:           None                                                         E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            * Output:          None                                                         E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            * Side Effects:    None                                                         E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            * Overview:        The purpose of this interrupt is mainly for debugging        E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                  during development. Check UEIR to see which error causes     E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                  the interrupt.                                               E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            * Note:            None                                                         E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *****************************************************************************/  E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                           void USBErrorHandler(void)                                                       E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                           {                                                                                E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
0014ca   9268     BCF       0x68,0x1,0x0       UIRbits.UERRIF = 0;                                                          E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
0014cc   0012     RETURN    0x0            }//end USBErrorHandler                                                           E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                           /******************************************************************************  E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            * Function:        void USBProtocolResetHandler(void)                           E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            * PreCondition:    A USB bus reset is received from the host.                   E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            * Input:           None                                                         E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            * Output:          None                                                         E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            * Side Effects:    Currently, this routine flushes any pending USB              E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                  transactions. It empties out the USTAT FIFO. This action     E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                  might not be desirable in some applications.                 E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            * Overview:        Once a USB bus reset is received from the host, this         E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                  routine should be called. It resets the device address to    E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                  zero, disables all non-EP0 endpoints, initializes EP0 to     E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                  be ready for default communication, clears all USB           E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                  interrupt flags, unmasks applicable USB interrupts, and      E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                  reinitializes internal state-machine variables.              E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            * Note:            None                                                         E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                            *****************************************************************************/  E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                           void USBProtocolResetHandler(void)                                               E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                           {                                                                                E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
0014ce   6a6a     CLRF      0x6a,0x0           UEIR = 0;                       // Clear all USB error flags                 E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
0014d0   6a68     CLRF      0x68,0x0           UIR = 0;                        // Clears all USB interrupts                 E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
0014d2   0e9f     MOVLW     0x9f               UEIE = 0b10011111;              // Unmask all USB error interrupts           E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
0014d4   6e6b     MOVWF     0x6b,0x0                                                                                        
0014d6   0e7b     MOVLW     0x7b               UIE = 0b01111011;               // Enable all interrupts except ACTVIE       E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
0014d8   6e69     MOVWF     0x69,0x0                                                                                        
                                                                                                                            E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
0014da   6a6e     CLRF      0x6e,0x0           UADDR = 0x00;                   // Reset to default address                  E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
0014dc   0e0f     MOVLW     0xf                mDisableEP1to15();              // Reset all non-EP0 UEPn registers          E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
0014de   6ee6     MOVWF     0xe6,0x0                                                                                        
0014e0   0e71     MOVLW     0x71                                                                                            
0014e2   6ee6     MOVWF     0xe6,0x0                                                                                        
0014e4   0e0f     MOVLW     0xf                                                                                             
0014e6   6ee6     MOVWF     0xe6,0x0                                                                                        
0014e8   d814     RCALL     0x1512                                                                                          
0014ea   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0014ec   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0014ee   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0014f0   0e16     MOVLW     0x16               UEP0 = EP_CTRL|HSHK_EN;         // Init EP0 as a Ctrl EP, see usbdrv.h       E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
0014f2   6e70     MOVWF     0x70,0x0                                                                                        
                                                                                                                            E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
0014f4   a668     BTFSS     0x68,0x3,0x0       while(UIRbits.TRNIF == 1)       // Flush any pending transactions            E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
0014f6   d002     BRA       0x14fc                                                                                          
0014fa   d7fc     BRA       0x14f4                                                                                          
0014f8   9668     BCF       0x68,0x3,0x0           UIRbits.TRNIF = 0;                                                       E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
0014fc   986d     BCF       0x6d,0x4,0x0       UCONbits.PKTDIS = 0;            // Make sure packet processing is enabled    E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
0014fe   ecd6     CALL      0x13ac,0x0         USBPrepareForNextSetupTrf();    // Declared in usbctrltrf.c                  E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
001500   f009                                                                                                               
                                                                                                                            E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
001502   0100     MOVLB     0x0                usb_stat.RemoteWakeup = 0;      // Default status flag to disable            E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
001504   91fd     BCF       0xfd,0x0,0x1                                                                                    
001506   0100     MOVLB     0x0                usb_active_cfg = 0;             // Clear active configuration                E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
001508   6bfe     CLRF      0xfe,0x1                                                                                        
00150a   0100     MOVLB     0x0                usb_device_state = DEFAULT_STATE;                                            E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
00150c   0e03     MOVLW     0x3                                                                                             
00150e   6ffc     MOVWF     0xfc,0x1                                                                                        
001510   0012     RETURN    0x0            }//end USBProtocolResetHandler                                                   E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                           /* Auxiliary Function */                                                         E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
001512   cfd9     MOVFF     0xfd9,0xfe6    void ClearArray(byte* startAdr,byte count)                                       E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
001514   ffe6                                                                                                               
001516   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
001518   ffd9                                                                                                               
                                           {                                                                                E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
00151a   0efd     MOVLW     0xfd               *startAdr;                                                                   E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
00151c   cfdb     MOVFF     0xfdb,0xfe9                                                                                     
00151e   ffe9                                                                                                               
001520   0efe     MOVLW     0xfe                                                                                            
001522   cfdb     MOVFF     0xfdb,0xfea                                                                                     
001524   ffea                                                                                                               
001526   0efc     MOVLW     0xfc               while(count)                                                                 E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
001528   50db     MOVF      0xdb,0x0,0x0                                                                                    
00152a   e004     BZ        0x1534                                                                                          
001532   d7f9     BRA       0x1526                                                                                          
                                               {                                                                            E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                                   _asm                                                                     E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
00152c   6aee     CLRF      0xee,0x0               clrf POSTINC0,0                                                          E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                                   _endasm                                                                  E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
00152e   0efc     MOVLW     0xfc                   count--;                                                                 E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
001530   06db     DECF      0xdb,0x1,0x0                                                                                    
                                               }//end while                                                                 E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
001534   52e5     MOVF      0xe5,0x1,0x0   }//end ClearArray                                                                E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
001536   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
001538   ffd9                                                                                                               
00153a   0012     RETURN    0x0                                                                                             
                                                                                                                            E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                           /** EOF usbdrv.c *************************************************************/  E:\usb20\lighting2\system\usb\usbdrv\usbdrv.c
                                           /*********************************************************************           E:\usb20\lighting2\system\usb\usbmmap.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbmmap.c
                                            *                Microchip USB C18 Firmware Version 1.0                         E:\usb20\lighting2\system\usb\usbmmap.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbmmap.c
                                            *********************************************************************           E:\usb20\lighting2\system\usb\usbmmap.c
                                            * FileName:        usbmmap.c                                                    E:\usb20\lighting2\system\usb\usbmmap.c
                                            * Dependencies:    See INCLUDES section below                                   E:\usb20\lighting2\system\usb\usbmmap.c
                                            * Processor:       PIC18                                                        E:\usb20\lighting2\system\usb\usbmmap.c
                                            * Compiler:        C18 2.30.01+                                                 E:\usb20\lighting2\system\usb\usbmmap.c
                                            * Company:         Microchip Technology, Inc.                                   E:\usb20\lighting2\system\usb\usbmmap.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbmmap.c
                                            * Software License Agreement                                                    E:\usb20\lighting2\system\usb\usbmmap.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbmmap.c
                                            * The software supplied herewith by Microchip Technology Incorporated           E:\usb20\lighting2\system\usb\usbmmap.c
                                            * (the 鼎ompany) for its PICmicroｮ Microcontroller is intended and             E:\usb20\lighting2\system\usb\usbmmap.c
                                            * supplied to you, the Company痴 customer, for use solely and                   E:\usb20\lighting2\system\usb\usbmmap.c
                                            * exclusively on Microchip PICmicro Microcontroller products. The               E:\usb20\lighting2\system\usb\usbmmap.c
                                            * software is owned by the Company and/or its supplier, and is                  E:\usb20\lighting2\system\usb\usbmmap.c
                                            * protected under applicable copyright laws. All rights are reserved.           E:\usb20\lighting2\system\usb\usbmmap.c
                                            * Any use in violation of the foregoing restrictions may subject the            E:\usb20\lighting2\system\usb\usbmmap.c
                                            * user to criminal sanctions under applicable laws, as well as to               E:\usb20\lighting2\system\usb\usbmmap.c
                                            * civil liability for the breach of the terms and conditions of this            E:\usb20\lighting2\system\usb\usbmmap.c
                                            * license.                                                                      E:\usb20\lighting2\system\usb\usbmmap.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbmmap.c
                                            * THIS SOFTWARE IS PROVIDED IN AN 鄭S IS CONDITION. NO WARRANTIES,             E:\usb20\lighting2\system\usb\usbmmap.c
                                            * WHETHER EXPRESS, IMPLIED OR STATUTORY, INCLUDING, BUT NOT LIMITED             E:\usb20\lighting2\system\usb\usbmmap.c
                                            * TO, IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A                   E:\usb20\lighting2\system\usb\usbmmap.c
                                            * PARTICULAR PURPOSE APPLY TO THIS SOFTWARE. THE COMPANY SHALL NOT,             E:\usb20\lighting2\system\usb\usbmmap.c
                                            * IN ANY CIRCUMSTANCES, BE LIABLE FOR SPECIAL, INCIDENTAL OR                    E:\usb20\lighting2\system\usb\usbmmap.c
                                            * CONSEQUENTIAL DAMAGES, FOR ANY REASON WHATSOEVER.                             E:\usb20\lighting2\system\usb\usbmmap.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbmmap.c
                                            * Author               Date        Comment                                      E:\usb20\lighting2\system\usb\usbmmap.c
                                            *~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~           E:\usb20\lighting2\system\usb\usbmmap.c
                                            * Rawin Rojvanit       11/19/04    Original.                                    E:\usb20\lighting2\system\usb\usbmmap.c
                                            ********************************************************************/           E:\usb20\lighting2\system\usb\usbmmap.c
                                                                                                                            E:\usb20\lighting2\system\usb\usbmmap.c
                                           /******************************************************************************  E:\usb20\lighting2\system\usb\usbmmap.c
                                            * -usbmmap.c-                                                                   E:\usb20\lighting2\system\usb\usbmmap.c
                                            * USB Memory Map                                                                E:\usb20\lighting2\system\usb\usbmmap.c
                                            * This file is the USB memory manager; it serves as a compile-time memory       E:\usb20\lighting2\system\usb\usbmmap.c
                                            * allocator for the USB endpoints. It uses the compile time options passed      E:\usb20\lighting2\system\usb\usbmmap.c
                                            * from usbcfg.h to instantiate endpoints and endpoint buffer.                   E:\usb20\lighting2\system\usb\usbmmap.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbmmap.c
                                            * Each endpoint requires to have a set of Buffer Descriptor registers(BDT).     E:\usb20\lighting2\system\usb\usbmmap.c
                                            * A BDT is 4-byte long and has a specific RAM location for each endpoint.       E:\usb20\lighting2\system\usb\usbmmap.c
                                            * The BDT for endpoint 0 out is located at address 0x400 to 0x403.              E:\usb20\lighting2\system\usb\usbmmap.c
                                            * The BDT for endpoint 0 in is located at address 0x404 to 0x407.               E:\usb20\lighting2\system\usb\usbmmap.c
                                            * The BDT for endpoint 1 out is located at address 0x408 to 0x40B.              E:\usb20\lighting2\system\usb\usbmmap.c
                                            * and so on... The above allocation assumes the Ping-Pong Buffer Mode 0 is      E:\usb20\lighting2\system\usb\usbmmap.c
                                            * used. These locations are already hard-wired in the silicon. The point        E:\usb20\lighting2\system\usb\usbmmap.c
                                            * of doing instantiation, i.e. volatile far BDT ep0Bo;, is to provide the       E:\usb20\lighting2\system\usb\usbmmap.c
                                            * C compiler a way to address each variable directly. This is very important    E:\usb20\lighting2\system\usb\usbmmap.c
                                            * because when a register can be accessed directly, it saves execution time     E:\usb20\lighting2\system\usb\usbmmap.c
                                            * and reduces program size.                                                     E:\usb20\lighting2\system\usb\usbmmap.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbmmap.c
                                            * Endpoints are defined using the endpoint number and the direction             E:\usb20\lighting2\system\usb\usbmmap.c
                                            * of transfer. For simplicity, usbmmap.c only uses the endpoint number          E:\usb20\lighting2\system\usb\usbmmap.c
                                            * in the BDT register allocation scheme. This means if the usbcfg.h states      E:\usb20\lighting2\system\usb\usbmmap.c
                                            * that the MAX_EP_NUMBER is number 1, then four BDTs will be                    E:\usb20\lighting2\system\usb\usbmmap.c
                                            * instantiated: one each for endpoint0 in and endpoint0 out, which must         E:\usb20\lighting2\system\usb\usbmmap.c
                                            * always be instantiated for control transfer by default, and one each sets     E:\usb20\lighting2\system\usb\usbmmap.c
                                            * for endpoint1 in and endpoint1 out. The naming convention for instantiating   E:\usb20\lighting2\system\usb\usbmmap.c
                                            * BDT is                                                                        E:\usb20\lighting2\system\usb\usbmmap.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbmmap.c
                                            * ep<#>B<d>                                                                     E:\usb20\lighting2\system\usb\usbmmap.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbmmap.c
                                            * where # is the endpoint number, and d is the direction of                     E:\usb20\lighting2\system\usb\usbmmap.c
                                            * transfer, which could be either <i> or <o>.                                   E:\usb20\lighting2\system\usb\usbmmap.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbmmap.c
                                            * The USB memory manager uses MAX_EP_NUMBER, as defined in usbcfg.h, to define  E:\usb20\lighting2\system\usb\usbmmap.c
                                            * the endpoints to be instantiated. This represents the highest endpoint        E:\usb20\lighting2\system\usb\usbmmap.c
                                            * number to be allocated, not how many endpoints are used. Since the BDTs for   E:\usb20\lighting2\system\usb\usbmmap.c
                                            * endpoints have hardware-assigned addresses in Bank 4, setting this value too  E:\usb20\lighting2\system\usb\usbmmap.c
                                            * high may lead to inefficient use of data RAM. For example, if an application  E:\usb20\lighting2\system\usb\usbmmap.c
                                            * uses only endpoints EP0 and EP4, then the MAX_EP_NUMBER is 4, and not 2.      E:\usb20\lighting2\system\usb\usbmmap.c
                                            * The in-between endpoint BDTs in this example (EP1, EP2, and EP3) go unused,   E:\usb20\lighting2\system\usb\usbmmap.c
                                            * and the 24 bytes of memory associated with them are wasted. It does not make  E:\usb20\lighting2\system\usb\usbmmap.c
                                            * much sense to skip endpoints, but the final decision lies with the user.      E:\usb20\lighting2\system\usb\usbmmap.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbmmap.c
                                            * The next step is to assign the instantiated BDTs to different                 E:\usb20\lighting2\system\usb\usbmmap.c
                                            * USB functions. The firmware framework fundamentally assumes that every USB    E:\usb20\lighting2\system\usb\usbmmap.c
                                            * function should know which endpoint it is using, i.e., the default control    E:\usb20\lighting2\system\usb\usbmmap.c
                                            * transfer should know that it is using endpoint 0 in and endpoint 0 out.       E:\usb20\lighting2\system\usb\usbmmap.c
                                            * A HID class can choose which endpoint it wants to use, but once chosen, it    E:\usb20\lighting2\system\usb\usbmmap.c
                                            * should always know the number of the endpoint.                                E:\usb20\lighting2\system\usb\usbmmap.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbmmap.c
                                            * The assignment of endpoints to USB functions is managed centrally             E:\usb20\lighting2\system\usb\usbmmap.c
                                            * in usbcfg.h. This helps prevent the mistake of having more                    E:\usb20\lighting2\system\usb\usbmmap.c
                                            * than one USB function using the same endpoint. The "Endpoint Allocation"      E:\usb20\lighting2\system\usb\usbmmap.c
                                            * section in usbcfg.h provides examples for how to map USB endpoints to USB     E:\usb20\lighting2\system\usb\usbmmap.c
                                            * functions.                                                                    E:\usb20\lighting2\system\usb\usbmmap.c
                                            * Quite a few things can be mapped in that section. There is no                 E:\usb20\lighting2\system\usb\usbmmap.c
                                            * one correct way to do the mapping and the user has the choice to              E:\usb20\lighting2\system\usb\usbmmap.c
                                            * choose a method that is most suitable to the application.                     E:\usb20\lighting2\system\usb\usbmmap.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbmmap.c
                                            * Typically, however, a user will want to map the following for a given         E:\usb20\lighting2\system\usb\usbmmap.c
                                            * USB interface function:                                                       E:\usb20\lighting2\system\usb\usbmmap.c
                                            * 1. The USB interface ID                                                       E:\usb20\lighting2\system\usb\usbmmap.c
                                            * 2. The endpoint control registers (UEPn)                                      E:\usb20\lighting2\system\usb\usbmmap.c
                                            * 3. The BDT registers (ep<#>B<d>)                                              E:\usb20\lighting2\system\usb\usbmmap.c
                                            * 4. The endpoint size                                                          E:\usb20\lighting2\system\usb\usbmmap.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbmmap.c
                                            * Example: Assume a USB device class "foo", which uses one out endpoint         E:\usb20\lighting2\system\usb\usbmmap.c
                                            *          of size 64-byte and one in endpoint of size 64-byte, then:           E:\usb20\lighting2\system\usb\usbmmap.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbmmap.c
                                            * #define FOO_INTF_ID          0x00                                             E:\usb20\lighting2\system\usb\usbmmap.c
                                            * #define FOO_UEP              UEP1                                             E:\usb20\lighting2\system\usb\usbmmap.c
                                            * #define FOO_BD_OUT           ep1Bo                                            E:\usb20\lighting2\system\usb\usbmmap.c
                                            * #define FOO_BD_IN            ep1Bi                                            E:\usb20\lighting2\system\usb\usbmmap.c
                                            * #define FOO_EP_SIZE          64                                               E:\usb20\lighting2\system\usb\usbmmap.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbmmap.c
                                            * The mapping above has chosen class "foo" to use endpoint 1.                   E:\usb20\lighting2\system\usb\usbmmap.c
                                            * The names are arbitrary and can be anything other than FOO_??????.            E:\usb20\lighting2\system\usb\usbmmap.c
                                            * For abstraction, the code for class "foo" should use the abstract             E:\usb20\lighting2\system\usb\usbmmap.c
                                            * definitions of FOO_BD_OUT,FOO_BD_IN, and not ep1Bo or ep1Bi.                  E:\usb20\lighting2\system\usb\usbmmap.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbmmap.c
                                            * Note that the endpoint size defined in the usbcfg.h file is again             E:\usb20\lighting2\system\usb\usbmmap.c
                                            * used in the usbmmap.c file. This shows that the relationship between          E:\usb20\lighting2\system\usb\usbmmap.c
                                            * the two files are tightly related.                                            E:\usb20\lighting2\system\usb\usbmmap.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbmmap.c
                                            * The endpoint buffer for each USB function must be located in the              E:\usb20\lighting2\system\usb\usbmmap.c
                                            * dual-port RAM area and has to come after all the BDTs have been               E:\usb20\lighting2\system\usb\usbmmap.c
                                            * instantiated. An example declaration is:                                      E:\usb20\lighting2\system\usb\usbmmap.c
                                            * volatile far unsigned char[FOO_EP_SIZE] data;                                 E:\usb20\lighting2\system\usb\usbmmap.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbmmap.c
                                            * The 'volatile' keyword tells the compiler not to perform any code             E:\usb20\lighting2\system\usb\usbmmap.c
                                            * optimization on this variable because its content could be modified           E:\usb20\lighting2\system\usb\usbmmap.c
                                            * by the hardware. The 'far' keyword tells the compiler that this variable      E:\usb20\lighting2\system\usb\usbmmap.c
                                            * is not located in the Access RAM area (0x000 - 0x05F).                        E:\usb20\lighting2\system\usb\usbmmap.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbmmap.c
                                            * For the variable to be globally accessible by other files, it should be       E:\usb20\lighting2\system\usb\usbmmap.c
                                            * declared in the header file usbmmap.h as an extern definition, such as        E:\usb20\lighting2\system\usb\usbmmap.c
                                            * extern volatile far unsigned char[FOO_EP_SIZE] data;                          E:\usb20\lighting2\system\usb\usbmmap.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbmmap.c
                                            * Conclusion:                                                                   E:\usb20\lighting2\system\usb\usbmmap.c
                                            * In a short summary, the dependencies between usbcfg and usbmmap can           E:\usb20\lighting2\system\usb\usbmmap.c
                                            * be shown as:                                                                  E:\usb20\lighting2\system\usb\usbmmap.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbmmap.c
                                            * usbcfg[MAX_EP_NUMBER] -> usbmmap                                              E:\usb20\lighting2\system\usb\usbmmap.c
                                            * usbmmap[ep<#>B<d>] -> usbcfg                                                  E:\usb20\lighting2\system\usb\usbmmap.c
                                            * usbcfg[EP size] -> usbmmap                                                    E:\usb20\lighting2\system\usb\usbmmap.c
                                            * usbcfg[abstract ep definitions] -> usb9/hid/cdc/etc class code                E:\usb20\lighting2\system\usb\usbmmap.c
                                            * usbmmap[endpoint buffer variable] -> usb9/hid/cdc/etc class code              E:\usb20\lighting2\system\usb\usbmmap.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbmmap.c
                                            * Data mapping provides a means for direct addressing of BDT and endpoint       E:\usb20\lighting2\system\usb\usbmmap.c
                                            * buffer. This means less usage of pointers, which equates to a faster and      E:\usb20\lighting2\system\usb\usbmmap.c
                                            * smaller program code.                                                         E:\usb20\lighting2\system\usb\usbmmap.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbmmap.c
                                            *****************************************************************************/  E:\usb20\lighting2\system\usb\usbmmap.c
                                                                                                                            E:\usb20\lighting2\system\usb\usbmmap.c
                                           /** I N C L U D E S **********************************************************/  E:\usb20\lighting2\system\usb\usbmmap.c
                                           #include "system\typedefs.h"                                                     E:\usb20\lighting2\system\usb\usbmmap.c
                                           #include "system\usb\usb.h"                                                      E:\usb20\lighting2\system\usb\usbmmap.c
                                                                                                                            E:\usb20\lighting2\system\usb\usbmmap.c
                                           /** U S B  G L O B A L  V A R I A B L E S ************************************/  E:\usb20\lighting2\system\usb\usbmmap.c
                                           #pragma udata                                                                    E:\usb20\lighting2\system\usb\usbmmap.c
                                           byte usb_device_state;          // Device States: DETACHED, ATTACHED, ...        E:\usb20\lighting2\system\usb\usbmmap.c
                                           USB_DEVICE_STATUS usb_stat;     // Global USB flags                              E:\usb20\lighting2\system\usb\usbmmap.c
                                           byte usb_active_cfg;            // Value of current configuration                E:\usb20\lighting2\system\usb\usbmmap.c
                                           byte usb_alt_intf[MAX_NUM_INT]; // Array to keep track of the current alternate  E:\usb20\lighting2\system\usb\usbmmap.c
                                                                           // setting for each interface ID                 E:\usb20\lighting2\system\usb\usbmmap.c
                                                                                                                            E:\usb20\lighting2\system\usb\usbmmap.c
                                           /** U S B  F I X E D  L O C A T I O N  V A R I A B L E S *********************/  E:\usb20\lighting2\system\usb\usbmmap.c
                                           #pragma udata usbram4=0x400     //See Linker Script,usb4:0x400-0x4FF(256-byte)   E:\usb20\lighting2\system\usb\usbmmap.c
                                                                                                                            E:\usb20\lighting2\system\usb\usbmmap.c
                                           /******************************************************************************  E:\usb20\lighting2\system\usb\usbmmap.c
                                            * Section A: Buffer Descriptor Table                                            E:\usb20\lighting2\system\usb\usbmmap.c
                                            * - 0x400 - 0x4FF(max)                                                          E:\usb20\lighting2\system\usb\usbmmap.c
                                            * - MAX_EP_NUMBER is defined in autofiles\usbcfg.h                              E:\usb20\lighting2\system\usb\usbmmap.c
                                            * - BDT data type is defined in system\usb\usbmmap.h                            E:\usb20\lighting2\system\usb\usbmmap.c
                                            *****************************************************************************/  E:\usb20\lighting2\system\usb\usbmmap.c
                                                                                                                            E:\usb20\lighting2\system\usb\usbmmap.c
                                           #if(0 <= MAX_EP_NUMBER)                                                          E:\usb20\lighting2\system\usb\usbmmap.c
                                           volatile far BDT ep0Bo;         //Endpoint #0 BD Out                             E:\usb20\lighting2\system\usb\usbmmap.c
                                           volatile far BDT ep0Bi;         //Endpoint #0 BD In                              E:\usb20\lighting2\system\usb\usbmmap.c
                                           #endif                                                                           E:\usb20\lighting2\system\usb\usbmmap.c
                                                                                                                            E:\usb20\lighting2\system\usb\usbmmap.c
                                           #if(1 <= MAX_EP_NUMBER)                                                          E:\usb20\lighting2\system\usb\usbmmap.c
                                           volatile far BDT ep1Bo;         //Endpoint #1 BD Out                             E:\usb20\lighting2\system\usb\usbmmap.c
                                           volatile far BDT ep1Bi;         //Endpoint #1 BD In                              E:\usb20\lighting2\system\usb\usbmmap.c
                                           #endif                                                                           E:\usb20\lighting2\system\usb\usbmmap.c
                                                                                                                            E:\usb20\lighting2\system\usb\usbmmap.c
                                           #if(2 <= MAX_EP_NUMBER)                                                          E:\usb20\lighting2\system\usb\usbmmap.c
                                           volatile far BDT ep2Bo;         //Endpoint #2 BD Out                             E:\usb20\lighting2\system\usb\usbmmap.c
                                           volatile far BDT ep2Bi;         //Endpoint #2 BD In                              E:\usb20\lighting2\system\usb\usbmmap.c
                                           #endif                                                                           E:\usb20\lighting2\system\usb\usbmmap.c
                                                                                                                            E:\usb20\lighting2\system\usb\usbmmap.c
                                           #if(3 <= MAX_EP_NUMBER)                                                          E:\usb20\lighting2\system\usb\usbmmap.c
                                           volatile far BDT ep3Bo;         //Endpoint #3 BD Out                             E:\usb20\lighting2\system\usb\usbmmap.c
                                           volatile far BDT ep3Bi;         //Endpoint #3 BD In                              E:\usb20\lighting2\system\usb\usbmmap.c
                                           #endif                                                                           E:\usb20\lighting2\system\usb\usbmmap.c
                                                                                                                            E:\usb20\lighting2\system\usb\usbmmap.c
                                           #if(4 <= MAX_EP_NUMBER)                                                          E:\usb20\lighting2\system\usb\usbmmap.c
                                           volatile far BDT ep4Bo;         //Endpoint #4 BD Out                             E:\usb20\lighting2\system\usb\usbmmap.c
                                           volatile far BDT ep4Bi;         //Endpoint #4 BD In                              E:\usb20\lighting2\system\usb\usbmmap.c
                                           #endif                                                                           E:\usb20\lighting2\system\usb\usbmmap.c
                                                                                                                            E:\usb20\lighting2\system\usb\usbmmap.c
                                           #if(5 <= MAX_EP_NUMBER)                                                          E:\usb20\lighting2\system\usb\usbmmap.c
                                           volatile far BDT ep5Bo;         //Endpoint #5 BD Out                             E:\usb20\lighting2\system\usb\usbmmap.c
                                           volatile far BDT ep5Bi;         //Endpoint #5 BD In                              E:\usb20\lighting2\system\usb\usbmmap.c
                                           #endif                                                                           E:\usb20\lighting2\system\usb\usbmmap.c
                                                                                                                            E:\usb20\lighting2\system\usb\usbmmap.c
                                           #if(6 <= MAX_EP_NUMBER)                                                          E:\usb20\lighting2\system\usb\usbmmap.c
                                           volatile far BDT ep6Bo;         //Endpoint #6 BD Out                             E:\usb20\lighting2\system\usb\usbmmap.c
                                           volatile far BDT ep6Bi;         //Endpoint #6 BD In                              E:\usb20\lighting2\system\usb\usbmmap.c
                                           #endif                                                                           E:\usb20\lighting2\system\usb\usbmmap.c
                                                                                                                            E:\usb20\lighting2\system\usb\usbmmap.c
                                           #if(7 <= MAX_EP_NUMBER)                                                          E:\usb20\lighting2\system\usb\usbmmap.c
                                           volatile far BDT ep7Bo;         //Endpoint #7 BD Out                             E:\usb20\lighting2\system\usb\usbmmap.c
                                           volatile far BDT ep7Bi;         //Endpoint #7 BD In                              E:\usb20\lighting2\system\usb\usbmmap.c
                                           #endif                                                                           E:\usb20\lighting2\system\usb\usbmmap.c
                                                                                                                            E:\usb20\lighting2\system\usb\usbmmap.c
                                           #if(8 <= MAX_EP_NUMBER)                                                          E:\usb20\lighting2\system\usb\usbmmap.c
                                           volatile far BDT ep8Bo;         //Endpoint #8 BD Out                             E:\usb20\lighting2\system\usb\usbmmap.c
                                           volatile far BDT ep8Bi;         //Endpoint #8 BD In                              E:\usb20\lighting2\system\usb\usbmmap.c
                                           #endif                                                                           E:\usb20\lighting2\system\usb\usbmmap.c
                                                                                                                            E:\usb20\lighting2\system\usb\usbmmap.c
                                           #if(9 <= MAX_EP_NUMBER)                                                          E:\usb20\lighting2\system\usb\usbmmap.c
                                           volatile far BDT ep9Bo;         //Endpoint #9 BD Out                             E:\usb20\lighting2\system\usb\usbmmap.c
                                           volatile far BDT ep9Bi;         //Endpoint #9 BD In                              E:\usb20\lighting2\system\usb\usbmmap.c
                                           #endif                                                                           E:\usb20\lighting2\system\usb\usbmmap.c
                                                                                                                            E:\usb20\lighting2\system\usb\usbmmap.c
                                           #if(10 <= MAX_EP_NUMBER)                                                         E:\usb20\lighting2\system\usb\usbmmap.c
                                           volatile far BDT ep10Bo;        //Endpoint #10 BD Out                            E:\usb20\lighting2\system\usb\usbmmap.c
                                           volatile far BDT ep10Bi;        //Endpoint #10 BD In                             E:\usb20\lighting2\system\usb\usbmmap.c
                                           #endif                                                                           E:\usb20\lighting2\system\usb\usbmmap.c
                                                                                                                            E:\usb20\lighting2\system\usb\usbmmap.c
                                           #if(11 <= MAX_EP_NUMBER)                                                         E:\usb20\lighting2\system\usb\usbmmap.c
                                           volatile far BDT ep11Bo;        //Endpoint #11 BD Out                            E:\usb20\lighting2\system\usb\usbmmap.c
                                           volatile far BDT ep11Bi;        //Endpoint #11 BD In                             E:\usb20\lighting2\system\usb\usbmmap.c
                                           #endif                                                                           E:\usb20\lighting2\system\usb\usbmmap.c
                                                                                                                            E:\usb20\lighting2\system\usb\usbmmap.c
                                           #if(12 <= MAX_EP_NUMBER)                                                         E:\usb20\lighting2\system\usb\usbmmap.c
                                           volatile far BDT ep12Bo;        //Endpoint #12 BD Out                            E:\usb20\lighting2\system\usb\usbmmap.c
                                           volatile far BDT ep12Bi;        //Endpoint #12 BD In                             E:\usb20\lighting2\system\usb\usbmmap.c
                                           #endif                                                                           E:\usb20\lighting2\system\usb\usbmmap.c
                                                                                                                            E:\usb20\lighting2\system\usb\usbmmap.c
                                           #if(13 <= MAX_EP_NUMBER)                                                         E:\usb20\lighting2\system\usb\usbmmap.c
                                           volatile far BDT ep13Bo;        //Endpoint #13 BD Out                            E:\usb20\lighting2\system\usb\usbmmap.c
                                           volatile far BDT ep13Bi;        //Endpoint #13 BD In                             E:\usb20\lighting2\system\usb\usbmmap.c
                                           #endif                                                                           E:\usb20\lighting2\system\usb\usbmmap.c
                                                                                                                            E:\usb20\lighting2\system\usb\usbmmap.c
                                           #if(14 <= MAX_EP_NUMBER)                                                         E:\usb20\lighting2\system\usb\usbmmap.c
                                           volatile far BDT ep14Bo;        //Endpoint #14 BD Out                            E:\usb20\lighting2\system\usb\usbmmap.c
                                           volatile far BDT ep14Bi;        //Endpoint #14 BD In                             E:\usb20\lighting2\system\usb\usbmmap.c
                                           #endif                                                                           E:\usb20\lighting2\system\usb\usbmmap.c
                                                                                                                            E:\usb20\lighting2\system\usb\usbmmap.c
                                           #if(15 <= MAX_EP_NUMBER)                                                         E:\usb20\lighting2\system\usb\usbmmap.c
                                           volatile far BDT ep15Bo;        //Endpoint #15 BD Out                            E:\usb20\lighting2\system\usb\usbmmap.c
                                           volatile far BDT ep15Bi;        //Endpoint #15 BD In                             E:\usb20\lighting2\system\usb\usbmmap.c
                                           #endif                                                                           E:\usb20\lighting2\system\usb\usbmmap.c
                                                                                                                            E:\usb20\lighting2\system\usb\usbmmap.c
                                           /******************************************************************************  E:\usb20\lighting2\system\usb\usbmmap.c
                                            * Section B: EP0 Buffer Space                                                   E:\usb20\lighting2\system\usb\usbmmap.c
                                            ******************************************************************************  E:\usb20\lighting2\system\usb\usbmmap.c
                                            * - Two buffer areas are defined:                                               E:\usb20\lighting2\system\usb\usbmmap.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbmmap.c
                                            *   A. CTRL_TRF_SETUP                                                           E:\usb20\lighting2\system\usb\usbmmap.c
                                            *      - Size = EP0_BUFF_SIZE as defined in autofiles\usbcfg.h                  E:\usb20\lighting2\system\usb\usbmmap.c
                                            *      - Detailed data structure allows direct adddressing of bits and bytes.   E:\usb20\lighting2\system\usb\usbmmap.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbmmap.c
                                            *   B. CTRL_TRF_DATA                                                            E:\usb20\lighting2\system\usb\usbmmap.c
                                            *      - Size = EP0_BUFF_SIZE as defined in autofiles\usbcfg.h                  E:\usb20\lighting2\system\usb\usbmmap.c
                                            *      - Data structure allows direct adddressing of the first 8 bytes.         E:\usb20\lighting2\system\usb\usbmmap.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbmmap.c
                                            * - Both data types are defined in system\usb\usbdefs\usbdefs_ep0_buff.h        E:\usb20\lighting2\system\usb\usbmmap.c
                                            *****************************************************************************/  E:\usb20\lighting2\system\usb\usbmmap.c
                                           volatile far CTRL_TRF_SETUP SetupPkt;                                            E:\usb20\lighting2\system\usb\usbmmap.c
                                           volatile far CTRL_TRF_DATA CtrlTrfData;                                          E:\usb20\lighting2\system\usb\usbmmap.c
                                                                                                                            E:\usb20\lighting2\system\usb\usbmmap.c
                                           /******************************************************************************  E:\usb20\lighting2\system\usb\usbmmap.c
                                            * Section C: CDC Buffer                                                         E:\usb20\lighting2\system\usb\usbmmap.c
                                            ******************************************************************************  E:\usb20\lighting2\system\usb\usbmmap.c
                                            *                                                                               E:\usb20\lighting2\system\usb\usbmmap.c
                                            *****************************************************************************/  E:\usb20\lighting2\system\usb\usbmmap.c
                                           #pragma udata usbram5a=0x500    //See Linker Script,usb5:0x500-...               E:\usb20\lighting2\system\usb\usbmmap.c
                                           #if defined(USB_USE_CDC)                                                         E:\usb20\lighting2\system\usb\usbmmap.c
                                           volatile far unsigned char cdc_notice[CDC_INT_EP_SIZE];                          E:\usb20\lighting2\system\usb\usbmmap.c
                                           volatile far unsigned char cdc_data_rx[CDC_BULK_OUT_EP_SIZE];                    E:\usb20\lighting2\system\usb\usbmmap.c
                                           volatile far unsigned char cdc_data_tx[CDC_BULK_IN_EP_SIZE];                     E:\usb20\lighting2\system\usb\usbmmap.c
                                           #endif                                                                           E:\usb20\lighting2\system\usb\usbmmap.c
                                           #pragma udata                                                                    E:\usb20\lighting2\system\usb\usbmmap.c
                                                                                                                            E:\usb20\lighting2\system\usb\usbmmap.c
                                           /** EOF usbmmap.c ************************************************************/  E:\usb20\lighting2\system\usb\usbmmap.c
                                           /*********************************************************************           E:\usb20\lighting2\autofiles\usbdsc.c
                                            *                                                                               E:\usb20\lighting2\autofiles\usbdsc.c
                                            *                Microchip USB C18 Firmware Version 1.0                         E:\usb20\lighting2\autofiles\usbdsc.c
                                            *                                                                               E:\usb20\lighting2\autofiles\usbdsc.c
                                            *********************************************************************           E:\usb20\lighting2\autofiles\usbdsc.c
                                            * FileName:        usbdsc.c                                                     E:\usb20\lighting2\autofiles\usbdsc.c
                                            * Dependencies:    See INCLUDES section below                                   E:\usb20\lighting2\autofiles\usbdsc.c
                                            * Processor:       PIC18                                                        E:\usb20\lighting2\autofiles\usbdsc.c
                                            * Compiler:        C18 2.30.01+                                                 E:\usb20\lighting2\autofiles\usbdsc.c
                                            * Company:         Microchip Technology, Inc.                                   E:\usb20\lighting2\autofiles\usbdsc.c
                                            *                                                                               E:\usb20\lighting2\autofiles\usbdsc.c
                                            * Software License Agreement                                                    E:\usb20\lighting2\autofiles\usbdsc.c
                                            *                                                                               E:\usb20\lighting2\autofiles\usbdsc.c
                                            * The software supplied herewith by Microchip Technology Incorporated           E:\usb20\lighting2\autofiles\usbdsc.c
                                            * (the 鼎ompany・ for its PICmicroｮ Microcontroller is intended and             E:\usb20\lighting2\autofiles\usbdsc.c
                                            * supplied to you, the Company痴 customer, for use solely and                   E:\usb20\lighting2\autofiles\usbdsc.c
                                            * exclusively on Microchip PICmicro Microcontroller products. The               E:\usb20\lighting2\autofiles\usbdsc.c
                                            * software is owned by the Company and/or its supplier, and is                  E:\usb20\lighting2\autofiles\usbdsc.c
                                            * protected under applicable copyright laws. All rights are reserved.           E:\usb20\lighting2\autofiles\usbdsc.c
                                            * Any use in violation of the foregoing restrictions may subject the            E:\usb20\lighting2\autofiles\usbdsc.c
                                            * user to criminal sanctions under applicable laws, as well as to               E:\usb20\lighting2\autofiles\usbdsc.c
                                            * civil liability for the breach of the terms and conditions of this            E:\usb20\lighting2\autofiles\usbdsc.c
                                            * license.                                                                      E:\usb20\lighting2\autofiles\usbdsc.c
                                            *                                                                               E:\usb20\lighting2\autofiles\usbdsc.c
                                            * THIS SOFTWARE IS PROVIDED IN AN 鄭S IS・CONDITION. NO WARRANTIES,             E:\usb20\lighting2\autofiles\usbdsc.c
                                            * WHETHER EXPRESS, IMPLIED OR STATUTORY, INCLUDING, BUT NOT LIMITED             E:\usb20\lighting2\autofiles\usbdsc.c
                                            * TO, IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A                   E:\usb20\lighting2\autofiles\usbdsc.c
                                            * PARTICULAR PURPOSE APPLY TO THIS SOFTWARE. THE COMPANY SHALL NOT,             E:\usb20\lighting2\autofiles\usbdsc.c
                                            * IN ANY CIRCUMSTANCES, BE LIABLE FOR SPECIAL, INCIDENTAL OR                    E:\usb20\lighting2\autofiles\usbdsc.c
                                            * CONSEQUENTIAL DAMAGES, FOR ANY REASON WHATSOEVER.                             E:\usb20\lighting2\autofiles\usbdsc.c
                                            *                                                                               E:\usb20\lighting2\autofiles\usbdsc.c
                                            ********************************************************************/           E:\usb20\lighting2\autofiles\usbdsc.c
                                                                                                                            E:\usb20\lighting2\autofiles\usbdsc.c
                                           /*********************************************************************           E:\usb20\lighting2\autofiles\usbdsc.c
                                            * -usbdsc.c-                                                                    E:\usb20\lighting2\autofiles\usbdsc.c
                                            * This file contains the USB descriptor information. It is used                 E:\usb20\lighting2\autofiles\usbdsc.c
                                            * in conjunction with the usbdsc.h file. When a descriptor is added             E:\usb20\lighting2\autofiles\usbdsc.c
                                            * or removed from the main configuration descriptor, i.e. CFG01,                E:\usb20\lighting2\autofiles\usbdsc.c
                                            * the user must also change the descriptor structure defined in                 E:\usb20\lighting2\autofiles\usbdsc.c
                                            * the usbdsc.h file. The structure is used to calculate the                     E:\usb20\lighting2\autofiles\usbdsc.c
                                            * descriptor size, i.e. sizeof(CFG01).                                          E:\usb20\lighting2\autofiles\usbdsc.c
                                            *                                                                               E:\usb20\lighting2\autofiles\usbdsc.c
                                            * A typical configuration descriptor consists of:                               E:\usb20\lighting2\autofiles\usbdsc.c
                                            * At least one configuration descriptor (USB_CFG_DSC)                           E:\usb20\lighting2\autofiles\usbdsc.c
                                            * One or more interface descriptors (USB_INTF_DSC)                              E:\usb20\lighting2\autofiles\usbdsc.c
                                            * One or more endpoint descriptors (USB_EP_DSC)                                 E:\usb20\lighting2\autofiles\usbdsc.c
                                            *                                                                               E:\usb20\lighting2\autofiles\usbdsc.c
                                            * Naming Convention:                                                            E:\usb20\lighting2\autofiles\usbdsc.c
                                            * To resolve ambiguity, the naming convention are as followed:                  E:\usb20\lighting2\autofiles\usbdsc.c
                                            * - USB_CFG_DSC type should be named cdxx, where xx is the                      E:\usb20\lighting2\autofiles\usbdsc.c
                                            *   configuration number. This number should match the actual                   E:\usb20\lighting2\autofiles\usbdsc.c
                                            *   index value of this configuration.                                          E:\usb20\lighting2\autofiles\usbdsc.c
                                            * - USB_INTF_DSC type should be named i<yy>a<zz>, where yy is the               E:\usb20\lighting2\autofiles\usbdsc.c
                                            *   interface number and zz is the alternate interface number.                  E:\usb20\lighting2\autofiles\usbdsc.c
                                            * - USB_EP_DSC type should be named ep<##><d>_i<yy>a<zz>, where                 E:\usb20\lighting2\autofiles\usbdsc.c
                                            *   ## is the endpoint number and d is the direction of transfer.               E:\usb20\lighting2\autofiles\usbdsc.c
                                            *   The interface name should also be listed as a suffix to identify            E:\usb20\lighting2\autofiles\usbdsc.c
                                            *   which interface does the endpoint belong to.                                E:\usb20\lighting2\autofiles\usbdsc.c
                                            *                                                                               E:\usb20\lighting2\autofiles\usbdsc.c
                                            * Example:                                                                      E:\usb20\lighting2\autofiles\usbdsc.c
                                            * If a device has one configuration, two interfaces; interface 0                E:\usb20\lighting2\autofiles\usbdsc.c
                                            * has two endpoints (in and out), and interface 1 has one endpoint(in).         E:\usb20\lighting2\autofiles\usbdsc.c
                                            * Then the CFG01 structure in the usbdsc.h should be:                           E:\usb20\lighting2\autofiles\usbdsc.c
                                            *                                                                               E:\usb20\lighting2\autofiles\usbdsc.c
                                            * #define CFG01 rom struct                            \                         E:\usb20\lighting2\autofiles\usbdsc.c
                                            * {   USB_CFG_DSC             cd01;                   \                         E:\usb20\lighting2\autofiles\usbdsc.c
                                            *     USB_INTF_DSC            i00a00;                 \                         E:\usb20\lighting2\autofiles\usbdsc.c
                                            *     USB_EP_DSC              ep01o_i00a00;           \                         E:\usb20\lighting2\autofiles\usbdsc.c
                                            *     USB_EP_DSC              ep01i_i00a00;           \                         E:\usb20\lighting2\autofiles\usbdsc.c
                                            *     USB_INTF_DSC            i01a00;                 \                         E:\usb20\lighting2\autofiles\usbdsc.c
                                            *     USB_EP_DSC              ep02i_i01a00;           \                         E:\usb20\lighting2\autofiles\usbdsc.c
                                            * } cfg01                                                                       E:\usb20\lighting2\autofiles\usbdsc.c
                                            *                                                                               E:\usb20\lighting2\autofiles\usbdsc.c
                                            * Note the hierarchy of the descriptors above, it follows the USB               E:\usb20\lighting2\autofiles\usbdsc.c
                                            * specification requirement. All endpoints belonging to an interface            E:\usb20\lighting2\autofiles\usbdsc.c
                                            * should be listed immediately after that interface.                            E:\usb20\lighting2\autofiles\usbdsc.c
                                            *                                                                               E:\usb20\lighting2\autofiles\usbdsc.c
                                            * -------------------------------------------------------------------           E:\usb20\lighting2\autofiles\usbdsc.c
                                            * Filling in the descriptor values in the usbdsc.c file:                        E:\usb20\lighting2\autofiles\usbdsc.c
                                            * -------------------------------------------------------------------           E:\usb20\lighting2\autofiles\usbdsc.c
                                            * Most items should be self-explanatory, however, a few will be                 E:\usb20\lighting2\autofiles\usbdsc.c
                                            * explained for clarification.                                                  E:\usb20\lighting2\autofiles\usbdsc.c
                                            *                                                                               E:\usb20\lighting2\autofiles\usbdsc.c
                                            * [Configuration Descriptor(USB_CFG_DSC)]                                       E:\usb20\lighting2\autofiles\usbdsc.c
                                            * The configuration attribute must always have the _DEFAULT                     E:\usb20\lighting2\autofiles\usbdsc.c
                                            * definition at the minimum. Additional options can be ORed                     E:\usb20\lighting2\autofiles\usbdsc.c
                                            * to the _DEFAULT attribute. Available options are _SELF and _RWU.              E:\usb20\lighting2\autofiles\usbdsc.c
                                            * These definitions are defined in the usbdefs_std_dsc.h file. The              E:\usb20\lighting2\autofiles\usbdsc.c
                                            * _SELF tells the USB host that this device is self-powered. The                E:\usb20\lighting2\autofiles\usbdsc.c
                                            * _RWU tells the USB host that this device supports Remote Wakeup.              E:\usb20\lighting2\autofiles\usbdsc.c
                                            *                                                                               E:\usb20\lighting2\autofiles\usbdsc.c
                                            * [Endpoint Descriptor(USB_EP_DSC)]                                             E:\usb20\lighting2\autofiles\usbdsc.c
                                            * Assume the following example:                                                 E:\usb20\lighting2\autofiles\usbdsc.c
                                            * sizeof(USB_EP_DSC),DSC_EP,_EP01_OUT,_BULK,64,0x00                             E:\usb20\lighting2\autofiles\usbdsc.c
                                            *                                                                               E:\usb20\lighting2\autofiles\usbdsc.c
                                            * The first two parameters are self-explanatory. They specify the               E:\usb20\lighting2\autofiles\usbdsc.c
                                            * length of this endpoint descriptor (7) and the descriptor type.               E:\usb20\lighting2\autofiles\usbdsc.c
                                            * The next parameter identifies the endpoint, the definitions are               E:\usb20\lighting2\autofiles\usbdsc.c
                                            * defined in usbdefs_std_dsc.h and has the following naming                     E:\usb20\lighting2\autofiles\usbdsc.c
                                            * convention:                                                                   E:\usb20\lighting2\autofiles\usbdsc.c
                                            * _EP<##>_<dir>                                                                 E:\usb20\lighting2\autofiles\usbdsc.c
                                            * where ## is the endpoint number and dir is the direction of                   E:\usb20\lighting2\autofiles\usbdsc.c
                                            * transfer. The dir has the value of either 'OUT' or 'IN'.                      E:\usb20\lighting2\autofiles\usbdsc.c
                                            * The next parameter identifies the type of the endpoint. Available             E:\usb20\lighting2\autofiles\usbdsc.c
                                            * options are _BULK, _INT, _ISO, and _CTRL. The _CTRL is not                    E:\usb20\lighting2\autofiles\usbdsc.c
                                            * typically used because the default control transfer endpoint is               E:\usb20\lighting2\autofiles\usbdsc.c
                                            * not defined in the USB descriptors. When _ISO option is used,                 E:\usb20\lighting2\autofiles\usbdsc.c
                                            * addition options can be ORed to _ISO. Example:                                E:\usb20\lighting2\autofiles\usbdsc.c
                                            * _ISO|_AD|_FE                                                                  E:\usb20\lighting2\autofiles\usbdsc.c
                                            * This describes the endpoint as an isochronous pipe with adaptive              E:\usb20\lighting2\autofiles\usbdsc.c
                                            * and feedback attributes. See usbdefs_std_dsc.h and the USB                    E:\usb20\lighting2\autofiles\usbdsc.c
                                            * specification for details. The next parameter defines the size of             E:\usb20\lighting2\autofiles\usbdsc.c
                                            * the endpoint. The last parameter in the polling interval.                     E:\usb20\lighting2\autofiles\usbdsc.c
                                            *                                                                               E:\usb20\lighting2\autofiles\usbdsc.c
                                            * -------------------------------------------------------------------           E:\usb20\lighting2\autofiles\usbdsc.c
                                            * Adding a USB String                                                           E:\usb20\lighting2\autofiles\usbdsc.c
                                            * -------------------------------------------------------------------           E:\usb20\lighting2\autofiles\usbdsc.c
                                            * A string descriptor array should have the following format:                   E:\usb20\lighting2\autofiles\usbdsc.c
                                            *                                                                               E:\usb20\lighting2\autofiles\usbdsc.c
                                            * rom struct{byte bLength;byte bDscType;word string[size];}sdxxx={              E:\usb20\lighting2\autofiles\usbdsc.c
                                            * sizeof(sdxxx),DSC_STR,<text>};                                                E:\usb20\lighting2\autofiles\usbdsc.c
                                            *                                                                               E:\usb20\lighting2\autofiles\usbdsc.c
                                            * The above structure provides a means for the C compiler to                    E:\usb20\lighting2\autofiles\usbdsc.c
                                            * calculate the length of string descriptor sdxxx, where xxx is the             E:\usb20\lighting2\autofiles\usbdsc.c
                                            * index number. The first two bytes of the descriptor are descriptor            E:\usb20\lighting2\autofiles\usbdsc.c
                                            * length and type. The rest <text> are string texts which must be               E:\usb20\lighting2\autofiles\usbdsc.c
                                            * in the unicode format. The unicode format is achieved by declaring            E:\usb20\lighting2\autofiles\usbdsc.c
                                            * each character as a word type. The whole text string is declared              E:\usb20\lighting2\autofiles\usbdsc.c
                                            * as a word array with the number of characters equals to <size>.               E:\usb20\lighting2\autofiles\usbdsc.c
                                            * <size> has to be manually counted and entered into the array                  E:\usb20\lighting2\autofiles\usbdsc.c
                                            * declaration. Let's study this through an example:                             E:\usb20\lighting2\autofiles\usbdsc.c
                                            * if the string is "USB" , then the string descriptor should be:                E:\usb20\lighting2\autofiles\usbdsc.c
                                            * (Using index 02)                                                              E:\usb20\lighting2\autofiles\usbdsc.c
                                            * rom struct{byte bLength;byte bDscType;word string[3];}sd002={                 E:\usb20\lighting2\autofiles\usbdsc.c
                                            * sizeof(sd002),DSC_STR,'U','S','B'};                                           E:\usb20\lighting2\autofiles\usbdsc.c
                                            *                                                                               E:\usb20\lighting2\autofiles\usbdsc.c
                                            * A USB project may have multiple strings and the firmware supports             E:\usb20\lighting2\autofiles\usbdsc.c
                                            * the management of multiple strings through a look-up table.                   E:\usb20\lighting2\autofiles\usbdsc.c
                                            * The look-up table is defined as:                                              E:\usb20\lighting2\autofiles\usbdsc.c
                                            * rom const unsigned char *rom USB_SD_Ptr[]={&sd000,&sd001,&sd002};             E:\usb20\lighting2\autofiles\usbdsc.c
                                            *                                                                               E:\usb20\lighting2\autofiles\usbdsc.c
                                            * The above declaration has 3 strings, sd000, sd001, and sd002.                 E:\usb20\lighting2\autofiles\usbdsc.c
                                            * Strings can be removed or added. sd000 is a specialized string                E:\usb20\lighting2\autofiles\usbdsc.c
                                            * descriptor. It defines the language code, usually this is                     E:\usb20\lighting2\autofiles\usbdsc.c
                                            * US English (0x0409). The index of the string must match the index             E:\usb20\lighting2\autofiles\usbdsc.c
                                            * position of the USB_SD_Ptr array, &sd000 must be in position                  E:\usb20\lighting2\autofiles\usbdsc.c
                                            * USB_SD_Ptr[0], &sd001 must be in position USB_SD_Ptr[1] and so on.            E:\usb20\lighting2\autofiles\usbdsc.c
                                            * The look-up table USB_SD_Ptr is used by the get string handler                E:\usb20\lighting2\autofiles\usbdsc.c
                                            * function in usb9.c.                                                           E:\usb20\lighting2\autofiles\usbdsc.c
                                            *                                                                               E:\usb20\lighting2\autofiles\usbdsc.c
                                            * -------------------------------------------------------------------           E:\usb20\lighting2\autofiles\usbdsc.c
                                            *                                                                               E:\usb20\lighting2\autofiles\usbdsc.c
                                            * The look-up table scheme also applies to the configuration                    E:\usb20\lighting2\autofiles\usbdsc.c
                                            * descriptor. A USB device may have multiple configuration                      E:\usb20\lighting2\autofiles\usbdsc.c
                                            * descriptors, i.e. CFG01, CFG02, etc. To add a configuration                   E:\usb20\lighting2\autofiles\usbdsc.c
                                            * descriptor, user must implement a structure similar to CFG01.                 E:\usb20\lighting2\autofiles\usbdsc.c
                                            * The next step is to add the configuration descriptor name, i.e.               E:\usb20\lighting2\autofiles\usbdsc.c
                                            * cfg01, cfg02,.., to the look-up table USB_CD_Ptr. USB_CD_Ptr[0]               E:\usb20\lighting2\autofiles\usbdsc.c
                                            * is a dummy place holder since configuration 0 is the un-configured            E:\usb20\lighting2\autofiles\usbdsc.c
                                            * state according to the definition in the USB specification.                   E:\usb20\lighting2\autofiles\usbdsc.c
                                            *                                                                               E:\usb20\lighting2\autofiles\usbdsc.c
                                            ********************************************************************/           E:\usb20\lighting2\autofiles\usbdsc.c
                                                                                                                            E:\usb20\lighting2\autofiles\usbdsc.c
                                           /*********************************************************************           E:\usb20\lighting2\autofiles\usbdsc.c
                                            * Descriptor specific type definitions are defined in:                          E:\usb20\lighting2\autofiles\usbdsc.c
                                            * system\usb\usbdefs\usbdefs_std_dsc.h                                          E:\usb20\lighting2\autofiles\usbdsc.c
                                            *                                                                               E:\usb20\lighting2\autofiles\usbdsc.c
                                            * Configuration information is defined in:                                      E:\usb20\lighting2\autofiles\usbdsc.c
                                            * autofiles\usbcfg.h                                                            E:\usb20\lighting2\autofiles\usbdsc.c
                                            ********************************************************************/           E:\usb20\lighting2\autofiles\usbdsc.c
                                                                                                                            E:\usb20\lighting2\autofiles\usbdsc.c
                                           /** I N C L U D E S *************************************************/           E:\usb20\lighting2\autofiles\usbdsc.c
                                           #include "system\typedefs.h"                                                     E:\usb20\lighting2\autofiles\usbdsc.c
                                           #include "system\usb\usb.h"                                                      E:\usb20\lighting2\autofiles\usbdsc.c
                                                                                                                            E:\usb20\lighting2\autofiles\usbdsc.c
                                           /** C O N S T A N T S ************************************************/          E:\usb20\lighting2\autofiles\usbdsc.c
                                           #pragma romdata                                                                  E:\usb20\lighting2\autofiles\usbdsc.c
                                                                                                                            E:\usb20\lighting2\autofiles\usbdsc.c
                                           /* Device Descriptor */                                                          E:\usb20\lighting2\autofiles\usbdsc.c
                                           rom USB_DEV_DSC device_dsc=                                                      E:\usb20\lighting2\autofiles\usbdsc.c
                                           {                                                                                E:\usb20\lighting2\autofiles\usbdsc.c
                                               sizeof(USB_DEV_DSC),    // Size of this descriptor in bytes                  E:\usb20\lighting2\autofiles\usbdsc.c
                                               DSC_DEV,                // DEVICE descriptor type                            E:\usb20\lighting2\autofiles\usbdsc.c
                                               0x0200,                 // USB Spec Release Number in BCD format             E:\usb20\lighting2\autofiles\usbdsc.c
                                               CDC_DEVICE,             // Class Code                                        E:\usb20\lighting2\autofiles\usbdsc.c
                                               0x00,                   // Subclass code                                     E:\usb20\lighting2\autofiles\usbdsc.c
                                               0x00,                   // Protocol code                                     E:\usb20\lighting2\autofiles\usbdsc.c
                                               EP0_BUFF_SIZE,          // Max packet size for EP0, see usbcfg.h             E:\usb20\lighting2\autofiles\usbdsc.c
                                               0x09B9,                 // Vendor ID                                         E:\usb20\lighting2\autofiles\usbdsc.c
                                               0x0047,                 // Product ID: CDC RS-232 Emulation Demo             E:\usb20\lighting2\autofiles\usbdsc.c
                                               0x0000,                 // Device release number in BCD format               E:\usb20\lighting2\autofiles\usbdsc.c
                                               0x01,                   // Manufacturer string index                         E:\usb20\lighting2\autofiles\usbdsc.c
                                               0x02,                   // Product string index                              E:\usb20\lighting2\autofiles\usbdsc.c
                                               0x00,                   // Device serial number string index                 E:\usb20\lighting2\autofiles\usbdsc.c
                                               0x01                    // Number of possible configurations                 E:\usb20\lighting2\autofiles\usbdsc.c
                                           };                                                                               E:\usb20\lighting2\autofiles\usbdsc.c
                                                                                                                            E:\usb20\lighting2\autofiles\usbdsc.c
                                           /* Configuration 1 Descriptor */                                                 E:\usb20\lighting2\autofiles\usbdsc.c
                                           CFG01=                                                                           E:\usb20\lighting2\autofiles\usbdsc.c
                                           {                                                                                E:\usb20\lighting2\autofiles\usbdsc.c
                                               /* Configuration Descriptor */                                               E:\usb20\lighting2\autofiles\usbdsc.c
                                               sizeof(USB_CFG_DSC),    // Size of this descriptor in bytes                  E:\usb20\lighting2\autofiles\usbdsc.c
                                               DSC_CFG,                // CONFIGURATION descriptor type                     E:\usb20\lighting2\autofiles\usbdsc.c
                                               sizeof(cfg01),          // Total length of data for this cfg                 E:\usb20\lighting2\autofiles\usbdsc.c
                                               2,                      // Number of interfaces in this cfg                  E:\usb20\lighting2\autofiles\usbdsc.c
                                               1,                      // Index value of this configuration                 E:\usb20\lighting2\autofiles\usbdsc.c
                                               0,                      // Configuration string index                        E:\usb20\lighting2\autofiles\usbdsc.c
                                               _DEFAULT,               // Attributes, see usbdefs_std_dsc.h                 E:\usb20\lighting2\autofiles\usbdsc.c
                                               50,                     // Max power consumption (2X mA)                     E:\usb20\lighting2\autofiles\usbdsc.c
                                                                                                                            E:\usb20\lighting2\autofiles\usbdsc.c
                                               /* Interface Descriptor */                                                   E:\usb20\lighting2\autofiles\usbdsc.c
                                               sizeof(USB_INTF_DSC),   // Size of this descriptor in bytes                  E:\usb20\lighting2\autofiles\usbdsc.c
                                               DSC_INTF,               // INTERFACE descriptor type                         E:\usb20\lighting2\autofiles\usbdsc.c
                                               0,                      // Interface Number                                  E:\usb20\lighting2\autofiles\usbdsc.c
                                               0,                      // Alternate Setting Number                          E:\usb20\lighting2\autofiles\usbdsc.c
                                               1,                      // Number of endpoints in this intf                  E:\usb20\lighting2\autofiles\usbdsc.c
                                               COMM_INTF,              // Class code                                        E:\usb20\lighting2\autofiles\usbdsc.c
                                               ABSTRACT_CONTROL_MODEL, // Subclass code                                     E:\usb20\lighting2\autofiles\usbdsc.c
                                               V25TER,                 // Protocol code                                     E:\usb20\lighting2\autofiles\usbdsc.c
                                               0,                      // Interface string index                            E:\usb20\lighting2\autofiles\usbdsc.c
                                                                                                                            E:\usb20\lighting2\autofiles\usbdsc.c
                                               /* CDC Class-Specific Descriptors */                                         E:\usb20\lighting2\autofiles\usbdsc.c
                                               sizeof(USB_CDC_HEADER_FN_DSC),CS_INTERFACE,DSC_FN_HEADER,0x0110,             E:\usb20\lighting2\autofiles\usbdsc.c
                                               sizeof(USB_CDC_ACM_FN_DSC),CS_INTERFACE,DSC_FN_ACM,0x02,                     E:\usb20\lighting2\autofiles\usbdsc.c
                                               sizeof(USB_CDC_UNION_FN_DSC),CS_INTERFACE,DSC_FN_UNION,CDC_COMM_INTF_ID,CDC_DATA_INTF_ID, E:\usb20\lighting2\autofiles\usbdsc.c
                                               sizeof(USB_CDC_CALL_MGT_FN_DSC),CS_INTERFACE,DSC_FN_CALL_MGT,0x00,CDC_DATA_INTF_ID, E:\usb20\lighting2\autofiles\usbdsc.c
                                                                                                                            E:\usb20\lighting2\autofiles\usbdsc.c
                                               /* Endpoint Descriptor */                                                    E:\usb20\lighting2\autofiles\usbdsc.c
                                               sizeof(USB_EP_DSC),DSC_EP,_EP02_IN,_INT,CDC_INT_EP_SIZE,0x02,                E:\usb20\lighting2\autofiles\usbdsc.c
                                                                                                                            E:\usb20\lighting2\autofiles\usbdsc.c
                                               /* Interface Descriptor */                                                   E:\usb20\lighting2\autofiles\usbdsc.c
                                               sizeof(USB_INTF_DSC),   // Size of this descriptor in bytes                  E:\usb20\lighting2\autofiles\usbdsc.c
                                               DSC_INTF,               // INTERFACE descriptor type                         E:\usb20\lighting2\autofiles\usbdsc.c
                                               1,                      // Interface Number                                  E:\usb20\lighting2\autofiles\usbdsc.c
                                               0,                      // Alternate Setting Number                          E:\usb20\lighting2\autofiles\usbdsc.c
                                               2,                      // Number of endpoints in this intf                  E:\usb20\lighting2\autofiles\usbdsc.c
                                               DATA_INTF,              // Class code                                        E:\usb20\lighting2\autofiles\usbdsc.c
                                               0,                      // Subclass code                                     E:\usb20\lighting2\autofiles\usbdsc.c
                                               NO_PROTOCOL,            // Protocol code                                     E:\usb20\lighting2\autofiles\usbdsc.c
                                               0,                      // Interface string index                            E:\usb20\lighting2\autofiles\usbdsc.c
                                                                                                                            E:\usb20\lighting2\autofiles\usbdsc.c
                                               /* Endpoint Descriptors */                                                   E:\usb20\lighting2\autofiles\usbdsc.c
                                               sizeof(USB_EP_DSC),DSC_EP,_EP03_OUT,_BULK,CDC_BULK_OUT_EP_SIZE,0x00,         E:\usb20\lighting2\autofiles\usbdsc.c
                                               sizeof(USB_EP_DSC),DSC_EP,_EP03_IN,_BULK,CDC_BULK_IN_EP_SIZE,0x00            E:\usb20\lighting2\autofiles\usbdsc.c
                                           };                                                                               E:\usb20\lighting2\autofiles\usbdsc.c
                                                                                                                            E:\usb20\lighting2\autofiles\usbdsc.c
                                           rom struct{byte bLength;byte bDscType;word string[1];}sd000={                    E:\usb20\lighting2\autofiles\usbdsc.c
                                           sizeof(sd000),DSC_STR,0x0409};                                                   E:\usb20\lighting2\autofiles\usbdsc.c
                                                                                                                            E:\usb20\lighting2\autofiles\usbdsc.c
                                           rom struct{byte bLength;byte bDscType;word string[25];}sd001={                   E:\usb20\lighting2\autofiles\usbdsc.c
                                           sizeof(sd001),DSC_STR,                                                           E:\usb20\lighting2\autofiles\usbdsc.c
                                           'M','i','c','r','o','c','h','i','p',' ',                                         E:\usb20\lighting2\autofiles\usbdsc.c
                                           'T','e','c','h','n','o','l','o','g','y',' ','I','n','c','.'};                    E:\usb20\lighting2\autofiles\usbdsc.c
                                                                                                                            E:\usb20\lighting2\autofiles\usbdsc.c
                                           rom struct{byte bLength;byte bDscType;word string[25];}sd002={                   E:\usb20\lighting2\autofiles\usbdsc.c
                                           sizeof(sd002),DSC_STR,                                                           E:\usb20\lighting2\autofiles\usbdsc.c
                                           'C','D','C',' ','R','S','-','2','3','2',' ',                                     E:\usb20\lighting2\autofiles\usbdsc.c
                                           'E','m','u','l','a','t','i','o','n',' ','D','e','m','o'};                        E:\usb20\lighting2\autofiles\usbdsc.c
                                                                                                                            E:\usb20\lighting2\autofiles\usbdsc.c
                                           rom const unsigned char *rom USB_CD_Ptr[]={&cfg01,&cfg01};                       E:\usb20\lighting2\autofiles\usbdsc.c
                                           rom const unsigned char *rom USB_SD_Ptr[]={&sd000,&sd001,&sd002};                E:\usb20\lighting2\autofiles\usbdsc.c
                                                                                                                            E:\usb20\lighting2\autofiles\usbdsc.c
                                           rom pFunc ClassReqHandler[1]=                                                    E:\usb20\lighting2\autofiles\usbdsc.c
                                           {                                                                                E:\usb20\lighting2\autofiles\usbdsc.c
                                               &USBCheckCDCRequest                                                          E:\usb20\lighting2\autofiles\usbdsc.c
                                           };                                                                               E:\usb20\lighting2\autofiles\usbdsc.c
                                                                                                                            E:\usb20\lighting2\autofiles\usbdsc.c
                                           #pragma code                                                                     E:\usb20\lighting2\autofiles\usbdsc.c
                                                                                                                            E:\usb20\lighting2\autofiles\usbdsc.c
                                           /** EOF usbdsc.c ****************************************************/           E:\usb20\lighting2\autofiles\usbdsc.c
