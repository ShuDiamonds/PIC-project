MP2COD 4.00, COFF to COD File Converter
Copyright (c) 2005 Microchip Technology Inc.
Listing File Generated: Wed Nov 02 23:29:45 2005


Address  Value    Disassembly              Source                                                                           File
-------  -------  -----------------------  -------------------------------------------------------------------------------  -----
                                           /*********************************************************************           E:\usb20\logger\main.c
                                           *                                                                                E:\usb20\logger\main.c
                                           *　USB接続 データロガーシステムプログラム                                        E:\usb20\logger\main.c
                                           *	USBフレームワーク修正情報                                                      E:\usb20\logger\main.c
                                           *　　コンフィギュレーションの設定変更                                            E:\usb20\logger\main.c
                                           *　　main.c　の変更　初期化削除　IO設定変更                                      E:\usb20\logger\main.c
                                           *　　io_cfg.hの変更　LED削除　IOモニタ削除                                       E:\usb20\logger\main.c
                                           *　　user.cの変更　　実行内容削除                                                E:\usb20\logger\main.c
                                           *　　usbcfg.hの変更　IOモニタ削除                                                E:\usb20\logger\main.c
                                           *                                                                                E:\usb20\logger\main.c
                                           *********************************************************************/           E:\usb20\logger\main.c
                                           #include <p18cxxx.h>                                                             E:\usb20\logger\main.c
                                           #include "system\typedefs.h"                      // Required                    E:\usb20\logger\main.c
                                           #include "system\usb\usb.h"                       // Required                    E:\usb20\logger\main.c
                                           #include "io_cfg.h"                               // Required                    E:\usb20\logger\main.c
                                           #include "system\usb\usb_compile_time_validation.h"                              E:\usb20\logger\main.c
                                           #include	"delays.h"                                                              E:\usb20\logger\main.c
                                           #include "lcd_lib.h"                                                             E:\usb20\logger\main.c
                                           #include	"i2c.h"                                                                 E:\usb20\logger\main.c
                                           #include "string.h"                                                              E:\usb20\logger\main.c
                                                                                                                            E:\usb20\logger\main.c
                                           //****変数定義　********************************************* */                 E:\usb20\logger\main.c
                                           #pragma udata                                                                    E:\usb20\logger\main.c
                                           char input_buffer[64];						// USB入力バッファ                                   E:\usb20\logger\main.c
                                           char output_buffer[64];						// USB出力バッファ                                  E:\usb20\logger\main.c
                                                                                                                            E:\usb20\logger\main.c
                                           char LogFlag, MsrFlag;						// ログ,計測開始フラグ                               E:\usb20\logger\main.c
                                           char Period;									// ログ周期定数エリア                                       E:\usb20\logger\main.c
                                           char PeriCounter;								// 周期用カウンタ                                       E:\usb20\logger\main.c
                                           unsigned int Result;							// アナログ計測データ                                 E:\usb20\logger\main.c
                                           float Battery;								// バッテリ電圧変数                                        E:\usb20\logger\main.c
                                           char ErrFlag, FullFlag;						// エラー、バッファ一杯フラグ                       E:\usb20\logger\main.c
                                           unsigned int	 WRAdrs, RDAdrs;					// EEPROMアドレス                              E:\usb20\logger\main.c
                                                                                                                            E:\usb20\logger\main.c
                                                                                                                            E:\usb20\logger\main.c
                                           char MsgStart[] ="Start!";						// 初期メッセージ                                E:\usb20\logger\main.c
                                           char MsgLCD1[] = "C0=xxxx  C1=xxxx";			// LCDメッセージ                          E:\usb20\logger\main.c
                                           char MsgLCD2[] = "BT=x.xxV xxxxxxx";			// バッテリ電圧表示                       E:\usb20\logger\main.c
                                           char MsgFull[] = "Full!! ";					// メモリオーバーフロー                          E:\usb20\logger\main.c
                                           char MsgErase[] ="EraseEEPROM ";				// EEPROｍ消去コマンド                       E:\usb20\logger\main.c
                                           char MsgEnd[] = "End!";                                                          E:\usb20\logger\main.c
                                           char MsgLow[]  = "Low Bat";					// 電池電圧低下                                  E:\usb20\logger\main.c
                                           char MsgPer[]  = "Pxx00ms";					// ログ周期表示                                  E:\usb20\logger\main.c
                                           char MsgMsr[]  = "Mesure ";					// 計測開始                                      E:\usb20\logger\main.c
                                           char MsgDmp[]  = "DumpAll";					// メモリ送信                                    E:\usb20\logger\main.c
                                           char MsgErr[]  = "Cmd Err";					// コマンドエラー表示                            E:\usb20\logger\main.c
                                           char MsgTest[] = "EEPROMTest xxxx";				// テスト                                 E:\usb20\logger\main.c
                                           char MsgTX[] = "CH0=xxxx  CH1=xxxx  BAT=xxxx\r\n";                               E:\usb20\logger\main.c
                                           unsigned char TXBuffer[64];					// USB送信バッファ                               E:\usb20\logger\main.c
                                                                                                                            E:\usb20\logger\main.c
                                           //** プロトタイピング *******************************/                           E:\usb20\logger\main.c
                                           unsigned int ADconv(char chan);                                                  E:\usb20\logger\main.c
                                           void SaveMem(unsigned int data);                                                 E:\usb20\logger\main.c
                                           void itostring(char digit, unsigned int data, char *buffer);                     E:\usb20\logger\main.c
                                           void ISRProcess(void);                                                           E:\usb20\logger\main.c
                                           void WriteMem(unsigned char data);                                               E:\usb20\logger\main.c
                                           unsigned char ReadMem(unsigned int adrs);                                        E:\usb20\logger\main.c
                                           void ftostring(int seisu, int shousu, float data, char *buffer);                 E:\usb20\logger\main.c
                                                                                                                            E:\usb20\logger\main.c
                                           ////// 割り込みベクタ定義　/////                                                 E:\usb20\logger\main.c
                                           #pragma code high_vector=0x08                                                    E:\usb20\logger\main.c
                                           void interrupt_at_high_vector(void)                                              E:\usb20\logger\main.c
                                           {                                                                                E:\usb20\logger\main.c
000008   ef1c     GOTO      0x38               _asm goto ISRProcess _endasm                                                 E:\usb20\logger\main.c
00000a   f000                                                                                                               
00000c   0012     RETURN    0x0            }                                                                                E:\usb20\logger\main.c
                                           #pragma code                                                                     E:\usb20\logger\main.c
                                                                                                                            E:\usb20\logger\main.c
                                           ////// タイマ0割り込み処理 100msec                                               E:\usb20\logger\main.c
                                           #pragma interrupt ISRProcess                                                     E:\usb20\logger\main.c
000038   cfda     MOVFF     0xfda,0xfe4    void ISRProcess(void)                                                            E:\usb20\logger\main.c
00003a   ffe4                                                                                                               
00003c   cfe2     MOVFF     0xfe2,0xfda                                                                                     
00003e   ffda                                                                                                               
000040   52e6     MOVF      0xe6,0x1,0x0                                                                                    
                                           {                                                                                E:\usb20\logger\main.c
000042   94f2     BCF       0xf2,0x2,0x0   	INTCONbits.T0IF = 0;				// Interrupt Flag Clear                                 E:\usb20\logger\main.c
000044   0eb6     MOVLW     0xb6           	TMR0H = 0xB6;						// 12MHz/64/18750=10Hz                                       E:\usb20\logger\main.c
000046   6ed7     MOVWF     0xd7,0x0                                                                                        
000048   0ec1     MOVLW     0xc1           	TMR0L = 0xC1;	                                                                  E:\usb20\logger\main.c
00004a   6ed6     MOVWF     0xd6,0x0                                                                                        
00004c   0101     MOVLB     0x1            	PeriCounter--;					// 周期カウンター１                                          E:\usb20\logger\main.c
00004e   0783     DECF      0x83,0x1,0x1                                                                                    
000050   5183     MOVF      0x83,0x0,0x1   	if(PeriCounter == 0)				// 周期一致                                             E:\usb20\logger\main.c
000052   e104     BNZ       0x5c                                                                                            
                                           	{                                                                               E:\usb20\logger\main.c
000054   0e01     MOVLW     0x1            		LogFlag = 1;					// ログ開始フラグオン                                         E:\usb20\logger\main.c
000056   6f80     MOVWF     0x80,0x1                                                                                        
000058   c182     MOVFF     0x182,0x183    		PeriCounter = Period;			// 周期カウンタ再セット                                E:\usb20\logger\main.c
00005a   f183                                                                                                               
                                           	}                                                                               E:\usb20\logger\main.c
00005c   b082     BTFSC     0x82,0x0,0x0   	if(PORTCbits.RC0 == 0)				// 開始、停止ボタンチェック                           E:\usb20\logger\main.c
00005e   d007     BRA       0x6e                                                                                            
                                           	{                                                                               E:\usb20\logger\main.c
000060   0e02     MOVLW     0x2            		if(MsrFlag == 2)				// 開始済みなら停止                                        E:\usb20\logger\main.c
000062   5d81     SUBWF     0x81,0x0,0x1                                                                                    
000064   e102     BNZ       0x6a                                                                                            
000066   6b81     CLRF      0x81,0x1       			MsrFlag = 0;                                                                  E:\usb20\logger\main.c
000068   d002     BRA       0x6e           		else                                                                           E:\usb20\logger\main.c
00006a   0e01     MOVLW     0x1            			MsrFlag = 1;				// 開始オン                                                   E:\usb20\logger\main.c
00006c   6f81     MOVWF     0x81,0x1                                                                                        
                                           	}                                                                               E:\usb20\logger\main.c
00006e   52e5     MOVF      0xe5,0x1,0x0   }                                                                                E:\usb20\logger\main.c
000070   cfe5     MOVFF     0xfe5,0xfda                                                                                     
000072   ffda                                                                                                               
000074   0011     RETFIE    0x1                                                                                             
                                                                                                                            E:\usb20\logger\main.c
                                           #pragma code                                                                     E:\usb20\logger\main.c
                                           /*********************************************************************           E:\usb20\logger\main.c
                                            * メイン処理                                                                    E:\usb20\logger\main.c
                                            ********************************************************************/           E:\usb20\logger\main.c
000076   cfd9     MOVFF     0xfd9,0xfe6    void main(void)                                                                  E:\usb20\logger\main.c
000078   ffe6                                                                                                               
00007a   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
00007c   ffd9                                                                                                               
00007e   0e03     MOVLW     0x3                                                                                             
000080   26e1     ADDWF     0xe1,0x1,0x0                                                                                    
                                           {                                                                                E:\usb20\logger\main.c
                                           	unsigned char i;                                                                E:\usb20\logger\main.c
                                           	unsigned int L;                                                                 E:\usb20\logger\main.c
                                           	                                                                                E:\usb20\logger\main.c
                                           	// I/O設定                                                                      E:\usb20\logger\main.c
000082   0e07     MOVLW     0x7            	CMCON = 0x07;						// コンパレータオフ                                          E:\usb20\logger\main.c
000084   6eb4     MOVWF     0xb4,0x0                                                                                        
000086   6a8a     CLRF      0x8a,0x0          	LATB = 0;							// 液晶表示ポートリセット                                    E:\usb20\logger\main.c
000088   0ec0     MOVLW     0xc0             	LATC  = 0xC0;						// LED off                                                 E:\usb20\logger\main.c
00008a   6e8b     MOVWF     0x8b,0x0                                                                                        
00008c   6892     SETF      0x92,0x0        	TRISA = 0xFF;						// 全入力                                                   E:\usb20\logger\main.c
00008e   6a93     CLRF      0x93,0x0       	TRISB = 0x0;						// 液晶表示                                                   E:\usb20\logger\main.c
000090   0e31     MOVLW     0x31            	TRISC = 0x31;						// LED Output Mode, SW input                                E:\usb20\logger\main.c
000092   6e94     MOVWF     0x94,0x0                                                                                        
                                            	// A/D初期設定                                                                 E:\usb20\logger\main.c
000094   0e1a     MOVLW     0x1a            	ADCON1 = 0x1A;					// AN0-AN2,AN4 Analog Input Vref+                           E:\usb20\logger\main.c
000096   6ec1     MOVWF     0xc1,0x0                                                                                        
000098   0e95     MOVLW     0x95            	ADCON2 = 0x95;					// 4Tad, Fosc/16                                            E:\usb20\logger\main.c
00009a   6ec0     MOVWF     0xc0,0x0                                                                                        
00009c   0e01     MOVLW     0x1             	ADCON0 = 0x01;					// AD on                                                    E:\usb20\logger\main.c
00009e   6ec2     MOVWF     0xc2,0x0                                                                                        
                                            	// タイマ初期化                                                                E:\usb20\logger\main.c
0000a0   0e85     MOVLW     0x85           	T0CON = 0x85;						// Int 1/64                                                  E:\usb20\logger\main.c
0000a2   6ed5     MOVWF     0xd5,0x0                                                                                        
0000a4   0eb6     MOVLW     0xb6           	TMR0H = 0xB6;						// 12MHz/64/18750=10Hz                                       E:\usb20\logger\main.c
0000a6   6ed7     MOVWF     0xd7,0x0                                                                                        
0000a8   0ec1     MOVLW     0xc1           	TMR0L = 0xC1;                                                                   E:\usb20\logger\main.c
0000aa   6ed6     MOVWF     0xd6,0x0                                                                                        
                                           	/// I2C初期化                                                                   E:\usb20\logger\main.c
0000ac   6ae6     CLRF      0xe6,0x0       	OpenI2C(MASTER, SLEW_ON);                                                       E:\usb20\logger\main.c
0000ae   0e08     MOVLW     0x8                                                                                             
0000b0   6ee6     MOVWF     0xe6,0x0                                                                                        
0000b2   ec36     CALL      0x206c,0x0                                                                                      
0000b4   f010                                                                                                               
0000b6   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0000b8   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0000ba   0e1b     MOVLW     0x1b           	SSPADD = 27;						//400kHz @48MHz                                               E:\usb20\logger\main.c
0000bc   6ec8     MOVWF     0xc8,0x0                                                                                        
                                           	/// USB初期化                                                                   E:\usb20\logger\main.c
0000be   0e14     MOVLW     0x14           	mInitializeUSBDriver();         	// See usbdrv.h                                E:\usb20\logger\main.c
0000c0   6e6f     MOVWF     0x6f,0x0                                                                                        
0000c2   0100     MOVLB     0x0                                                                                             
0000c4   6bfa     CLRF      0xfa,0x1                                                                                        
0000c6   0100     MOVLB     0x0                                                                                             
0000c8   6bfb     CLRF      0xfb,0x1                                                                                        
0000ca   0100     MOVLB     0x0                                                                                             
0000cc   6bfc     CLRF      0xfc,0x1                                                                                        
                                           	/// 液晶表示器初期化                                                            E:\usb20\logger\main.c
0000ce   ec5b     CALL      0x1cb6,0x0     	lcd_init();						// LCD初期化                                                   E:\usb20\logger\main.c
0000d0   f00e                                                                                                               
0000d2   0e60     MOVLW     0x60           	lcd_str(MsgStart);				// 初期メッセージ表示                                     E:\usb20\logger\main.c
0000d4   6ee6     MOVWF     0xe6,0x0                                                                                        
0000d6   0e00     MOVLW     0x0                                                                                             
0000d8   6ee6     MOVWF     0xe6,0x0                                                                                        
0000da   ec3b     CALL      0x1c76,0x0                                                                                      
0000dc   f00e                                                                                                               
0000de   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0000e0   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0000e2   0ef4     MOVLW     0xf4           	Delay10KTCYx(500);				// 0.5秒                                                  E:\usb20\logger\main.c
0000e4   6ee6     MOVWF     0xe6,0x0                                                                                        
0000e6   ec69     CALL      0x20d2,0x0                                                                                      
0000e8   f010                                                                                                               
0000ea   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                           	/// 変数初期化                                                                  E:\usb20\logger\main.c
0000ec   0101     MOVLB     0x1            	Period = 10;                                                                    E:\usb20\logger\main.c
0000ee   0e0a     MOVLW     0xa                                                                                             
0000f0   6f82     MOVWF     0x82,0x1                                                                                        
0000f2   6f83     MOVWF     0x83,0x1       	PeriCounter = 10;                                                               E:\usb20\logger\main.c
0000f4   6b8c     CLRF      0x8c,0x1       	WRAdrs = 0;                                                                     E:\usb20\logger\main.c
0000f6   6b8d     CLRF      0x8d,0x1                                                                                        
0000f8   6b8e     CLRF      0x8e,0x1       	RDAdrs = 0;                                                                     E:\usb20\logger\main.c
0000fa   6b8f     CLRF      0x8f,0x1                                                                                        
0000fc   6b80     CLRF      0x80,0x1       	LogFlag = 0;                                                                    E:\usb20\logger\main.c
0000fe   6b81     CLRF      0x81,0x1       	MsrFlag = 0;                                                                    E:\usb20\logger\main.c
000100   6b8b     CLRF      0x8b,0x1       	FullFlag = 0;                                                                   E:\usb20\logger\main.c
                                           	// Enable Interrupt                                                             E:\usb20\logger\main.c
000102   9ed0     BCF       0xd0,0x7,0x0   	RCONbits.IPEN = 0;				// No Priority                                            E:\usb20\logger\main.c
000104   0ea0     MOVLW     0xa0           	INTCON = 0xA0;					// Enable Interrupt                                          E:\usb20\logger\main.c
000106   6ef2     MOVWF     0xf2,0x0                                                                                        
                                           	                                                                                E:\usb20\logger\main.c
                                               /// メインループ                                                             E:\usb20\logger\main.c
000722   d4f2     BRA       0x108              while(1)                                                                     E:\usb20\logger\main.c
                                               {                                                                            E:\usb20\logger\main.c
000108   eca5     CALL      0x1d4a,0x0         		USBCheckBusStatus();        						// USB接続チェック                       E:\usb20\logger\main.c
00010a   f00e                                                                                                               
00010c   be6f     BTFSC     0x6f,0x7,0x0       		if(UCFGbits.UTEYE!=1)								// アイパターンモードオフか                   E:\usb20\logger\main.c
00010e   d002     BRA       0x114                                                                                           
000110   ecc4     CALL      0x1d88,0x0         			USBDriverService();							// USBイベントポーリング                        E:\usb20\logger\main.c
000112   f00e                                                                                                               
000114   ec5b     CALL      0x14b6,0x0     		CDCTxService();									// クラス送受信実行                                    E:\usb20\logger\main.c
000116   f00a                                                                                                               
                                           		/// 送受信データの処理実行                                                     E:\usb20\logger\main.c
000118   0e06     MOVLW     0x6            		if((usb_device_state >= CONFIGURED_STATE)&&(UCONbits.SUSPND==0))               E:\usb20\logger\main.c
00011a   0100     MOVLB     0x0                                                                                             
00011c   5dfa     SUBWF     0xfa,0x0,0x1                                                                                    
00011e   e201     BC        0x122                                                                                           
000120   d211     BRA       0x544                                                                                           
000122   506d     MOVF      0x6d,0x0,0x0                                                                                    
000124   0b02     ANDLW     0x2                                                                                             
000126   e001     BZ        0x12a                                                                                           
000128   d20d     BRA       0x544                                                                                           
                                           		{                                                                              E:\usb20\logger\main.c
00012a   0e40     MOVLW     0x40               			if(getsUSBUSART(input_buffer,64))				// データ受信ポール                  E:\usb20\logger\main.c
00012c   6ee6     MOVWF     0xe6,0x0                                                                                        
00012e   0e00     MOVLW     0x0                                                                                             
000130   6ee6     MOVWF     0xe6,0x0                                                                                        
000132   0e01     MOVLW     0x1                                                                                             
000134   6ee6     MOVWF     0xe6,0x0                                                                                        
000136   eca0     CALL      0x1340,0x0                                                                                      
000138   f009                                                                                                               
00013a   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00013c   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00013e   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000140   0900     IORLW     0x0                                                                                             
000142   e101     BNZ       0x146                                                                                           
000144   d1ff     BRA       0x544                                                                                           
                                               			{                                                                         E:\usb20\logger\main.c
000146   7e8b     BTG       0x8b,0x7,0x0               		LATCbits.LATC7 = !LATCbits.LATC7;			// LED反転                     E:\usb20\logger\main.c
000148   0101     MOVLB     0x1            	    			switch(input_buffer[0])					// 最初の１文字チェック                      E:\usb20\logger\main.c
00014a   5100     MOVF      0x0,0x0,0x1                                                                                     
00014c   0a37     XORLW     0x37                                                                                            
00014e   e101     BNZ       0x152                                                                                           
000150   d1f1     BRA       0x534                                                                                           
000152   0a01     XORLW     0x1                                                                                             
000154   e101     BNZ       0x158                                                                                           
000156   d198     BRA       0x488                                                                                           
000158   0a03     XORLW     0x3                                                                                             
00015a   e101     BNZ       0x15e                                                                                           
00015c   d16c     BRA       0x436                                                                                           
00015e   0a01     XORLW     0x1                                                                                             
000160   e101     BNZ       0x164                                                                                           
000162   d124     BRA       0x3ac                                                                                           
000164   0a07     XORLW     0x7                                                                                             
000166   e101     BNZ       0x16a                                                                                           
000168   d0da     BRA       0x31e                                                                                           
00016a   0a01     XORLW     0x1                                                                                             
00016c   e068     BZ        0x23e                                                                                           
00016e   0a03     XORLW     0x3                                                                                             
000170   e034     BZ        0x1da                                                                                           
000172   0a01     XORLW     0x1                                                                                             
000174   e021     BZ        0x1b8                                                                                           
                                           	    			{                                                                        E:\usb20\logger\main.c
                                           		    			case '0':	// 初期設定とオープン                                         E:\usb20\logger\main.c
0001b8   6b8e     CLRF      0x8e,0x1       						RDAdrs = 0;						// アドレス初期値セット                                   E:\usb20\logger\main.c
0001ba   6b8f     CLRF      0x8f,0x1                                                                                        
0001bc   6b8c     CLRF      0x8c,0x1       						WRAdrs = 0;                                                                E:\usb20\logger\main.c
0001be   6b8d     CLRF      0x8d,0x1                                                                                        
0001c0   6b81     CLRF      0x81,0x1       						MsrFlag = 0;						// 計測停止		    				                                    E:\usb20\logger\main.c
0001c2   0101     MOVLB     0x1                       			    	if(mUSBUSARTIsTxTrfReady())		// 送信可能か？                  E:\usb20\logger\main.c
0001c4   51d1     MOVF      0xd1,0x0,0x1                                                                                    
0001c6   e108     BNZ       0x1d8                                                                                           
0001c8   0e5a     MOVLW     0x5a                   		   			 	putrsUSBUSART("OK");			// OKデータ送信                         E:\usb20\logger\main.c
0001ca   6ee6     MOVWF     0xe6,0x0                                                                                        
0001cc   0e21     MOVLW     0x21                                                                                            
0001ce   6ee6     MOVWF     0xe6,0x0                                                                                        
0001d0   ec1d     CALL      0x143a,0x0                                                                                      
0001d2   f00a                                                                                                               
0001d4   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0001d6   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0001d8   d1b5     BRA       0x544                  		   			 break;         			 	                                            E:\usb20\logger\main.c
                                           		    			case '1':	// 周期設定                                                   E:\usb20\logger\main.c
0001da   c101     MOVFF     0x101,0x182    						Period = input_buffer[1];			// 周期データ取得                              E:\usb20\logger\main.c
0001dc   f182                                                                                                               
0001de   0eab     MOVLW     0xab           						strcpy(MsgLCD2+9, MsgPer);			// 周期表示                                   E:\usb20\logger\main.c
0001e0   6ee6     MOVWF     0xe6,0x0                                                                                        
0001e2   0e00     MOVLW     0x0                                                                                             
0001e4   6ee6     MOVWF     0xe6,0x0                                                                                        
0001e6   0e81     MOVLW     0x81                                                                                            
0001e8   6ee6     MOVWF     0xe6,0x0                                                                                        
0001ea   0e00     MOVLW     0x0                                                                                             
0001ec   6ee6     MOVWF     0xe6,0x0                                                                                        
0001ee   ec15     CALL      0x202a,0x0                                                                                      
0001f0   f010                                                                                                               
0001f2   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0001f4   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0001f6   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0001f8   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0001fa   0e82     MOVLW     0x82           						itostring(2, Period, MsgLCD2+10);                                          E:\usb20\logger\main.c
0001fc   6ee6     MOVWF     0xe6,0x0                                                                                        
0001fe   0e00     MOVLW     0x0                                                                                             
000200   6ee6     MOVWF     0xe6,0x0                                                                                        
000202   c182     MOVFF     0x182,0x14                                                                                      
000204   f014                                                                                                               
000206   6a15     CLRF      0x15,0x0                                                                                        
000208   be14     BTFSC     0x14,0x7,0x0                                                                                    
00020a   6815     SETF      0x15,0x0                                                                                        
00020c   c014     MOVFF     0x14,0xfe6                                                                                      
00020e   ffe6                                                                                                               
000210   c015     MOVFF     0x15,0xfe6                                                                                      
000212   ffe6                                                                                                               
000214   0e02     MOVLW     0x2                                                                                             
000216   6ee6     MOVWF     0xe6,0x0                                                                                        
000218   dbf5     RCALL     0xa04                                                                                           
00021a   6ef5     MOVWF     0xf5,0x0                                                                                        
00021c   0e05     MOVLW     0x5                                                                                             
00021e   5ee1     SUBWF     0xe1,0x1,0x0                                                                                    
000220   50f5     MOVF      0xf5,0x0,0x0                                                                                    
000222   0ec0     MOVLW     0xc0           						lcd_cmd(0xC0);                                                             E:\usb20\logger\main.c
000224   6ee6     MOVWF     0xe6,0x0                                                                                        
000226   ec0e     CALL      0x1c1c,0x0                                                                                      
000228   f00e                                                                                                               
00022a   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00022c   0e78     MOVLW     0x78           						lcd_str(MsgLCD2);                                                          E:\usb20\logger\main.c
00022e   6ee6     MOVWF     0xe6,0x0                                                                                        
000230   0e00     MOVLW     0x0                                                                                             
000232   6ee6     MOVWF     0xe6,0x0                                                                                        
000234   ec3b     CALL      0x1c76,0x0                                                                                      
000236   f00e                                                                                                               
000238   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00023a   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00023c   d183     BRA       0x544                     			 	break;                                                           E:\usb20\logger\main.c
                                                      			case '2':	// データ直接送信                                        E:\usb20\logger\main.c
00023e   0ec0     MOVLW     0xc0            						lcd_cmd(0xC0);                                                            E:\usb20\logger\main.c
000240   6ee6     MOVWF     0xe6,0x0                                                                                        
000242   ec0e     CALL      0x1c1c,0x0                                                                                      
000244   f00e                                                                                                               
000246   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000248   0eb3     MOVLW     0xb3           						strcpy(MsgLCD2+9, MsgMsr);			// 計測開始表示                               E:\usb20\logger\main.c
00024a   6ee6     MOVWF     0xe6,0x0                                                                                        
00024c   0e00     MOVLW     0x0                                                                                             
00024e   6ee6     MOVWF     0xe6,0x0                                                                                        
000250   0e81     MOVLW     0x81                                                                                            
000252   6ee6     MOVWF     0xe6,0x0                                                                                        
000254   0e00     MOVLW     0x0                                                                                             
000256   6ee6     MOVWF     0xe6,0x0                                                                                        
000258   ec15     CALL      0x202a,0x0                                                                                      
00025a   f010                                                                                                               
00025c   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00025e   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000260   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000262   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000264   0e78     MOVLW     0x78           						lcd_str(MsgLCD2);	          			                                            E:\usb20\logger\main.c
000266   6ee6     MOVWF     0xe6,0x0                                                                                        
000268   0e00     MOVLW     0x0                                                                                             
00026a   6ee6     MOVWF     0xe6,0x0                                                                                        
00026c   ec3b     CALL      0x1c76,0x0                                                                                      
00026e   f00e                                                                                                               
000270   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000272   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000274   0101     MOVLB     0x1                       			    	if(mUSBUSARTIsTxTrfReady())		// 送信可能か？                  E:\usb20\logger\main.c
000276   51d1     MOVF      0xd1,0x0,0x1                                                                                    
000278   e151     BNZ       0x31c                                                                                           
                                                   					{                                                                   E:\usb20\logger\main.c
00027a   6ae6     CLRF      0xe6,0x0       		    					Result = ADconv(0);			// CH0測定                                      E:\usb20\logger\main.c
00027c   da5f     RCALL     0x73c                                                                                           
00027e   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000280   cff3     MOVFF     0xff3,0x184                                                                                     
000282   f184                                                                                                               
000284   cff4     MOVFF     0xff4,0x185                                                                                     
000286   f185                                                                                                               
000288   0edf     MOVLW     0xdf           		    					itostring(4, Result, MsgTX+4);                                        E:\usb20\logger\main.c
00028a   6ee6     MOVWF     0xe6,0x0                                                                                        
00028c   0e00     MOVLW     0x0                                                                                             
00028e   6ee6     MOVWF     0xe6,0x0                                                                                        
000290   c184     MOVFF     0x184,0xfe6                                                                                     
000292   ffe6                                                                                                               
000294   c185     MOVFF     0x185,0xfe6                                                                                     
000296   ffe6                                                                                                               
000298   0e04     MOVLW     0x4                                                                                             
00029a   6ee6     MOVWF     0xe6,0x0                                                                                        
00029c   dbb3     RCALL     0xa04                                                                                           
00029e   6ef5     MOVWF     0xf5,0x0                                                                                        
0002a0   0e05     MOVLW     0x5                                                                                             
0002a2   5ee1     SUBWF     0xe1,0x1,0x0                                                                                    
0002a4   50f5     MOVF      0xf5,0x0,0x0                                                                                    
0002a6   0e01     MOVLW     0x1            	           			 	Result = ADconv(1);			// CH1測定                                E:\usb20\logger\main.c
0002a8   6ee6     MOVWF     0xe6,0x0                                                                                        
0002aa   da48     RCALL     0x73c                                                                                           
0002ac   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0002ae   cff3     MOVFF     0xff3,0x184                                                                                     
0002b0   f184                                                                                                               
0002b2   cff4     MOVFF     0xff4,0x185                                                                                     
0002b4   f185                                                                                                               
0002b6   0ee9     MOVLW     0xe9               		       			 	itostring(4, Result, MsgTX+14);                                E:\usb20\logger\main.c
0002b8   6ee6     MOVWF     0xe6,0x0                                                                                        
0002ba   0e00     MOVLW     0x0                                                                                             
0002bc   6ee6     MOVWF     0xe6,0x0                                                                                        
0002be   c184     MOVFF     0x184,0xfe6                                                                                     
0002c0   ffe6                                                                                                               
0002c2   c185     MOVFF     0x185,0xfe6                                                                                     
0002c4   ffe6                                                                                                               
0002c6   0e04     MOVLW     0x4                                                                                             
0002c8   6ee6     MOVWF     0xe6,0x0                                                                                        
0002ca   db9c     RCALL     0xa04                                                                                           
0002cc   6ef5     MOVWF     0xf5,0x0                                                                                        
0002ce   0e05     MOVLW     0x5                                                                                             
0002d0   5ee1     SUBWF     0xe1,0x1,0x0                                                                                    
0002d2   50f5     MOVF      0xf5,0x0,0x0                                                                                    
0002d4   0e04     MOVLW     0x4            	           			 	Result = ADconv(4);			// CH4測定                                E:\usb20\logger\main.c
0002d6   6ee6     MOVWF     0xe6,0x0                                                                                        
0002d8   da31     RCALL     0x73c                                                                                           
0002da   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0002dc   cff3     MOVFF     0xff3,0x184                                                                                     
0002de   f184                                                                                                               
0002e0   cff4     MOVFF     0xff4,0x185                                                                                     
0002e2   f185                                                                                                               
0002e4   0ef3     MOVLW     0xf3                	      			 	itostring(4, Result, MsgTX+24);                                 E:\usb20\logger\main.c
0002e6   6ee6     MOVWF     0xe6,0x0                                                                                        
0002e8   0e00     MOVLW     0x0                                                                                             
0002ea   6ee6     MOVWF     0xe6,0x0                                                                                        
0002ec   c184     MOVFF     0x184,0xfe6                                                                                     
0002ee   ffe6                                                                                                               
0002f0   c185     MOVFF     0x185,0xfe6                                                                                     
0002f2   ffe6                                                                                                               
0002f4   0e04     MOVLW     0x4                                                                                             
0002f6   6ee6     MOVWF     0xe6,0x0                                                                                        
0002f8   db85     RCALL     0xa04                                                                                           
0002fa   6ef5     MOVWF     0xf5,0x0                                                                                        
0002fc   0e05     MOVLW     0x5                                                                                             
0002fe   5ee1     SUBWF     0xe1,0x1,0x0                                                                                    
000300   50f5     MOVF      0xf5,0x0,0x0                                                                                    
                                                	      			 	                                                                E:\usb20\logger\main.c
000302   0101     MOVLB     0x1                    		   			 	mUSBUSARTTxRam((byte*)(MsgTX), 30);	// データ送信              E:\usb20\logger\main.c
000304   0edb     MOVLW     0xdb                                                                                            
000306   6fd2     MOVWF     0xd2,0x1                                                                                        
000308   0e00     MOVLW     0x0                                                                                             
00030a   6fd3     MOVWF     0xd3,0x1                                                                                        
00030c   0101     MOVLB     0x1                                                                                             
00030e   0e1e     MOVLW     0x1e                                                                                            
000310   6fd6     MOVWF     0xd6,0x1                                                                                        
000312   0101     MOVLB     0x1                                                                                             
000314   6bd7     CLRF      0xd7,0x1                                                                                        
000316   0101     MOVLB     0x1                                                                                             
000318   0e01     MOVLW     0x1                                                                                             
00031a   6fd1     MOVWF     0xd1,0x1                                                                                        
                                                    		   		}                                                                E:\usb20\logger\main.c
00031c   d113     BRA       0x544                     				break;                                                            E:\usb20\logger\main.c
                                                      			case '3':	// メモリダンプ                                          E:\usb20\logger\main.c
00031e   0ec0     MOVLW     0xc0             						lcd_cmd(0xC0);                                                           E:\usb20\logger\main.c
000320   6ee6     MOVWF     0xe6,0x0                                                                                        
000322   ec0e     CALL      0x1c1c,0x0                                                                                      
000324   f00e                                                                                                               
000326   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000328   0ebb     MOVLW     0xbb           						strcpy(MsgLCD2+9, MsgDmp);			// メモリダンプ表示                           E:\usb20\logger\main.c
00032a   6ee6     MOVWF     0xe6,0x0                                                                                        
00032c   0e00     MOVLW     0x0                                                                                             
00032e   6ee6     MOVWF     0xe6,0x0                                                                                        
000330   0e81     MOVLW     0x81                                                                                            
000332   6ee6     MOVWF     0xe6,0x0                                                                                        
000334   0e00     MOVLW     0x0                                                                                             
000336   6ee6     MOVWF     0xe6,0x0                                                                                        
000338   ec15     CALL      0x202a,0x0                                                                                      
00033a   f010                                                                                                               
00033c   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00033e   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000340   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000342   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000344   0e78     MOVLW     0x78           						lcd_str(MsgLCD2);	          			                                            E:\usb20\logger\main.c
000346   6ee6     MOVWF     0xe6,0x0                                                                                        
000348   0e00     MOVLW     0x0                                                                                             
00034a   6ee6     MOVWF     0xe6,0x0                                                                                        
00034c   ec3b     CALL      0x1c76,0x0                                                                                      
00034e   f00e                                                                                                               
000350   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000352   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000354   0101     MOVLB     0x1                   					if(mUSBUSARTIsTxTrfReady())		// 送信可能か                           E:\usb20\logger\main.c
000356   51d1     MOVF      0xd1,0x0,0x1                                                                                    
000358   e128     BNZ       0x3aa                                                                                           
                                           	       				{                                                                    E:\usb20\logger\main.c
00035a   6adf     CLRF      0xdf,0x0       							for(i=0; i<64; i++)			// 64バイト分読み出し                               E:\usb20\logger\main.c
00035c   0e40     MOVLW     0x40                                                                                            
00035e   5cdf     SUBWF     0xdf,0x0,0x0                                                                                    
000360   e217     BC        0x390                                                                                           
00038c   2adf     INCF      0xdf,0x1,0x0                                                                                    
00038e   d7e6     BRA       0x35c                                                                                           
                                           							{                                                                         E:\usb20\logger\main.c
000362   c18e     MOVFF     0x18e,0xfe6             						TXBuffer[i] = ReadMem(RDAdrs);	// 現在アドレスのデータ            E:\usb20\logger\main.c
000364   ffe6                                                                                                               
000366   c18f     MOVFF     0x18f,0xfe6                                                                                     
000368   ffe6                                                                                                               
00036a   dac3     RCALL     0x8f2                                                                                           
00036c   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00036e   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000370   6ee6     MOVWF     0xe6,0x0                                                                                        
000372   50df     MOVF      0xdf,0x0,0x0                                                                                    
000374   6aea     CLRF      0xea,0x0                                                                                        
000376   0f90     ADDLW     0x90                                                                                            
000378   6ee9     MOVWF     0xe9,0x0                                                                                        
00037a   0e01     MOVLW     0x1                                                                                             
00037c   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
00037e   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000380   50e7     MOVF      0xe7,0x0,0x0                                                                                    
000382   6eef     MOVWF     0xef,0x0                                                                                        
000384   0101     MOVLB     0x1                    							RDAdrs++;				// アドレス＋１                                      E:\usb20\logger\main.c
000386   2b8e     INCF      0x8e,0x1,0x1                                                                                    
000388   0e00     MOVLW     0x0                                                                                             
00038a   238f     ADDWFC    0x8f,0x1,0x1                                                                                    
                                                   						}                                                                  E:\usb20\logger\main.c
000390   0101     MOVLB     0x1            							mUSBUSARTTxRam(TXBuffer, 64);	// データ送信                               E:\usb20\logger\main.c
000392   0e90     MOVLW     0x90                                                                                            
000394   6fd2     MOVWF     0xd2,0x1                                                                                        
000396   0e01     MOVLW     0x1                                                                                             
000398   6fd3     MOVWF     0xd3,0x1                                                                                        
00039a   0101     MOVLB     0x1                                                                                             
00039c   0e40     MOVLW     0x40                                                                                            
00039e   6fd6     MOVWF     0xd6,0x1                                                                                        
0003a0   0101     MOVLB     0x1                                                                                             
0003a2   6bd7     CLRF      0xd7,0x1                                                                                        
0003a4   0101     MOVLB     0x1                                                                                             
0003a6   0e01     MOVLW     0x1                                                                                             
0003a8   6fd1     MOVWF     0xd1,0x1                                                                                        
                                           						}                                                                          E:\usb20\logger\main.c
0003aa   d0cc     BRA       0x544          						break;                                                                     E:\usb20\logger\main.c
                                           					case '4':	// メモリReadテスト                                               E:\usb20\logger\main.c
0003ac   0101     MOVLB     0x1                   					if(mUSBUSARTIsTxTrfReady())		// 送信可能か                           E:\usb20\logger\main.c
0003ae   51d1     MOVF      0xd1,0x0,0x1                                                                                    
0003b0   e141     BNZ       0x434                                                                                           
                                           						{                                                                          E:\usb20\logger\main.c
0003b2   ec36     CALL      0x1c6c,0x0     							lcd_clear();                                                              E:\usb20\logger\main.c
0003b4   f00e                                                                                                               
0003b6   0ed6     MOVLW     0xd6           							itostring(4, RDAdrs, MsgTest+11);                                         E:\usb20\logger\main.c
0003b8   6ee6     MOVWF     0xe6,0x0                                                                                        
0003ba   0e00     MOVLW     0x0                                                                                             
0003bc   6ee6     MOVWF     0xe6,0x0                                                                                        
0003be   c18e     MOVFF     0x18e,0xfe6                                                                                     
0003c0   ffe6                                                                                                               
0003c2   c18f     MOVFF     0x18f,0xfe6                                                                                     
0003c4   ffe6                                                                                                               
0003c6   0e04     MOVLW     0x4                                                                                             
0003c8   6ee6     MOVWF     0xe6,0x0                                                                                        
0003ca   db1c     RCALL     0xa04                                                                                           
0003cc   6ef5     MOVWF     0xf5,0x0                                                                                        
0003ce   0e05     MOVLW     0x5                                                                                             
0003d0   5ee1     SUBWF     0xe1,0x1,0x0                                                                                    
0003d2   50f5     MOVF      0xf5,0x0,0x0                                                                                    
0003d4   0ecb     MOVLW     0xcb           							lcd_str(MsgTest);				// 現在アドレス表示                                  E:\usb20\logger\main.c
0003d6   6ee6     MOVWF     0xe6,0x0                                                                                        
0003d8   0e00     MOVLW     0x0                                                                                             
0003da   6ee6     MOVWF     0xe6,0x0                                                                                        
0003dc   ec3b     CALL      0x1c76,0x0                                                                                      
0003de   f00e                                                                                                               
0003e0   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0003e2   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0003e4   6adf     CLRF      0xdf,0x0       							for(i=0; i<64; i++)			// 64バイト読み出し                                 E:\usb20\logger\main.c
0003e6   0e40     MOVLW     0x40                                                                                            
0003e8   5cdf     SUBWF     0xdf,0x0,0x0                                                                                    
0003ea   e217     BC        0x41a                                                                                           
000416   2adf     INCF      0xdf,0x1,0x0                                                                                    
000418   d7e6     BRA       0x3e6                                                                                           
                                           							{                                                                         E:\usb20\logger\main.c
0003ec   c18e     MOVFF     0x18e,0xfe6    								TXBuffer[i] = ReadMem(RDAdrs);	// ASCIIコードとして表示                  E:\usb20\logger\main.c
0003ee   ffe6                                                                                                               
0003f0   c18f     MOVFF     0x18f,0xfe6                                                                                     
0003f2   ffe6                                                                                                               
0003f4   da7e     RCALL     0x8f2                                                                                           
0003f6   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0003f8   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0003fa   6ee6     MOVWF     0xe6,0x0                                                                                        
0003fc   50df     MOVF      0xdf,0x0,0x0                                                                                    
0003fe   6aea     CLRF      0xea,0x0                                                                                        
000400   0f90     ADDLW     0x90                                                                                            
000402   6ee9     MOVWF     0xe9,0x0                                                                                        
000404   0e01     MOVLW     0x1                                                                                             
000406   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
000408   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00040a   50e7     MOVF      0xe7,0x0,0x0                                                                                    
00040c   6eef     MOVWF     0xef,0x0                                                                                        
00040e   0101     MOVLB     0x1            								RDAdrs ++;                                                               E:\usb20\logger\main.c
000410   2b8e     INCF      0x8e,0x1,0x1                                                                                    
000412   0e00     MOVLW     0x0                                                                                             
000414   238f     ADDWFC    0x8f,0x1,0x1                                                                                    
                                           							}                                                                         E:\usb20\logger\main.c
00041a   0101     MOVLB     0x1            							mUSBUSARTTxRam(TXBuffer, 64);	// データ送信	                              E:\usb20\logger\main.c
00041c   0e90     MOVLW     0x90                                                                                            
00041e   6fd2     MOVWF     0xd2,0x1                                                                                        
000420   0e01     MOVLW     0x1                                                                                             
000422   6fd3     MOVWF     0xd3,0x1                                                                                        
000424   0101     MOVLB     0x1                                                                                             
000426   0e40     MOVLW     0x40                                                                                            
000428   6fd6     MOVWF     0xd6,0x1                                                                                        
00042a   0101     MOVLB     0x1                                                                                             
00042c   6bd7     CLRF      0xd7,0x1                                                                                        
00042e   0101     MOVLB     0x1                                                                                             
000430   0e01     MOVLW     0x1                                                                                             
000432   6fd1     MOVWF     0xd1,0x1                                                                                        
                                           						}                                                                          E:\usb20\logger\main.c
000434   d087     BRA       0x544          						break;                                                                     E:\usb20\logger\main.c
                                           					case '5':	// メモリWriteテスト実行                                          E:\usb20\logger\main.c
000436   ec36     CALL      0x1c6c,0x0     						lcd_clear();                                                               E:\usb20\logger\main.c
000438   f00e                                                                                                               
00043a   0ed6     MOVLW     0xd6           						itostring(4, WRAdrs, MsgTest+11);	// 書き込みテスト表示                    E:\usb20\logger\main.c
00043c   6ee6     MOVWF     0xe6,0x0                                                                                        
00043e   0e00     MOVLW     0x0                                                                                             
000440   6ee6     MOVWF     0xe6,0x0                                                                                        
000442   c18c     MOVFF     0x18c,0xfe6                                                                                     
000444   ffe6                                                                                                               
000446   c18d     MOVFF     0x18d,0xfe6                                                                                     
000448   ffe6                                                                                                               
00044a   0e04     MOVLW     0x4                                                                                             
00044c   6ee6     MOVWF     0xe6,0x0                                                                                        
00044e   dada     RCALL     0xa04                                                                                           
000450   6ef5     MOVWF     0xf5,0x0                                                                                        
000452   0e05     MOVLW     0x5                                                                                             
000454   5ee1     SUBWF     0xe1,0x1,0x0                                                                                    
000456   50f5     MOVF      0xf5,0x0,0x0                                                                                    
000458   0ecb     MOVLW     0xcb           						lcd_str(MsgTest);                                                          E:\usb20\logger\main.c
00045a   6ee6     MOVWF     0xe6,0x0                                                                                        
00045c   0e00     MOVLW     0x0                                                                                             
00045e   6ee6     MOVWF     0xe6,0x0                                                                                        
000460   ec3b     CALL      0x1c76,0x0                                                                                      
000462   f00e                                                                                                               
000464   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000466   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000468   6adf     CLRF      0xdf,0x0       						for(i=0; i<64; i++)				// 64バイト書き込み                                 E:\usb20\logger\main.c
00046a   0e40     MOVLW     0x40                                                                                            
00046c   5cdf     SUBWF     0xdf,0x0,0x0                                                                                    
00046e   e20b     BC        0x486                                                                                           
000482   2adf     INCF      0xdf,0x1,0x0                                                                                    
000484   d7f2     BRA       0x46a                                                                                           
                                           						{                                                                          E:\usb20\logger\main.c
000470   0e20     MOVLW     0x20           							WriteMem(i+0x20);				// ASCIIコード書き込み                               E:\usb20\logger\main.c
000472   24df     ADDWF     0xdf,0x0,0x0                                                                                    
000474   6ee6     MOVWF     0xe6,0x0                                                                                        
000476   d9c7     RCALL     0x806                                                                                           
000478   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00047a   0101     MOVLB     0x1            							WRAdrs++;                                                                 E:\usb20\logger\main.c
00047c   2b8c     INCF      0x8c,0x1,0x1                                                                                    
00047e   0e00     MOVLW     0x0                                                                                             
000480   238d     ADDWFC    0x8d,0x1,0x1                                                                                    
                                           						}                                                                          E:\usb20\logger\main.c
000486   d05e     BRA       0x544          						break;                                                                     E:\usb20\logger\main.c
                                           					case '6':	// メモリ全消去　長時間                                           E:\usb20\logger\main.c
000488   ec36     CALL      0x1c6c,0x0     						lcd_clear();                                                               E:\usb20\logger\main.c
00048a   f00e                                                                                                               
00048c   0e91     MOVLW     0x91           						lcd_str(MsgErase);				// EERPOM消去メッセージ                              E:\usb20\logger\main.c
00048e   6ee6     MOVWF     0xe6,0x0                                                                                        
000490   0e00     MOVLW     0x0                                                                                             
000492   6ee6     MOVWF     0xe6,0x0                                                                                        
000494   ec3b     CALL      0x1c76,0x0                                                                                      
000496   f00e                                                                                                               
000498   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00049a   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00049c   0e01     MOVLW     0x1            						for(L=0; L<0x7FFF; L++)			// １チップ目32kバイト                           E:\usb20\logger\main.c
00049e   6adb     CLRF      0xdb,0x0                                                                                        
0004a0   0e02     MOVLW     0x2                                                                                             
0004a2   6adb     CLRF      0xdb,0x0                                                                                        
0004a4   0e01     MOVLW     0x1                                                                                             
0004a6   cfdb     MOVFF     0xfdb,0x14                                                                                      
0004a8   f014                                                                                                               
0004aa   0e02     MOVLW     0x2                                                                                             
0004ac   cfdb     MOVFF     0xfdb,0x15                                                                                      
0004ae   f015                                                                                                               
0004b0   0eff     MOVLW     0xff                                                                                            
0004b2   5c14     SUBWF     0x14,0x0,0x0                                                                                    
0004b4   0e7f     MOVLW     0x7f                                                                                            
0004b6   5815     SUBWFB    0x15,0x0,0x0                                                                                    
0004b8   e20d     BC        0x4d4                                                                                           
0004c8   0e01     MOVLW     0x1                                                                                             
0004ca   2adb     INCF      0xdb,0x1,0x0                                                                                    
0004cc   0e02     MOVLW     0x2                                                                                             
0004ce   e301     BNC       0x4d2                                                                                           
0004d0   2adb     INCF      0xdb,0x1,0x0                                                                                    
0004d2   d7e8     BRA       0x4a4                                                                                           
                                           						{                                                                          E:\usb20\logger\main.c
0004ba   68e6     SETF      0xe6,0x0       							WriteMem(0xFF);				// FFで消去                                            E:\usb20\logger\main.c
0004bc   d9a4     RCALL     0x806                                                                                           
0004be   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0004c0   0101     MOVLB     0x1            							WRAdrs++;                                                                 E:\usb20\logger\main.c
0004c2   2b8c     INCF      0x8c,0x1,0x1                                                                                    
0004c4   0e00     MOVLW     0x0                                                                                             
0004c6   238d     ADDWFC    0x8d,0x1,0x1                                                                                    
                                           						}                                                                          E:\usb20\logger\main.c
0004d4   0e9e     MOVLW     0x9e           						lcd_str(MsgEnd);					// ２チップ目32kバイト                                E:\usb20\logger\main.c
0004d6   6ee6     MOVWF     0xe6,0x0                                                                                        
0004d8   0e00     MOVLW     0x0                                                                                             
0004da   6ee6     MOVWF     0xe6,0x0                                                                                        
0004dc   ec3b     CALL      0x1c76,0x0                                                                                      
0004de   f00e                                                                                                               
0004e0   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0004e2   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0004e4   0e01     MOVLW     0x1            						for(L=0; L<0x7FFF; L++)                                                    E:\usb20\logger\main.c
0004e6   6adb     CLRF      0xdb,0x0                                                                                        
0004e8   0e02     MOVLW     0x2                                                                                             
0004ea   6adb     CLRF      0xdb,0x0                                                                                        
0004ec   0e01     MOVLW     0x1                                                                                             
0004ee   cfdb     MOVFF     0xfdb,0x14                                                                                      
0004f0   f014                                                                                                               
0004f2   0e02     MOVLW     0x2                                                                                             
0004f4   cfdb     MOVFF     0xfdb,0x15                                                                                      
0004f6   f015                                                                                                               
0004f8   0eff     MOVLW     0xff                                                                                            
0004fa   5c14     SUBWF     0x14,0x0,0x0                                                                                    
0004fc   0e7f     MOVLW     0x7f                                                                                            
0004fe   5815     SUBWFB    0x15,0x0,0x0                                                                                    
000500   e20d     BC        0x51c                                                                                           
000510   0e01     MOVLW     0x1                                                                                             
000512   2adb     INCF      0xdb,0x1,0x0                                                                                    
000514   0e02     MOVLW     0x2                                                                                             
000516   e301     BNC       0x51a                                                                                           
000518   2adb     INCF      0xdb,0x1,0x0                                                                                    
00051a   d7e8     BRA       0x4ec                                                                                           
                                           						{                                                                          E:\usb20\logger\main.c
000502   68e6     SETF      0xe6,0x0       							WriteMem(0xFF);				// FFで消去                                            E:\usb20\logger\main.c
000504   d980     RCALL     0x806                                                                                           
000506   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000508   0101     MOVLB     0x1            							WRAdrs++;                                                                 E:\usb20\logger\main.c
00050a   2b8c     INCF      0x8c,0x1,0x1                                                                                    
00050c   0e00     MOVLW     0x0                                                                                             
00050e   238d     ADDWFC    0x8d,0x1,0x1                                                                                    
                                           						}                                                                          E:\usb20\logger\main.c
00051c   0e9e     MOVLW     0x9e           						lcd_str(MsgEnd);					// 終了メッセージ                                     E:\usb20\logger\main.c
00051e   6ee6     MOVWF     0xe6,0x0                                                                                        
000520   0e00     MOVLW     0x0                                                                                             
000522   6ee6     MOVWF     0xe6,0x0                                                                                        
000524   ec3b     CALL      0x1c76,0x0                                                                                      
000526   f00e                                                                                                               
000528   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00052a   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00052c   0101     MOVLB     0x1            						WRAdrs = 0;                                                                E:\usb20\logger\main.c
00052e   6b8c     CLRF      0x8c,0x1                                                                                        
000530   6b8d     CLRF      0x8d,0x1                                                                                        
000532   d008     BRA       0x544          						break;                                                                     E:\usb20\logger\main.c
                                           					case '7':	// 計測開始/停止                                                  E:\usb20\logger\main.c
000534   0e02     MOVLW     0x2            					 	if(MsrFlag == 2)                                                          E:\usb20\logger\main.c
000536   5d81     SUBWF     0x81,0x0,0x1                                                                                    
000538   e102     BNZ       0x53e                                                                                           
00053a   6b81     CLRF      0x81,0x1       					 		MsrFlag = 0;					// 開始済みなら停止                                     E:\usb20\logger\main.c
00053c   d002     BRA       0x542          					 	else                                                                      E:\usb20\logger\main.c
00053e   0e01     MOVLW     0x1            						 	MsrFlag = 1;					// 開始                                                 E:\usb20\logger\main.c
000540   6f81     MOVWF     0x81,0x1                                                                                        
000542   d000     BRA       0x544          					 	break;                                                                    E:\usb20\logger\main.c
                                           		    			default:                                                                E:\usb20\logger\main.c
000176   0ec0     MOVLW     0xc0             						lcd_cmd(0xC0);					// エラーコマンド表示                                 E:\usb20\logger\main.c
000178   6ee6     MOVWF     0xe6,0x0                                                                                        
00017a   ec0e     CALL      0x1c1c,0x0                                                                                      
00017c   f00e                                                                                                               
00017e   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000180   0ec3     MOVLW     0xc3           						strcpy(MsgLCD2+9, MsgErr);                                                 E:\usb20\logger\main.c
000182   6ee6     MOVWF     0xe6,0x0                                                                                        
000184   0e00     MOVLW     0x0                                                                                             
000186   6ee6     MOVWF     0xe6,0x0                                                                                        
000188   0e81     MOVLW     0x81                                                                                            
00018a   6ee6     MOVWF     0xe6,0x0                                                                                        
00018c   0e00     MOVLW     0x0                                                                                             
00018e   6ee6     MOVWF     0xe6,0x0                                                                                        
000190   ec15     CALL      0x202a,0x0                                                                                      
000192   f010                                                                                                               
000194   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000196   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000198   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00019a   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00019c   0e78     MOVLW     0x78           						lcd_str(MsgLCD2);                                                          E:\usb20\logger\main.c
00019e   6ee6     MOVWF     0xe6,0x0                                                                                        
0001a0   0e00     MOVLW     0x0                                                                                             
0001a2   6ee6     MOVWF     0xe6,0x0                                                                                        
0001a4   ec3b     CALL      0x1c76,0x0                                                                                      
0001a6   f00e                                                                                                               
0001a8   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0001aa   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0001ac   0101     MOVLB     0x1            						RDAdrs = 0;						// アドレス初期値セット                                   E:\usb20\logger\main.c
0001ae   6b8e     CLRF      0x8e,0x1                                                                                        
0001b0   6b8f     CLRF      0x8f,0x1                                                                                        
0001b2   6b8c     CLRF      0x8c,0x1       						WRAdrs = 0;                                                                E:\usb20\logger\main.c
0001b4   6b8d     CLRF      0x8d,0x1                                                                                        
0001b6   d1c6     BRA       0x544          		    			 	break;                                                                E:\usb20\logger\main.c
                                           		    		}                                                                        E:\usb20\logger\main.c
                                               			}                                                                         E:\usb20\logger\main.c
                                               		}                                                                          E:\usb20\logger\main.c
                                           		//// ログ実行処理　一定周期                                                    E:\usb20\logger\main.c
000544   0101     MOVLB     0x1              		if((LogFlag == 1) && (MsrFlag != 0))				// ログフラグオンか？                E:\usb20\logger\main.c
000546   0580     DECF      0x80,0x0,0x1                                                                                    
000548   e001     BZ        0x54c                                                                                           
00054a   d0eb     BRA       0x722                                                                                           
00054c   5181     MOVF      0x81,0x0,0x1                                                                                    
00054e   e101     BNZ       0x552                                                                                           
000550   d0e8     BRA       0x722                                                                                           
                                               		{	    		                                                                   E:\usb20\logger\main.c
000552   7c8b     BTG       0x8b,0x6,0x0   	    		LATCbits.LATC6 = !LATCbits.LATC6;				// LED反転                           E:\usb20\logger\main.c
000554   6b80     CLRF      0x80,0x1       	    		LogFlag = 0;									// １回のみでクリア                                  E:\usb20\logger\main.c
                                           	    		// Mesure CH0                                                             E:\usb20\logger\main.c
000556   6ae6     CLRF      0xe6,0x0       			Result = ADconv(0);							// CH0計測                                          E:\usb20\logger\main.c
000558   d8f1     RCALL     0x73c                                                                                           
00055a   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00055c   cff3     MOVFF     0xff3,0x184                                                                                     
00055e   f184                                                                                                               
000560   cff4     MOVFF     0xff4,0x185                                                                                     
000562   f185                                                                                                               
000564   c184     MOVFF     0x184,0xfe6    			SaveMem(Result);								// メモリに保存                                       E:\usb20\logger\main.c
000566   ffe6                                                                                                               
000568   c185     MOVFF     0x185,0xfe6                                                                                     
00056a   ffe6                                                                                                               
00056c   d920     RCALL     0x7ae                                                                                           
00056e   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000570   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000572   0e6a     MOVLW     0x6a           			itostring(4, Result, MsgLCD1+3);				// LCD表示                                E:\usb20\logger\main.c
000574   6ee6     MOVWF     0xe6,0x0                                                                                        
000576   0e00     MOVLW     0x0                                                                                             
000578   6ee6     MOVWF     0xe6,0x0                                                                                        
00057a   c184     MOVFF     0x184,0xfe6                                                                                     
00057c   ffe6                                                                                                               
00057e   c185     MOVFF     0x185,0xfe6                                                                                     
000580   ffe6                                                                                                               
000582   0e04     MOVLW     0x4                                                                                             
000584   6ee6     MOVWF     0xe6,0x0                                                                                        
000586   da3e     RCALL     0xa04                                                                                           
000588   6ef5     MOVWF     0xf5,0x0                                                                                        
00058a   0e05     MOVLW     0x5                                                                                             
00058c   5ee1     SUBWF     0xe1,0x1,0x0                                                                                    
00058e   50f5     MOVF      0xf5,0x0,0x0                                                                                    
                                           			// Mesure CH1                                                                 E:\usb20\logger\main.c
000590   0e01     MOVLW     0x1            			Result = ADconv(1);							// CH1計測                                          E:\usb20\logger\main.c
000592   6ee6     MOVWF     0xe6,0x0                                                                                        
000594   d8d3     RCALL     0x73c                                                                                           
000596   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000598   cff3     MOVFF     0xff3,0x184                                                                                     
00059a   f184                                                                                                               
00059c   cff4     MOVFF     0xff4,0x185                                                                                     
00059e   f185                                                                                                               
0005a0   c184     MOVFF     0x184,0xfe6    			SaveMem(Result);								// メモリに保存                                       E:\usb20\logger\main.c
0005a2   ffe6                                                                                                               
0005a4   c185     MOVFF     0x185,0xfe6                                                                                     
0005a6   ffe6                                                                                                               
0005a8   d902     RCALL     0x7ae                                                                                           
0005aa   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0005ac   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0005ae   0e73     MOVLW     0x73           			itostring(4, Result, MsgLCD1+12);				// LCD表示                               E:\usb20\logger\main.c
0005b0   6ee6     MOVWF     0xe6,0x0                                                                                        
0005b2   0e00     MOVLW     0x0                                                                                             
0005b4   6ee6     MOVWF     0xe6,0x0                                                                                        
0005b6   c184     MOVFF     0x184,0xfe6                                                                                     
0005b8   ffe6                                                                                                               
0005ba   c185     MOVFF     0x185,0xfe6                                                                                     
0005bc   ffe6                                                                                                               
0005be   0e04     MOVLW     0x4                                                                                             
0005c0   6ee6     MOVWF     0xe6,0x0                                                                                        
0005c2   da20     RCALL     0xa04                                                                                           
0005c4   6ef5     MOVWF     0xf5,0x0                                                                                        
0005c6   0e05     MOVLW     0x5                                                                                             
0005c8   5ee1     SUBWF     0xe1,0x1,0x0                                                                                    
0005ca   50f5     MOVF      0xf5,0x0,0x0                                                                                    
0005cc   ec36     CALL      0x1c6c,0x0     			lcd_clear();                                                                  E:\usb20\logger\main.c
0005ce   f00e                                                                                                               
0005d0   0e67     MOVLW     0x67           			lcd_str(MsgLCD1);                                                             E:\usb20\logger\main.c
0005d2   6ee6     MOVWF     0xe6,0x0                                                                                        
0005d4   0e00     MOVLW     0x0                                                                                             
0005d6   6ee6     MOVWF     0xe6,0x0                                                                                        
0005d8   ec3b     CALL      0x1c76,0x0                                                                                      
0005da   f00e                                                                                                               
0005dc   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0005de   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0005e0   0e04     MOVLW     0x4            		    	Result = ADconv(4);							// CH4計測                                      E:\usb20\logger\main.c
0005e2   6ee6     MOVWF     0xe6,0x0                                                                                        
0005e4   d8ab     RCALL     0x73c                                                                                           
0005e6   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0005e8   cff3     MOVFF     0xff3,0x184                                                                                     
0005ea   f184                                                                                                               
0005ec   cff4     MOVFF     0xff4,0x185                                                                                     
0005ee   f185                                                                                                               
0005f0   c184     MOVFF     0x184,0xfe6    		    	SaveMem(Result);								// メモリに保存                                   E:\usb20\logger\main.c
0005f2   ffe6                                                                                                               
0005f4   c185     MOVFF     0x185,0xfe6                                                                                     
0005f6   ffe6                                                                                                               
0005f8   d8da     RCALL     0x7ae                                                                                           
0005fa   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0005fc   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0005fe   c184     MOVFF     0x184,0x6      			Battery = (Result*5.00)/1024.0;					// 電圧値に変換                           E:\usb20\logger\main.c
000600   f006                                                                                                               
000602   c185     MOVFF     0x185,0x7                                                                                       
000604   f007                                                                                                               
000606   eccf     CALL      0xd9e,0x0                                                                                       
000608   f006                                                                                                               
00060a   c005     MOVFF     0x5,0x18                                                                                        
00060c   f018                                                                                                               
00060e   c006     MOVFF     0x6,0x19                                                                                        
000610   f019                                                                                                               
000612   c007     MOVFF     0x7,0x1a                                                                                        
000614   f01a                                                                                                               
000616   c008     MOVFF     0x8,0x1b                                                                                        
000618   f01b                                                                                                               
00061a   6a0a     CLRF      0xa,0x0                                                                                         
00061c   6a0b     CLRF      0xb,0x0                                                                                         
00061e   0ea0     MOVLW     0xa0                                                                                            
000620   6e0c     MOVWF     0xc,0x0                                                                                         
000622   0e40     MOVLW     0x40                                                                                            
000624   6e0d     MOVWF     0xd,0x0                                                                                         
000626   c018     MOVFF     0x18,0x5                                                                                        
000628   f005                                                                                                               
00062a   c019     MOVFF     0x19,0x6                                                                                        
00062c   f006                                                                                                               
00062e   c01a     MOVFF     0x1a,0x7                                                                                        
000630   f007                                                                                                               
000632   c01b     MOVFF     0x1b,0x8                                                                                        
000634   f008                                                                                                               
000636   ecce     CALL      0xf9c,0x0                                                                                       
000638   f007                                                                                                               
00063a   c005     MOVFF     0x5,0x14                                                                                        
00063c   f014                                                                                                               
00063e   c006     MOVFF     0x6,0x15                                                                                        
000640   f015                                                                                                               
000642   c007     MOVFF     0x7,0x16                                                                                        
000644   f016                                                                                                               
000646   c008     MOVFF     0x8,0x17                                                                                        
000648   f017                                                                                                               
00064a   6a0a     CLRF      0xa,0x0                                                                                         
00064c   6a0b     CLRF      0xb,0x0                                                                                         
00064e   0e80     MOVLW     0x80                                                                                            
000650   6e0c     MOVWF     0xc,0x0                                                                                         
000652   0e44     MOVLW     0x44                                                                                            
000654   6e0d     MOVWF     0xd,0x0                                                                                         
000656   c014     MOVFF     0x14,0x5                                                                                        
000658   f005                                                                                                               
00065a   c015     MOVFF     0x15,0x6                                                                                        
00065c   f006                                                                                                               
00065e   c016     MOVFF     0x16,0x7                                                                                        
000660   f007                                                                                                               
000662   c017     MOVFF     0x17,0x8                                                                                        
000664   f008                                                                                                               
000666   ec7b     CALL      0xef6,0x0                                                                                       
000668   f007                                                                                                               
00066a   c005     MOVFF     0x5,0x186                                                                                       
00066c   f186                                                                                                               
00066e   c006     MOVFF     0x6,0x187                                                                                       
000670   f187                                                                                                               
000672   c007     MOVFF     0x7,0x188                                                                                       
000674   f188                                                                                                               
000676   c008     MOVFF     0x8,0x189                                                                                       
000678   f189                                                                                                               
00067a   0e7b     MOVLW     0x7b           		    	ftostring(1, 2, Battery, MsgLCD2+3);		  		// LCD表示                      E:\usb20\logger\main.c
00067c   6ee6     MOVWF     0xe6,0x0                                                                                        
00067e   0e00     MOVLW     0x0                                                                                             
000680   6ee6     MOVWF     0xe6,0x0                                                                                        
000682   c186     MOVFF     0x186,0xfe6                                                                                     
000684   ffe6                                                                                                               
000686   c187     MOVFF     0x187,0xfe6                                                                                     
000688   ffe6                                                                                                               
00068a   c188     MOVFF     0x188,0xfe6                                                                                     
00068c   ffe6                                                                                                               
00068e   c189     MOVFF     0x189,0xfe6                                                                                     
000690   ffe6                                                                                                               
000692   0e02     MOVLW     0x2                                                                                             
000694   6ee6     MOVWF     0xe6,0x0                                                                                        
000696   6ae6     CLRF      0xe6,0x0                                                                                        
000698   0e01     MOVLW     0x1                                                                                             
00069a   6ee6     MOVWF     0xe6,0x0                                                                                        
00069c   6ae6     CLRF      0xe6,0x0                                                                                        
00069e   da17     RCALL     0xace                                                                                           
0006a0   6ef5     MOVWF     0xf5,0x0                                                                                        
0006a2   0e0a     MOVLW     0xa                                                                                             
0006a4   5ee1     SUBWF     0xe1,0x1,0x0                                                                                    
0006a6   50f5     MOVF      0xf5,0x0,0x0                                                                                    
0006a8   0ec0     MOVLW     0xc0           		    	lcd_cmd(0xC0);                                                            E:\usb20\logger\main.c
0006aa   6ee6     MOVWF     0xe6,0x0                                                                                        
0006ac   ec0e     CALL      0x1c1c,0x0                                                                                      
0006ae   f00e                                                                                                               
0006b0   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0006b2   0e78     MOVLW     0x78           			lcd_str(MsgLCD2);                                                             E:\usb20\logger\main.c
0006b4   6ee6     MOVWF     0xe6,0x0                                                                                        
0006b6   0e00     MOVLW     0x0                                                                                             
0006b8   6ee6     MOVWF     0xe6,0x0                                                                                        
0006ba   ec3b     CALL      0x1c76,0x0                                                                                      
0006bc   f00e                                                                                                               
0006be   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0006c0   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                           			// バッテリ低電圧検出(3V以下で停止) USBバスパワーでないとき		                 E:\usb20\logger\main.c
                                                                                                                            E:\usb20\logger\main.c
                                           /*			if((PORTCbits.RC1 == 0) && (Result < 614))		// 低電圧チェック               E:\usb20\logger\main.c
                                           			{                                                                             E:\usb20\logger\main.c
                                           				lcd_cmd(0xC0);                                                               E:\usb20\logger\main.c
                                           				strcpy(MsgLCD2+9, MsgLow);                                                   E:\usb20\logger\main.c
                                           				lcd_str(MsgLCD2);                                                            E:\usb20\logger\main.c
                                           	    			_asm sleep _endasm						// Then sleep                                    E:\usb20\logger\main.c
                                           	    		}                                                                         E:\usb20\logger\main.c
                                           */                                                                               E:\usb20\logger\main.c
0006c2   68e6     SETF      0xe6,0x0       	    		SaveMem(0xFFFF);								// 終了フラグ保存	                                E:\usb20\logger\main.c
0006c4   68e6     SETF      0xe6,0x0                                                                                        
0006c6   d873     RCALL     0x7ae                                                                                           
0006c8   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0006ca   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0006cc   0101     MOVLB     0x1            	    		WRAdrs = WRAdrs - 2;							// アドレスを戻す                              E:\usb20\logger\main.c
0006ce   0e02     MOVLW     0x2                                                                                             
0006d0   5f8c     SUBWF     0x8c,0x1,0x1                                                                                    
0006d2   0e00     MOVLW     0x0                                                                                             
0006d4   5b8d     SUBWFB    0x8d,0x1,0x1                                                                                    
0006d6   0efa     MOVLW     0xfa           			if(WRAdrs > 0xFFFA)							// 最終アドレスか？                                 E:\usb20\logger\main.c
0006d8   80d8     BSF       0xd8,0x0,0x0                                                                                    
0006da   558c     SUBFWB    0x8c,0x0,0x1                                                                                    
0006dc   0eff     MOVLW     0xff                                                                                            
0006de   558d     SUBFWB    0x8d,0x0,0x1                                                                                    
0006e0   e21d     BC        0x71c                                                                                           
                                           			{                                                                             E:\usb20\logger\main.c
0006e2   6b8c     CLRF      0x8c,0x1       				WRAdrs = 0;								// 終了、アドレス0に                                      E:\usb20\logger\main.c
0006e4   6b8d     CLRF      0x8d,0x1                                                                                        
0006e6   0ec0     MOVLW     0xc0           				lcd_cmd(0xC0);                                                               E:\usb20\logger\main.c
0006e8   6ee6     MOVWF     0xe6,0x0                                                                                        
0006ea   ec0e     CALL      0x1c1c,0x0                                                                                      
0006ec   f00e                                                                                                               
0006ee   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0006f0   0e89     MOVLW     0x89           				strcpy(MsgLCD2+9, MsgFull);				// LCD表示                                    E:\usb20\logger\main.c
0006f2   6ee6     MOVWF     0xe6,0x0                                                                                        
0006f4   0e00     MOVLW     0x0                                                                                             
0006f6   6ee6     MOVWF     0xe6,0x0                                                                                        
0006f8   0e81     MOVLW     0x81                                                                                            
0006fa   6ee6     MOVWF     0xe6,0x0                                                                                        
0006fc   0e00     MOVLW     0x0                                                                                             
0006fe   6ee6     MOVWF     0xe6,0x0                                                                                        
000700   ec15     CALL      0x202a,0x0                                                                                      
000702   f010                                                                                                               
000704   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000706   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000708   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00070a   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00070c   0e78     MOVLW     0x78           				lcd_str(MsgLCD2);                                                            E:\usb20\logger\main.c
00070e   6ee6     MOVWF     0xe6,0x0                                                                                        
000710   0e00     MOVLW     0x0                                                                                             
000712   6ee6     MOVWF     0xe6,0x0                                                                                        
000714   ec3b     CALL      0x1c76,0x0                                                                                      
000716   f00e                                                                                                               
000718   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00071a   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                           			}                                                                             E:\usb20\logger\main.c
00071c   0101     MOVLB     0x1            			MsrFlag = 2;									// 計測開始すみ                                          E:\usb20\logger\main.c
00071e   0e02     MOVLW     0x2                                                                                             
000720   6f81     MOVWF     0x81,0x1                                                                                        
                                           	    }                                                                           E:\usb20\logger\main.c
                                                }                                                                           E:\usb20\logger\main.c
000724   6ef5     MOVWF     0xf5,0x0       }                                                                                E:\usb20\logger\main.c
000726   0e03     MOVLW     0x3                                                                                             
000728   5ce1     SUBWF     0xe1,0x0,0x0                                                                                    
00072a   e202     BC        0x730                                                                                           
00072c   6ae1     CLRF      0xe1,0x0                                                                                        
00072e   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000730   6ee1     MOVWF     0xe1,0x0                                                                                        
000732   50f5     MOVF      0xf5,0x0,0x0                                                                                    
000734   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000736   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
000738   ffd9                                                                                                               
00073a   0012     RETURN    0x0                                                                                             
                                                                                                                            E:\usb20\logger\main.c
                                           /// アナログデータ入力                                                           E:\usb20\logger\main.c
00073c   cfd9     MOVFF     0xfd9,0xfe6    unsigned int ADconv(char chan)                                                   E:\usb20\logger\main.c
00073e   ffe6                                                                                                               
000740   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
000742   ffd9                                                                                                               
000744   0e02     MOVLW     0x2                                                                                             
000746   26e1     ADDWF     0xe1,0x1,0x0                                                                                    
                                           {                                                                                E:\usb20\logger\main.c
                                           	unsigned int data;                                                              E:\usb20\logger\main.c
                                           	                                                                                E:\usb20\logger\main.c
000748   0efe     MOVLW     0xfe           	ADCON0 = (chan << 2) + 0x01;			// チャネル選択                                  E:\usb20\logger\main.c
00074a   50db     MOVF      0xdb,0x0,0x0                                                                                    
00074c   0d04     MULLW     0x4                                                                                             
00074e   28f3     INCF      0xf3,0x0,0x0                                                                                    
000750   6ec2     MOVWF     0xc2,0x0                                                                                        
000752   0e14     MOVLW     0x14           	Delay10TCYx(20);	    					// アクイジションタイム                               E:\usb20\logger\main.c
000754   6ee6     MOVWF     0xe6,0x0                                                                                        
000756   eca2     CALL      0x2144,0x0                                                                                      
000758   f010                                                                                                               
00075a   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00075c   82c2     BSF       0xc2,0x1,0x0   	ADCON0bits.GO = 1;					// 変換開始                                              E:\usb20\logger\main.c
00075e   b2c2     BTFSC     0xc2,0x1,0x0   	while(ADCON0bits.GO);					// 変換終了待ち                                       E:\usb20\logger\main.c
000760   d7fe     BRA       0x75e                                                                                           
000762   50c4     MOVF      0xc4,0x0,0x0   	data = ADRESH * 256 + ADRESL;			// データ入力                                   E:\usb20\logger\main.c
000764   6e16     MOVWF     0x16,0x0                                                                                        
000766   6a17     CLRF      0x17,0x0                                                                                        
000768   c016     MOVFF     0x16,0x17                                                                                       
00076a   f017                                                                                                               
00076c   6a16     CLRF      0x16,0x0                                                                                        
00076e   50c3     MOVF      0xc3,0x0,0x0                                                                                    
000770   0100     MOVLB     0x0                                                                                             
000772   2416     ADDWF     0x16,0x0,0x0                                                                                    
000774   6e14     MOVWF     0x14,0x0                                                                                        
000776   0e00     MOVLW     0x0                                                                                             
000778   2017     ADDWFC    0x17,0x0,0x0                                                                                    
00077a   6e15     MOVWF     0x15,0x0                                                                                        
00077c   c014     MOVFF     0x14,0xfde                                                                                      
00077e   ffde                                                                                                               
000780   c015     MOVFF     0x15,0xfdd                                                                                      
000782   ffdd                                                                                                               
000784   cfde     MOVFF     0xfde,0x14     	return(data);					                                                              E:\usb20\logger\main.c
000786   f014                                                                                                               
000788   cfdd     MOVFF     0xfdd,0x15                                                                                      
00078a   f015                                                                                                               
00078c   c014     MOVFF     0x14,0xff3                                                                                      
00078e   fff3                                                                                                               
000790   c015     MOVFF     0x15,0xff4                                                                                      
000792   fff4                                                                                                               
000794   6ef5     MOVWF     0xf5,0x0       }                                                                                E:\usb20\logger\main.c
000796   0e02     MOVLW     0x2                                                                                             
000798   5ce1     SUBWF     0xe1,0x0,0x0                                                                                    
00079a   e203     BC        0x7a2                                                                                           
00079c   d000     BRA       0x79e                                                                                           
00079e   6ae1     CLRF      0xe1,0x0                                                                                        
0007a0   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0007a2   6ee1     MOVWF     0xe1,0x0                                                                                        
0007a4   50f5     MOVF      0xf5,0x0,0x0                                                                                    
0007a6   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0007a8   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
0007aa   ffd9                                                                                                               
0007ac   0012     RETURN    0x0                                                                                             
                                           /// EEPROM２バイト保存                                                           E:\usb20\logger\main.c
0007ae   cfd9     MOVFF     0xfd9,0xfe6    void SaveMem(unsigned int data)                                                  E:\usb20\logger\main.c
0007b0   ffe6                                                                                                               
0007b2   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
0007b4   ffd9                                                                                                               
                                           {                                                                                E:\usb20\logger\main.c
0007b6   0efd     MOVLW     0xfd           	WriteMem(data >> 8);					// 上位保存                                            E:\usb20\logger\main.c
0007b8   cfdb     MOVFF     0xfdb,0x14                                                                                      
0007ba   f014                                                                                                               
0007bc   0efe     MOVLW     0xfe                                                                                            
0007be   cfdb     MOVFF     0xfdb,0x15                                                                                      
0007c0   f015                                                                                                               
0007c2   c015     MOVFF     0x15,0x14                                                                                       
0007c4   f014                                                                                                               
0007c6   6a15     CLRF      0x15,0x0                                                                                        
0007c8   5014     MOVF      0x14,0x0,0x0                                                                                    
0007ca   6ee6     MOVWF     0xe6,0x0                                                                                        
0007cc   d81c     RCALL     0x806                                                                                           
0007ce   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0007d0   0101     MOVLB     0x1            	WRAdrs++;                                                                       E:\usb20\logger\main.c
0007d2   2b8c     INCF      0x8c,0x1,0x1                                                                                    
0007d4   0e00     MOVLW     0x0                                                                                             
0007d6   238d     ADDWFC    0x8d,0x1,0x1                                                                                    
0007d8   0eff     MOVLW     0xff           	WriteMem(data & 0xFF);					// 下位保存                                          E:\usb20\logger\main.c
0007da   6ee7     MOVWF     0xe7,0x0                                                                                        
0007dc   0efd     MOVLW     0xfd                                                                                            
0007de   cfdb     MOVFF     0xfdb,0x14                                                                                      
0007e0   f014                                                                                                               
0007e2   0efe     MOVLW     0xfe                                                                                            
0007e4   cfdb     MOVFF     0xfdb,0x15                                                                                      
0007e6   f015                                                                                                               
0007e8   50e7     MOVF      0xe7,0x0,0x0                                                                                    
0007ea   1614     ANDWF     0x14,0x1,0x0                                                                                    
0007ec   6a15     CLRF      0x15,0x0                                                                                        
0007ee   5014     MOVF      0x14,0x0,0x0                                                                                    
0007f0   6ee6     MOVWF     0xe6,0x0                                                                                        
0007f2   d809     RCALL     0x806                                                                                           
0007f4   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0007f6   0101     MOVLB     0x1            	WRAdrs++;                                                                       E:\usb20\logger\main.c
0007f8   2b8c     INCF      0x8c,0x1,0x1                                                                                    
0007fa   0e00     MOVLW     0x0                                                                                             
0007fc   238d     ADDWFC    0x8d,0x1,0x1                                                                                    
0007fe   52e5     MOVF      0xe5,0x1,0x0   }                                                                                E:\usb20\logger\main.c
000800   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
000802   ffd9                                                                                                               
000804   0012     RETURN    0x0                                                                                             
                                                                                                                            E:\usb20\logger\main.c
                                           /// EEPROMバイト書き込み                                                         E:\usb20\logger\main.c
000806   cfd9     MOVFF     0xfd9,0xfe6    void WriteMem(unsigned char data)                                                E:\usb20\logger\main.c
000808   ffe6                                                                                                               
00080a   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
00080c   ffd9                                                                                                               
00080e   0e02     MOVLW     0x2                                                                                             
000810   26e1     ADDWF     0xe1,0x1,0x0                                                                                    
                                           {                                                                                E:\usb20\logger\main.c
                                           	unsigned char Err, Chip;                                                        E:\usb20\logger\main.c
                                           	                                                                                E:\usb20\logger\main.c
000812   0101     MOVLB     0x1            	if(WRAdrs < 0x8000)					// チップ選択                                           E:\usb20\logger\main.c
000814   0e00     MOVLW     0x0                                                                                             
000816   5d8c     SUBWF     0x8c,0x0,0x1                                                                                    
000818   0e80     MOVLW     0x80                                                                                            
00081a   598d     SUBWFB    0x8d,0x0,0x1                                                                                    
00081c   e204     BC        0x826                                                                                           
00081e   52de     MOVF      0xde,0x1,0x0   		Chip = 0xA0;                                                                   E:\usb20\logger\main.c
000820   0ea0     MOVLW     0xa0                                                                                            
000822   6edd     MOVWF     0xdd,0x0                                                                                        
000824   d003     BRA       0x82c          	else                                                                            E:\usb20\logger\main.c
000826   52de     MOVF      0xde,0x1,0x0   		Chip = 0xA2;                                                                   E:\usb20\logger\main.c
000828   0ea2     MOVLW     0xa2                                                                                            
00082a   6edd     MOVWF     0xdd,0x0                                                                                        
                                           	///                                                                             E:\usb20\logger\main.c
00082c   50c7     MOVF      0xc7,0x0,0x0   	IdleI2C();                                                                      E:\usb20\logger\main.c
00082e   0b04     ANDLW     0x4                                                                                             
000830   e001     BZ        0x834                                                                                           
000832   0e01     MOVLW     0x1                                                                                             
000834   6e14     MOVWF     0x14,0x0                                                                                        
000836   0e1f     MOVLW     0x1f                                                                                            
000838   14c5     ANDWF     0xc5,0x0,0x0                                                                                    
00083a   1014     IORWF     0x14,0x0,0x0                                                                                    
00083c   e001     BZ        0x840                                                                                           
00083e   d7f6     BRA       0x82c                                                                                           
000840   80c5     BSF       0xc5,0x0,0x0   	StartI2C();							// スタートシーケンス                                         E:\usb20\logger\main.c
000842   b0c5     BTFSC     0xc5,0x0,0x0   	while ( SSPCON2bits.SEN );                                                      E:\usb20\logger\main.c
000844   d7fe     BRA       0x842                                                                                           
000846   0e01     MOVLW     0x1            	WriteI2C(Chip);						// コントロール                                            E:\usb20\logger\main.c
000848   cfdb     MOVFF     0xfdb,0xfe6                                                                                     
00084a   ffe6                                                                                                               
00084c   ec51     CALL      0x20a2,0x0                                                                                      
00084e   f010                                                                                                               
000850   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000852   50c7     MOVF      0xc7,0x0,0x0   	IdleI2C();                                                                      E:\usb20\logger\main.c
000854   0b04     ANDLW     0x4                                                                                             
000856   e001     BZ        0x85a                                                                                           
000858   0e01     MOVLW     0x1                                                                                             
00085a   6e14     MOVWF     0x14,0x0                                                                                        
00085c   0e1f     MOVLW     0x1f                                                                                            
00085e   14c5     ANDWF     0xc5,0x0,0x0                                                                                    
000860   1014     IORWF     0x14,0x0,0x0                                                                                    
000862   e001     BZ        0x866                                                                                           
000864   d7f6     BRA       0x852                                                                                           
000866   c18d     MOVFF     0x18d,0x14     	WriteI2C((WRAdrs >> 8) & 0x7F);			// アドレス上位                               E:\usb20\logger\main.c
000868   f014                                                                                                               
00086a   6a15     CLRF      0x15,0x0                                                                                        
00086c   0e7f     MOVLW     0x7f                                                                                            
00086e   1414     ANDWF     0x14,0x0,0x0                                                                                    
000870   6ee6     MOVWF     0xe6,0x0                                                                                        
000872   ec51     CALL      0x20a2,0x0                                                                                      
000874   f010                                                                                                               
000876   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000878   50c7     MOVF      0xc7,0x0,0x0   	IdleI2C();                                                                      E:\usb20\logger\main.c
00087a   0b04     ANDLW     0x4                                                                                             
00087c   e001     BZ        0x880                                                                                           
00087e   0e01     MOVLW     0x1                                                                                             
000880   6e14     MOVWF     0x14,0x0                                                                                        
000882   0e1f     MOVLW     0x1f                                                                                            
000884   14c5     ANDWF     0xc5,0x0,0x0                                                                                    
000886   1014     IORWF     0x14,0x0,0x0                                                                                    
000888   e001     BZ        0x88c                                                                                           
00088a   d7f6     BRA       0x878                                                                                           
00088c   c18c     MOVFF     0x18c,0xfe6    	WriteI2C(WRAdrs);						// アドレス下位                                          E:\usb20\logger\main.c
00088e   ffe6                                                                                                               
000890   ec51     CALL      0x20a2,0x0                                                                                      
000892   f010                                                                                                               
000894   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000896   50c7     MOVF      0xc7,0x0,0x0   	IdleI2C();                                                                      E:\usb20\logger\main.c
000898   0b04     ANDLW     0x4                                                                                             
00089a   e001     BZ        0x89e                                                                                           
00089c   0e01     MOVLW     0x1                                                                                             
00089e   6e14     MOVWF     0x14,0x0                                                                                        
0008a0   0e1f     MOVLW     0x1f                                                                                            
0008a2   14c5     ANDWF     0xc5,0x0,0x0                                                                                    
0008a4   1014     IORWF     0x14,0x0,0x0                                                                                    
0008a6   e001     BZ        0x8aa                                                                                           
0008a8   d7f6     BRA       0x896                                                                                           
0008aa   0efe     MOVLW     0xfe           	WriteI2C(data);						// データ出力                                              E:\usb20\logger\main.c
0008ac   cfdb     MOVFF     0xfdb,0xfe6                                                                                     
0008ae   ffe6                                                                                                               
0008b0   ec51     CALL      0x20a2,0x0                                                                                      
0008b2   f010                                                                                                               
0008b4   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0008b6   50c7     MOVF      0xc7,0x0,0x0   	IdleI2C();                                                                      E:\usb20\logger\main.c
0008b8   0b04     ANDLW     0x4                                                                                             
0008ba   e001     BZ        0x8be                                                                                           
0008bc   0e01     MOVLW     0x1                                                                                             
0008be   6e14     MOVWF     0x14,0x0                                                                                        
0008c0   0e1f     MOVLW     0x1f                                                                                            
0008c2   14c5     ANDWF     0xc5,0x0,0x0                                                                                    
0008c4   1014     IORWF     0x14,0x0,0x0                                                                                    
0008c6   e001     BZ        0x8ca                                                                                           
0008c8   d7f6     BRA       0x8b6                                                                                           
0008ca   84c5     BSF       0xc5,0x2,0x0   	StopI2C();							// ストップシーケンス                                          E:\usb20\logger\main.c
0008cc   b4c5     BTFSC     0xc5,0x2,0x0   	while ( SSPCON2bits.PEN );                                                      E:\usb20\logger\main.c
0008ce   d7fe     BRA       0x8cc                                                                                           
0008d0   0e05     MOVLW     0x5            	Delay10KTCYx(5);						// 5msec待ち                                              E:\usb20\logger\main.c
0008d2   6ee6     MOVWF     0xe6,0x0                                                                                        
0008d4   ec69     CALL      0x20d2,0x0                                                                                      
0008d6   f010                                                                                                               
0008d8   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0008da   6ef5     MOVWF     0xf5,0x0       }                                                                                E:\usb20\logger\main.c
0008dc   0e02     MOVLW     0x2                                                                                             
0008de   5ce1     SUBWF     0xe1,0x0,0x0                                                                                    
0008e0   e202     BC        0x8e6                                                                                           
0008e2   6ae1     CLRF      0xe1,0x0                                                                                        
0008e4   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0008e6   6ee1     MOVWF     0xe1,0x0                                                                                        
0008e8   50f5     MOVF      0xf5,0x0,0x0                                                                                    
0008ea   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0008ec   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
0008ee   ffd9                                                                                                               
0008f0   0012     RETURN    0x0                                                                                             
                                           //// EEPROMバイト読み出し                                                        E:\usb20\logger\main.c
0008f2   cfd9     MOVFF     0xfd9,0xfe6    unsigned char ReadMem(unsigned int adrs)                                         E:\usb20\logger\main.c
0008f4   ffe6                                                                                                               
0008f6   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
0008f8   ffd9                                                                                                               
0008fa   0e02     MOVLW     0x2                                                                                             
0008fc   26e1     ADDWF     0xe1,0x1,0x0                                                                                    
                                           {                                                                                E:\usb20\logger\main.c
                                           	unsigned char data, Chip;                                                       E:\usb20\logger\main.c
                                                                                                                            E:\usb20\logger\main.c
0008fe   0efd     MOVLW     0xfd           	if(adrs < 0x8000)						// チップ選択                                            E:\usb20\logger\main.c
000900   cfdb     MOVFF     0xfdb,0x14                                                                                      
000902   f014                                                                                                               
000904   0efe     MOVLW     0xfe                                                                                            
000906   cfdb     MOVFF     0xfdb,0x15                                                                                      
000908   f015                                                                                                               
00090a   0e00     MOVLW     0x0                                                                                             
00090c   5c14     SUBWF     0x14,0x0,0x0                                                                                    
00090e   0e80     MOVLW     0x80                                                                                            
000910   5815     SUBWFB    0x15,0x0,0x0                                                                                    
000912   e204     BC        0x91c                                                                                           
000914   52de     MOVF      0xde,0x1,0x0   		Chip = 0xA0;                                                                   E:\usb20\logger\main.c
000916   0ea0     MOVLW     0xa0                                                                                            
000918   6edd     MOVWF     0xdd,0x0                                                                                        
00091a   d003     BRA       0x922          	else                                                                            E:\usb20\logger\main.c
00091c   52de     MOVF      0xde,0x1,0x0   		Chip = 0xA2;                                                                   E:\usb20\logger\main.c
00091e   0ea2     MOVLW     0xa2                                                                                            
000920   6edd     MOVWF     0xdd,0x0                                                                                        
                                           	////                                                                            E:\usb20\logger\main.c
000922   50c7     MOVF      0xc7,0x0,0x0   	IdleI2C();                                                                      E:\usb20\logger\main.c
000924   0b04     ANDLW     0x4                                                                                             
000926   e001     BZ        0x92a                                                                                           
000928   0e01     MOVLW     0x1                                                                                             
00092a   6e14     MOVWF     0x14,0x0                                                                                        
00092c   0e1f     MOVLW     0x1f                                                                                            
00092e   14c5     ANDWF     0xc5,0x0,0x0                                                                                    
000930   1014     IORWF     0x14,0x0,0x0                                                                                    
000932   e001     BZ        0x936                                                                                           
000934   d7f6     BRA       0x922                                                                                           
000936   80c5     BSF       0xc5,0x0,0x0   	StartI2C();							// スタートシーケンス                                         E:\usb20\logger\main.c
000938   b0c5     BTFSC     0xc5,0x0,0x0   	while ( SSPCON2bits.SEN );                                                      E:\usb20\logger\main.c
00093a   d7fe     BRA       0x938                                                                                           
00093c   0e01     MOVLW     0x1            	WriteI2C(Chip);						// コントロール                                            E:\usb20\logger\main.c
00093e   cfdb     MOVFF     0xfdb,0xfe6                                                                                     
000940   ffe6                                                                                                               
000942   ec51     CALL      0x20a2,0x0                                                                                      
000944   f010                                                                                                               
000946   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000948   50c7     MOVF      0xc7,0x0,0x0   	IdleI2C();                                                                      E:\usb20\logger\main.c
00094a   0b04     ANDLW     0x4                                                                                             
00094c   e001     BZ        0x950                                                                                           
00094e   0e01     MOVLW     0x1                                                                                             
000950   6e14     MOVWF     0x14,0x0                                                                                        
000952   0e1f     MOVLW     0x1f                                                                                            
000954   14c5     ANDWF     0xc5,0x0,0x0                                                                                    
000956   1014     IORWF     0x14,0x0,0x0                                                                                    
000958   e001     BZ        0x95c                                                                                           
00095a   d7f6     BRA       0x948                                                                                           
00095c   0efd     MOVLW     0xfd           	WriteI2C((adrs >> 8) & 0x7F);			// アドレス上位                                 E:\usb20\logger\main.c
00095e   cfdb     MOVFF     0xfdb,0x14                                                                                      
000960   f014                                                                                                               
000962   0efe     MOVLW     0xfe                                                                                            
000964   cfdb     MOVFF     0xfdb,0x15                                                                                      
000966   f015                                                                                                               
000968   c015     MOVFF     0x15,0x14                                                                                       
00096a   f014                                                                                                               
00096c   6a15     CLRF      0x15,0x0                                                                                        
00096e   0e7f     MOVLW     0x7f                                                                                            
000970   1414     ANDWF     0x14,0x0,0x0                                                                                    
000972   6ee6     MOVWF     0xe6,0x0                                                                                        
000974   ec51     CALL      0x20a2,0x0                                                                                      
000976   f010                                                                                                               
000978   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00097a   50c7     MOVF      0xc7,0x0,0x0   	IdleI2C();                                                                      E:\usb20\logger\main.c
00097c   0b04     ANDLW     0x4                                                                                             
00097e   e001     BZ        0x982                                                                                           
000980   0e01     MOVLW     0x1                                                                                             
000982   6e14     MOVWF     0x14,0x0                                                                                        
000984   0e1f     MOVLW     0x1f                                                                                            
000986   14c5     ANDWF     0xc5,0x0,0x0                                                                                    
000988   1014     IORWF     0x14,0x0,0x0                                                                                    
00098a   e001     BZ        0x98e                                                                                           
00098c   d7f6     BRA       0x97a                                                                                           
00098e   0efd     MOVLW     0xfd           	WriteI2C(adrs);						// アドレス下位                                            E:\usb20\logger\main.c
000990   cfdb     MOVFF     0xfdb,0xfe6                                                                                     
000992   ffe6                                                                                                               
000994   ec51     CALL      0x20a2,0x0                                                                                      
000996   f010                                                                                                               
000998   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00099a   50c7     MOVF      0xc7,0x0,0x0   	IdleI2C();                                                                      E:\usb20\logger\main.c
00099c   0b04     ANDLW     0x4                                                                                             
00099e   e001     BZ        0x9a2                                                                                           
0009a0   0e01     MOVLW     0x1                                                                                             
0009a2   6e14     MOVWF     0x14,0x0                                                                                        
0009a4   0e1f     MOVLW     0x1f                                                                                            
0009a6   14c5     ANDWF     0xc5,0x0,0x0                                                                                    
0009a8   1014     IORWF     0x14,0x0,0x0                                                                                    
0009aa   e001     BZ        0x9ae                                                                                           
0009ac   d7f6     BRA       0x99a                                                                                           
0009ae   82c5     BSF       0xc5,0x1,0x0   	RestartI2C();							// リスタートシーケンス                                     E:\usb20\logger\main.c
0009b0   b2c5     BTFSC     0xc5,0x1,0x0   	while ( SSPCON2bits.RSEN );                                                     E:\usb20\logger\main.c
0009b2   d7fe     BRA       0x9b0                                                                                           
0009b4   0e01     MOVLW     0x1            	WriteI2C(Chip + 0x01);					// リードコントロール                                E:\usb20\logger\main.c
0009b6   28db     INCF      0xdb,0x0,0x0                                                                                    
0009b8   6ee6     MOVWF     0xe6,0x0                                                                                        
0009ba   ec51     CALL      0x20a2,0x0                                                                                      
0009bc   f010                                                                                                               
0009be   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0009c0   50c7     MOVF      0xc7,0x0,0x0   	IdleI2C();                                                                      E:\usb20\logger\main.c
0009c2   0b04     ANDLW     0x4                                                                                             
0009c4   e001     BZ        0x9c8                                                                                           
0009c6   0e01     MOVLW     0x1                                                                                             
0009c8   6e14     MOVWF     0x14,0x0                                                                                        
0009ca   0e1f     MOVLW     0x1f                                                                                            
0009cc   14c5     ANDWF     0xc5,0x0,0x0                                                                                    
0009ce   1014     IORWF     0x14,0x0,0x0                                                                                    
0009d0   e001     BZ        0x9d4                                                                                           
0009d2   d7f6     BRA       0x9c0                                                                                           
0009d4   86c5     BSF       0xc5,0x3,0x0   	SSPCON2bits.RCEN = 1;                                                           E:\usb20\logger\main.c
0009d6   b6c5     BTFSC     0xc5,0x3,0x0   	while ( SSPCON2bits.RCEN ); 			// データ待ち                                    E:\usb20\logger\main.c
0009d8   d7fe     BRA       0x9d6                                                                                           
0009da   8ac5     BSF       0xc5,0x5,0x0   	NotAckI2C();              				// NAK送信                                        E:\usb20\logger\main.c
0009dc   88c5     BSF       0xc5,0x4,0x0                                                                                    
0009de   b8c5     BTFSC     0xc5,0x4,0x0   	while ( SSPCON2bits.ACKEN );                                                    E:\usb20\logger\main.c
0009e0   d7fe     BRA       0x9de                                                                                           
0009e2   84c5     BSF       0xc5,0x2,0x0   	StopI2C();              				// ストップシーケンス                               E:\usb20\logger\main.c
0009e4   b4c5     BTFSC     0xc5,0x2,0x0   	while ( SSPCON2bits.PEN );                                                      E:\usb20\logger\main.c
0009e6   d7fe     BRA       0x9e4                                                                                           
0009e8   50c9     MOVF      0xc9,0x0,0x0   	return(SSPBUF);						// データ取り出し                                          E:\usb20\logger\main.c
0009ea   6ef5     MOVWF     0xf5,0x0       }                                                                                E:\usb20\logger\main.c
0009ec   0e02     MOVLW     0x2                                                                                             
0009ee   5ce1     SUBWF     0xe1,0x0,0x0                                                                                    
0009f0   e203     BC        0x9f8                                                                                           
0009f2   d000     BRA       0x9f4                                                                                           
0009f4   6ae1     CLRF      0xe1,0x0                                                                                        
0009f6   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0009f8   6ee1     MOVWF     0xe1,0x0                                                                                        
0009fa   50f5     MOVF      0xf5,0x0,0x0                                                                                    
0009fc   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0009fe   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
000a00   ffd9                                                                                                               
000a02   0012     RETURN    0x0                                                                                             
                                           ///// 数値から文字列に変換                                                       E:\usb20\logger\main.c
000a04   cfd9     MOVFF     0xfd9,0xfe6    void itostring(char digit, unsigned int data, char *buffer)                      E:\usb20\logger\main.c
000a06   ffe6                                                                                                               
000a08   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
000a0a   ffd9                                                                                                               
000a0c   52e6     MOVF      0xe6,0x1,0x0                                                                                    
                                           {                                                                                E:\usb20\logger\main.c
                                           	char i;                                                                         E:\usb20\logger\main.c
000a0e   0efe     MOVLW     0xfe           	buffer += digit;						// 文字列の最後                                           E:\usb20\logger\main.c
000a10   cfdb     MOVFF     0xfdb,0x14                                                                                      
000a12   f014                                                                                                               
000a14   6a15     CLRF      0x15,0x0                                                                                        
000a16   be14     BTFSC     0x14,0x7,0x0                                                                                    
000a18   6815     SETF      0x15,0x0                                                                                        
000a1a   50d9     MOVF      0xd9,0x0,0x0                                                                                    
000a1c   0ffa     ADDLW     0xfa                                                                                            
000a1e   6ee9     MOVWF     0xe9,0x0                                                                                        
000a20   0eff     MOVLW     0xff                                                                                            
000a22   20da     ADDWFC    0xda,0x0,0x0                                                                                    
000a24   6eea     MOVWF     0xea,0x0                                                                                        
000a26   5014     MOVF      0x14,0x0,0x0                                                                                    
000a28   26ee     ADDWF     0xee,0x1,0x0                                                                                    
000a2a   5015     MOVF      0x15,0x0,0x0                                                                                    
000a2c   22ed     ADDWFC    0xed,0x1,0x0                                                                                    
000a2e   0efe     MOVLW     0xfe           	for(i=digit; i>0; i--) {				// 最下位桁から上位へ                               E:\usb20\logger\main.c
000a30   50db     MOVF      0xdb,0x0,0x0                                                                                    
000a32   6edf     MOVWF     0xdf,0x0                                                                                        
000a34   cfdf     MOVFF     0xfdf,0x14                                                                                      
000a36   f014                                                                                                               
000a38   0e00     MOVLW     0x0                                                                                             
000a3a   6ee7     MOVWF     0xe7,0x0                                                                                        
000a3c   1814     XORWF     0x14,0x0,0x0                                                                                    
000a3e   aee8     BTFSS     0xe8,0x7,0x0                                                                                    
000a40   d002     BRA       0xa46                                                                                           
000a42   3414     RLCF      0x14,0x0,0x0                                                                                    
000a44   d003     BRA       0xa4c                                                                                           
000a46   50e7     MOVF      0xe7,0x0,0x0                                                                                    
000a48   80d8     BSF       0xd8,0x0,0x0                                                                                    
000a4a   5414     SUBFWB    0x14,0x0,0x0                                                                                    
000a4c   e23b     BC        0xac4                                                                                           
000ac0   06df     DECF      0xdf,0x1,0x0                                                                                    
000ac2   d7b8     BRA       0xa34                                                                                           
000a4e   0efa     MOVLW     0xfa           		buffer--;						// ポインター１                                                 E:\usb20\logger\main.c
000a50   06db     DECF      0xdb,0x1,0x0                                                                                    
000a52   0efb     MOVLW     0xfb                                                                                            
000a54   e201     BC        0xa58                                                                                           
000a56   06db     DECF      0xdb,0x1,0x0                                                                                    
000a58   0efc     MOVLW     0xfc           		*buffer = (data % 10) + '0';		// その桁数値を文字にして格納                    E:\usb20\logger\main.c
000a5a   cfdb     MOVFF     0xfdb,0x14                                                                                      
000a5c   f014                                                                                                               
000a5e   0efd     MOVLW     0xfd                                                                                            
000a60   cfdb     MOVFF     0xfdb,0x15                                                                                      
000a62   f015                                                                                                               
000a64   0e0a     MOVLW     0xa                                                                                             
000a66   6e0b     MOVWF     0xb,0x0                                                                                         
000a68   6a0c     CLRF      0xc,0x0                                                                                         
000a6a   c014     MOVFF     0x14,0x6                                                                                        
000a6c   f006                                                                                                               
000a6e   c015     MOVFF     0x15,0x7                                                                                        
000a70   f007                                                                                                               
000a72   ec80     CALL      0x2100,0x0                                                                                      
000a74   f010                                                                                                               
000a76   c002     MOVFF     0x2,0x14                                                                                        
000a78   f014                                                                                                               
000a7a   c003     MOVFF     0x3,0x15                                                                                        
000a7c   f015                                                                                                               
000a7e   0e30     MOVLW     0x30                                                                                            
000a80   2614     ADDWF     0x14,0x1,0x0                                                                                    
000a82   0e00     MOVLW     0x0                                                                                             
000a84   2215     ADDWFC    0x15,0x1,0x0                                                                                    
000a86   0efa     MOVLW     0xfa                                                                                            
000a88   cfdb     MOVFF     0xfdb,0xfe9                                                                                     
000a8a   ffe9                                                                                                               
000a8c   0efb     MOVLW     0xfb                                                                                            
000a8e   cfdb     MOVFF     0xfdb,0xfea                                                                                     
000a90   ffea                                                                                                               
000a92   c014     MOVFF     0x14,0xfef                                                                                      
000a94   ffef                                                                                                               
000a96   0e0a     MOVLW     0xa            		data = data / 10;					// 桁-1                                                  E:\usb20\logger\main.c
000a98   6e14     MOVWF     0x14,0x0                                                                                        
000a9a   6a15     CLRF      0x15,0x0                                                                                        
000a9c   0efc     MOVLW     0xfc                                                                                            
000a9e   cfdb     MOVFF     0xfdb,0x6                                                                                       
000aa0   f006                                                                                                               
000aa2   0efd     MOVLW     0xfd                                                                                            
000aa4   cfdb     MOVFF     0xfdb,0x7                                                                                       
000aa6   f007                                                                                                               
000aa8   c014     MOVFF     0x14,0xb                                                                                        
000aaa   f00b                                                                                                               
000aac   c015     MOVFF     0x15,0xc                                                                                        
000aae   f00c                                                                                                               
000ab0   ec80     CALL      0x2100,0x0                                                                                      
000ab2   f010                                                                                                               
000ab4   0efc     MOVLW     0xfc                                                                                            
000ab6   c006     MOVFF     0x6,0xfdb                                                                                       
000ab8   ffdb                                                                                                               
000aba   0efd     MOVLW     0xfd                                                                                            
000abc   c007     MOVFF     0x7,0xfdb                                                                                       
000abe   ffdb                                                                                                               
                                           	}                                                                               E:\usb20\logger\main.c
000ac4   52e5     MOVF      0xe5,0x1,0x0   }                                                                                E:\usb20\logger\main.c
000ac6   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000ac8   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
000aca   ffd9                                                                                                               
000acc   0012     RETURN    0x0                                                                                             
                                           ////// Floatから文字列へ変換                                                     E:\usb20\logger\main.c
                                           //////　合計有効桁は５桁以下とすること                                           E:\usb20\logger\main.c
000ace   cfd9     MOVFF     0xfd9,0xfe6    void ftostring(int seisu, int shousu, float data, char *buffer)                  E:\usb20\logger\main.c
000ad0   ffe6                                                                                                               
000ad2   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
000ad4   ffd9                                                                                                               
000ad6   0e04     MOVLW     0x4                                                                                             
000ad8   26e1     ADDWF     0xe1,0x1,0x0                                                                                    
                                           {                                                                                E:\usb20\logger\main.c
                                           	int i, dumy;                                                                    E:\usb20\logger\main.c
                                                                                                                            E:\usb20\logger\main.c
000ada   50d9     MOVF      0xd9,0x0,0x0   	if(shousu != 0)						//小数部桁ありか                                           E:\usb20\logger\main.c
000adc   0ffb     ADDLW     0xfb                                                                                            
000ade   6ee9     MOVWF     0xe9,0x0                                                                                        
000ae0   0eff     MOVLW     0xff                                                                                            
000ae2   20da     ADDWFC    0xda,0x0,0x0                                                                                    
000ae4   6eea     MOVWF     0xea,0x0                                                                                        
000ae6   50ee     MOVF      0xee,0x0,0x0                                                                                    
000ae8   10ed     IORWF     0xed,0x0,0x0                                                                                    
000aea   e01d     BZ        0xb26                                                                                           
000aec   0efb     MOVLW     0xfb           		buffer += seisu+shousu+1;			//全体桁数＋小数点                                 E:\usb20\logger\main.c
000aee   cfdb     MOVFF     0xfdb,0x16                                                                                      
000af0   f016                                                                                                               
000af2   0efc     MOVLW     0xfc                                                                                            
000af4   cfdb     MOVFF     0xfdb,0x17                                                                                      
000af6   f017                                                                                                               
000af8   0efd     MOVLW     0xfd                                                                                            
000afa   50db     MOVF      0xdb,0x0,0x0                                                                                    
000afc   2416     ADDWF     0x16,0x0,0x0                                                                                    
000afe   6e14     MOVWF     0x14,0x0                                                                                        
000b00   0efe     MOVLW     0xfe                                                                                            
000b02   50db     MOVF      0xdb,0x0,0x0                                                                                    
000b04   2017     ADDWFC    0x17,0x0,0x0                                                                                    
000b06   6e15     MOVWF     0x15,0x0                                                                                        
000b08   0e01     MOVLW     0x1                                                                                             
000b0a   2614     ADDWF     0x14,0x1,0x0                                                                                    
000b0c   0e00     MOVLW     0x0                                                                                             
000b0e   2215     ADDWFC    0x15,0x1,0x0                                                                                    
000b10   50d9     MOVF      0xd9,0x0,0x0                                                                                    
000b12   0ff5     ADDLW     0xf5                                                                                            
000b14   6ee9     MOVWF     0xe9,0x0                                                                                        
000b16   0eff     MOVLW     0xff                                                                                            
000b18   20da     ADDWFC    0xda,0x0,0x0                                                                                    
000b1a   6eea     MOVWF     0xea,0x0                                                                                        
000b1c   5014     MOVF      0x14,0x0,0x0                                                                                    
000b1e   26ee     ADDWF     0xee,0x1,0x0                                                                                    
000b20   5015     MOVF      0x15,0x0,0x0                                                                                    
000b22   22ed     ADDWFC    0xed,0x1,0x0                                                                                    
000b24   d018     BRA       0xb56          	else								//小数部桁なしのとき                                                E:\usb20\logger\main.c
000b26   0efb     MOVLW     0xfb           		buffer += seisu + shousu;			//全体桁数のみ                                     E:\usb20\logger\main.c
000b28   cfdb     MOVFF     0xfdb,0x16                                                                                      
000b2a   f016                                                                                                               
000b2c   0efc     MOVLW     0xfc                                                                                            
000b2e   cfdb     MOVFF     0xfdb,0x17                                                                                      
000b30   f017                                                                                                               
000b32   0efd     MOVLW     0xfd                                                                                            
000b34   50db     MOVF      0xdb,0x0,0x0                                                                                    
000b36   2416     ADDWF     0x16,0x0,0x0                                                                                    
000b38   6e14     MOVWF     0x14,0x0                                                                                        
000b3a   0efe     MOVLW     0xfe                                                                                            
000b3c   50db     MOVF      0xdb,0x0,0x0                                                                                    
000b3e   2017     ADDWFC    0x17,0x0,0x0                                                                                    
000b40   6e15     MOVWF     0x15,0x0                                                                                        
000b42   50d9     MOVF      0xd9,0x0,0x0                                                                                    
000b44   0ff5     ADDLW     0xf5                                                                                            
000b46   6ee9     MOVWF     0xe9,0x0                                                                                        
000b48   0eff     MOVLW     0xff                                                                                            
000b4a   20da     ADDWFC    0xda,0x0,0x0                                                                                    
000b4c   6eea     MOVWF     0xea,0x0                                                                                        
000b4e   5014     MOVF      0x14,0x0,0x0                                                                                    
000b50   26ee     ADDWF     0xee,0x1,0x0                                                                                    
000b52   5015     MOVF      0x15,0x0,0x0                                                                                    
000b54   22ed     ADDWFC    0xed,0x1,0x0                                                                                    
000b56   0ef5     MOVLW     0xf5           	buffer--;							//配列ポインタ-1                                                E:\usb20\logger\main.c
000b58   06db     DECF      0xdb,0x1,0x0                                                                                    
000b5a   0ef6     MOVLW     0xf6                                                                                            
000b5c   e201     BC        0xb60                                                                                           
000b5e   06db     DECF      0xdb,0x1,0x0                                                                                    
000b60   6ade     CLRF      0xde,0x0       	for(i=0; i<shousu; i++)				//小数部を整数に変換                                 E:\usb20\logger\main.c
000b62   6add     CLRF      0xdd,0x0                                                                                        
000b64   cfde     MOVFF     0xfde,0x14                                                                                      
000b66   f014                                                                                                               
000b68   cfdd     MOVFF     0xfdd,0x15                                                                                      
000b6a   f015                                                                                                               
000b6c   0efb     MOVLW     0xfb                                                                                            
000b6e   cfdb     MOVFF     0xfdb,0x16                                                                                      
000b70   f016                                                                                                               
000b72   0efc     MOVLW     0xfc                                                                                            
000b74   cfdb     MOVFF     0xfdb,0x17                                                                                      
000b76   f017                                                                                                               
000b78   5015     MOVF      0x15,0x0,0x0                                                                                    
000b7a   1817     XORWF     0x17,0x0,0x0                                                                                    
000b7c   aee8     BTFSS     0xe8,0x7,0x0                                                                                    
000b7e   d002     BRA       0xb84                                                                                           
000b80   3417     RLCF      0x17,0x0,0x0                                                                                    
000b82   d004     BRA       0xb8c                                                                                           
000b84   5016     MOVF      0x16,0x0,0x0                                                                                    
000b86   5c14     SUBWF     0x14,0x0,0x0                                                                                    
000b88   5017     MOVF      0x17,0x0,0x0                                                                                    
000b8a   5815     SUBWFB    0x15,0x0,0x0                                                                                    
000b8c   e22d     BC        0xbe8                                                                                           
000bde   2adf     INCF      0xdf,0x1,0x0                                                                                    
000be0   0e01     MOVLW     0x1                                                                                             
000be2   e301     BNC       0xbe6                                                                                           
000be4   2adb     INCF      0xdb,0x1,0x0                                                                                    
000be6   d7be     BRA       0xb64                                                                                           
000b8e   0ef7     MOVLW     0xf7           		data = data * 10;					//１０倍                                                 E:\usb20\logger\main.c
000b90   cfdb     MOVFF     0xfdb,0x14                                                                                      
000b92   f014                                                                                                               
000b94   0ef8     MOVLW     0xf8                                                                                            
000b96   cfdb     MOVFF     0xfdb,0x15                                                                                      
000b98   f015                                                                                                               
000b9a   0ef9     MOVLW     0xf9                                                                                            
000b9c   cfdb     MOVFF     0xfdb,0x16                                                                                      
000b9e   f016                                                                                                               
000ba0   0efa     MOVLW     0xfa                                                                                            
000ba2   cfdb     MOVFF     0xfdb,0x17                                                                                      
000ba4   f017                                                                                                               
000ba6   6a0a     CLRF      0xa,0x0                                                                                         
000ba8   6a0b     CLRF      0xb,0x0                                                                                         
000baa   0e20     MOVLW     0x20                                                                                            
000bac   6e0c     MOVWF     0xc,0x0                                                                                         
000bae   0e41     MOVLW     0x41                                                                                            
000bb0   6e0d     MOVWF     0xd,0x0                                                                                         
000bb2   c014     MOVFF     0x14,0x5                                                                                        
000bb4   f005                                                                                                               
000bb6   c015     MOVFF     0x15,0x6                                                                                        
000bb8   f006                                                                                                               
000bba   c016     MOVFF     0x16,0x7                                                                                        
000bbc   f007                                                                                                               
000bbe   c017     MOVFF     0x17,0x8                                                                                        
000bc0   f008                                                                                                               
000bc2   ecce     CALL      0xf9c,0x0                                                                                       
000bc4   f007                                                                                                               
000bc6   0ef7     MOVLW     0xf7                                                                                            
000bc8   c005     MOVFF     0x5,0xfdb                                                                                       
000bca   ffdb                                                                                                               
000bcc   0ef8     MOVLW     0xf8                                                                                            
000bce   c006     MOVFF     0x6,0xfdb                                                                                       
000bd0   ffdb                                                                                                               
000bd2   0ef9     MOVLW     0xf9                                                                                            
000bd4   c007     MOVFF     0x7,0xfdb                                                                                       
000bd6   ffdb                                                                                                               
000bd8   0efa     MOVLW     0xfa                                                                                            
000bda   c008     MOVFF     0x8,0xfdb                                                                                       
000bdc   ffdb                                                                                                               
000be8   0ef7     MOVLW     0xf7           	dumy = (int) (data + 0.5);				//四捨五入して整数に変換                          E:\usb20\logger\main.c
000bea   cfdb     MOVFF     0xfdb,0x14                                                                                      
000bec   f014                                                                                                               
000bee   0ef8     MOVLW     0xf8                                                                                            
000bf0   cfdb     MOVFF     0xfdb,0x15                                                                                      
000bf2   f015                                                                                                               
000bf4   0ef9     MOVLW     0xf9                                                                                            
000bf6   cfdb     MOVFF     0xfdb,0x16                                                                                      
000bf8   f016                                                                                                               
000bfa   0efa     MOVLW     0xfa                                                                                            
000bfc   cfdb     MOVFF     0xfdb,0x17                                                                                      
000bfe   f017                                                                                                               
000c00   6a0a     CLRF      0xa,0x0                                                                                         
000c02   6a0b     CLRF      0xb,0x0                                                                                         
000c04   6a0c     CLRF      0xc,0x0                                                                                         
000c06   0e3f     MOVLW     0x3f                                                                                            
000c08   6e0d     MOVWF     0xd,0x0                                                                                         
000c0a   c014     MOVFF     0x14,0x5                                                                                        
000c0c   f005                                                                                                               
000c0e   c015     MOVFF     0x15,0x6                                                                                        
000c10   f006                                                                                                               
000c12   c016     MOVFF     0x16,0x7                                                                                        
000c14   f007                                                                                                               
000c16   c017     MOVFF     0x17,0x8                                                                                        
000c18   f008                                                                                                               
000c1a   ece5     CALL      0xdca,0x0                                                                                       
000c1c   f006                                                                                                               
000c1e   ec61     CALL      0x10c2,0x0                                                                                      
000c20   f008                                                                                                               
000c22   0e02     MOVLW     0x2                                                                                             
000c24   c006     MOVFF     0x6,0xfdb                                                                                       
000c26   ffdb                                                                                                               
000c28   0e03     MOVLW     0x3                                                                                             
000c2a   c007     MOVFF     0x7,0xfdb                                                                                       
000c2c   ffdb                                                                                                               
000c2e   0efb     MOVLW     0xfb           	for(i=shousu; i>0; i--)	{			//小数桁数分繰り返し                                E:\usb20\logger\main.c
000c30   cfdb     MOVFF     0xfdb,0xfde                                                                                     
000c32   ffde                                                                                                               
000c34   cfdb     MOVFF     0xfdb,0xfdd                                                                                     
000c36   ffdd                                                                                                               
000c38   cfde     MOVFF     0xfde,0x14                                                                                      
000c3a   f014                                                                                                               
000c3c   cfdd     MOVFF     0xfdd,0x15                                                                                      
000c3e   f015                                                                                                               
000c40   3415     RLCF      0x15,0x0,0x0                                                                                    
000c42   e204     BC        0xc4c                                                                                           
000c44   5014     MOVF      0x14,0x0,0x0                                                                                    
000c46   0800     SUBLW     0x0                                                                                             
000c48   0e00     MOVLW     0x0                                                                                             
000c4a   5415     SUBFWB    0x15,0x0,0x0                                                                                    
000c4c   e23b     BC        0xcc4                                                                                           
000cba   06df     DECF      0xdf,0x1,0x0                                                                                    
000cbc   0e01     MOVLW     0x1                                                                                             
000cbe   e201     BC        0xcc2                                                                                           
000cc0   06db     DECF      0xdb,0x1,0x0                                                                                    
000cc2   d7ba     BRA       0xc38                                                                                           
000c4e   0e02     MOVLW     0x2            		*buffer =(dumy % 10)+'0';			//数値を文字に変換格納                             E:\usb20\logger\main.c
000c50   cfdb     MOVFF     0xfdb,0x14                                                                                      
000c52   f014                                                                                                               
000c54   0e03     MOVLW     0x3                                                                                             
000c56   cfdb     MOVFF     0xfdb,0x15                                                                                      
000c58   f015                                                                                                               
000c5a   0e0a     MOVLW     0xa                                                                                             
000c5c   6e0b     MOVWF     0xb,0x0                                                                                         
000c5e   6a0c     CLRF      0xc,0x0                                                                                         
000c60   c014     MOVFF     0x14,0x6                                                                                        
000c62   f006                                                                                                               
000c64   c015     MOVFF     0x15,0x7                                                                                        
000c66   f007                                                                                                               
000c68   ec3b     CALL      0x1076,0x0                                                                                      
000c6a   f008                                                                                                               
000c6c   c002     MOVFF     0x2,0x14                                                                                        
000c6e   f014                                                                                                               
000c70   c003     MOVFF     0x3,0x15                                                                                        
000c72   f015                                                                                                               
000c74   0e30     MOVLW     0x30                                                                                            
000c76   2614     ADDWF     0x14,0x1,0x0                                                                                    
000c78   0e00     MOVLW     0x0                                                                                             
000c7a   2215     ADDWFC    0x15,0x1,0x0                                                                                    
000c7c   0ef5     MOVLW     0xf5                                                                                            
000c7e   cfdb     MOVFF     0xfdb,0xfe9                                                                                     
000c80   ffe9                                                                                                               
000c82   0ef6     MOVLW     0xf6                                                                                            
000c84   cfdb     MOVFF     0xfdb,0xfea                                                                                     
000c86   ffea                                                                                                               
000c88   c014     MOVFF     0x14,0xfef                                                                                      
000c8a   ffef                                                                                                               
000c8c   0ef5     MOVLW     0xf5           		buffer--;						//格納場所下位から上位へ                                        E:\usb20\logger\main.c
000c8e   06db     DECF      0xdb,0x1,0x0                                                                                    
000c90   0ef6     MOVLW     0xf6                                                                                            
000c92   e201     BC        0xc96                                                                                           
000c94   06db     DECF      0xdb,0x1,0x0                                                                                    
000c96   50d9     MOVF      0xd9,0x0,0x0   		dumy /= 10;						//次の桁へ                                                    E:\usb20\logger\main.c
000c98   0f02     ADDLW     0x2                                                                                             
000c9a   6ee9     MOVWF     0xe9,0x0                                                                                        
000c9c   cfda     MOVFF     0xfda,0xfea                                                                                     
000c9e   ffea                                                                                                               
000ca0   0e0a     MOVLW     0xa                                                                                             
000ca2   6e0b     MOVWF     0xb,0x0                                                                                         
000ca4   6a0c     CLRF      0xc,0x0                                                                                         
000ca6   cfee     MOVFF     0xfee,0x6                                                                                       
000ca8   f006                                                                                                               
000caa   cfed     MOVFF     0xfed,0x7                                                                                       
000cac   f007                                                                                                               
000cae   ec3b     CALL      0x1076,0x0                                                                                      
000cb0   f008                                                                                                               
000cb2   c006     MOVFF     0x6,0xfee                                                                                       
000cb4   ffee                                                                                                               
000cb6   c007     MOVFF     0x7,0xfed                                                                                       
000cb8   ffed                                                                                                               
                                           	}                                                                               E:\usb20\logger\main.c
000cc4   50d9     MOVF      0xd9,0x0,0x0   	if(shousu != 0) {						//小数桁0なら小数点なし                                  E:\usb20\logger\main.c
000cc6   0ffb     ADDLW     0xfb                                                                                            
000cc8   6ee9     MOVWF     0xe9,0x0                                                                                        
000cca   0eff     MOVLW     0xff                                                                                            
000ccc   20da     ADDWFC    0xda,0x0,0x0                                                                                    
000cce   6eea     MOVWF     0xea,0x0                                                                                        
000cd0   50ee     MOVF      0xee,0x0,0x0                                                                                    
000cd2   10ed     IORWF     0xed,0x0,0x0                                                                                    
000cd4   e00d     BZ        0xcf0                                                                                           
000cd6   0ef5     MOVLW     0xf5           		*buffer = '.';					//小数点を格納                                              E:\usb20\logger\main.c
000cd8   cfdb     MOVFF     0xfdb,0xfe9                                                                                     
000cda   ffe9                                                                                                               
000cdc   0ef6     MOVLW     0xf6                                                                                            
000cde   cfdb     MOVFF     0xfdb,0xfea                                                                                     
000ce0   ffea                                                                                                               
000ce2   0e2e     MOVLW     0x2e                                                                                            
000ce4   6eef     MOVWF     0xef,0x0                                                                                        
000ce6   0ef5     MOVLW     0xf5           		buffer--;						//ポインタ-1                                                    E:\usb20\logger\main.c
000ce8   06db     DECF      0xdb,0x1,0x0                                                                                    
000cea   0ef6     MOVLW     0xf6                                                                                            
000cec   e201     BC        0xcf0                                                                                           
000cee   06db     DECF      0xdb,0x1,0x0                                                                                    
                                           	}                                                                               E:\usb20\logger\main.c
000cf0   0efd     MOVLW     0xfd           	for(i=seisu; i>0; i--) {				//整数桁分繰り返し                                  E:\usb20\logger\main.c
000cf2   cfdb     MOVFF     0xfdb,0xfde                                                                                     
000cf4   ffde                                                                                                               
000cf6   cfdb     MOVFF     0xfdb,0xfdd                                                                                     
000cf8   ffdd                                                                                                               
000cfa   cfde     MOVFF     0xfde,0x14                                                                                      
000cfc   f014                                                                                                               
000cfe   cfdd     MOVFF     0xfdd,0x15                                                                                      
000d00   f015                                                                                                               
000d02   3415     RLCF      0x15,0x0,0x0                                                                                    
000d04   e204     BC        0xd0e                                                                                           
000d06   5014     MOVF      0x14,0x0,0x0                                                                                    
000d08   0800     SUBLW     0x0                                                                                             
000d0a   0e00     MOVLW     0x0                                                                                             
000d0c   5415     SUBFWB    0x15,0x0,0x0                                                                                    
000d0e   e23b     BC        0xd86                                                                                           
000d7c   06df     DECF      0xdf,0x1,0x0                                                                                    
000d7e   0e01     MOVLW     0x1                                                                                             
000d80   e201     BC        0xd84                                                                                           
000d82   06db     DECF      0xdb,0x1,0x0                                                                                    
000d84   d7ba     BRA       0xcfa                                                                                           
000d10   0e02     MOVLW     0x2            		*buffer = (dumy % 10)+'0';			//数値を文字に変換格納                            E:\usb20\logger\main.c
000d12   cfdb     MOVFF     0xfdb,0x14                                                                                      
000d14   f014                                                                                                               
000d16   0e03     MOVLW     0x3                                                                                             
000d18   cfdb     MOVFF     0xfdb,0x15                                                                                      
000d1a   f015                                                                                                               
000d1c   0e0a     MOVLW     0xa                                                                                             
000d1e   6e0b     MOVWF     0xb,0x0                                                                                         
000d20   6a0c     CLRF      0xc,0x0                                                                                         
000d22   c014     MOVFF     0x14,0x6                                                                                        
000d24   f006                                                                                                               
000d26   c015     MOVFF     0x15,0x7                                                                                        
000d28   f007                                                                                                               
000d2a   ec3b     CALL      0x1076,0x0                                                                                      
000d2c   f008                                                                                                               
000d2e   c002     MOVFF     0x2,0x14                                                                                        
000d30   f014                                                                                                               
000d32   c003     MOVFF     0x3,0x15                                                                                        
000d34   f015                                                                                                               
000d36   0e30     MOVLW     0x30                                                                                            
000d38   2614     ADDWF     0x14,0x1,0x0                                                                                    
000d3a   0e00     MOVLW     0x0                                                                                             
000d3c   2215     ADDWFC    0x15,0x1,0x0                                                                                    
000d3e   0ef5     MOVLW     0xf5                                                                                            
000d40   cfdb     MOVFF     0xfdb,0xfe9                                                                                     
000d42   ffe9                                                                                                               
000d44   0ef6     MOVLW     0xf6                                                                                            
000d46   cfdb     MOVFF     0xfdb,0xfea                                                                                     
000d48   ffea                                                                                                               
000d4a   c014     MOVFF     0x14,0xfef                                                                                      
000d4c   ffef                                                                                                               
000d4e   0ef5     MOVLW     0xf5           		buffer--;						//ポインタ-1                                                    E:\usb20\logger\main.c
000d50   06db     DECF      0xdb,0x1,0x0                                                                                    
000d52   0ef6     MOVLW     0xf6                                                                                            
000d54   e201     BC        0xd58                                                                                           
000d56   06db     DECF      0xdb,0x1,0x0                                                                                    
000d58   50d9     MOVF      0xd9,0x0,0x0   		dumy /= 10;						//次の桁へ                                                    E:\usb20\logger\main.c
000d5a   0f02     ADDLW     0x2                                                                                             
000d5c   6ee9     MOVWF     0xe9,0x0                                                                                        
000d5e   cfda     MOVFF     0xfda,0xfea                                                                                     
000d60   ffea                                                                                                               
000d62   0e0a     MOVLW     0xa                                                                                             
000d64   6e0b     MOVWF     0xb,0x0                                                                                         
000d66   6a0c     CLRF      0xc,0x0                                                                                         
000d68   cfee     MOVFF     0xfee,0x6                                                                                       
000d6a   f006                                                                                                               
000d6c   cfed     MOVFF     0xfed,0x7                                                                                       
000d6e   f007                                                                                                               
000d70   ec3b     CALL      0x1076,0x0                                                                                      
000d72   f008                                                                                                               
000d74   c006     MOVFF     0x6,0xfee                                                                                       
000d76   ffee                                                                                                               
000d78   c007     MOVFF     0x7,0xfed                                                                                       
000d7a   ffed                                                                                                               
                                           	}                                                                               E:\usb20\logger\main.c
000d86   6ef5     MOVWF     0xf5,0x0       }                                                                                E:\usb20\logger\main.c
000d88   0e04     MOVLW     0x4                                                                                             
000d8a   5ce1     SUBWF     0xe1,0x0,0x0                                                                                    
000d8c   e202     BC        0xd92                                                                                           
000d8e   6ae1     CLRF      0xe1,0x0                                                                                        
000d90   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000d92   6ee1     MOVWF     0xe1,0x0                                                                                        
000d94   50f5     MOVF      0xf5,0x0,0x0                                                                                    
000d96   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000d98   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
000d9a   ffd9                                                                                                               
000d9c   0012     RETURN    0x0                                                                                             
                                           ///////////////////////////////////////////////                                  E:\usb20\logger\lcd_lib.c
                                           //  液晶表示器制御ライブラリ　for PIC18Fxxxx                                     E:\usb20\logger\lcd_lib.c
                                           //  内蔵関数は以下                                                               E:\usb20\logger\lcd_lib.c
                                           //    lcd_init()    ----- 初期化                                                 E:\usb20\logger\lcd_lib.c
                                           //    lcd_cmd(cmd)  ----- コマンド出力                                           E:\usb20\logger\lcd_lib.c
                                           //    lcd_data(chr) ----- １文字表示出力                                         E:\usb20\logger\lcd_lib.c
                                           //    lcd_clear()   ----- 全消去                                                 E:\usb20\logger\lcd_lib.c
                                           //////////////////////////////////////////////                                   E:\usb20\logger\lcd_lib.c
                                           #include <p18cxxx.h>                                                             E:\usb20\logger\lcd_lib.c
                                           #include "io_cfg.h"                                                              E:\usb20\logger\lcd_lib.c
                                           #include	"delays.h"                                                              E:\usb20\logger\lcd_lib.c
                                           #include "lcd_lib.h"                                                             E:\usb20\logger\lcd_lib.c
                                                                                                                            E:\usb20\logger\lcd_lib.c
                                           //////// データ出力サブ関数                                                      E:\usb20\logger\lcd_lib.c
001bb0   cfd9     MOVFF     0xfd9,0xfe6    void lcd_out(char code, char flag)                                               E:\usb20\logger\lcd_lib.c
001bb2   ffe6                                                                                                               
001bb4   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
001bb6   ffd9                                                                                                               
                                           {                                                                                E:\usb20\logger\lcd_lib.c
001bb8   0efe     MOVLW     0xfe           	lcd_port = code & 0xF0;                                                         E:\usb20\logger\lcd_lib.c
001bba   50db     MOVF      0xdb,0x0,0x0                                                                                    
001bbc   0bf0     ANDLW     0xf0                                                                                            
001bbe   6e8a     MOVWF     0x8a,0x0                                                                                        
001bc0   0efd     MOVLW     0xfd           	if (flag == 0)                                                                  E:\usb20\logger\lcd_lib.c
001bc2   50db     MOVF      0xdb,0x0,0x0                                                                                    
001bc4   e102     BNZ       0x1bca                                                                                          
001bc6   848a     BSF       0x8a,0x2,0x0   		lcd_rs = 1;			//表示データの場合                                               E:\usb20\logger\lcd_lib.c
001bc8   d001     BRA       0x1bcc         	else                                                                            E:\usb20\logger\lcd_lib.c
001bca   948a     BCF       0x8a,0x2,0x0   		lcd_rs = 0;			//コマンドデータの場合                                           E:\usb20\logger\lcd_lib.c
001bcc   0000     NOP                      	Delay1TCY();				//NOP		                                                         E:\usb20\logger\lcd_lib.c
001bce   868a     BSF       0x8a,0x3,0x0   	lcd_stb = 1;				//strobe out                                                    E:\usb20\logger\lcd_lib.c
001bd0   0e01     MOVLW     0x1            	Delay10TCYx(1);			//10NOP                                                       E:\usb20\logger\lcd_lib.c
001bd2   6ee6     MOVWF     0xe6,0x0                                                                                        
001bd4   eca2     CALL      0x2144,0x0                                                                                      
001bd6   f010                                                                                                               
001bd8   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001bda   968a     BCF       0x8a,0x3,0x0   	lcd_stb = 0;				//reset strobe                                                  E:\usb20\logger\lcd_lib.c
001bdc   52e5     MOVF      0xe5,0x1,0x0   }                                                                                E:\usb20\logger\lcd_lib.c
001bde   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
001be0   ffd9                                                                                                               
001be2   0012     RETURN    0x0                                                                                             
                                           //////// １文字表示関数                                                          E:\usb20\logger\lcd_lib.c
001be4   cfd9     MOVFF     0xfd9,0xfe6    void lcd_data(char asci)                                                         E:\usb20\logger\lcd_lib.c
001be6   ffe6                                                                                                               
001be8   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
001bea   ffd9                                                                                                               
                                           {                                                                                E:\usb20\logger\lcd_lib.c
001bec   6ae6     CLRF      0xe6,0x0       	lcd_out(asci, 0);			//上位４ビット出力                                          E:\usb20\logger\lcd_lib.c
001bee   0efe     MOVLW     0xfe                                                                                            
001bf0   cfdb     MOVFF     0xfdb,0xfe6                                                                                     
001bf2   ffe6                                                                                                               
001bf4   dfdd     RCALL     0x1bb0                                                                                          
001bf6   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001bf8   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001bfa   6ae6     CLRF      0xe6,0x0       	lcd_out(asci<<4, 0);		//下位４ビット出力                                        E:\usb20\logger\lcd_lib.c
001bfc   0efe     MOVLW     0xfe                                                                                            
001bfe   38db     SWAPF     0xdb,0x0,0x0                                                                                    
001c00   0bf0     ANDLW     0xf0                                                                                            
001c02   6ee6     MOVWF     0xe6,0x0                                                                                        
001c04   dfd5     RCALL     0x1bb0                                                                                          
001c06   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001c08   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001c0a   0e32     MOVLW     0x32           	Delay10TCYx(50);			//50μsec待ち                                                E:\usb20\logger\lcd_lib.c
001c0c   6ee6     MOVWF     0xe6,0x0                                                                                        
001c0e   eca2     CALL      0x2144,0x0                                                                                      
001c10   f010                                                                                                               
001c12   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001c14   52e5     MOVF      0xe5,0x1,0x0   }                                                                                E:\usb20\logger\lcd_lib.c
001c16   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
001c18   ffd9                                                                                                               
001c1a   0012     RETURN    0x0                                                                                             
                                           /////// コマンド出力関数                                                         E:\usb20\logger\lcd_lib.c
001c1c   cfd9     MOVFF     0xfd9,0xfe6    void lcd_cmd(char cmd)                                                           E:\usb20\logger\lcd_lib.c
001c1e   ffe6                                                                                                               
001c20   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
001c22   ffd9                                                                                                               
                                           {                                                                                E:\usb20\logger\lcd_lib.c
001c24   0e01     MOVLW     0x1            	lcd_out(cmd, 1);			//上位４ビット出力                                           E:\usb20\logger\lcd_lib.c
001c26   6ee6     MOVWF     0xe6,0x0                                                                                        
001c28   0efe     MOVLW     0xfe                                                                                            
001c2a   cfdb     MOVFF     0xfdb,0xfe6                                                                                     
001c2c   ffe6                                                                                                               
001c2e   dfc0     RCALL     0x1bb0                                                                                          
001c30   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001c32   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001c34   0e01     MOVLW     0x1            	lcd_out(cmd<<4, 1);		//下位４ビット出力                                         E:\usb20\logger\lcd_lib.c
001c36   6ee6     MOVWF     0xe6,0x0                                                                                        
001c38   0efe     MOVLW     0xfe                                                                                            
001c3a   38db     SWAPF     0xdb,0x0,0x0                                                                                    
001c3c   0bf0     ANDLW     0xf0                                                                                            
001c3e   6ee6     MOVWF     0xe6,0x0                                                                                        
001c40   dfb7     RCALL     0x1bb0                                                                                          
001c42   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001c44   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001c46   0efe     MOVLW     0xfe           	if((cmd & 0x03) != 0)                                                           E:\usb20\logger\lcd_lib.c
001c48   50db     MOVF      0xdb,0x0,0x0                                                                                    
001c4a   0b03     ANDLW     0x3                                                                                             
001c4c   e006     BZ        0x1c5a                                                                                          
001c4e   0e02     MOVLW     0x2            		Delay10KTCYx(2);		//2msec待ち                                                  E:\usb20\logger\lcd_lib.c
001c50   6ee6     MOVWF     0xe6,0x0                                                                                        
001c52   ec69     CALL      0x20d2,0x0                                                                                      
001c54   f010                                                                                                               
001c56   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001c58   d005     BRA       0x1c64         	else                                                                            E:\usb20\logger\lcd_lib.c
001c5a   0e32     MOVLW     0x32           		Delay10TCYx(50);		//50usec待ち                                                 E:\usb20\logger\lcd_lib.c
001c5c   6ee6     MOVWF     0xe6,0x0                                                                                        
001c5e   eca2     CALL      0x2144,0x0                                                                                      
001c60   f010                                                                                                               
001c62   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001c64   52e5     MOVF      0xe5,0x1,0x0   }                                                                                E:\usb20\logger\lcd_lib.c
001c66   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
001c68   ffd9                                                                                                               
001c6a   0012     RETURN    0x0                                                                                             
                                           /////// 全消去関数                                                               E:\usb20\logger\lcd_lib.c
                                           void lcd_clear(void)                                                             E:\usb20\logger\lcd_lib.c
                                           {                                                                                E:\usb20\logger\lcd_lib.c
001c6c   0e01     MOVLW     0x1            	lcd_cmd(0x01);			//初期化コマンド出力                                           E:\usb20\logger\lcd_lib.c
001c6e   6ee6     MOVWF     0xe6,0x0                                                                                        
001c70   dfd5     RCALL     0x1c1c                                                                                          
001c72   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001c74   0012     RETURN    0x0            }                                                                                E:\usb20\logger\lcd_lib.c
                                                                                                                            E:\usb20\logger\lcd_lib.c
                                           /////// 文字列出力関数                                                           E:\usb20\logger\lcd_lib.c
001c76   cfd9     MOVFF     0xfd9,0xfe6    void lcd_str(char *str)                                                          E:\usb20\logger\lcd_lib.c
001c78   ffe6                                                                                                               
001c7a   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
001c7c   ffd9                                                                                                               
                                           {                                                                                E:\usb20\logger\lcd_lib.c
001c7e   0efd     MOVLW     0xfd           	while(*str != 0x00)			//文字列の終わり判定                                      E:\usb20\logger\lcd_lib.c
001c80   cfdb     MOVFF     0xfdb,0xfe9                                                                                     
001c82   ffe9                                                                                                               
001c84   0efe     MOVLW     0xfe                                                                                            
001c86   cfdb     MOVFF     0xfdb,0xfea                                                                                     
001c88   ffea                                                                                                               
001c8a   50ef     MOVF      0xef,0x0,0x0                                                                                    
001c8c   e010     BZ        0x1cae                                                                                          
001cac   d7e8     BRA       0x1c7e                                                                                          
                                           	{                                                                               E:\usb20\logger\lcd_lib.c
001c8e   0efd     MOVLW     0xfd           		lcd_data(*str);			//文字列１文字出力                                           E:\usb20\logger\lcd_lib.c
001c90   cfdb     MOVFF     0xfdb,0xfe9                                                                                     
001c92   ffe9                                                                                                               
001c94   0efe     MOVLW     0xfe                                                                                            
001c96   cfdb     MOVFF     0xfdb,0xfea                                                                                     
001c98   ffea                                                                                                               
001c9a   50ef     MOVF      0xef,0x0,0x0                                                                                    
001c9c   6ee6     MOVWF     0xe6,0x0                                                                                        
001c9e   dfa2     RCALL     0x1be4                                                                                          
001ca0   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001ca2   0efd     MOVLW     0xfd           		str++;					//ポインタ＋１                                                      E:\usb20\logger\lcd_lib.c
001ca4   2adb     INCF      0xdb,0x1,0x0                                                                                    
001ca6   0efe     MOVLW     0xfe                                                                                            
001ca8   e301     BNC       0x1cac                                                                                          
001caa   2adb     INCF      0xdb,0x1,0x0                                                                                    
                                           	}                                                                               E:\usb20\logger\lcd_lib.c
001cae   52e5     MOVF      0xe5,0x1,0x0   }                                                                                E:\usb20\logger\lcd_lib.c
001cb0   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
001cb2   ffd9                                                                                                               
001cb4   0012     RETURN    0x0                                                                                             
                                                                                                                            E:\usb20\logger\lcd_lib.c
                                           /////// 初期化関数                                                               E:\usb20\logger\lcd_lib.c
                                           void lcd_init(void)                                                              E:\usb20\logger\lcd_lib.c
                                           {                                                                                E:\usb20\logger\lcd_lib.c
001cb6   0e14     MOVLW     0x14           	Delay10KTCYx(20);                                                               E:\usb20\logger\lcd_lib.c
001cb8   6ee6     MOVWF     0xe6,0x0                                                                                        
001cba   ec69     CALL      0x20d2,0x0                                                                                      
001cbc   f010                                                                                                               
001cbe   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001cc0   0e01     MOVLW     0x1            	lcd_out(0x30, 1);			//8bit mode set                                             E:\usb20\logger\lcd_lib.c
001cc2   6ee6     MOVWF     0xe6,0x0                                                                                        
001cc4   0e30     MOVLW     0x30                                                                                            
001cc6   6ee6     MOVWF     0xe6,0x0                                                                                        
001cc8   df73     RCALL     0x1bb0                                                                                          
001cca   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001ccc   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001cce   0e05     MOVLW     0x5            	Delay10KTCYx(5);                                                                E:\usb20\logger\lcd_lib.c
001cd0   6ee6     MOVWF     0xe6,0x0                                                                                        
001cd2   ec69     CALL      0x20d2,0x0                                                                                      
001cd4   f010                                                                                                               
001cd6   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001cd8   0e01     MOVLW     0x1            	lcd_out(0x30, 1);			//8bit mode set                                             E:\usb20\logger\lcd_lib.c
001cda   6ee6     MOVWF     0xe6,0x0                                                                                        
001cdc   0e30     MOVLW     0x30                                                                                            
001cde   6ee6     MOVWF     0xe6,0x0                                                                                        
001ce0   df67     RCALL     0x1bb0                                                                                          
001ce2   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001ce4   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001ce6   0e01     MOVLW     0x1            	Delay10KTCYx(1);                                                                E:\usb20\logger\lcd_lib.c
001ce8   6ee6     MOVWF     0xe6,0x0                                                                                        
001cea   ec69     CALL      0x20d2,0x0                                                                                      
001cec   f010                                                                                                               
001cee   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001cf0   0e01     MOVLW     0x1            	lcd_out(0x30, 1);			//8bit mode set                                             E:\usb20\logger\lcd_lib.c
001cf2   6ee6     MOVWF     0xe6,0x0                                                                                        
001cf4   0e30     MOVLW     0x30                                                                                            
001cf6   6ee6     MOVWF     0xe6,0x0                                                                                        
001cf8   df5b     RCALL     0x1bb0                                                                                          
001cfa   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001cfc   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001cfe   0e01     MOVLW     0x1            	Delay10KTCYx(1);                                                                E:\usb20\logger\lcd_lib.c
001d00   6ee6     MOVWF     0xe6,0x0                                                                                        
001d02   ec69     CALL      0x20d2,0x0                                                                                      
001d04   f010                                                                                                               
001d06   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001d08   0e01     MOVLW     0x1            	lcd_out(0x20, 1);			//4bit mode set                                             E:\usb20\logger\lcd_lib.c
001d0a   6ee6     MOVWF     0xe6,0x0                                                                                        
001d0c   0e20     MOVLW     0x20                                                                                            
001d0e   6ee6     MOVWF     0xe6,0x0                                                                                        
001d10   df4f     RCALL     0x1bb0                                                                                          
001d12   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001d14   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001d16   0e01     MOVLW     0x1            	Delay10KTCYx(1);                                                                E:\usb20\logger\lcd_lib.c
001d18   6ee6     MOVWF     0xe6,0x0                                                                                        
001d1a   ec69     CALL      0x20d2,0x0                                                                                      
001d1c   f010                                                                                                               
001d1e   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001d20   0e2e     MOVLW     0x2e           	lcd_cmd(0x2E);			//DL=0 4bit mode                                               E:\usb20\logger\lcd_lib.c
001d22   6ee6     MOVWF     0xe6,0x0                                                                                        
001d24   df7b     RCALL     0x1c1c                                                                                          
001d26   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001d28   0e08     MOVLW     0x8            	lcd_cmd(0x08);			//display off C=D=B=0                                          E:\usb20\logger\lcd_lib.c
001d2a   6ee6     MOVWF     0xe6,0x0                                                                                        
001d2c   df77     RCALL     0x1c1c                                                                                          
001d2e   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001d30   0e0d     MOVLW     0xd            	lcd_cmd(0x0D);			//display on C=D=1 B=0                                         E:\usb20\logger\lcd_lib.c
001d32   6ee6     MOVWF     0xe6,0x0                                                                                        
001d34   df73     RCALL     0x1c1c                                                                                          
001d36   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001d38   0e06     MOVLW     0x6            	lcd_cmd(0x06);			//entry I/D=1 S=0                                              E:\usb20\logger\lcd_lib.c
001d3a   6ee6     MOVWF     0xe6,0x0                                                                                        
001d3c   df6f     RCALL     0x1c1c                                                                                          
001d3e   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001d40   0e01     MOVLW     0x1            	lcd_cmd(0x01);			//all clear                                                    E:\usb20\logger\lcd_lib.c
001d42   6ee6     MOVWF     0xe6,0x0                                                                                        
001d44   df6b     RCALL     0x1c1c                                                                                          
001d46   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001d48   0012     RETURN    0x0            }                                                                                E:\usb20\logger\lcd_lib.c
                                           /*********************************************************************           E:\usb20\logger\system\usb\usbmmap.c
                                            *                                                                               E:\usb20\logger\system\usb\usbmmap.c
                                            *                Microchip USB C18 Firmware Version 1.0                         E:\usb20\logger\system\usb\usbmmap.c
                                            *                                                                               E:\usb20\logger\system\usb\usbmmap.c
                                            *********************************************************************           E:\usb20\logger\system\usb\usbmmap.c
                                            * FileName:        usbmmap.c                                                    E:\usb20\logger\system\usb\usbmmap.c
                                            * Dependencies:    See INCLUDES section below                                   E:\usb20\logger\system\usb\usbmmap.c
                                            * Processor:       PIC18                                                        E:\usb20\logger\system\usb\usbmmap.c
                                            * Compiler:        C18 2.30.01+                                                 E:\usb20\logger\system\usb\usbmmap.c
                                            * Company:         Microchip Technology, Inc.                                   E:\usb20\logger\system\usb\usbmmap.c
                                            *                                                                               E:\usb20\logger\system\usb\usbmmap.c
                                            * Software License Agreement                                                    E:\usb20\logger\system\usb\usbmmap.c
                                            *                                                                               E:\usb20\logger\system\usb\usbmmap.c
                                            * The software supplied herewith by Microchip Technology Incorporated           E:\usb20\logger\system\usb\usbmmap.c
                                            * (the 鼎ompany) for its PICmicroｮ Microcontroller is intended and             E:\usb20\logger\system\usb\usbmmap.c
                                            * supplied to you, the Company痴 customer, for use solely and                   E:\usb20\logger\system\usb\usbmmap.c
                                            * exclusively on Microchip PICmicro Microcontroller products. The               E:\usb20\logger\system\usb\usbmmap.c
                                            * software is owned by the Company and/or its supplier, and is                  E:\usb20\logger\system\usb\usbmmap.c
                                            * protected under applicable copyright laws. All rights are reserved.           E:\usb20\logger\system\usb\usbmmap.c
                                            * Any use in violation of the foregoing restrictions may subject the            E:\usb20\logger\system\usb\usbmmap.c
                                            * user to criminal sanctions under applicable laws, as well as to               E:\usb20\logger\system\usb\usbmmap.c
                                            * civil liability for the breach of the terms and conditions of this            E:\usb20\logger\system\usb\usbmmap.c
                                            * license.                                                                      E:\usb20\logger\system\usb\usbmmap.c
                                            *                                                                               E:\usb20\logger\system\usb\usbmmap.c
                                            * THIS SOFTWARE IS PROVIDED IN AN 鄭S IS CONDITION. NO WARRANTIES,             E:\usb20\logger\system\usb\usbmmap.c
                                            * WHETHER EXPRESS, IMPLIED OR STATUTORY, INCLUDING, BUT NOT LIMITED             E:\usb20\logger\system\usb\usbmmap.c
                                            * TO, IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A                   E:\usb20\logger\system\usb\usbmmap.c
                                            * PARTICULAR PURPOSE APPLY TO THIS SOFTWARE. THE COMPANY SHALL NOT,             E:\usb20\logger\system\usb\usbmmap.c
                                            * IN ANY CIRCUMSTANCES, BE LIABLE FOR SPECIAL, INCIDENTAL OR                    E:\usb20\logger\system\usb\usbmmap.c
                                            * CONSEQUENTIAL DAMAGES, FOR ANY REASON WHATSOEVER.                             E:\usb20\logger\system\usb\usbmmap.c
                                            *                                                                               E:\usb20\logger\system\usb\usbmmap.c
                                            * Author               Date        Comment                                      E:\usb20\logger\system\usb\usbmmap.c
                                            *~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~           E:\usb20\logger\system\usb\usbmmap.c
                                            * Rawin Rojvanit       11/19/04    Original.                                    E:\usb20\logger\system\usb\usbmmap.c
                                            ********************************************************************/           E:\usb20\logger\system\usb\usbmmap.c
                                                                                                                            E:\usb20\logger\system\usb\usbmmap.c
                                           /******************************************************************************  E:\usb20\logger\system\usb\usbmmap.c
                                            * -usbmmap.c-                                                                   E:\usb20\logger\system\usb\usbmmap.c
                                            * USB Memory Map                                                                E:\usb20\logger\system\usb\usbmmap.c
                                            * This file is the USB memory manager; it serves as a compile-time memory       E:\usb20\logger\system\usb\usbmmap.c
                                            * allocator for the USB endpoints. It uses the compile time options passed      E:\usb20\logger\system\usb\usbmmap.c
                                            * from usbcfg.h to instantiate endpoints and endpoint buffer.                   E:\usb20\logger\system\usb\usbmmap.c
                                            *                                                                               E:\usb20\logger\system\usb\usbmmap.c
                                            * Each endpoint requires to have a set of Buffer Descriptor registers(BDT).     E:\usb20\logger\system\usb\usbmmap.c
                                            * A BDT is 4-byte long and has a specific RAM location for each endpoint.       E:\usb20\logger\system\usb\usbmmap.c
                                            * The BDT for endpoint 0 out is located at address 0x400 to 0x403.              E:\usb20\logger\system\usb\usbmmap.c
                                            * The BDT for endpoint 0 in is located at address 0x404 to 0x407.               E:\usb20\logger\system\usb\usbmmap.c
                                            * The BDT for endpoint 1 out is located at address 0x408 to 0x40B.              E:\usb20\logger\system\usb\usbmmap.c
                                            * and so on... The above allocation assumes the Ping-Pong Buffer Mode 0 is      E:\usb20\logger\system\usb\usbmmap.c
                                            * used. These locations are already hard-wired in the silicon. The point        E:\usb20\logger\system\usb\usbmmap.c
                                            * of doing instantiation, i.e. volatile far BDT ep0Bo;, is to provide the       E:\usb20\logger\system\usb\usbmmap.c
                                            * C compiler a way to address each variable directly. This is very important    E:\usb20\logger\system\usb\usbmmap.c
                                            * because when a register can be accessed directly, it saves execution time     E:\usb20\logger\system\usb\usbmmap.c
                                            * and reduces program size.                                                     E:\usb20\logger\system\usb\usbmmap.c
                                            *                                                                               E:\usb20\logger\system\usb\usbmmap.c
                                            * Endpoints are defined using the endpoint number and the direction             E:\usb20\logger\system\usb\usbmmap.c
                                            * of transfer. For simplicity, usbmmap.c only uses the endpoint number          E:\usb20\logger\system\usb\usbmmap.c
                                            * in the BDT register allocation scheme. This means if the usbcfg.h states      E:\usb20\logger\system\usb\usbmmap.c
                                            * that the MAX_EP_NUMBER is number 1, then four BDTs will be                    E:\usb20\logger\system\usb\usbmmap.c
                                            * instantiated: one each for endpoint0 in and endpoint0 out, which must         E:\usb20\logger\system\usb\usbmmap.c
                                            * always be instantiated for control transfer by default, and one each sets     E:\usb20\logger\system\usb\usbmmap.c
                                            * for endpoint1 in and endpoint1 out. The naming convention for instantiating   E:\usb20\logger\system\usb\usbmmap.c
                                            * BDT is                                                                        E:\usb20\logger\system\usb\usbmmap.c
                                            *                                                                               E:\usb20\logger\system\usb\usbmmap.c
                                            * ep<#>B<d>                                                                     E:\usb20\logger\system\usb\usbmmap.c
                                            *                                                                               E:\usb20\logger\system\usb\usbmmap.c
                                            * where # is the endpoint number, and d is the direction of                     E:\usb20\logger\system\usb\usbmmap.c
                                            * transfer, which could be either <i> or <o>.                                   E:\usb20\logger\system\usb\usbmmap.c
                                            *                                                                               E:\usb20\logger\system\usb\usbmmap.c
                                            * The USB memory manager uses MAX_EP_NUMBER, as defined in usbcfg.h, to define  E:\usb20\logger\system\usb\usbmmap.c
                                            * the endpoints to be instantiated. This represents the highest endpoint        E:\usb20\logger\system\usb\usbmmap.c
                                            * number to be allocated, not how many endpoints are used. Since the BDTs for   E:\usb20\logger\system\usb\usbmmap.c
                                            * endpoints have hardware-assigned addresses in Bank 4, setting this value too  E:\usb20\logger\system\usb\usbmmap.c
                                            * high may lead to inefficient use of data RAM. For example, if an application  E:\usb20\logger\system\usb\usbmmap.c
                                            * uses only endpoints EP0 and EP4, then the MAX_EP_NUMBER is 4, and not 2.      E:\usb20\logger\system\usb\usbmmap.c
                                            * The in-between endpoint BDTs in this example (EP1, EP2, and EP3) go unused,   E:\usb20\logger\system\usb\usbmmap.c
                                            * and the 24 bytes of memory associated with them are wasted. It does not make  E:\usb20\logger\system\usb\usbmmap.c
                                            * much sense to skip endpoints, but the final decision lies with the user.      E:\usb20\logger\system\usb\usbmmap.c
                                            *                                                                               E:\usb20\logger\system\usb\usbmmap.c
                                            * The next step is to assign the instantiated BDTs to different                 E:\usb20\logger\system\usb\usbmmap.c
                                            * USB functions. The firmware framework fundamentally assumes that every USB    E:\usb20\logger\system\usb\usbmmap.c
                                            * function should know which endpoint it is using, i.e., the default control    E:\usb20\logger\system\usb\usbmmap.c
                                            * transfer should know that it is using endpoint 0 in and endpoint 0 out.       E:\usb20\logger\system\usb\usbmmap.c
                                            * A HID class can choose which endpoint it wants to use, but once chosen, it    E:\usb20\logger\system\usb\usbmmap.c
                                            * should always know the number of the endpoint.                                E:\usb20\logger\system\usb\usbmmap.c
                                            *                                                                               E:\usb20\logger\system\usb\usbmmap.c
                                            * The assignment of endpoints to USB functions is managed centrally             E:\usb20\logger\system\usb\usbmmap.c
                                            * in usbcfg.h. This helps prevent the mistake of having more                    E:\usb20\logger\system\usb\usbmmap.c
                                            * than one USB function using the same endpoint. The "Endpoint Allocation"      E:\usb20\logger\system\usb\usbmmap.c
                                            * section in usbcfg.h provides examples for how to map USB endpoints to USB     E:\usb20\logger\system\usb\usbmmap.c
                                            * functions.                                                                    E:\usb20\logger\system\usb\usbmmap.c
                                            * Quite a few things can be mapped in that section. There is no                 E:\usb20\logger\system\usb\usbmmap.c
                                            * one correct way to do the mapping and the user has the choice to              E:\usb20\logger\system\usb\usbmmap.c
                                            * choose a method that is most suitable to the application.                     E:\usb20\logger\system\usb\usbmmap.c
                                            *                                                                               E:\usb20\logger\system\usb\usbmmap.c
                                            * Typically, however, a user will want to map the following for a given         E:\usb20\logger\system\usb\usbmmap.c
                                            * USB interface function:                                                       E:\usb20\logger\system\usb\usbmmap.c
                                            * 1. The USB interface ID                                                       E:\usb20\logger\system\usb\usbmmap.c
                                            * 2. The endpoint control registers (UEPn)                                      E:\usb20\logger\system\usb\usbmmap.c
                                            * 3. The BDT registers (ep<#>B<d>)                                              E:\usb20\logger\system\usb\usbmmap.c
                                            * 4. The endpoint size                                                          E:\usb20\logger\system\usb\usbmmap.c
                                            *                                                                               E:\usb20\logger\system\usb\usbmmap.c
                                            * Example: Assume a USB device class "foo", which uses one out endpoint         E:\usb20\logger\system\usb\usbmmap.c
                                            *          of size 64-byte and one in endpoint of size 64-byte, then:           E:\usb20\logger\system\usb\usbmmap.c
                                            *                                                                               E:\usb20\logger\system\usb\usbmmap.c
                                            * #define FOO_INTF_ID          0x00                                             E:\usb20\logger\system\usb\usbmmap.c
                                            * #define FOO_UEP              UEP1                                             E:\usb20\logger\system\usb\usbmmap.c
                                            * #define FOO_BD_OUT           ep1Bo                                            E:\usb20\logger\system\usb\usbmmap.c
                                            * #define FOO_BD_IN            ep1Bi                                            E:\usb20\logger\system\usb\usbmmap.c
                                            * #define FOO_EP_SIZE          64                                               E:\usb20\logger\system\usb\usbmmap.c
                                            *                                                                               E:\usb20\logger\system\usb\usbmmap.c
                                            * The mapping above has chosen class "foo" to use endpoint 1.                   E:\usb20\logger\system\usb\usbmmap.c
                                            * The names are arbitrary and can be anything other than FOO_??????.            E:\usb20\logger\system\usb\usbmmap.c
                                            * For abstraction, the code for class "foo" should use the abstract             E:\usb20\logger\system\usb\usbmmap.c
                                            * definitions of FOO_BD_OUT,FOO_BD_IN, and not ep1Bo or ep1Bi.                  E:\usb20\logger\system\usb\usbmmap.c
                                            *                                                                               E:\usb20\logger\system\usb\usbmmap.c
                                            * Note that the endpoint size defined in the usbcfg.h file is again             E:\usb20\logger\system\usb\usbmmap.c
                                            * used in the usbmmap.c file. This shows that the relationship between          E:\usb20\logger\system\usb\usbmmap.c
                                            * the two files are tightly related.                                            E:\usb20\logger\system\usb\usbmmap.c
                                            *                                                                               E:\usb20\logger\system\usb\usbmmap.c
                                            * The endpoint buffer for each USB function must be located in the              E:\usb20\logger\system\usb\usbmmap.c
                                            * dual-port RAM area and has to come after all the BDTs have been               E:\usb20\logger\system\usb\usbmmap.c
                                            * instantiated. An example declaration is:                                      E:\usb20\logger\system\usb\usbmmap.c
                                            * volatile far unsigned char[FOO_EP_SIZE] data;                                 E:\usb20\logger\system\usb\usbmmap.c
                                            *                                                                               E:\usb20\logger\system\usb\usbmmap.c
                                            * The 'volatile' keyword tells the compiler not to perform any code             E:\usb20\logger\system\usb\usbmmap.c
                                            * optimization on this variable because its content could be modified           E:\usb20\logger\system\usb\usbmmap.c
                                            * by the hardware. The 'far' keyword tells the compiler that this variable      E:\usb20\logger\system\usb\usbmmap.c
                                            * is not located in the Access RAM area (0x000 - 0x05F).                        E:\usb20\logger\system\usb\usbmmap.c
                                            *                                                                               E:\usb20\logger\system\usb\usbmmap.c
                                            * For the variable to be globally accessible by other files, it should be       E:\usb20\logger\system\usb\usbmmap.c
                                            * declared in the header file usbmmap.h as an extern definition, such as        E:\usb20\logger\system\usb\usbmmap.c
                                            * extern volatile far unsigned char[FOO_EP_SIZE] data;                          E:\usb20\logger\system\usb\usbmmap.c
                                            *                                                                               E:\usb20\logger\system\usb\usbmmap.c
                                            * Conclusion:                                                                   E:\usb20\logger\system\usb\usbmmap.c
                                            * In a short summary, the dependencies between usbcfg and usbmmap can           E:\usb20\logger\system\usb\usbmmap.c
                                            * be shown as:                                                                  E:\usb20\logger\system\usb\usbmmap.c
                                            *                                                                               E:\usb20\logger\system\usb\usbmmap.c
                                            * usbcfg[MAX_EP_NUMBER] -> usbmmap                                              E:\usb20\logger\system\usb\usbmmap.c
                                            * usbmmap[ep<#>B<d>] -> usbcfg                                                  E:\usb20\logger\system\usb\usbmmap.c
                                            * usbcfg[EP size] -> usbmmap                                                    E:\usb20\logger\system\usb\usbmmap.c
                                            * usbcfg[abstract ep definitions] -> usb9/hid/cdc/etc class code                E:\usb20\logger\system\usb\usbmmap.c
                                            * usbmmap[endpoint buffer variable] -> usb9/hid/cdc/etc class code              E:\usb20\logger\system\usb\usbmmap.c
                                            *                                                                               E:\usb20\logger\system\usb\usbmmap.c
                                            * Data mapping provides a means for direct addressing of BDT and endpoint       E:\usb20\logger\system\usb\usbmmap.c
                                            * buffer. This means less usage of pointers, which equates to a faster and      E:\usb20\logger\system\usb\usbmmap.c
                                            * smaller program code.                                                         E:\usb20\logger\system\usb\usbmmap.c
                                            *                                                                               E:\usb20\logger\system\usb\usbmmap.c
                                            *****************************************************************************/  E:\usb20\logger\system\usb\usbmmap.c
                                                                                                                            E:\usb20\logger\system\usb\usbmmap.c
                                           /** I N C L U D E S **********************************************************/  E:\usb20\logger\system\usb\usbmmap.c
                                           #include "system\typedefs.h"                                                     E:\usb20\logger\system\usb\usbmmap.c
                                           #include "system\usb\usb.h"                                                      E:\usb20\logger\system\usb\usbmmap.c
                                                                                                                            E:\usb20\logger\system\usb\usbmmap.c
                                           /** U S B  G L O B A L  V A R I A B L E S ************************************/  E:\usb20\logger\system\usb\usbmmap.c
                                           #pragma udata                                                                    E:\usb20\logger\system\usb\usbmmap.c
                                           byte usb_device_state;          // Device States: DETACHED, ATTACHED, ...        E:\usb20\logger\system\usb\usbmmap.c
                                           USB_DEVICE_STATUS usb_stat;     // Global USB flags                              E:\usb20\logger\system\usb\usbmmap.c
                                           byte usb_active_cfg;            // Value of current configuration                E:\usb20\logger\system\usb\usbmmap.c
                                           byte usb_alt_intf[MAX_NUM_INT]; // Array to keep track of the current alternate  E:\usb20\logger\system\usb\usbmmap.c
                                                                           // setting for each interface ID                 E:\usb20\logger\system\usb\usbmmap.c
                                                                                                                            E:\usb20\logger\system\usb\usbmmap.c
                                           /** U S B  F I X E D  L O C A T I O N  V A R I A B L E S *********************/  E:\usb20\logger\system\usb\usbmmap.c
                                           #pragma udata usbram4=0x400     //See Linker Script,usb4:0x400-0x4FF(256-byte)   E:\usb20\logger\system\usb\usbmmap.c
                                                                                                                            E:\usb20\logger\system\usb\usbmmap.c
                                           /******************************************************************************  E:\usb20\logger\system\usb\usbmmap.c
                                            * Section A: Buffer Descriptor Table                                            E:\usb20\logger\system\usb\usbmmap.c
                                            * - 0x400 - 0x4FF(max)                                                          E:\usb20\logger\system\usb\usbmmap.c
                                            * - MAX_EP_NUMBER is defined in autofiles\usbcfg.h                              E:\usb20\logger\system\usb\usbmmap.c
                                            * - BDT data type is defined in system\usb\usbmmap.h                            E:\usb20\logger\system\usb\usbmmap.c
                                            *****************************************************************************/  E:\usb20\logger\system\usb\usbmmap.c
                                                                                                                            E:\usb20\logger\system\usb\usbmmap.c
                                           #if(0 <= MAX_EP_NUMBER)                                                          E:\usb20\logger\system\usb\usbmmap.c
                                           volatile far BDT ep0Bo;         //Endpoint #0 BD Out                             E:\usb20\logger\system\usb\usbmmap.c
                                           volatile far BDT ep0Bi;         //Endpoint #0 BD In                              E:\usb20\logger\system\usb\usbmmap.c
                                           #endif                                                                           E:\usb20\logger\system\usb\usbmmap.c
                                                                                                                            E:\usb20\logger\system\usb\usbmmap.c
                                           #if(1 <= MAX_EP_NUMBER)                                                          E:\usb20\logger\system\usb\usbmmap.c
                                           volatile far BDT ep1Bo;         //Endpoint #1 BD Out                             E:\usb20\logger\system\usb\usbmmap.c
                                           volatile far BDT ep1Bi;         //Endpoint #1 BD In                              E:\usb20\logger\system\usb\usbmmap.c
                                           #endif                                                                           E:\usb20\logger\system\usb\usbmmap.c
                                                                                                                            E:\usb20\logger\system\usb\usbmmap.c
                                           #if(2 <= MAX_EP_NUMBER)                                                          E:\usb20\logger\system\usb\usbmmap.c
                                           volatile far BDT ep2Bo;         //Endpoint #2 BD Out                             E:\usb20\logger\system\usb\usbmmap.c
                                           volatile far BDT ep2Bi;         //Endpoint #2 BD In                              E:\usb20\logger\system\usb\usbmmap.c
                                           #endif                                                                           E:\usb20\logger\system\usb\usbmmap.c
                                                                                                                            E:\usb20\logger\system\usb\usbmmap.c
                                           #if(3 <= MAX_EP_NUMBER)                                                          E:\usb20\logger\system\usb\usbmmap.c
                                           volatile far BDT ep3Bo;         //Endpoint #3 BD Out                             E:\usb20\logger\system\usb\usbmmap.c
                                           volatile far BDT ep3Bi;         //Endpoint #3 BD In                              E:\usb20\logger\system\usb\usbmmap.c
                                           #endif                                                                           E:\usb20\logger\system\usb\usbmmap.c
                                                                                                                            E:\usb20\logger\system\usb\usbmmap.c
                                           #if(4 <= MAX_EP_NUMBER)                                                          E:\usb20\logger\system\usb\usbmmap.c
                                           volatile far BDT ep4Bo;         //Endpoint #4 BD Out                             E:\usb20\logger\system\usb\usbmmap.c
                                           volatile far BDT ep4Bi;         //Endpoint #4 BD In                              E:\usb20\logger\system\usb\usbmmap.c
                                           #endif                                                                           E:\usb20\logger\system\usb\usbmmap.c
                                                                                                                            E:\usb20\logger\system\usb\usbmmap.c
                                           #if(5 <= MAX_EP_NUMBER)                                                          E:\usb20\logger\system\usb\usbmmap.c
                                           volatile far BDT ep5Bo;         //Endpoint #5 BD Out                             E:\usb20\logger\system\usb\usbmmap.c
                                           volatile far BDT ep5Bi;         //Endpoint #5 BD In                              E:\usb20\logger\system\usb\usbmmap.c
                                           #endif                                                                           E:\usb20\logger\system\usb\usbmmap.c
                                                                                                                            E:\usb20\logger\system\usb\usbmmap.c
                                           #if(6 <= MAX_EP_NUMBER)                                                          E:\usb20\logger\system\usb\usbmmap.c
                                           volatile far BDT ep6Bo;         //Endpoint #6 BD Out                             E:\usb20\logger\system\usb\usbmmap.c
                                           volatile far BDT ep6Bi;         //Endpoint #6 BD In                              E:\usb20\logger\system\usb\usbmmap.c
                                           #endif                                                                           E:\usb20\logger\system\usb\usbmmap.c
                                                                                                                            E:\usb20\logger\system\usb\usbmmap.c
                                           #if(7 <= MAX_EP_NUMBER)                                                          E:\usb20\logger\system\usb\usbmmap.c
                                           volatile far BDT ep7Bo;         //Endpoint #7 BD Out                             E:\usb20\logger\system\usb\usbmmap.c
                                           volatile far BDT ep7Bi;         //Endpoint #7 BD In                              E:\usb20\logger\system\usb\usbmmap.c
                                           #endif                                                                           E:\usb20\logger\system\usb\usbmmap.c
                                                                                                                            E:\usb20\logger\system\usb\usbmmap.c
                                           #if(8 <= MAX_EP_NUMBER)                                                          E:\usb20\logger\system\usb\usbmmap.c
                                           volatile far BDT ep8Bo;         //Endpoint #8 BD Out                             E:\usb20\logger\system\usb\usbmmap.c
                                           volatile far BDT ep8Bi;         //Endpoint #8 BD In                              E:\usb20\logger\system\usb\usbmmap.c
                                           #endif                                                                           E:\usb20\logger\system\usb\usbmmap.c
                                                                                                                            E:\usb20\logger\system\usb\usbmmap.c
                                           #if(9 <= MAX_EP_NUMBER)                                                          E:\usb20\logger\system\usb\usbmmap.c
                                           volatile far BDT ep9Bo;         //Endpoint #9 BD Out                             E:\usb20\logger\system\usb\usbmmap.c
                                           volatile far BDT ep9Bi;         //Endpoint #9 BD In                              E:\usb20\logger\system\usb\usbmmap.c
                                           #endif                                                                           E:\usb20\logger\system\usb\usbmmap.c
                                                                                                                            E:\usb20\logger\system\usb\usbmmap.c
                                           #if(10 <= MAX_EP_NUMBER)                                                         E:\usb20\logger\system\usb\usbmmap.c
                                           volatile far BDT ep10Bo;        //Endpoint #10 BD Out                            E:\usb20\logger\system\usb\usbmmap.c
                                           volatile far BDT ep10Bi;        //Endpoint #10 BD In                             E:\usb20\logger\system\usb\usbmmap.c
                                           #endif                                                                           E:\usb20\logger\system\usb\usbmmap.c
                                                                                                                            E:\usb20\logger\system\usb\usbmmap.c
                                           #if(11 <= MAX_EP_NUMBER)                                                         E:\usb20\logger\system\usb\usbmmap.c
                                           volatile far BDT ep11Bo;        //Endpoint #11 BD Out                            E:\usb20\logger\system\usb\usbmmap.c
                                           volatile far BDT ep11Bi;        //Endpoint #11 BD In                             E:\usb20\logger\system\usb\usbmmap.c
                                           #endif                                                                           E:\usb20\logger\system\usb\usbmmap.c
                                                                                                                            E:\usb20\logger\system\usb\usbmmap.c
                                           #if(12 <= MAX_EP_NUMBER)                                                         E:\usb20\logger\system\usb\usbmmap.c
                                           volatile far BDT ep12Bo;        //Endpoint #12 BD Out                            E:\usb20\logger\system\usb\usbmmap.c
                                           volatile far BDT ep12Bi;        //Endpoint #12 BD In                             E:\usb20\logger\system\usb\usbmmap.c
                                           #endif                                                                           E:\usb20\logger\system\usb\usbmmap.c
                                                                                                                            E:\usb20\logger\system\usb\usbmmap.c
                                           #if(13 <= MAX_EP_NUMBER)                                                         E:\usb20\logger\system\usb\usbmmap.c
                                           volatile far BDT ep13Bo;        //Endpoint #13 BD Out                            E:\usb20\logger\system\usb\usbmmap.c
                                           volatile far BDT ep13Bi;        //Endpoint #13 BD In                             E:\usb20\logger\system\usb\usbmmap.c
                                           #endif                                                                           E:\usb20\logger\system\usb\usbmmap.c
                                                                                                                            E:\usb20\logger\system\usb\usbmmap.c
                                           #if(14 <= MAX_EP_NUMBER)                                                         E:\usb20\logger\system\usb\usbmmap.c
                                           volatile far BDT ep14Bo;        //Endpoint #14 BD Out                            E:\usb20\logger\system\usb\usbmmap.c
                                           volatile far BDT ep14Bi;        //Endpoint #14 BD In                             E:\usb20\logger\system\usb\usbmmap.c
                                           #endif                                                                           E:\usb20\logger\system\usb\usbmmap.c
                                                                                                                            E:\usb20\logger\system\usb\usbmmap.c
                                           #if(15 <= MAX_EP_NUMBER)                                                         E:\usb20\logger\system\usb\usbmmap.c
                                           volatile far BDT ep15Bo;        //Endpoint #15 BD Out                            E:\usb20\logger\system\usb\usbmmap.c
                                           volatile far BDT ep15Bi;        //Endpoint #15 BD In                             E:\usb20\logger\system\usb\usbmmap.c
                                           #endif                                                                           E:\usb20\logger\system\usb\usbmmap.c
                                                                                                                            E:\usb20\logger\system\usb\usbmmap.c
                                           /******************************************************************************  E:\usb20\logger\system\usb\usbmmap.c
                                            * Section B: EP0 Buffer Space                                                   E:\usb20\logger\system\usb\usbmmap.c
                                            ******************************************************************************  E:\usb20\logger\system\usb\usbmmap.c
                                            * - Two buffer areas are defined:                                               E:\usb20\logger\system\usb\usbmmap.c
                                            *                                                                               E:\usb20\logger\system\usb\usbmmap.c
                                            *   A. CTRL_TRF_SETUP                                                           E:\usb20\logger\system\usb\usbmmap.c
                                            *      - Size = EP0_BUFF_SIZE as defined in autofiles\usbcfg.h                  E:\usb20\logger\system\usb\usbmmap.c
                                            *      - Detailed data structure allows direct adddressing of bits and bytes.   E:\usb20\logger\system\usb\usbmmap.c
                                            *                                                                               E:\usb20\logger\system\usb\usbmmap.c
                                            *   B. CTRL_TRF_DATA                                                            E:\usb20\logger\system\usb\usbmmap.c
                                            *      - Size = EP0_BUFF_SIZE as defined in autofiles\usbcfg.h                  E:\usb20\logger\system\usb\usbmmap.c
                                            *      - Data structure allows direct adddressing of the first 8 bytes.         E:\usb20\logger\system\usb\usbmmap.c
                                            *                                                                               E:\usb20\logger\system\usb\usbmmap.c
                                            * - Both data types are defined in system\usb\usbdefs\usbdefs_ep0_buff.h        E:\usb20\logger\system\usb\usbmmap.c
                                            *****************************************************************************/  E:\usb20\logger\system\usb\usbmmap.c
                                           volatile far CTRL_TRF_SETUP SetupPkt;                                            E:\usb20\logger\system\usb\usbmmap.c
                                           volatile far CTRL_TRF_DATA CtrlTrfData;                                          E:\usb20\logger\system\usb\usbmmap.c
                                                                                                                            E:\usb20\logger\system\usb\usbmmap.c
                                           /******************************************************************************  E:\usb20\logger\system\usb\usbmmap.c
                                            * Section C: CDC Buffer                                                         E:\usb20\logger\system\usb\usbmmap.c
                                            ******************************************************************************  E:\usb20\logger\system\usb\usbmmap.c
                                            *                                                                               E:\usb20\logger\system\usb\usbmmap.c
                                            *****************************************************************************/  E:\usb20\logger\system\usb\usbmmap.c
                                           #pragma udata usbram5a=0x500    //See Linker Script,usb5:0x500-...               E:\usb20\logger\system\usb\usbmmap.c
                                           #if defined(USB_USE_CDC)                                                         E:\usb20\logger\system\usb\usbmmap.c
                                           volatile far unsigned char cdc_notice[CDC_INT_EP_SIZE];                          E:\usb20\logger\system\usb\usbmmap.c
                                           volatile far unsigned char cdc_data_rx[CDC_BULK_OUT_EP_SIZE];                    E:\usb20\logger\system\usb\usbmmap.c
                                           volatile far unsigned char cdc_data_tx[CDC_BULK_IN_EP_SIZE];                     E:\usb20\logger\system\usb\usbmmap.c
                                           #endif                                                                           E:\usb20\logger\system\usb\usbmmap.c
                                           #pragma udata                                                                    E:\usb20\logger\system\usb\usbmmap.c
                                                                                                                            E:\usb20\logger\system\usb\usbmmap.c
                                           /** EOF usbmmap.c ************************************************************/  E:\usb20\logger\system\usb\usbmmap.c
                                           /*********************************************************************           E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                Microchip USB C18 Firmware Version 1.0                         E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *********************************************************************           E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            * FileName:        usbdrv.c                                                     E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            * Dependencies:    See INCLUDES section below                                   E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            * Processor:       PIC18                                                        E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            * Compiler:        C18 2.30.01+                                                 E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            * Company:         Microchip Technology, Inc.                                   E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            * Software License Agreement                                                    E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            * The software supplied herewith by Microchip Technology Incorporated           E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            * (the 鼎ompany・ for its PICmicroｮ Microcontroller is intended and             E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            * supplied to you, the Company痴 customer, for use solely and                   E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            * exclusively on Microchip PICmicro Microcontroller products. The               E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            * software is owned by the Company and/or its supplier, and is                  E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            * protected under applicable copyright laws. All rights are reserved.           E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            * Any use in violation of the foregoing restrictions may subject the            E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            * user to criminal sanctions under applicable laws, as well as to               E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            * civil liability for the breach of the terms and conditions of this            E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            * license.                                                                      E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            * THIS SOFTWARE IS PROVIDED IN AN 鄭S IS・CONDITION. NO WARRANTIES,             E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            * WHETHER EXPRESS, IMPLIED OR STATUTORY, INCLUDING, BUT NOT LIMITED             E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            * TO, IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A                   E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            * PARTICULAR PURPOSE APPLY TO THIS SOFTWARE. THE COMPANY SHALL NOT,             E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            * IN ANY CIRCUMSTANCES, BE LIABLE FOR SPECIAL, INCIDENTAL OR                    E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            * CONSEQUENTIAL DAMAGES, FOR ANY REASON WHATSOEVER.                             E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            * Author               Date        Comment                                      E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~           E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            * Rawin Rojvanit       11/19/04    Original.                                    E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            ********************************************************************/           E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                           /** I N C L U D E S **********************************************************/  E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                           #include <p18cxxx.h>                                                             E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                           #include "system\typedefs.h"                                                     E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                           #include "system\usb\usb.h"                                                      E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                           #include "io_cfg.h"             // Required for USBCheckBusStatus()              E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                           /** V A R I A B L E S ********************************************************/  E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                           #pragma udata                                                                    E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                           /** P R I V A T E  P R O T O T Y P E S ***************************************/  E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                           void USBModuleEnable(void);                                                      E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                           void USBModuleDisable(void);                                                     E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                           void USBSuspend(void);                                                           E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                           void USBWakeFromSuspend(void);                                                   E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                           void USBProtocolResetHandler(void);                                              E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                           void USB_SOF_Handler(void);                                                      E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                           void USBStallHandler(void);                                                      E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                           void USBErrorHandler(void);                                                      E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                           /** D E C L A R A T I O N S **************************************************/  E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                           #pragma code                                                                     E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                           /******************************************************************************  E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            * Function:        void USBCheckBusStatus(void)                                 E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            * PreCondition:    None                                                         E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            * Input:           None                                                         E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            * Output:          None                                                         E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            * Side Effects:    None                                                         E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            * Overview:        This routine enables/disables the USB module by monitoring   E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                  the USB power signal.                                        E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            * Note:            None                                                         E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *****************************************************************************/  E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                           void USBCheckBusStatus(void)                                                     E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                           {                                                                                E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                               /**************************************************************************  E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                                * Bus Attachment & Detachment Detection                                     E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                                * usb_bus_sense is an i/o pin defined in io_cfg.h                           E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                                *************************************************************************/  E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                               #define USB_BUS_ATTACHED    1                                                E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                               #define USB_BUS_DETACHED    0                                                E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                               if(usb_bus_sense == USB_BUS_ATTACHED)       // Is USB bus attached?          E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                               {                                                                            E:\usb20\logger\system\usb\usbdrv\usbdrv.c
001d4a   a66d     BTFSS     0x6d,0x3,0x0           if(UCONbits.USBEN == 0)                 // Is the module off?            E:\usb20\logger\system\usb\usbdrv\usbdrv.c
001d4c   d80f     RCALL     0x1d6c                     USBModuleEnable();                  // Is off, enable it             E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                               }                                                                            E:\usb20\logger\system\usb\usbdrv\usbdrv.c
001d4e   d002     BRA       0x1d54             else                                                                         E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                               {                                                                            E:\usb20\logger\system\usb\usbdrv\usbdrv.c
001d50   b66d     BTFSC     0x6d,0x3,0x0           if(UCONbits.USBEN == 1)                 // Is the module on?             E:\usb20\logger\system\usb\usbdrv\usbdrv.c
001d52   d813     RCALL     0x1d7a                     USBModuleDisable();                 // Is on, disable it             E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                               }//end if(usb_bus_sense...)                                                  E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                               /*                                                                           E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                                * After enabling the USB module, it takes some time for the voltage         E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                                * on the D+ or D- line to rise high enough to get out of the SE0 condition. E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                                * The USB Reset interrupt should not be unmasked until the SE0 condition is E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                                * cleared. This helps preventing the firmware from misinterpreting this     E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                                * unique event as a USB bus reset from the USB host.                        E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                                */                                                                          E:\usb20\logger\system\usb\usbdrv\usbdrv.c
001d54   0100     MOVLB     0x0                if(usb_device_state == ATTACHED_STATE)                                       E:\usb20\logger\system\usb\usbdrv\usbdrv.c
001d56   05fa     DECF      0xfa,0x0,0x1                                                                                    
001d58   e108     BNZ       0x1d6a                                                                                          
                                               {                                                                            E:\usb20\logger\system\usb\usbdrv\usbdrv.c
001d5a   ba6d     BTFSC     0x6d,0x5,0x0           if(!UCONbits.SE0)                                                        E:\usb20\logger\system\usb\usbdrv\usbdrv.c
001d5c   d006     BRA       0x1d6a                                                                                          
                                                   {                                                                        E:\usb20\logger\system\usb\usbdrv\usbdrv.c
001d5e   6a68     CLRF      0x68,0x0                   UIR = 0;                        // Clear all USB interrupts          E:\usb20\logger\system\usb\usbdrv\usbdrv.c
001d60   6a69     CLRF      0x69,0x0                   UIE = 0;                        // Mask all USB interrupts           E:\usb20\logger\system\usb\usbdrv\usbdrv.c
001d62   8069     BSF       0x69,0x0,0x0               UIEbits.URSTIE = 1;             // Unmask RESET interrupt            E:\usb20\logger\system\usb\usbdrv\usbdrv.c
001d64   8869     BSF       0x69,0x4,0x0               UIEbits.IDLEIE = 1;             // Unmask IDLE interrupt             E:\usb20\logger\system\usb\usbdrv\usbdrv.c
001d66   0e02     MOVLW     0x2                        usb_device_state = POWERED_STATE;                                    E:\usb20\logger\system\usb\usbdrv\usbdrv.c
001d68   6ffa     MOVWF     0xfa,0x1                                                                                        
                                                   }//end if                           // else wait until SE0 is cleared    E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                               }//end if(usb_device_state == ATTACHED_STATE)                                E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\logger\system\usb\usbdrv\usbdrv.c
001d6a   0012     RETURN    0x0            }//end USBCheckBusStatus                                                         E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                           /******************************************************************************  E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            * Function:        void USBModuleEnable(void)                                   E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            * PreCondition:    None                                                         E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            * Input:           None                                                         E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            * Output:          None                                                         E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            * Side Effects:    None                                                         E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            * Overview:        This routine enables the USB module.                         E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                  An end designer should never have to call this routine       E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                  manually. This routine should only be called from            E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                  USBCheckBusStatus().                                         E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            * Note:            See USBCheckBusStatus() for more information.                E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *****************************************************************************/  E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                           void USBModuleEnable(void)                                                       E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                           {                                                                                E:\usb20\logger\system\usb\usbdrv\usbdrv.c
001d6c   6a6d     CLRF      0x6d,0x0           UCON = 0;                                                                    E:\usb20\logger\system\usb\usbdrv\usbdrv.c
001d6e   6a69     CLRF      0x69,0x0           UIE = 0;                                // Mask all USB interrupts           E:\usb20\logger\system\usb\usbdrv\usbdrv.c
001d70   866d     BSF       0x6d,0x3,0x0       UCONbits.USBEN = 1;                     // Enable module & attach to bus     E:\usb20\logger\system\usb\usbdrv\usbdrv.c
001d72   0100     MOVLB     0x0                usb_device_state = ATTACHED_STATE;      // Defined in usbmmap.c & .h         E:\usb20\logger\system\usb\usbdrv\usbdrv.c
001d74   0e01     MOVLW     0x1                                                                                             
001d76   6ffa     MOVWF     0xfa,0x1                                                                                        
001d78   0012     RETURN    0x0            }//end USBModuleEnable                                                           E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                           /******************************************************************************  E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            * Function:        void USBModuleDisable(void)                                  E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            * PreCondition:    None                                                         E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            * Input:           None                                                         E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            * Output:          None                                                         E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            * Side Effects:    None                                                         E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            * Overview:        This routine disables the USB module.                        E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                  An end designer should never have to call this routine       E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                  manually. This routine should only be called from            E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                  USBCheckBusStatus().                                         E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            * Note:            See USBCheckBusStatus() for more information.                E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *****************************************************************************/  E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                           void USBModuleDisable(void)                                                      E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                           {                                                                                E:\usb20\logger\system\usb\usbdrv\usbdrv.c
001d7a   6a6d     CLRF      0x6d,0x0           UCON = 0;                               // Disable module & detach from bus  E:\usb20\logger\system\usb\usbdrv\usbdrv.c
001d7c   6a69     CLRF      0x69,0x0           UIE = 0;                                // Mask all USB interrupts           E:\usb20\logger\system\usb\usbdrv\usbdrv.c
001d7e   0100     MOVLB     0x0                usb_device_state = DETACHED_STATE;      // Defined in usbmmap.c & .h         E:\usb20\logger\system\usb\usbdrv\usbdrv.c
001d80   6bfa     CLRF      0xfa,0x1                                                                                        
001d82   0012     RETURN    0x0            }//end USBModuleDisable                                                          E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                           /******************************************************************************  E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            * Function:        void USBSoftDetach(void)                                     E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            * PreCondition:    None                                                         E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            * Input:           None                                                         E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            * Output:          None                                                         E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            * Side Effects:    The device will have to be re-enumerated to function again.  E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            * Overview:        USBSoftDetach electrically disconnects the device from       E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                  the bus. This is done by stop supplying Vusb voltage to      E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                  pull-up resistor. The pull-down resistors on the host        E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                  side will pull both differential signal lines low and        E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                  the host registers the event as a disconnect.                E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                  Since the USB cable is not physically disconnected, the      E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                  power supply through the cable can still be sensed by        E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                  the device. The next time USBCheckBusStatus() function       E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                  is called, it will reconnect the device back to the bus.     E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            * Note:            None                                                         E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *****************************************************************************/  E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                           void USBSoftDetach(void)                                                         E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                           {                                                                                E:\usb20\logger\system\usb\usbdrv\usbdrv.c
001d84   efbd     GOTO      0x1d7a             USBModuleDisable();                                                          E:\usb20\logger\system\usb\usbdrv\usbdrv.c
001d86   f00e                                                                                                               
                                           }//end USBSoftDetach                                                             E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                           /******************************************************************************  E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            * Function:        void USBDriverService(void)                                  E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            * PreCondition:    None                                                         E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            * Input:           None                                                         E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            * Output:          None                                                         E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            * Side Effects:    None                                                         E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            * Overview:        This routine is the heart of this firmware. It manages       E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                  all USB interrupts.                                          E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            * Note:            Device state transitions through the following stages:       E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                  DETACHED -> ATTACHED -> POWERED -> DEFAULT ->                E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                  ADDRESS_PENDING -> ADDRESSED -> CONFIGURED -> READY          E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *****************************************************************************/  E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                           void USBDriverService(void)                                                      E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                           {                                                                                E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                               /*                                                                           E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                                * Pointless to continue servicing if USB cable is not even attached.        E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                                */                                                                          E:\usb20\logger\system\usb\usbdrv\usbdrv.c
001d88   0100     MOVLB     0x0                if(usb_device_state == DETACHED_STATE) return;                               E:\usb20\logger\system\usb\usbdrv\usbdrv.c
001d8a   51fa     MOVF      0xfa,0x0,0x1                                                                                    
001d8c   e101     BNZ       0x1d90                                                                                          
001d8e   d03a     BRA       0x1e04                                                                                          
                                                                                                                            E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                               /*                                                                           E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                                * Task A: Service USB Activity Interrupt                                    E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                                */                                                                          E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\logger\system\usb\usbdrv\usbdrv.c
001d90   5068     MOVF      0x68,0x0,0x0       if(UIRbits.ACTVIF && UIEbits.ACTVIE)    USBWakeFromSuspend();                E:\usb20\logger\system\usb\usbdrv\usbdrv.c
001d92   0b04     ANDLW     0x4                                                                                             
001d94   e004     BZ        0x1d9e                                                                                          
001d96   5069     MOVF      0x69,0x0,0x0                                                                                    
001d98   0b04     ANDLW     0x4                                                                                             
001d9a   e001     BZ        0x1d9e                                                                                          
001d9c   d838     RCALL     0x1e0e                                                                                          
                                                                                                                            E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                               /*                                                                           E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                                * Pointless to continue servicing if the device is in suspend mode.         E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                                */                                                                          E:\usb20\logger\system\usb\usbdrv\usbdrv.c
001d9e   b26d     BTFSC     0x6d,0x1,0x0       if(UCONbits.SUSPND==1) return;                                               E:\usb20\logger\system\usb\usbdrv\usbdrv.c
001da0   d031     BRA       0x1e04                                                                                          
                                                                                                                            E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                               /*                                                                           E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                                * Task B: Service USB Bus Reset Interrupt.                                  E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                                * When bus reset is received during suspend, ACTVIF will be set first,      E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                                * once the UCONbits.SUSPND is clear, then the URSTIF bit will be asserted.  E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                                * This is why URSTIF is checked after ACTVIF.                               E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                                */                                                                          E:\usb20\logger\system\usb\usbdrv\usbdrv.c
001da2   5068     MOVF      0x68,0x0,0x0       if(UIRbits.URSTIF && UIEbits.URSTIE)    USBProtocolResetHandler();           E:\usb20\logger\system\usb\usbdrv\usbdrv.c
001da4   0b01     ANDLW     0x1                                                                                             
001da6   e004     BZ        0x1db0                                                                                          
001da8   5069     MOVF      0x69,0x0,0x0                                                                                    
001daa   0b01     ANDLW     0x1                                                                                             
001dac   e001     BZ        0x1db0                                                                                          
001dae   d850     RCALL     0x1e50                                                                                          
                                                                                                                            E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                               /*                                                                           E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                                * Task C: Service other USB interrupts                                      E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                                */                                                                          E:\usb20\logger\system\usb\usbdrv\usbdrv.c
001db0   5068     MOVF      0x68,0x0,0x0       if(UIRbits.IDLEIF && UIEbits.IDLEIE)    USBSuspend();                        E:\usb20\logger\system\usb\usbdrv\usbdrv.c
001db2   0b10     ANDLW     0x10                                                                                            
001db4   e004     BZ        0x1dbe                                                                                          
001db6   5069     MOVF      0x69,0x0,0x0                                                                                    
001db8   0b10     ANDLW     0x10                                                                                            
001dba   e001     BZ        0x1dbe                                                                                          
001dbc   d824     RCALL     0x1e06                                                                                          
001dbe   5068     MOVF      0x68,0x0,0x0       if(UIRbits.SOFIF && UIEbits.SOFIE)      USB_SOF_Handler();                   E:\usb20\logger\system\usb\usbdrv\usbdrv.c
001dc0   0b40     ANDLW     0x40                                                                                            
001dc2   e004     BZ        0x1dcc                                                                                          
001dc4   5069     MOVF      0x69,0x0,0x0                                                                                    
001dc6   0b40     ANDLW     0x40                                                                                            
001dc8   e001     BZ        0x1dcc                                                                                          
001dca   d837     RCALL     0x1e3a                                                                                          
001dcc   5068     MOVF      0x68,0x0,0x0       if(UIRbits.STALLIF && UIEbits.STALLIE)  USBStallHandler();                   E:\usb20\logger\system\usb\usbdrv\usbdrv.c
001dce   0b20     ANDLW     0x20                                                                                            
001dd0   e004     BZ        0x1dda                                                                                          
001dd2   5069     MOVF      0x69,0x0,0x0                                                                                    
001dd4   0b20     ANDLW     0x20                                                                                            
001dd6   e001     BZ        0x1dda                                                                                          
001dd8   d832     RCALL     0x1e3e                                                                                          
001dda   5068     MOVF      0x68,0x0,0x0       if(UIRbits.UERRIF && UIEbits.UERRIE)    USBErrorHandler();                   E:\usb20\logger\system\usb\usbdrv\usbdrv.c
001ddc   0b02     ANDLW     0x2                                                                                             
001dde   e004     BZ        0x1de8                                                                                          
001de0   5069     MOVF      0x69,0x0,0x0                                                                                    
001de2   0b02     ANDLW     0x2                                                                                             
001de4   e001     BZ        0x1de8                                                                                          
001de6   d832     RCALL     0x1e4c                                                                                          
                                                                                                                            E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                               /*                                                                           E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                                * Pointless to continue servicing if the host has not sent a bus reset.     E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                                * Once bus reset is received, the device transitions into the DEFAULT       E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                                * state and is ready for communication.                                     E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                                */                                                                          E:\usb20\logger\system\usb\usbdrv\usbdrv.c
001de8   0e03     MOVLW     0x3                if(usb_device_state < DEFAULT_STATE) return;                                 E:\usb20\logger\system\usb\usbdrv\usbdrv.c
001dea   0100     MOVLB     0x0                                                                                             
001dec   5dfa     SUBWF     0xfa,0x0,0x1                                                                                    
001dee   e201     BC        0x1df2                                                                                          
001df0   d009     BRA       0x1e04                                                                                          
                                                                                                                            E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                               /*                                                                           E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                                * Task D: Servicing USB Transaction Complete Interrupt                      E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                                */                                                                          E:\usb20\logger\system\usb\usbdrv\usbdrv.c
001df2   5068     MOVF      0x68,0x0,0x0       if(UIRbits.TRNIF && UIEbits.TRNIE)                                           E:\usb20\logger\system\usb\usbdrv\usbdrv.c
001df4   0b08     ANDLW     0x8                                                                                             
001df6   e006     BZ        0x1e04                                                                                          
001df8   5069     MOVF      0x69,0x0,0x0                                                                                    
001dfa   0b08     ANDLW     0x8                                                                                             
001dfc   e003     BZ        0x1e04                                                                                          
                                               {                                                                            E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                                   /*                                                                       E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                                    * USBCtrlEPService only services transactions over EP0.                 E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                                    * It ignores all other EP transactions.                                 E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                                    */                                                                      E:\usb20\logger\system\usb\usbdrv\usbdrv.c
001dfe   ec57     CALL      0x18ae,0x0             USBCtrlEPService();                                                      E:\usb20\logger\system\usb\usbdrv\usbdrv.c
001e00   f00c                                                                                                               
                                                                                                                            E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                                   /*                                                                       E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                                    * Other EP can be serviced later by responsible device class firmware.  E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                                    * Each device driver knows when an OUT or IN transaction is ready by    E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                                    * checking the buffer ownership bit.                                    E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                                    * An OUT EP should always be owned by SIE until the data is ready.      E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                                    * An IN EP should always be owned by CPU until the data is ready.       E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                                    *                                                                       E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                                    * Because of this logic, it is not necessary to save the USTAT value    E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                                    * of non-EP0 transactions.                                              E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                                    */                                                                      E:\usb20\logger\system\usb\usbdrv\usbdrv.c
001e02   9668     BCF       0x68,0x3,0x0           UIRbits.TRNIF = 0;                                                       E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                               }//end if(UIRbits.TRNIF && UIEbits.TRNIE)                                    E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\logger\system\usb\usbdrv\usbdrv.c
001e04   0012     RETURN    0x0            }//end USBDriverService                                                          E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                           /******************************************************************************  E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            * Function:        void USBSuspend(void)                                        E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            * PreCondition:    None                                                         E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            * Input:           None                                                         E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            * Output:          None                                                         E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            * Side Effects:    None                                                         E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            * Overview:                                                                     E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            * Note:            None                                                         E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *****************************************************************************/  E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                           void USBSuspend(void)                                                            E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                           {                                                                                E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                               /*                                                                           E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                                * NOTE: Do not clear UIRbits.ACTVIF here!                                   E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                                * Reason:                                                                   E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                                * ACTVIF is only generated once an IDLEIF has been generated.               E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                                * This is a 1:1 ratio interrupt generation.                                 E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                                * For every IDLEIF, there will be only one ACTVIF regardless of             E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                                * the number of subsequent bus transitions.                                 E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                                *                                                                           E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                                * If the ACTIF is cleared here, a problem could occur when:                 E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                                * [       IDLE       ][bus activity ->                                      E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                                * <--- 3 ms ----->     ^                                                    E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                                *                ^     ACTVIF=1                                             E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                                *                IDLEIF=1                                                   E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                                *  #           #           #           #   (#=Program polling flags)        E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                                *                          ^                                                E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                                *                          This polling loop will see both                  E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                                *                          IDLEIF=1 and ACTVIF=1.                           E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                                *                          However, the program services IDLEIF first       E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                                *                          because ACTIVIE=0.                               E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                                *                          If this routine clears the only ACTIVIF,         E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                                *                          then it can never get out of the suspend         E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                                *                          mode.                                            E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                                */                                                                          E:\usb20\logger\system\usb\usbdrv\usbdrv.c
001e06   8469     BSF       0x69,0x2,0x0       UIEbits.ACTVIE = 1;                     // Enable bus activity interrupt     E:\usb20\logger\system\usb\usbdrv\usbdrv.c
001e08   9868     BCF       0x68,0x4,0x0       UIRbits.IDLEIF = 0;                                                          E:\usb20\logger\system\usb\usbdrv\usbdrv.c
001e0a   826d     BSF       0x6d,0x1,0x0       UCONbits.SUSPND = 1;                    // Put USB module in power conserve  E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                                                                       // mode, SIE clock inactive          E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                               /*                                                                           E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                                * At this point the PIC can go into sleep,idle, or                          E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                                * switch to a slower clock, etc.                                            E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                                */                                                                          E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                               /* Modifiable Section */                                                     E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                               /* End Modifiable Section */                                                 E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\logger\system\usb\usbdrv\usbdrv.c
001e0c   0012     RETURN    0x0            }//end USBSuspend                                                                E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                           /******************************************************************************  E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            * Function:        void USBWakeFromSuspend(void)                                E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            * PreCondition:    None                                                         E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            * Input:           None                                                         E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            * Output:          None                                                         E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            * Side Effects:    None                                                         E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            * Overview:                                                                     E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            * Note:            None                                                         E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *****************************************************************************/  E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                           void USBWakeFromSuspend(void)                                                    E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                           {                                                                                E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                               /*                                                                           E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                                * If using clock switching, this is the place to restore the                E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                                * original clock frequency.                                                 E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                                */                                                                          E:\usb20\logger\system\usb\usbdrv\usbdrv.c
001e0e   926d     BCF       0x6d,0x1,0x0       UCONbits.SUSPND = 0;                                                         E:\usb20\logger\system\usb\usbdrv\usbdrv.c
001e10   9469     BCF       0x69,0x2,0x0       UIEbits.ACTVIE = 0;                                                          E:\usb20\logger\system\usb\usbdrv\usbdrv.c
001e12   9468     BCF       0x68,0x2,0x0       UIRbits.ACTVIF = 0;                                                          E:\usb20\logger\system\usb\usbdrv\usbdrv.c
001e14   0012     RETURN    0x0            }//end USBWakeFromSuspend                                                        E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                           /******************************************************************************  E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            * Function:        void USBRemoteWakeup(void)                                   E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            * PreCondition:    None                                                         E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            * Input:           None                                                         E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            * Output:          None                                                         E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            * Side Effects:    None                                                         E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            * Overview:        This function should be called by user when the device       E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                  is waken up by an external stimulus other than ACTIVIF.      E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                  Please read the note below to understand the limitations.    E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            * Note:            The modifiable section in this routine should be changed     E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                  to meet the application needs. Current implementation        E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                  temporary blocks other functions from executing for a        E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                  period of 1-13 ms depending on the core frequency.           E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                  According to USB 2.0 specification section 7.1.7.7,          E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                  "The remote wakeup device must hold the resume signaling     E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                  for at lest 1 ms but for no more than 15 ms."                E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                  The idea here is to use a delay counter loop, using a        E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                  common value that would work over a wide range of core       E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                  frequencies.                                                 E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                  That value selected is 1800. See table below:                E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                  ==========================================================   E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                  Core Freq(MHz)      MIP         RESUME Signal Period (ms)    E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                  ==========================================================   E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                      48              12          1.05                         E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                       4              1           12.6                         E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                  ==========================================================   E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                  * These timing could be incorrect when using code            E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                    optimization or extended instruction mode,                 E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                    or when having other interrupts enabled.                   E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                    Make sure to verify using the MPLAB SIM's Stopwatch        E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *****************************************************************************/  E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                           void USBRemoteWakeup(void)                                                       E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                           {                                                                                E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                               static word delay_count;                                                     E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\logger\system\usb\usbdrv\usbdrv.c
001e16   0100     MOVLB     0x0                if(usb_stat.RemoteWakeup == 1)          // Check if RemoteWakeup function    E:\usb20\logger\system\usb\usbdrv\usbdrv.c
001e18   a1fb     BTFSS     0xfb,0x0,0x1                                                                                    
001e1a   d00e     BRA       0x1e38                                                                                          
                                               {                                       // has been enabled by the host.     E:\usb20\logger\system\usb\usbdrv\usbdrv.c
001e1c   dff8     RCALL     0x1e0e                 USBWakeFromSuspend();               // Unsuspend USB modue               E:\usb20\logger\system\usb\usbdrv\usbdrv.c
001e1e   846d     BSF       0x6d,0x2,0x0           UCONbits.RESUME = 1;                // Start RESUME signaling            E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                                   /* Modifiable Section */                                                 E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\logger\system\usb\usbdrv\usbdrv.c
001e20   0100     MOVLB     0x0                    delay_count = 1800U;                // Set RESUME line for 1-13 ms       E:\usb20\logger\system\usb\usbdrv\usbdrv.c
001e22   0e08     MOVLW     0x8                                                                                             
001e24   6ffe     MOVWF     0xfe,0x1                                                                                        
001e26   0e07     MOVLW     0x7                                                                                             
001e28   6fff     MOVWF     0xff,0x1                                                                                        
                                                   do                                                                       E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                                   {                                                                        E:\usb20\logger\system\usb\usbdrv\usbdrv.c
001e2a   07fe     DECF      0xfe,0x1,0x1               delay_count--;                                                       E:\usb20\logger\system\usb\usbdrv\usbdrv.c
001e2c   0e00     MOVLW     0x0                                                                                             
001e2e   5bff     SUBWFB    0xff,0x1,0x1                                                                                    
001e30   51fe     MOVF      0xfe,0x0,0x1           }while(delay_count);                                                     E:\usb20\logger\system\usb\usbdrv\usbdrv.c
001e32   11ff     IORWF     0xff,0x0,0x1                                                                                    
001e34   e1fa     BNZ       0x1e2a                                                                                          
                                                                                                                            E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                                   /* End Modifiable Section */                                             E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\logger\system\usb\usbdrv\usbdrv.c
001e36   946d     BCF       0x6d,0x2,0x0           UCONbits.RESUME = 0;                                                     E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                               }//endif                                                                     E:\usb20\logger\system\usb\usbdrv\usbdrv.c
001e38   0012     RETURN    0x0            }//end USBRemoteWakeup                                                           E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                           /******************************************************************************  E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            * Function:        void USB_SOF_Handler(void)                                   E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            * PreCondition:    None                                                         E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            * Input:           None                                                         E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            * Output:          None                                                         E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            * Side Effects:    None                                                         E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            * Overview:        The USB host sends out a SOF packet to full-speed devices    E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                  every 1 ms. This interrupt may be useful for isochronous     E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                  pipes. End designers should implement callback routine       E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                  as necessary.                                                E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            * Note:            None                                                         E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *****************************************************************************/  E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                           void USB_SOF_Handler(void)                                                       E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                           {                                                                                E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                               /* Callback routine here */                                                  E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\logger\system\usb\usbdrv\usbdrv.c
001e3a   9c68     BCF       0x68,0x6,0x0       UIRbits.SOFIF = 0;                                                           E:\usb20\logger\system\usb\usbdrv\usbdrv.c
001e3c   0012     RETURN    0x0            }//end USB_SOF_Handler                                                           E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                           /******************************************************************************  E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            * Function:        void USBStallHandler(void)                                   E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            * PreCondition:    A STALL packet is sent to the host by the SIE.               E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            * Input:           None                                                         E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            * Output:          None                                                         E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            * Side Effects:    None                                                         E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            * Overview:        The STALLIF is set anytime the SIE sends out a STALL         E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                  packet regardless of which endpoint causes it.               E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                  A Setup transaction overrides the STALL function. A stalled  E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                  endpoint stops stalling once it receives a setup packet.     E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                  In this case, the SIE will accepts the Setup packet and      E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                  set the TRNIF flag to notify the firmware. STALL function    E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                  for that particular endpoint pipe will be automatically      E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                  disabled (direction specific).                               E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                  There are a few reasons for an endpoint to be stalled.       E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                  1. When a non-supported USB request is received.             E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                     Example: GET_DESCRIPTOR(DEVICE_QUALIFIER)                 E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                  2. When an endpoint is currently halted.                     E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                  3. When the device class specifies that an endpoint must     E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                     stall in response to a specific event.                    E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                     Example: Mass Storage Device Class                        E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                              If the CBW is not valid, the device shall        E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                              STALL the Bulk-In pipe.                          E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                              See USB Mass Storage Class Bulk-only Transport   E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                              Specification for more details.                  E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            * Note:            UEPn.EPSTALL can be scanned to see which endpoint causes     E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                  the stall event.                                             E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                  If                                                           E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *****************************************************************************/  E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                           void USBStallHandler(void)                                                       E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                           {                                                                                E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                               /*                                                                           E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                                * Does not really have to do anything here,                                 E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                                * even for the control endpoint.                                            E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                                * All BDs of Endpoint 0 are owned by SIE right now,                         E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                                * but once a Setup Transaction is received, the ownership                   E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                                * for EP0_OUT will be returned to CPU.                                      E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                                * When the Setup Transaction is serviced, the ownership                     E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                                * for EP0_IN will then be forced back to CPU by firmware.                   E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                                *                                                                           E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                                * NOTE: Above description is not quite true at this point.                  E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                                *       It seems the SIE never returns the UOWN bit to CPU,                 E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                                *       and a TRNIF is never generated upon successful                      E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                                *       reception of a SETUP transaction.                                   E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                                *       Firmware work-around is implemented below.                          E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                                */                                                                          E:\usb20\logger\system\usb\usbdrv\usbdrv.c
001e3e   a070     BTFSS     0x70,0x0,0x0       if(UEP0bits.EPSTALL == 1)                                                    E:\usb20\logger\system\usb\usbdrv\usbdrv.c
001e40   d003     BRA       0x1e48                                                                                          
                                               {                                                                            E:\usb20\logger\system\usb\usbdrv\usbdrv.c
001e42   ecca     CALL      0x1b94,0x0             USBPrepareForNextSetupTrf();        // Firmware Work-Around              E:\usb20\logger\system\usb\usbdrv\usbdrv.c
001e44   f00d                                                                                                               
001e46   9070     BCF       0x70,0x0,0x0           UEP0bits.EPSTALL = 0;                                                    E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                               }                                                                            E:\usb20\logger\system\usb\usbdrv\usbdrv.c
001e48   9a68     BCF       0x68,0x5,0x0       UIRbits.STALLIF = 0;                                                         E:\usb20\logger\system\usb\usbdrv\usbdrv.c
001e4a   0012     RETURN    0x0            }//end USBStallHandler                                                           E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                           /******************************************************************************  E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            * Function:        void USBErrorHandler(void)                                   E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            * PreCondition:    None                                                         E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            * Input:           None                                                         E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            * Output:          None                                                         E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            * Side Effects:    None                                                         E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            * Overview:        The purpose of this interrupt is mainly for debugging        E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                  during development. Check UEIR to see which error causes     E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                  the interrupt.                                               E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            * Note:            None                                                         E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *****************************************************************************/  E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                           void USBErrorHandler(void)                                                       E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                           {                                                                                E:\usb20\logger\system\usb\usbdrv\usbdrv.c
001e4c   9268     BCF       0x68,0x1,0x0       UIRbits.UERRIF = 0;                                                          E:\usb20\logger\system\usb\usbdrv\usbdrv.c
001e4e   0012     RETURN    0x0            }//end USBErrorHandler                                                           E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                           /******************************************************************************  E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            * Function:        void USBProtocolResetHandler(void)                           E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            * PreCondition:    A USB bus reset is received from the host.                   E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            * Input:           None                                                         E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            * Output:          None                                                         E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            * Side Effects:    Currently, this routine flushes any pending USB              E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                  transactions. It empties out the USTAT FIFO. This action     E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                  might not be desirable in some applications.                 E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            * Overview:        Once a USB bus reset is received from the host, this         E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                  routine should be called. It resets the device address to    E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                  zero, disables all non-EP0 endpoints, initializes EP0 to     E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                  be ready for default communication, clears all USB           E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                  interrupt flags, unmasks applicable USB interrupts, and      E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                  reinitializes internal state-machine variables.              E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            * Note:            None                                                         E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                            *****************************************************************************/  E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                           void USBProtocolResetHandler(void)                                               E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                           {                                                                                E:\usb20\logger\system\usb\usbdrv\usbdrv.c
001e50   6a6a     CLRF      0x6a,0x0           UEIR = 0;                       // Clear all USB error flags                 E:\usb20\logger\system\usb\usbdrv\usbdrv.c
001e52   6a68     CLRF      0x68,0x0           UIR = 0;                        // Clears all USB interrupts                 E:\usb20\logger\system\usb\usbdrv\usbdrv.c
001e54   0e9f     MOVLW     0x9f               UEIE = 0b10011111;              // Unmask all USB error interrupts           E:\usb20\logger\system\usb\usbdrv\usbdrv.c
001e56   6e6b     MOVWF     0x6b,0x0                                                                                        
001e58   0e7b     MOVLW     0x7b               UIE = 0b01111011;               // Enable all interrupts except ACTVIE       E:\usb20\logger\system\usb\usbdrv\usbdrv.c
001e5a   6e69     MOVWF     0x69,0x0                                                                                        
                                                                                                                            E:\usb20\logger\system\usb\usbdrv\usbdrv.c
001e5c   6a6e     CLRF      0x6e,0x0           UADDR = 0x00;                   // Reset to default address                  E:\usb20\logger\system\usb\usbdrv\usbdrv.c
001e5e   0e0f     MOVLW     0xf                mDisableEP1to15();              // Reset all non-EP0 UEPn registers          E:\usb20\logger\system\usb\usbdrv\usbdrv.c
001e60   6ee6     MOVWF     0xe6,0x0                                                                                        
001e62   0e71     MOVLW     0x71                                                                                            
001e64   6ee6     MOVWF     0xe6,0x0                                                                                        
001e66   0e0f     MOVLW     0xf                                                                                             
001e68   6ee6     MOVWF     0xe6,0x0                                                                                        
001e6a   d814     RCALL     0x1e94                                                                                          
001e6c   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001e6e   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001e70   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001e72   0e16     MOVLW     0x16               UEP0 = EP_CTRL|HSHK_EN;         // Init EP0 as a Ctrl EP, see usbdrv.h       E:\usb20\logger\system\usb\usbdrv\usbdrv.c
001e74   6e70     MOVWF     0x70,0x0                                                                                        
                                                                                                                            E:\usb20\logger\system\usb\usbdrv\usbdrv.c
001e76   a668     BTFSS     0x68,0x3,0x0       while(UIRbits.TRNIF == 1)       // Flush any pending transactions            E:\usb20\logger\system\usb\usbdrv\usbdrv.c
001e78   d002     BRA       0x1e7e                                                                                          
001e7c   d7fc     BRA       0x1e76                                                                                          
001e7a   9668     BCF       0x68,0x3,0x0           UIRbits.TRNIF = 0;                                                       E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\logger\system\usb\usbdrv\usbdrv.c
001e7e   986d     BCF       0x6d,0x4,0x0       UCONbits.PKTDIS = 0;            // Make sure packet processing is enabled    E:\usb20\logger\system\usb\usbdrv\usbdrv.c
001e80   ecca     CALL      0x1b94,0x0         USBPrepareForNextSetupTrf();    // Declared in usbctrltrf.c                  E:\usb20\logger\system\usb\usbdrv\usbdrv.c
001e82   f00d                                                                                                               
                                                                                                                            E:\usb20\logger\system\usb\usbdrv\usbdrv.c
001e84   0100     MOVLB     0x0                usb_stat.RemoteWakeup = 0;      // Default status flag to disable            E:\usb20\logger\system\usb\usbdrv\usbdrv.c
001e86   91fb     BCF       0xfb,0x0,0x1                                                                                    
001e88   0100     MOVLB     0x0                usb_active_cfg = 0;             // Clear active configuration                E:\usb20\logger\system\usb\usbdrv\usbdrv.c
001e8a   6bfc     CLRF      0xfc,0x1                                                                                        
001e8c   0100     MOVLB     0x0                usb_device_state = DEFAULT_STATE;                                            E:\usb20\logger\system\usb\usbdrv\usbdrv.c
001e8e   0e03     MOVLW     0x3                                                                                             
001e90   6ffa     MOVWF     0xfa,0x1                                                                                        
001e92   0012     RETURN    0x0            }//end USBProtocolResetHandler                                                   E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                           /* Auxiliary Function */                                                         E:\usb20\logger\system\usb\usbdrv\usbdrv.c
001e94   cfd9     MOVFF     0xfd9,0xfe6    void ClearArray(byte* startAdr,byte count)                                       E:\usb20\logger\system\usb\usbdrv\usbdrv.c
001e96   ffe6                                                                                                               
001e98   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
001e9a   ffd9                                                                                                               
                                           {                                                                                E:\usb20\logger\system\usb\usbdrv\usbdrv.c
001e9c   0efd     MOVLW     0xfd               *startAdr;                                                                   E:\usb20\logger\system\usb\usbdrv\usbdrv.c
001e9e   cfdb     MOVFF     0xfdb,0xfe9                                                                                     
001ea0   ffe9                                                                                                               
001ea2   0efe     MOVLW     0xfe                                                                                            
001ea4   cfdb     MOVFF     0xfdb,0xfea                                                                                     
001ea6   ffea                                                                                                               
001ea8   0efc     MOVLW     0xfc               while(count)                                                                 E:\usb20\logger\system\usb\usbdrv\usbdrv.c
001eaa   50db     MOVF      0xdb,0x0,0x0                                                                                    
001eac   e004     BZ        0x1eb6                                                                                          
001eb4   d7f9     BRA       0x1ea8                                                                                          
                                               {                                                                            E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                                   _asm                                                                     E:\usb20\logger\system\usb\usbdrv\usbdrv.c
001eae   6aee     CLRF      0xee,0x0               clrf POSTINC0,0                                                          E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                                   _endasm                                                                  E:\usb20\logger\system\usb\usbdrv\usbdrv.c
001eb0   0efc     MOVLW     0xfc                   count--;                                                                 E:\usb20\logger\system\usb\usbdrv\usbdrv.c
001eb2   06db     DECF      0xdb,0x1,0x0                                                                                    
                                               }//end while                                                                 E:\usb20\logger\system\usb\usbdrv\usbdrv.c
001eb6   52e5     MOVF      0xe5,0x1,0x0   }//end ClearArray                                                                E:\usb20\logger\system\usb\usbdrv\usbdrv.c
001eb8   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
001eba   ffd9                                                                                                               
001ebc   0012     RETURN    0x0                                                                                             
                                                                                                                            E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                           /** EOF usbdrv.c *************************************************************/  E:\usb20\logger\system\usb\usbdrv\usbdrv.c
                                           /*********************************************************************           E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            *                Microchip USB C18 Firmware Version 1.0                         E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            *********************************************************************           E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            * FileName:        usbctrltrf.c                                                 E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            * Dependencies:    See INCLUDES section below                                   E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            * Processor:       PIC18                                                        E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            * Compiler:        C18 2.30.01+                                                 E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            * Company:         Microchip Technology, Inc.                                   E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            * Software License Agreement                                                    E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            * The software supplied herewith by Microchip Technology Incorporated           E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            * (the 鼎ompany) for its PICmicroｮ Microcontroller is intended and             E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            * supplied to you, the Company痴 customer, for use solely and                   E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            * exclusively on Microchip PICmicro Microcontroller products. The               E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            * software is owned by the Company and/or its supplier, and is                  E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            * protected under applicable copyright laws. All rights are reserved.           E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            * Any use in violation of the foregoing restrictions may subject the            E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            * user to criminal sanctions under applicable laws, as well as to               E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            * civil liability for the breach of the terms and conditions of this            E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            * license.                                                                      E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            * THIS SOFTWARE IS PROVIDED IN AN 鄭S IS CONDITION. NO WARRANTIES,             E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            * WHETHER EXPRESS, IMPLIED OR STATUTORY, INCLUDING, BUT NOT LIMITED             E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            * TO, IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A                   E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            * PARTICULAR PURPOSE APPLY TO THIS SOFTWARE. THE COMPANY SHALL NOT,             E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            * IN ANY CIRCUMSTANCES, BE LIABLE FOR SPECIAL, INCIDENTAL OR                    E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            * CONSEQUENTIAL DAMAGES, FOR ANY REASON WHATSOEVER.                             E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            * Author               Date        Comment                                      E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            *~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~           E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            * Rawin Rojvanit       11/19/04    Original.                                    E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            ********************************************************************/           E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                                                                                                            E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                           /** I N C L U D E S **********************************************************/  E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                           #include <p18cxxx.h>                                                             E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                           #include "system\typedefs.h"                                                     E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                           #include "system\usb\usb.h"                                                      E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                                                                                                            E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                           /** V A R I A B L E S ********************************************************/  E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                           #pragma udata                                                                    E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                           byte ctrl_trf_state;                // Control Transfer State                    E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                           byte ctrl_trf_session_owner;        // Current transfer session owner            E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                                                                                                            E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                           POINTER pSrc;                       // Data source pointer                       E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                           POINTER pDst;                       // Data destination pointer                  E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                           WORD wCount;                        // Data counter                              E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                                                                                                            E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                           /** P R I V A T E  P R O T O T Y P E S ***************************************/  E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                           void USBCtrlTrfSetupHandler(void);                                               E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                           void USBCtrlTrfOutHandler(void);                                                 E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                           void USBCtrlTrfInHandler(void);                                                  E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                                                                                                            E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                           /** D E C L A R A T I O N S **************************************************/  E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                           #pragma code                                                                     E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                           /******************************************************************************  E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            * Function:        void USBCtrlEPService(void)                                  E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            * PreCondition:    USTAT is loaded with a valid endpoint address.               E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            * Input:           None                                                         E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            * Output:          None                                                         E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            * Side Effects:    None                                                         E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            * Overview:        USBCtrlEPService checks for three transaction types that     E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  it knows how to service and services them:                   E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  1. EP0 SETUP                                                 E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  2. EP0 OUT                                                   E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  3. EP0 IN                                                    E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  It ignores all other types (i.e. EP1, EP2, etc.)             E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            * Note:            None                                                         E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            *****************************************************************************/  E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                           void USBCtrlEPService(void)                                                      E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                           {                                                                                E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
0018ae   506c     MOVF      0x6c,0x0,0x0       if(USTAT == EP00_OUT)                                                        E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
0018b0   e002     BZ        0x18b6                                                                                          
0018b2   0e00     MOVLW     0x0                                                                                             
0018b4   d001     BRA       0x18b8                                                                                          
0018b6   0e01     MOVLW     0x1                                                                                             
0018b8   0900     IORLW     0x0                                                                                             
0018ba   e00b     BZ        0x18d2                                                                                          
                                               {                                                                            E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
0018bc   0104     MOVLB     0x4                    if(ep0Bo.Stat.PID == SETUP_TOKEN)           // EP0 SETUP                 E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
0018be   5100     MOVF      0x0,0x0,0x1                                                                                     
0018c0   0b3c     ANDLW     0x3c                                                                                            
0018c2   42e8     RRNCF     0xe8,0x1,0x0                                                                                    
0018c4   42e8     RRNCF     0xe8,0x1,0x0                                                                                    
0018c6   080d     SUBLW     0xd                                                                                             
0018c8   e102     BNZ       0x18ce                                                                                          
0018ca   d80c     RCALL     0x18e4                     USBCtrlTrfSetupHandler();                                            E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
0018cc   d001     BRA       0x18d0                 else                                        // EP0 OUT                   E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
0018ce   d840     RCALL     0x1950                     USBCtrlTrfOutHandler();                                              E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                               }                                                                            E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
0018d0   d008     BRA       0x18e2             else if(USTAT == EP00_IN)                       // EP0 IN                    E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
0018d2   506c     MOVF      0x6c,0x0,0x0                                                                                    
0018d4   e002     BZ        0x18da                                                                                          
0018d6   0e00     MOVLW     0x0                                                                                             
0018d8   d001     BRA       0x18dc                                                                                          
0018da   0e01     MOVLW     0x1                                                                                             
0018dc   0904     IORLW     0x4                                                                                             
0018de   e001     BZ        0x18e2                                                                                          
0018e0   d847     RCALL     0x1970                 USBCtrlTrfInHandler();                                                   E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                                                                                                            E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
0018e2   0012     RETURN    0x0            }//end USBCtrlEPService                                                          E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                                                                                                            E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                           /******************************************************************************  E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            * Function:        void USBCtrlTrfSetupHandler(void)                            E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            * PreCondition:    SetupPkt buffer is loaded with valid USB Setup Data          E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            * Input:           None                                                         E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            * Output:          None                                                         E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            * Side Effects:    None                                                         E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            * Overview:        This routine is a task dispatcher and has 3 stages.          E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  1. It initializes the control transfer state machine.        E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  2. It calls on each of the module that may know how to       E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            *                     service the Setup Request from the host.                  E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            *                     Module Example: USB9, HID, CDC, MSD, ...                  E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            *                     As new classes are added, ClassReqHandler table in        E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            *                     usbdsc.c should be updated to call all available          E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            *                     class handlers.                                           E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  3. Once each of the modules has had a chance to check if     E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            *                     it is responsible for servicing the request, stage 3      E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            *                     then checks direction of the transfer to determine how    E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            *                     to prepare EP0 for the control transfer.                  E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            *                     Refer to USBCtrlEPServiceComplete() for more details.     E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            * Note:            Microchip USB Firmware has three different states for        E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  the control transfer state machine:                          E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  1. WAIT_SETUP                                                E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  2. CTRL_TRF_TX                                               E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  3. CTRL_TRF_RX                                               E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  Refer to firmware manual to find out how one state           E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  is transitioned to another.                                  E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  A Control Transfer is composed of many USB transactions.     E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  When transferring data over multiple transactions,           E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  it is important to keep track of data source, data           E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  destination, and data count. These three parameters are      E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  stored in pSrc,pDst, and wCount. A flag is used to           E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  note if the data source is from ROM or RAM.                  E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            *****************************************************************************/  E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
0018e4   cfd9     MOVFF     0xfd9,0xfe6    void USBCtrlTrfSetupHandler(void)                                                E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
0018e6   ffe6                                                                                                               
0018e8   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
0018ea   ffd9                                                                                                               
0018ec   52e6     MOVF      0xe6,0x1,0x0                                                                                    
                                           {                                                                                E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                               byte i;                                                                      E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                                                                                                            E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                               /* Stage 1 */                                                                E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
0018ee   0101     MOVLB     0x1                ctrl_trf_state = WAIT_SETUP;                                                 E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
0018f0   6bf5     CLRF      0xf5,0x1                                                                                        
0018f2   6bf6     CLRF      0xf6,0x1           ctrl_trf_session_owner = MUID_NULL;     // Set owner to NULL                 E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
0018f4   6bfb     CLRF      0xfb,0x1           wCount._word = 0;                                                            E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
0018f6   6bfc     CLRF      0xfc,0x1                                                                                        
                                                                                                                            E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                               /* Stage 2 */                                                                E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
0018f8   ecd3     CALL      0x15a6,0x0         USBCheckStdRequest();                   // See system\usb9\usb9.c            E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
0018fa   f00a                                                                                                               
                                                                                                                            E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
0018fc   6adf     CLRF      0xdf,0x0           for(i=0;i < (sizeof(ClassReqHandler)/sizeof(pFunc));i++)                     E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
0018fe   50df     MOVF      0xdf,0x0,0x0                                                                                    
001900   6e14     MOVWF     0x14,0x0                                                                                        
001902   6a15     CLRF      0x15,0x0                                                                                        
001904   0e01     MOVLW     0x1                                                                                             
001906   5c14     SUBWF     0x14,0x0,0x0                                                                                    
001908   0e00     MOVLW     0x0                                                                                             
00190a   5815     SUBWFB    0x15,0x0,0x0                                                                                    
00190c   e21b     BC        0x1944                                                                                          
001940   2adf     INCF      0xdf,0x1,0x0                                                                                    
001942   d7dd     BRA       0x18fe                                                                                          
                                               {                                                                            E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
00190e   0101     MOVLB     0x1                    if(ctrl_trf_session_owner != MUID_NULL)break;                            E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
001910   51f6     MOVF      0xf6,0x0,0x1                                                                                    
001912   e001     BZ        0x1916                                                                                          
001914   d017     BRA       0x1944                                                                                          
001916   6af7     CLRF      0xf7,0x0               ClassReqHandler[i]();               // See autofiles\usbdsc.c            E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
001918   34df     RLCF      0xdf,0x0,0x0                                                                                    
00191a   0bfe     ANDLW     0xfe                                                                                            
00191c   36f7     RLCF      0xf7,0x1,0x0                                                                                    
00191e   6ef6     MOVWF     0xf6,0x0                                                                                        
001920   0e89     MOVLW     0x89                                                                                            
001922   26f6     ADDWF     0xf6,0x1,0x0                                                                                    
001924   0e1f     MOVLW     0x1f                                                                                            
001926   22f7     ADDWFC    0xf7,0x1,0x0                                                                                    
001928   0009     TBLRDPOSTINC                                                                                              
00192a   cff5     MOVFF     0xff5,0x14                                                                                      
00192c   f014                                                                                                               
00192e   0008     TBLRD                                                                                                     
001930   cff5     MOVFF     0xff5,0x15                                                                                      
001932   f015                                                                                                               
001934   d004     BRA       0x193e                                                                                          
001936   c015     MOVFF     0x15,0xffa                                                                                      
001938   fffa                                                                                                               
00193a   5014     MOVF      0x14,0x0,0x0                                                                                    
00193c   6ef9     MOVWF     0xf9,0x0                                                                                        
00193e   dffb     RCALL     0x1936                                                                                          
                                               }//end while                                                                 E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                                                                                                            E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                               /* Stage 3 */                                                                E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
001944   d8e1     RCALL     0x1b08             USBCtrlEPServiceComplete();                                                  E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                                                                                                            E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
001946   52e5     MOVF      0xe5,0x1,0x0   }//end USBCtrlTrfSetupHandler                                                    E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
001948   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00194a   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
00194c   ffd9                                                                                                               
00194e   0012     RETURN    0x0                                                                                             
                                                                                                                            E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                           /******************************************************************************  E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            * Function:        void USBCtrlTrfOutHandler(void)                              E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            * PreCondition:    None                                                         E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            * Input:           None                                                         E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            * Output:          None                                                         E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            * Side Effects:    None                                                         E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            * Overview:        This routine handles an OUT transaction according to         E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  which control transfer state is currently active.            E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            * Note:            Note that if the the control transfer was from               E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  host to device, the session owner should be notified         E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  at the end of each OUT transaction to service the            E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  received data.                                               E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            *****************************************************************************/  E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                           void USBCtrlTrfOutHandler(void)                                                  E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                           {                                                                                E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
001950   0e02     MOVLW     0x2                if(ctrl_trf_state == CTRL_TRF_RX)                                            E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
001952   0101     MOVLB     0x1                                                                                             
001954   5df5     SUBWF     0xf5,0x0,0x1                                                                                    
001956   e10a     BNZ       0x196c                                                                                          
                                               {                                                                            E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
001958   d898     RCALL     0x1a8a                 USBCtrlTrfRxService();                                                   E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                                                                                                            E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                                   /*                                                                       E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                                    * Don't have to worry about overwriting _KEEP bit                       E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                                    * because if _KEEP was set, TRNIF would not have been                   E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                                    * generated in the first place.                                         E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                                    */                                                                      E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
00195a   0104     MOVLB     0x4                    if(ep0Bo.Stat.DTS == 0)                                                  E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
00195c   bd00     BTFSC     0x0,0x6,0x1                                                                                     
00195e   d003     BRA       0x1966                                                                                          
001960   0ec8     MOVLW     0xc8                       ep0Bo.Stat._byte = _USIE|_DAT1|_DTSEN;                               E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
001962   6f00     MOVWF     0x0,0x1                                                                                         
001964   d002     BRA       0x196a                 else                                                                     E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
001966   0e88     MOVLW     0x88                       ep0Bo.Stat._byte = _USIE|_DAT0|_DTSEN;                               E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
001968   6f00     MOVWF     0x0,0x1                                                                                         
                                               }                                                                            E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
00196a   d001     BRA       0x196e             else    // CTRL_TRF_TX                                                       E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
00196c   d913     RCALL     0x1b94                 USBPrepareForNextSetupTrf();                                             E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                                                                                                            E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
00196e   0012     RETURN    0x0            }//end USBCtrlTrfOutHandler                                                      E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                                                                                                            E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                           /******************************************************************************  E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            * Function:        void USBCtrlTrfInHandler(void)                               E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            * PreCondition:    None                                                         E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            * Input:           None                                                         E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            * Output:          None                                                         E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            * Side Effects:    None                                                         E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            * Overview:        This routine handles an IN transaction according to          E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  which control transfer state is currently active.            E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            * Note:            A Set Address Request must not change the acutal address     E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  of the device until the completion of the control            E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  transfer. The end of the control transfer for Set Address    E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  Request is an IN transaction. Therefore it is necessary      E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  to service this unique situation when the condition is       E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  right. Macro mUSBCheckAdrPendingState is defined in          E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  usb9.h and its function is to specifically service this      E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  event.                                                       E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            *****************************************************************************/  E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                           void USBCtrlTrfInHandler(void)                                                   E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                           {                                                                                E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
001970   0e04     MOVLW     0x4                mUSBCheckAdrPendingState();         // Must check if in ADR_PENDING_STATE    E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
001972   0100     MOVLB     0x0                                                                                             
001974   5dfa     SUBWF     0xfa,0x0,0x1                                                                                    
001976   e10a     BNZ       0x198c                                                                                          
001978   c422     MOVFF     0x422,0xf6e                                                                                     
00197a   ff6e                                                                                                               
00197c   506e     MOVF      0x6e,0x0,0x0                                                                                    
00197e   0800     SUBLW     0x0                                                                                             
001980   e203     BC        0x1988                                                                                          
001982   0e05     MOVLW     0x5                                                                                             
001984   6ffa     MOVWF     0xfa,0x1                                                                                        
001986   d002     BRA       0x198c                                                                                          
001988   0e03     MOVLW     0x3                                                                                             
00198a   6ffa     MOVWF     0xfa,0x1                                                                                        
                                                                                                                            E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
00198c   0101     MOVLB     0x1                if(ctrl_trf_state == CTRL_TRF_TX)                                            E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
00198e   05f5     DECF      0xf5,0x0,0x1                                                                                    
001990   e10a     BNZ       0x19a6                                                                                          
                                               {                                                                            E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
001992   d80b     RCALL     0x19aa                 USBCtrlTrfTxService();                                                   E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                                                                                                            E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
001994   0104     MOVLB     0x4                    if(ep0Bi.Stat.DTS == 0)                                                  E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
001996   bd04     BTFSC     0x4,0x6,0x1                                                                                     
001998   d003     BRA       0x19a0                                                                                          
00199a   0ec8     MOVLW     0xc8                       ep0Bi.Stat._byte = _USIE|_DAT1|_DTSEN;                               E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
00199c   6f04     MOVWF     0x4,0x1                                                                                         
00199e   d002     BRA       0x19a4                 else                                                                     E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
0019a0   0e88     MOVLW     0x88                       ep0Bi.Stat._byte = _USIE|_DAT0|_DTSEN;                               E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
0019a2   6f04     MOVWF     0x4,0x1                                                                                         
                                               }                                                                            E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
0019a4   d001     BRA       0x19a8             else // CTRL_TRF_RX                                                          E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
0019a6   d8f6     RCALL     0x1b94                 USBPrepareForNextSetupTrf();                                             E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                                                                                                            E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
0019a8   0012     RETURN    0x0            }//end USBCtrlTrfInHandler                                                       E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                                                                                                            E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                           /******************************************************************************  E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            * Function:        void USBCtrlTrfTxService(void)                               E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            * PreCondition:    pSrc, wCount, and usb_stat.ctrl_trf_mem are setup properly.  E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            * Input:           None                                                         E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            * Output:          None                                                         E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            * Side Effects:    None                                                         E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            * Overview:        This routine should be called from only two places.          E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  One from USBCtrlEPServiceComplete() and one from             E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  USBCtrlTrfInHandler(). It takes care of managing a           E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  transfer over multiple USB transactions.                     E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            * Note:            This routine works with isochronous endpoint larger than     E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  256 bytes and is shown here as an example of how to deal     E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  with BC9 and BC8. In reality, a control endpoint can never   E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  be larger than 64 bytes.                                     E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            *****************************************************************************/  E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
0019aa   cfd9     MOVFF     0xfd9,0xfe6    void USBCtrlTrfTxService(void)                                                   E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
0019ac   ffe6                                                                                                               
0019ae   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
0019b0   ffd9                                                                                                               
0019b2   0e02     MOVLW     0x2                                                                                             
0019b4   26e1     ADDWF     0xe1,0x1,0x0                                                                                    
                                           {                                                                                E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                               WORD byte_to_send;                                                           E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                                                                                                            E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                               /*                                                                           E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                                * First, have to figure out how many byte of data to send.                  E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                                */                                                                          E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
0019b6   0101     MOVLB     0x1                if(wCount._word < EP0_BUFF_SIZE)                                             E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
0019b8   0e08     MOVLW     0x8                                                                                             
0019ba   5dfb     SUBWF     0xfb,0x0,0x1                                                                                    
0019bc   0e00     MOVLW     0x0                                                                                             
0019be   59fc     SUBWFB    0xfc,0x0,0x1                                                                                    
0019c0   e205     BC        0x19cc                                                                                          
0019c2   c1fb     MOVFF     0x1fb,0xfde            byte_to_send._word = wCount._word;                                       E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
0019c4   ffde                                                                                                               
0019c6   c1fc     MOVFF     0x1fc,0xfdd                                                                                     
0019c8   ffdd                                                                                                               
0019ca   d003     BRA       0x19d2             else                                                                         E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
0019cc   0e08     MOVLW     0x8                    byte_to_send._word = EP0_BUFF_SIZE;                                      E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
0019ce   6ede     MOVWF     0xde,0x0                                                                                        
0019d0   6add     CLRF      0xdd,0x0                                                                                        
                                                                                                                            E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                               /*                                                                           E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                                * Next, load the number of bytes to send to BC9..0 in buffer descriptor     E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                                */                                                                          E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
0019d2   0104     MOVLB     0x4                ep0Bi.Stat.BC9 = 0;                                                          E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
0019d4   9304     BCF       0x4,0x1,0x1                                                                                     
0019d6   9104     BCF       0x4,0x0,0x1        ep0Bi.Stat.BC8 = 0;                                                          E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
0019d8   0e01     MOVLW     0x1                ep0Bi.Stat._byte |= MSB(byte_to_send);                                       E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
0019da   50db     MOVF      0xdb,0x0,0x0                                                                                    
0019dc   1304     IORWF     0x4,0x1,0x1                                                                                     
0019de   cfdf     MOVFF     0xfdf,0x405        ep0Bi.Cnt = LSB(byte_to_send);                                               E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
0019e0   f405                                                                                                               
                                                                                                                            E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                               /*                                                                           E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                                * Subtract the number of bytes just about to be sent from the total.        E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                                */                                                                          E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
0019e2   0e00     MOVLW     0x0                wCount._word = wCount._word - byte_to_send._word;                            E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
0019e4   50db     MOVF      0xdb,0x0,0x0                                                                                    
0019e6   0101     MOVLB     0x1                                                                                             
0019e8   5ffb     SUBWF     0xfb,0x1,0x1                                                                                    
0019ea   0e01     MOVLW     0x1                                                                                             
0019ec   50db     MOVF      0xdb,0x0,0x0                                                                                    
0019ee   5bfc     SUBWFB    0xfc,0x1,0x1                                                                                    
                                                                                                                            E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
0019f0   0e28     MOVLW     0x28               pDst.bRam = (byte*)&CtrlTrfData;        // Set destination pointer           E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
0019f2   6ff9     MOVWF     0xf9,0x1                                                                                        
0019f4   0e04     MOVLW     0x4                                                                                             
0019f6   6ffa     MOVWF     0xfa,0x1                                                                                        
                                                                                                                            E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
0019f8   0100     MOVLB     0x0                if(usb_stat.ctrl_trf_mem == _ROM)       // Determine type of memory source   E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
0019fa   a3fb     BTFSS     0xfb,0x1,0x1                                                                                    
0019fc   d01e     BRA       0x1a3a                                                                                          
                                               {                                                                            E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
0019fe   cfd9     MOVFF     0xfd9,0xfe9            while(byte_to_send._word)                                                E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
001a00   ffe9                                                                                                               
001a02   cfda     MOVFF     0xfda,0xfea                                                                                     
001a04   ffea                                                                                                               
001a06   50ee     MOVF      0xee,0x0,0x0                                                                                    
001a08   10ed     IORWF     0xed,0x0,0x0                                                                                    
001a0a   e016     BZ        0x1a38                                                                                          
001a36   d7e3     BRA       0x19fe                                                                                          
                                                   {                                                                        E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
001a0c   c1f7     MOVFF     0x1f7,0xff6                *pDst.bRam = *pSrc.bRom;                                             E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
001a0e   fff6                                                                                                               
001a10   c1f8     MOVFF     0x1f8,0xff7                                                                                     
001a12   fff7                                                                                                               
001a14   0008     TBLRD                                                                                                     
001a16   50f5     MOVF      0xf5,0x0,0x0                                                                                    
001a18   c1f9     MOVFF     0x1f9,0xfe9                                                                                     
001a1a   ffe9                                                                                                               
001a1c   c1fa     MOVFF     0x1fa,0xfea                                                                                     
001a1e   ffea                                                                                                               
001a20   6eef     MOVWF     0xef,0x0                                                                                        
001a22   0101     MOVLB     0x1                        pDst.bRam++;                                                         E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
001a24   2bf9     INCF      0xf9,0x1,0x1                                                                                    
001a26   0e00     MOVLW     0x0                                                                                             
001a28   23fa     ADDWFC    0xfa,0x1,0x1                                                                                    
001a2a   2bf7     INCF      0xf7,0x1,0x1               pSrc.bRom++;                                                         E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
001a2c   23f8     ADDWFC    0xf8,0x1,0x1                                                                                    
001a2e   06df     DECF      0xdf,0x1,0x0               byte_to_send._word--;                                                E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
001a30   0e01     MOVLW     0x1                                                                                             
001a32   e201     BC        0x1a36                                                                                          
001a34   06db     DECF      0xdb,0x1,0x0                                                                                    
                                                   }//end while(byte_to_send._word)                                         E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                               }                                                                            E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
001a38   d01c     BRA       0x1a72             else // RAM                                                                  E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                               {                                                                            E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
001a3a   cfd9     MOVFF     0xfd9,0xfe9            while(byte_to_send._word)                                                E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
001a3c   ffe9                                                                                                               
001a3e   cfda     MOVFF     0xfda,0xfea                                                                                     
001a40   ffea                                                                                                               
001a42   50ee     MOVF      0xee,0x0,0x0                                                                                    
001a44   10ed     IORWF     0xed,0x0,0x0                                                                                    
001a46   e015     BZ        0x1a72                                                                                          
001a70   d7e4     BRA       0x1a3a                                                                                          
                                                   {                                                                        E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
001a48   c1f7     MOVFF     0x1f7,0xfe9                *pDst.bRam = *pSrc.bRam;                                             E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
001a4a   ffe9                                                                                                               
001a4c   c1f8     MOVFF     0x1f8,0xfea                                                                                     
001a4e   ffea                                                                                                               
001a50   50ef     MOVF      0xef,0x0,0x0                                                                                    
001a52   c1f9     MOVFF     0x1f9,0xfe9                                                                                     
001a54   ffe9                                                                                                               
001a56   c1fa     MOVFF     0x1fa,0xfea                                                                                     
001a58   ffea                                                                                                               
001a5a   6eef     MOVWF     0xef,0x0                                                                                        
001a5c   0101     MOVLB     0x1                        pDst.bRam++;                                                         E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
001a5e   2bf9     INCF      0xf9,0x1,0x1                                                                                    
001a60   0e00     MOVLW     0x0                                                                                             
001a62   23fa     ADDWFC    0xfa,0x1,0x1                                                                                    
001a64   2bf7     INCF      0xf7,0x1,0x1               pSrc.bRam++;                                                         E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
001a66   23f8     ADDWFC    0xf8,0x1,0x1                                                                                    
001a68   06df     DECF      0xdf,0x1,0x0               byte_to_send._word--;                                                E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
001a6a   0e01     MOVLW     0x1                                                                                             
001a6c   e201     BC        0x1a70                                                                                          
001a6e   06db     DECF      0xdb,0x1,0x0                                                                                    
                                                   }//end while(byte_to_send._word)                                         E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                               }//end if(usb_stat.ctrl_trf_mem == _ROM)                                     E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                                                                                                            E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
001a72   6ef5     MOVWF     0xf5,0x0       }//end USBCtrlTrfTxService                                                       E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
001a74   0e02     MOVLW     0x2                                                                                             
001a76   5ce1     SUBWF     0xe1,0x0,0x0                                                                                    
001a78   e202     BC        0x1a7e                                                                                          
001a7a   6ae1     CLRF      0xe1,0x0                                                                                        
001a7c   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001a7e   6ee1     MOVWF     0xe1,0x0                                                                                        
001a80   50f5     MOVF      0xf5,0x0,0x0                                                                                    
001a82   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001a84   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
001a86   ffd9                                                                                                               
001a88   0012     RETURN    0x0                                                                                             
                                                                                                                            E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                           /******************************************************************************  E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            * Function:        void USBCtrlTrfRxService(void)                               E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            * PreCondition:    pDst and wCount are setup properly.                          E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  pSrc is always &CtrlTrfData                                  E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  usb_stat.ctrl_trf_mem is always _RAM.                        E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  wCount should be set to 0 at the start of each control       E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  transfer.                                                    E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            * Input:           None                                                         E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            * Output:          None                                                         E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            * Side Effects:    None                                                         E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            * Overview:        *** This routine is only partially complete. Check for       E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  new version of the firmware.                                 E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            * Note:            None                                                         E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            *****************************************************************************/  E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
001a8a   cfd9     MOVFF     0xfd9,0xfe6    void USBCtrlTrfRxService(void)                                                   E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
001a8c   ffe6                                                                                                               
001a8e   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
001a90   ffd9                                                                                                               
001a92   0e02     MOVLW     0x2                                                                                             
001a94   26e1     ADDWF     0xe1,0x1,0x0                                                                                    
                                           {                                                                                E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                               WORD byte_to_read;                                                           E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                                                                                                            E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
001a96   0e03     MOVLW     0x3                MSB(byte_to_read) = 0x03 & ep0Bo.Stat._byte;    // Filter out last 2 bits    E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
001a98   0104     MOVLB     0x4                                                                                             
001a9a   1500     ANDWF     0x0,0x0,0x1                                                                                     
001a9c   6ee7     MOVWF     0xe7,0x0                                                                                        
001a9e   0e01     MOVLW     0x1                                                                                             
001aa0   cfe7     MOVFF     0xfe7,0xfdb                                                                                     
001aa2   ffdb                                                                                                               
001aa4   c401     MOVFF     0x401,0xfdf        LSB(byte_to_read) = ep0Bo.Cnt;                                               E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
001aa6   ffdf                                                                                                               
                                                                                                                            E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                               /*                                                                           E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                                * Accumulate total number of bytes read                                     E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                                */                                                                          E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
001aa8   50de     MOVF      0xde,0x0,0x0       wCount._word = wCount._word + byte_to_read._word;                            E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
001aaa   0101     MOVLB     0x1                                                                                             
001aac   27fb     ADDWF     0xfb,0x1,0x1                                                                                    
001aae   50dd     MOVF      0xdd,0x0,0x0                                                                                    
001ab0   23fc     ADDWFC    0xfc,0x1,0x1                                                                                    
                                                                                                                            E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
001ab2   0e28     MOVLW     0x28               pSrc.bRam = (byte*)&CtrlTrfData;                                             E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
001ab4   6ff7     MOVWF     0xf7,0x1                                                                                        
001ab6   0e04     MOVLW     0x4                                                                                             
001ab8   6ff8     MOVWF     0xf8,0x1                                                                                        
                                                                                                                            E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
001aba   cfd9     MOVFF     0xfd9,0xfe9        while(byte_to_read._word)                                                    E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
001abc   ffe9                                                                                                               
001abe   cfda     MOVFF     0xfda,0xfea                                                                                     
001ac0   ffea                                                                                                               
001ac2   50ee     MOVF      0xee,0x0,0x0                                                                                    
001ac4   10ed     IORWF     0xed,0x0,0x0                                                                                    
001ac6   e014     BZ        0x1af0                                                                                          
001aee   d7e5     BRA       0x1aba                                                                                          
                                               {                                                                            E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
001ac8   c1f7     MOVFF     0x1f7,0xfe9            *pDst.bRam = *pSrc.bRam;                                                 E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
001aca   ffe9                                                                                                               
001acc   c1f8     MOVFF     0x1f8,0xfea                                                                                     
001ace   ffea                                                                                                               
001ad0   50ef     MOVF      0xef,0x0,0x0                                                                                    
001ad2   c1f9     MOVFF     0x1f9,0xfe9                                                                                     
001ad4   ffe9                                                                                                               
001ad6   c1fa     MOVFF     0x1fa,0xfea                                                                                     
001ad8   ffea                                                                                                               
001ada   6eef     MOVWF     0xef,0x0                                                                                        
001adc   2bf9     INCF      0xf9,0x1,0x1           pDst.bRam++;                                                             E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
001ade   0e00     MOVLW     0x0                                                                                             
001ae0   23fa     ADDWFC    0xfa,0x1,0x1                                                                                    
001ae2   2bf7     INCF      0xf7,0x1,0x1           pSrc.bRam++;                                                             E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
001ae4   23f8     ADDWFC    0xf8,0x1,0x1                                                                                    
001ae6   06df     DECF      0xdf,0x1,0x0           byte_to_read._word--;                                                    E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
001ae8   0e01     MOVLW     0x1                                                                                             
001aea   e201     BC        0x1aee                                                                                          
001aec   06db     DECF      0xdb,0x1,0x0                                                                                    
                                               }//end while(byte_to_read._word)                                             E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                                                                                                            E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
001af0   6ef5     MOVWF     0xf5,0x0       }//end USBCtrlTrfRxService                                                       E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
001af2   0e02     MOVLW     0x2                                                                                             
001af4   5ce1     SUBWF     0xe1,0x0,0x0                                                                                    
001af6   e202     BC        0x1afc                                                                                          
001af8   6ae1     CLRF      0xe1,0x0                                                                                        
001afa   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001afc   6ee1     MOVWF     0xe1,0x0                                                                                        
001afe   50f5     MOVF      0xf5,0x0,0x0                                                                                    
001b00   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001b02   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
001b04   ffd9                                                                                                               
001b06   0012     RETURN    0x0                                                                                             
                                                                                                                            E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                           /******************************************************************************  E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            * Function:        void USBCtrlEPServiceComplete(void)                          E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            * PreCondition:    None                                                         E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            * Input:           None                                                         E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            * Output:          None                                                         E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            * Side Effects:    None                                                         E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            * Overview:        This routine wrap up the ramaining tasks in servicing        E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  a Setup Request. Its main task is to set the endpoint        E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  controls appropriately for a given situation. See code       E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  below.                                                       E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  There are three main scenarios:                              E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  a) There was no handler for the Request, in this case        E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            *                     a STALL should be sent out.                               E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  b) The host has requested a read control transfer,           E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            *                     endpoints are required to be setup in a specific way.     E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  c) The host has requested a write control transfer, or       E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            *                     a control data stage is not required, endpoints are       E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            *                     required to be setup in a specific way.                   E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  Packet processing is resumed by clearing PKTDIS bit.         E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            * Note:            None                                                         E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            *****************************************************************************/  E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                           void USBCtrlEPServiceComplete(void)                                              E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                           {                                                                                E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
001b08   0101     MOVLB     0x1                if(ctrl_trf_session_owner == MUID_NULL)                                      E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
001b0a   51f6     MOVF      0xf6,0x0,0x1                                                                                    
001b0c   e10c     BNZ       0x1b26                                                                                          
                                               {                                                                            E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                                   /*                                                                       E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                                    * If no one knows how to service this request then stall.               E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                                    * Must also prepare EP0 to receive the next SETUP transaction.          E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                                    */                                                                      E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
001b0e   0104     MOVLB     0x4                    ep0Bo.Cnt = EP0_BUFF_SIZE;                                               E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
001b10   0e08     MOVLW     0x8                                                                                             
001b12   6f01     MOVWF     0x1,0x1                                                                                         
001b14   0e20     MOVLW     0x20                   ep0Bo.ADR = (byte*)&SetupPkt;                                            E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
001b16   6f02     MOVWF     0x2,0x1                                                                                         
001b18   0e04     MOVLW     0x4                                                                                             
001b1a   6f03     MOVWF     0x3,0x1                                                                                         
                                                                                                                            E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
001b1c   0e84     MOVLW     0x84                   ep0Bo.Stat._byte = _USIE|_BSTALL;                                        E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
001b1e   6f00     MOVWF     0x0,0x1                                                                                         
001b20   0104     MOVLB     0x4                    ep0Bi.Stat._byte = _USIE|_BSTALL;                                        E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
001b22   6f04     MOVWF     0x4,0x1                                                                                         
                                               }                                                                            E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
001b24   d035     BRA       0x1b90             else    // A module has claimed ownership of the control transfer session.   E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                               {                                                                            E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
001b26   0104     MOVLB     0x4                    if(SetupPkt.DataDir == DEV_TO_HOST)                                      E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
001b28   af20     BTFSS     0x20,0x7,0x1                                                                                    
001b2a   d022     BRA       0x1b70                                                                                          
                                                   {                                                                        E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
001b2c   0101     MOVLB     0x1                        if(SetupPkt.wLength < wCount._word)                                  E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
001b2e   51fb     MOVF      0xfb,0x0,0x1                                                                                    
001b30   0104     MOVLB     0x4                                                                                             
001b32   5d26     SUBWF     0x26,0x0,0x1                                                                                    
001b34   0101     MOVLB     0x1                                                                                             
001b36   51fc     MOVF      0xfc,0x0,0x1                                                                                    
001b38   0104     MOVLB     0x4                                                                                             
001b3a   5927     SUBWFB    0x27,0x0,0x1                                                                                    
001b3c   e204     BC        0x1b46                                                                                          
001b3e   c426     MOVFF     0x426,0x1fb                    wCount._word = SetupPkt.wLength;                                 E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
001b40   f1fb                                                                                                               
001b42   c427     MOVFF     0x427,0x1fc                                                                                     
001b44   f1fc                                                                                                               
001b46   df31     RCALL     0x19aa                     USBCtrlTrfTxService();                                               E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
001b48   0101     MOVLB     0x1                        ctrl_trf_state = CTRL_TRF_TX;                                        E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
001b4a   0e01     MOVLW     0x1                                                                                             
001b4c   6ff5     MOVWF     0xf5,0x1                                                                                        
                                                       /*                                                                   E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                                        * Control Read:                                                     E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                                        * <SETUP[0]><IN[1]><IN[0]>...<OUT[1]> | <SETUP[0]>                  E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                                        * 1. Prepare OUT EP to respond to early termination                 E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                                        *                                                                   E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                                        * NOTE:                                                             E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                                        * If something went wrong during the control transfer,              E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                                        * the last status stage may not be sent by the host.                E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                                        * When this happens, two different things could happen              E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                                        * depending on the host.                                            E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                                        * a) The host could send out a RESET.                               E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                                        * b) The host could send out a new SETUP transaction                E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                                        *    without sending a RESET first.                                 E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                                        * To properly handle case (b), the OUT EP must be setup             E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                                        * to receive either a zero length OUT transaction, or a             E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                                        * new SETUP transaction.                                            E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                                        *                                                                   E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                                        * Since the SETUP transaction requires the DTS bit to be            E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                                        * DAT0 while the zero length OUT status requires the DTS            E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                                        * bit to be DAT1, the DTS bit check by the hardware should          E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                                        * be disabled. This way the SIE could accept either of              E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                                        * the two transactions.                                             E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                                        *                                                                   E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                                        * Furthermore, the Cnt byte should be set to prepare for            E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                                        * the SETUP data (8-byte or more), and the buffer address           E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                                        * should be pointed to SetupPkt.                                    E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                                        */                                                                  E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
001b4e   0104     MOVLB     0x4                        ep0Bo.Cnt = EP0_BUFF_SIZE;                                           E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
001b50   0e08     MOVLW     0x8                                                                                             
001b52   6f01     MOVWF     0x1,0x1                                                                                         
001b54   0e20     MOVLW     0x20                       ep0Bo.ADR = (byte*)&SetupPkt;                                        E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
001b56   6f02     MOVWF     0x2,0x1                                                                                         
001b58   0e04     MOVLW     0x4                                                                                             
001b5a   6f03     MOVWF     0x3,0x1                                                                                         
001b5c   0e80     MOVLW     0x80                       ep0Bo.Stat._byte = _USIE;           // Note: DTSEN is 0!             E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
001b5e   6f00     MOVWF     0x0,0x1                                                                                         
                                                                                                                            E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                                       /*                                                                   E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                                        * 2. Prepare IN EP to transfer data, Cnt should have                E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                                        *    been initialized by responsible request owner.                 E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                                        */                                                                  E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
001b60   0104     MOVLB     0x4                        ep0Bi.ADR = (byte*)&CtrlTrfData;                                     E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
001b62   0e28     MOVLW     0x28                                                                                            
001b64   6f06     MOVWF     0x6,0x1                                                                                         
001b66   0e04     MOVLW     0x4                                                                                             
001b68   6f07     MOVWF     0x7,0x1                                                                                         
001b6a   0ec8     MOVLW     0xc8                       ep0Bi.Stat._byte = _USIE|_DAT1|_DTSEN;                               E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
001b6c   6f04     MOVWF     0x4,0x1                                                                                         
                                                   }                                                                        E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
001b6e   d010     BRA       0x1b90                 else    // (SetupPkt.DataDir == HOST_TO_DEV)                             E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                                   {                                                                        E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
001b70   0101     MOVLB     0x1                        ctrl_trf_state = CTRL_TRF_RX;                                        E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
001b72   0e02     MOVLW     0x2                                                                                             
001b74   6ff5     MOVWF     0xf5,0x1                                                                                        
                                                       /*                                                                   E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                                        * Control Write:                                                    E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                                        * <SETUP[0]><OUT[1]><OUT[0]>...<IN[1]> | <SETUP[0]>                 E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                                        *                                                                   E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                                        * 1. Prepare IN EP to respond to early termination                  E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                                        *                                                                   E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                                        *    This is the same as a Zero Length Packet Response              E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                                        *    for control transfer without a data stage                      E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                                        */                                                                  E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
001b76   0104     MOVLB     0x4                        ep0Bi.Cnt = 0;                                                       E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
001b78   6b05     CLRF      0x5,0x1                                                                                         
001b7a   0ec8     MOVLW     0xc8                       ep0Bi.Stat._byte = _USIE|_DAT1|_DTSEN;                               E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
001b7c   6f04     MOVWF     0x4,0x1                                                                                         
                                                                                                                            E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                                       /*                                                                   E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                                        * 2. Prepare OUT EP to receive data.                                E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                                        */                                                                  E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
001b7e   0104     MOVLB     0x4                        ep0Bo.Cnt = EP0_BUFF_SIZE;                                           E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
001b80   0e08     MOVLW     0x8                                                                                             
001b82   6f01     MOVWF     0x1,0x1                                                                                         
001b84   0e28     MOVLW     0x28                       ep0Bo.ADR = (byte*)&CtrlTrfData;                                     E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
001b86   6f02     MOVWF     0x2,0x1                                                                                         
001b88   0e04     MOVLW     0x4                                                                                             
001b8a   6f03     MOVWF     0x3,0x1                                                                                         
001b8c   0ec8     MOVLW     0xc8                       ep0Bo.Stat._byte = _USIE|_DAT1|_DTSEN;                               E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
001b8e   6f00     MOVWF     0x0,0x1                                                                                         
                                                   }//end if(SetupPkt.DataDir == DEV_TO_HOST)                               E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                               }//end if(ctrl_trf_session_owner == MUID_NULL)                               E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                                                                                                            E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                               /*                                                                           E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                                * PKTDIS bit is set when a Setup Transaction is received.                   E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                                * Clear to resume packet processing.                                        E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                                */                                                                          E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
001b90   986d     BCF       0x6d,0x4,0x0       UCONbits.PKTDIS = 0;                                                         E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                                                                                                            E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
001b92   0012     RETURN    0x0            }//end USBCtrlEPServiceComplete                                                  E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                                                                                                            E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                           /******************************************************************************  E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            * Function:        void USBPrepareForNextSetupTrf(void)                         E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            * PreCondition:    None                                                         E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            * Input:           None                                                         E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            * Output:          None                                                         E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            * Side Effects:    None                                                         E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            * Overview:        The routine forces EP0 OUT to be ready for a new Setup       E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  transaction, and forces EP0 IN to be owned by CPU.           E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            * Note:            None                                                         E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                            *****************************************************************************/  E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                           void USBPrepareForNextSetupTrf(void)                                             E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                           {                                                                                E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
001b94   0101     MOVLB     0x1                ctrl_trf_state = WAIT_SETUP;            // See usbctrltrf.h                  E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
001b96   6bf5     CLRF      0xf5,0x1                                                                                        
001b98   0104     MOVLB     0x4                ep0Bo.Cnt = EP0_BUFF_SIZE;              // Defined in usbcfg.h               E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
001b9a   0e08     MOVLW     0x8                                                                                             
001b9c   6f01     MOVWF     0x1,0x1                                                                                         
001b9e   0e20     MOVLW     0x20               ep0Bo.ADR = (byte*)&SetupPkt;                                                E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
001ba0   6f02     MOVWF     0x2,0x1                                                                                         
001ba2   0e04     MOVLW     0x4                                                                                             
001ba4   6f03     MOVWF     0x3,0x1                                                                                         
001ba6   0e88     MOVLW     0x88               ep0Bo.Stat._byte = _USIE|_DAT0|_DTSEN;  // EP0 buff dsc init, see usbmmap.h  E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
001ba8   6f00     MOVWF     0x0,0x1                                                                                         
001baa   0104     MOVLB     0x4                ep0Bi.Stat._byte = _UCPU;               // EP0 IN buffer initialization      E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
001bac   6b04     CLRF      0x4,0x1                                                                                         
001bae   0012     RETURN    0x0            }//end USBPrepareForNextSetupTrf                                                 E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                                                                                                            E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                           /** EOF usbctrltrf.c *********************************************************/  E:\usb20\logger\system\usb\usbctrltrf\usbctrltrf.c
                                           /*********************************************************************           E:\usb20\logger\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\logger\system\usb\usb9\usb9.c
                                            *                Microchip USB C18 Firmware Version 1.0                         E:\usb20\logger\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\logger\system\usb\usb9\usb9.c
                                            *********************************************************************           E:\usb20\logger\system\usb\usb9\usb9.c
                                            * FileName:        usb9.c                                                       E:\usb20\logger\system\usb\usb9\usb9.c
                                            * Dependencies:    See INCLUDES section below                                   E:\usb20\logger\system\usb\usb9\usb9.c
                                            * Processor:       PIC18                                                        E:\usb20\logger\system\usb\usb9\usb9.c
                                            * Compiler:        C18 2.30.01+                                                 E:\usb20\logger\system\usb\usb9\usb9.c
                                            * Company:         Microchip Technology, Inc.                                   E:\usb20\logger\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\logger\system\usb\usb9\usb9.c
                                            * Software License Agreement                                                    E:\usb20\logger\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\logger\system\usb\usb9\usb9.c
                                            * The software supplied herewith by Microchip Technology Incorporated           E:\usb20\logger\system\usb\usb9\usb9.c
                                            * (the 鼎ompany・ for its PICmicroｮ Microcontroller is intended and             E:\usb20\logger\system\usb\usb9\usb9.c
                                            * supplied to you, the Company痴 customer, for use solely and                   E:\usb20\logger\system\usb\usb9\usb9.c
                                            * exclusively on Microchip PICmicro Microcontroller products. The               E:\usb20\logger\system\usb\usb9\usb9.c
                                            * software is owned by the Company and/or its supplier, and is                  E:\usb20\logger\system\usb\usb9\usb9.c
                                            * protected under applicable copyright laws. All rights are reserved.           E:\usb20\logger\system\usb\usb9\usb9.c
                                            * Any use in violation of the foregoing restrictions may subject the            E:\usb20\logger\system\usb\usb9\usb9.c
                                            * user to criminal sanctions under applicable laws, as well as to               E:\usb20\logger\system\usb\usb9\usb9.c
                                            * civil liability for the breach of the terms and conditions of this            E:\usb20\logger\system\usb\usb9\usb9.c
                                            * license.                                                                      E:\usb20\logger\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\logger\system\usb\usb9\usb9.c
                                            * THIS SOFTWARE IS PROVIDED IN AN 鄭S IS・CONDITION. NO WARRANTIES,             E:\usb20\logger\system\usb\usb9\usb9.c
                                            * WHETHER EXPRESS, IMPLIED OR STATUTORY, INCLUDING, BUT NOT LIMITED             E:\usb20\logger\system\usb\usb9\usb9.c
                                            * TO, IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A                   E:\usb20\logger\system\usb\usb9\usb9.c
                                            * PARTICULAR PURPOSE APPLY TO THIS SOFTWARE. THE COMPANY SHALL NOT,             E:\usb20\logger\system\usb\usb9\usb9.c
                                            * IN ANY CIRCUMSTANCES, BE LIABLE FOR SPECIAL, INCIDENTAL OR                    E:\usb20\logger\system\usb\usb9\usb9.c
                                            * CONSEQUENTIAL DAMAGES, FOR ANY REASON WHATSOEVER.                             E:\usb20\logger\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\logger\system\usb\usb9\usb9.c
                                            * Author               Date        Comment                                      E:\usb20\logger\system\usb\usb9\usb9.c
                                            *~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~           E:\usb20\logger\system\usb\usb9\usb9.c
                                            * Rawin Rojvanit       11/19/04    Original.                                    E:\usb20\logger\system\usb\usb9\usb9.c
                                            ********************************************************************/           E:\usb20\logger\system\usb\usb9\usb9.c
                                                                                                                            E:\usb20\logger\system\usb\usb9\usb9.c
                                           /** I N C L U D E S **********************************************************/  E:\usb20\logger\system\usb\usb9\usb9.c
                                           #include <p18cxxx.h>                                                             E:\usb20\logger\system\usb\usb9\usb9.c
                                           #include "system\typedefs.h"                                                     E:\usb20\logger\system\usb\usb9\usb9.c
                                           #include "system\usb\usb.h"                                                      E:\usb20\logger\system\usb\usb9\usb9.c
                                           #include "io_cfg.h"                     // Required for self_power status        E:\usb20\logger\system\usb\usb9\usb9.c
                                                                                                                            E:\usb20\logger\system\usb\usb9\usb9.c
                                           /** V A R I A B L E S ********************************************************/  E:\usb20\logger\system\usb\usb9\usb9.c
                                           #pragma udata                                                                    E:\usb20\logger\system\usb\usb9\usb9.c
                                                                                                                            E:\usb20\logger\system\usb\usb9\usb9.c
                                           /** P R I V A T E  P R O T O T Y P E S ***************************************/  E:\usb20\logger\system\usb\usb9\usb9.c
                                           void USBStdGetDscHandler(void);                                                  E:\usb20\logger\system\usb\usb9\usb9.c
                                           void USBStdSetCfgHandler(void);                                                  E:\usb20\logger\system\usb\usb9\usb9.c
                                           void USBStdGetStatusHandler(void);                                               E:\usb20\logger\system\usb\usb9\usb9.c
                                           void USBStdFeatureReqHandler(void);                                              E:\usb20\logger\system\usb\usb9\usb9.c
                                                                                                                            E:\usb20\logger\system\usb\usb9\usb9.c
                                           /** D E C L A R A T I O N S **************************************************/  E:\usb20\logger\system\usb\usb9\usb9.c
                                           #pragma code                                                                     E:\usb20\logger\system\usb\usb9\usb9.c
                                           /******************************************************************************  E:\usb20\logger\system\usb\usb9\usb9.c
                                            * Function:        void USBCheckStdRequest(void)                                E:\usb20\logger\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\logger\system\usb\usb9\usb9.c
                                            * PreCondition:    None                                                         E:\usb20\logger\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\logger\system\usb\usb9\usb9.c
                                            * Input:           None                                                         E:\usb20\logger\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\logger\system\usb\usb9\usb9.c
                                            * Output:          None                                                         E:\usb20\logger\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\logger\system\usb\usb9\usb9.c
                                            * Side Effects:    None                                                         E:\usb20\logger\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\logger\system\usb\usb9\usb9.c
                                            * Overview:        This routine checks the setup data packet to see if it       E:\usb20\logger\system\usb\usb9\usb9.c
                                            *                  knows how to handle it                                       E:\usb20\logger\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\logger\system\usb\usb9\usb9.c
                                            * Note:            None                                                         E:\usb20\logger\system\usb\usb9\usb9.c
                                            *****************************************************************************/  E:\usb20\logger\system\usb\usb9\usb9.c
                                           void USBCheckStdRequest(void)                                                    E:\usb20\logger\system\usb\usb9\usb9.c
                                           {                                                                                E:\usb20\logger\system\usb\usb9\usb9.c
0015a6   0104     MOVLB     0x4                if(SetupPkt.RequestType != STANDARD) return;                                 E:\usb20\logger\system\usb\usb9\usb9.c
0015a8   5120     MOVF      0x20,0x0,0x1                                                                                    
0015aa   0b60     ANDLW     0x60                                                                                            
0015ac   42e8     RRNCF     0xe8,0x1,0x0                                                                                    
0015ae   42e8     RRNCF     0xe8,0x1,0x0                                                                                    
0015b0   42e8     RRNCF     0xe8,0x1,0x0                                                                                    
0015b2   42e8     RRNCF     0xe8,0x1,0x0                                                                                    
0015b4   42e8     RRNCF     0xe8,0x1,0x0                                                                                    
0015b6   0900     IORLW     0x0                                                                                             
0015b8   e001     BZ        0x15bc                                                                                          
0015ba   d055     BRA       0x1666                                                                                          
                                                                                                                            E:\usb20\logger\system\usb\usb9\usb9.c
0015bc   5121     MOVF      0x21,0x0,0x1       switch(SetupPkt.bRequest)                                                    E:\usb20\logger\system\usb\usb9\usb9.c
0015be   0a07     XORLW     0x7                                                                                             
0015c0   e051     BZ        0x1664                                                                                          
0015c2   0a0b     XORLW     0xb                                                                                             
0015c4   e04f     BZ        0x1664                                                                                          
0015c6   0a07     XORLW     0x7                                                                                             
0015c8   e040     BZ        0x164a                                                                                          
0015ca   0a01     XORLW     0x1                                                                                             
0015cc   e02c     BZ        0x1626                                                                                          
0015ce   0a0b     XORLW     0xb                                                                                             
0015d0   e028     BZ        0x1622                                                                                          
0015d2   0a02     XORLW     0x2                                                                                             
0015d4   e026     BZ        0x1622                                                                                          
0015d6   0a03     XORLW     0x3                                                                                             
0015d8   e022     BZ        0x161e                                                                                          
0015da   0a08     XORLW     0x8                                                                                             
0015dc   e012     BZ        0x1602                                                                                          
0015de   0a01     XORLW     0x1                                                                                             
0015e0   e00e     BZ        0x15fe                                                                                          
0015e2   0a0f     XORLW     0xf                                                                                             
0015e4   e00a     BZ        0x15fa                                                                                          
0015e6   0a03     XORLW     0x3                                                                                             
0015e8   e001     BZ        0x15ec                                                                                          
0015ea   d03c     BRA       0x1664                                                                                          
                                               {                                                                            E:\usb20\logger\system\usb\usb9\usb9.c
                                                   case SET_ADR:                                                            E:\usb20\logger\system\usb\usb9\usb9.c
0015ec   0101     MOVLB     0x1                        ctrl_trf_session_owner = MUID_USB9;                                  E:\usb20\logger\system\usb\usb9\usb9.c
0015ee   0e01     MOVLW     0x1                                                                                             
0015f0   6ff6     MOVWF     0xf6,0x1                                                                                        
0015f2   0100     MOVLB     0x0                        usb_device_state = ADR_PENDING_STATE;       // Update state only     E:\usb20\logger\system\usb\usb9\usb9.c
0015f4   0e04     MOVLW     0x4                                                                                             
0015f6   6ffa     MOVWF     0xfa,0x1                                                                                        
                                                       /* See USBCtrlTrfInHandler() in usbctrltrf.c for the next step */    E:\usb20\logger\system\usb\usb9\usb9.c
0015f8   d036     BRA       0x1666                     break;                                                               E:\usb20\logger\system\usb\usb9\usb9.c
                                                   case GET_DSC:                                                            E:\usb20\logger\system\usb\usb9\usb9.c
0015fa   d836     RCALL     0x1668                     USBStdGetDscHandler();                                               E:\usb20\logger\system\usb\usb9\usb9.c
0015fc   d034     BRA       0x1666                     break;                                                               E:\usb20\logger\system\usb\usb9\usb9.c
                                                   case SET_CFG:                                                            E:\usb20\logger\system\usb\usb9\usb9.c
0015fe   d890     RCALL     0x1720                     USBStdSetCfgHandler();                                               E:\usb20\logger\system\usb\usb9\usb9.c
001600   d032     BRA       0x1666                     break;                                                               E:\usb20\logger\system\usb\usb9\usb9.c
                                                   case GET_CFG:                                                            E:\usb20\logger\system\usb\usb9\usb9.c
001602   0101     MOVLB     0x1                        ctrl_trf_session_owner = MUID_USB9;                                  E:\usb20\logger\system\usb\usb9\usb9.c
001604   0e01     MOVLW     0x1                                                                                             
001606   6ff6     MOVWF     0xf6,0x1                                                                                        
001608   0101     MOVLB     0x1                        pSrc.bRam = (byte*)&usb_active_cfg;         // Set Source            E:\usb20\logger\system\usb\usb9\usb9.c
00160a   0efc     MOVLW     0xfc                                                                                            
00160c   6ff7     MOVWF     0xf7,0x1                                                                                        
00160e   0e00     MOVLW     0x0                                                                                             
001610   6ff8     MOVWF     0xf8,0x1                                                                                        
001612   0100     MOVLB     0x0                        usb_stat.ctrl_trf_mem = _RAM;               // Set memory type       E:\usb20\logger\system\usb\usb9\usb9.c
001614   93fb     BCF       0xfb,0x1,0x1                                                                                    
001616   0101     MOVLB     0x1                        LSB(wCount) = 1;                            // Set data count        E:\usb20\logger\system\usb\usb9\usb9.c
001618   0e01     MOVLW     0x1                                                                                             
00161a   6ffb     MOVWF     0xfb,0x1                                                                                        
00161c   d024     BRA       0x1666                     break;                                                               E:\usb20\logger\system\usb\usb9\usb9.c
                                                   case GET_STATUS:                                                         E:\usb20\logger\system\usb\usb9\usb9.c
00161e   d8a8     RCALL     0x1770                     USBStdGetStatusHandler();                                            E:\usb20\logger\system\usb\usb9\usb9.c
001620   d022     BRA       0x1666                     break;                                                               E:\usb20\logger\system\usb\usb9\usb9.c
                                                   case CLR_FEATURE:                                                        E:\usb20\logger\system\usb\usb9\usb9.c
                                                   case SET_FEATURE:                                                        E:\usb20\logger\system\usb\usb9\usb9.c
001622   d8f4     RCALL     0x180c                     USBStdFeatureReqHandler();                                           E:\usb20\logger\system\usb\usb9\usb9.c
001624   d020     BRA       0x1666                     break;                                                               E:\usb20\logger\system\usb\usb9\usb9.c
                                                   case GET_INTF:                                                           E:\usb20\logger\system\usb\usb9\usb9.c
001626   0101     MOVLB     0x1                        ctrl_trf_session_owner = MUID_USB9;                                  E:\usb20\logger\system\usb\usb9\usb9.c
001628   0e01     MOVLW     0x1                                                                                             
00162a   6ff6     MOVWF     0xf6,0x1                                                                                        
00162c   0104     MOVLB     0x4                        pSrc.bRam = (byte*)&usb_alt_intf+SetupPkt.bIntfID;  // Set source    E:\usb20\logger\system\usb\usb9\usb9.c
00162e   5124     MOVF      0x24,0x0,0x1                                                                                    
001630   0101     MOVLB     0x1                                                                                             
001632   6ff7     MOVWF     0xf7,0x1                                                                                        
001634   6bf8     CLRF      0xf8,0x1                                                                                        
001636   0efd     MOVLW     0xfd                                                                                            
001638   27f7     ADDWF     0xf7,0x1,0x1                                                                                    
00163a   0e00     MOVLW     0x0                                                                                             
00163c   23f8     ADDWFC    0xf8,0x1,0x1                                                                                    
00163e   0100     MOVLB     0x0                        usb_stat.ctrl_trf_mem = _RAM;               // Set memory type       E:\usb20\logger\system\usb\usb9\usb9.c
001640   93fb     BCF       0xfb,0x1,0x1                                                                                    
001642   0101     MOVLB     0x1                        LSB(wCount) = 1;                            // Set data count        E:\usb20\logger\system\usb\usb9\usb9.c
001644   0e01     MOVLW     0x1                                                                                             
001646   6ffb     MOVWF     0xfb,0x1                                                                                        
001648   d00e     BRA       0x1666                     break;                                                               E:\usb20\logger\system\usb\usb9\usb9.c
                                                   case SET_INTF:                                                           E:\usb20\logger\system\usb\usb9\usb9.c
00164a   0101     MOVLB     0x1                        ctrl_trf_session_owner = MUID_USB9;                                  E:\usb20\logger\system\usb\usb9\usb9.c
00164c   0e01     MOVLW     0x1                                                                                             
00164e   6ff6     MOVWF     0xf6,0x1                                                                                        
001650   0104     MOVLB     0x4                        usb_alt_intf[SetupPkt.bIntfID] = SetupPkt.bAltID;                    E:\usb20\logger\system\usb\usb9\usb9.c
001652   5124     MOVF      0x24,0x0,0x1                                                                                    
001654   6aea     CLRF      0xea,0x0                                                                                        
001656   0ffd     ADDLW     0xfd                                                                                            
001658   6ee9     MOVWF     0xe9,0x0                                                                                        
00165a   0e00     MOVLW     0x0                                                                                             
00165c   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
00165e   c422     MOVFF     0x422,0xfef                                                                                     
001660   ffef                                                                                                               
001662   d001     BRA       0x1666                     break;                                                               E:\usb20\logger\system\usb\usb9\usb9.c
                                                   case SET_DSC:                                                            E:\usb20\logger\system\usb\usb9\usb9.c
                                                   case SYNCH_FRAME:                                                        E:\usb20\logger\system\usb\usb9\usb9.c
                                                   default:                                                                 E:\usb20\logger\system\usb\usb9\usb9.c
001664   d000     BRA       0x1666                     break;                                                               E:\usb20\logger\system\usb\usb9\usb9.c
                                               }//end switch                                                                E:\usb20\logger\system\usb\usb9\usb9.c
                                                                                                                            E:\usb20\logger\system\usb\usb9\usb9.c
001666   0012     RETURN    0x0            }//end USBCheckStdRequest                                                        E:\usb20\logger\system\usb\usb9\usb9.c
                                                                                                                            E:\usb20\logger\system\usb\usb9\usb9.c
                                           /******************************************************************************  E:\usb20\logger\system\usb\usb9\usb9.c
                                            * Function:        void USBStdGetDscHandler(void)                               E:\usb20\logger\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\logger\system\usb\usb9\usb9.c
                                            * PreCondition:    None                                                         E:\usb20\logger\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\logger\system\usb\usb9\usb9.c
                                            * Input:           None                                                         E:\usb20\logger\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\logger\system\usb\usb9\usb9.c
                                            * Output:          None                                                         E:\usb20\logger\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\logger\system\usb\usb9\usb9.c
                                            * Side Effects:    None                                                         E:\usb20\logger\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\logger\system\usb\usb9\usb9.c
                                            * Overview:        This routine handles the standard GET_DESCRIPTOR request.    E:\usb20\logger\system\usb\usb9\usb9.c
                                            *                  It utilizes tables dynamically looks up descriptor size.     E:\usb20\logger\system\usb\usb9\usb9.c
                                            *                  This routine should never have to be modified if the tables  E:\usb20\logger\system\usb\usb9\usb9.c
                                            *                  in usbdsc.c are declared correctly.                          E:\usb20\logger\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\logger\system\usb\usb9\usb9.c
                                            * Note:            None                                                         E:\usb20\logger\system\usb\usb9\usb9.c
                                            *****************************************************************************/  E:\usb20\logger\system\usb\usb9\usb9.c
                                           void USBStdGetDscHandler(void)                                                   E:\usb20\logger\system\usb\usb9\usb9.c
                                           {                                                                                E:\usb20\logger\system\usb\usb9\usb9.c
001668   0e80     MOVLW     0x80               if(SetupPkt.bmRequestType == 0x80)                                           E:\usb20\logger\system\usb\usb9\usb9.c
00166a   0104     MOVLB     0x4                                                                                             
00166c   5d20     SUBWF     0x20,0x0,0x1                                                                                    
00166e   e157     BNZ       0x171e                                                                                          
                                               {                                                                            E:\usb20\logger\system\usb\usb9\usb9.c
001670   5123     MOVF      0x23,0x0,0x1           switch(SetupPkt.bDscType)                                                E:\usb20\logger\system\usb\usb9\usb9.c
001672   0a03     XORLW     0x3                                                                                             
001674   e034     BZ        0x16de                                                                                          
001676   0a01     XORLW     0x1                                                                                             
001678   e010     BZ        0x169a                                                                                          
00167a   0a03     XORLW     0x3                                                                                             
00167c   e001     BZ        0x1680                                                                                          
00167e   d04d     BRA       0x171a                                                                                          
                                                   {                                                                        E:\usb20\logger\system\usb\usb9\usb9.c
                                                       case DSC_DEV:                                                        E:\usb20\logger\system\usb\usb9\usb9.c
001680   0101     MOVLB     0x1                            ctrl_trf_session_owner = MUID_USB9;                              E:\usb20\logger\system\usb\usb9\usb9.c
001682   0e01     MOVLW     0x1                                                                                             
001684   6ff6     MOVWF     0xf6,0x1                                                                                        
001686   0101     MOVLB     0x1                            pSrc.bRom = (rom byte*)&device_dsc;                              E:\usb20\logger\system\usb\usb9\usb9.c
001688   0ebe     MOVLW     0xbe                                                                                            
00168a   6ff7     MOVWF     0xf7,0x1                                                                                        
00168c   0e1e     MOVLW     0x1e                                                                                            
00168e   6ff8     MOVWF     0xf8,0x1                                                                                        
001690   0e12     MOVLW     0x12                           wCount._word = sizeof(device_dsc);          // Set data count    E:\usb20\logger\system\usb\usb9\usb9.c
001692   0101     MOVLB     0x1                                                                                             
001694   6ffb     MOVWF     0xfb,0x1                                                                                        
001696   6bfc     CLRF      0xfc,0x1                                                                                        
001698   d040     BRA       0x171a                         break;                                                           E:\usb20\logger\system\usb\usb9\usb9.c
                                                       case DSC_CFG:                                                        E:\usb20\logger\system\usb\usb9\usb9.c
00169a   0101     MOVLB     0x1                            ctrl_trf_session_owner = MUID_USB9;                              E:\usb20\logger\system\usb\usb9\usb9.c
00169c   0e01     MOVLW     0x1                                                                                             
00169e   6ff6     MOVWF     0xf6,0x1                                                                                        
0016a0   0104     MOVLB     0x4                            pSrc.bRom = *(USB_CD_Ptr+SetupPkt.bDscIndex);                    E:\usb20\logger\system\usb\usb9\usb9.c
0016a2   5122     MOVF      0x22,0x0,0x1                                                                                    
0016a4   6ef6     MOVWF     0xf6,0x0                                                                                        
0016a6   6af7     CLRF      0xf7,0x0                                                                                        
0016a8   90d8     BCF       0xd8,0x0,0x0                                                                                    
0016aa   36f6     RLCF      0xf6,0x1,0x0                                                                                    
0016ac   36f7     RLCF      0xf7,0x1,0x0                                                                                    
0016ae   0e7f     MOVLW     0x7f                                                                                            
0016b0   26f6     ADDWF     0xf6,0x1,0x0                                                                                    
0016b2   0e1f     MOVLW     0x1f                                                                                            
0016b4   22f7     ADDWFC    0xf7,0x1,0x0                                                                                    
0016b6   0009     TBLRDPOSTINC                                                                                              
0016b8   cff5     MOVFF     0xff5,0x1f7                                                                                     
0016ba   f1f7                                                                                                               
0016bc   000a     TBLRDPOSTDEC                                                                                              
0016be   cff5     MOVFF     0xff5,0x1f8                                                                                     
0016c0   f1f8                                                                                                               
0016c2   0e02     MOVLW     0x2                            wCount._word = *(pSrc.wRom+1);              // Set data count    E:\usb20\logger\system\usb\usb9\usb9.c
0016c4   0101     MOVLB     0x1                                                                                             
0016c6   6af7     CLRF      0xf7,0x0                                                                                        
0016c8   25f7     ADDWF     0xf7,0x0,0x1                                                                                    
0016ca   6ef6     MOVWF     0xf6,0x0                                                                                        
0016cc   51f8     MOVF      0xf8,0x0,0x1                                                                                    
0016ce   22f7     ADDWFC    0xf7,0x1,0x0                                                                                    
0016d0   0009     TBLRDPOSTINC                                                                                              
0016d2   cff5     MOVFF     0xff5,0x1fb                                                                                     
0016d4   f1fb                                                                                                               
0016d6   000a     TBLRDPOSTDEC                                                                                              
0016d8   cff5     MOVFF     0xff5,0x1fc                                                                                     
0016da   f1fc                                                                                                               
0016dc   d01e     BRA       0x171a                         break;                                                           E:\usb20\logger\system\usb\usb9\usb9.c
                                                       case DSC_STR:                                                        E:\usb20\logger\system\usb\usb9\usb9.c
0016de   0101     MOVLB     0x1                            ctrl_trf_session_owner = MUID_USB9;                              E:\usb20\logger\system\usb\usb9\usb9.c
0016e0   0e01     MOVLW     0x1                                                                                             
0016e2   6ff6     MOVWF     0xf6,0x1                                                                                        
0016e4   0104     MOVLB     0x4                            pSrc.bRom = *(USB_SD_Ptr+SetupPkt.bDscIndex);                    E:\usb20\logger\system\usb\usb9\usb9.c
0016e6   5122     MOVF      0x22,0x0,0x1                                                                                    
0016e8   6ef6     MOVWF     0xf6,0x0                                                                                        
0016ea   6af7     CLRF      0xf7,0x0                                                                                        
0016ec   90d8     BCF       0xd8,0x0,0x0                                                                                    
0016ee   36f6     RLCF      0xf6,0x1,0x0                                                                                    
0016f0   36f7     RLCF      0xf7,0x1,0x0                                                                                    
0016f2   0e83     MOVLW     0x83                                                                                            
0016f4   26f6     ADDWF     0xf6,0x1,0x0                                                                                    
0016f6   0e1f     MOVLW     0x1f                                                                                            
0016f8   22f7     ADDWFC    0xf7,0x1,0x0                                                                                    
0016fa   0009     TBLRDPOSTINC                                                                                              
0016fc   cff5     MOVFF     0xff5,0x1f7                                                                                     
0016fe   f1f7                                                                                                               
001700   000a     TBLRDPOSTDEC                                                                                              
001702   cff5     MOVFF     0xff5,0x1f8                                                                                     
001704   f1f8                                                                                                               
001706   c1f7     MOVFF     0x1f7,0xff6                    wCount._word = *pSrc.bRom;                  // Set data count    E:\usb20\logger\system\usb\usb9\usb9.c
001708   fff6                                                                                                               
00170a   c1f8     MOVFF     0x1f8,0xff7                                                                                     
00170c   fff7                                                                                                               
00170e   0008     TBLRD                                                                                                     
001710   50f5     MOVF      0xf5,0x0,0x0                                                                                    
001712   0101     MOVLB     0x1                                                                                             
001714   6ffb     MOVWF     0xfb,0x1                                                                                        
001716   6bfc     CLRF      0xfc,0x1                                                                                        
001718   d000     BRA       0x171a                         break;                                                           E:\usb20\logger\system\usb\usb9\usb9.c
                                                   }//end switch                                                            E:\usb20\logger\system\usb\usb9\usb9.c
                                                                                                                            E:\usb20\logger\system\usb\usb9\usb9.c
00171a   0100     MOVLB     0x0                    usb_stat.ctrl_trf_mem = _ROM;                       // Set memory type   E:\usb20\logger\system\usb\usb9\usb9.c
00171c   83fb     BSF       0xfb,0x1,0x1                                                                                    
                                               }//end if                                                                    E:\usb20\logger\system\usb\usb9\usb9.c
00171e   0012     RETURN    0x0            }//end USBStdGetDscHandler                                                       E:\usb20\logger\system\usb\usb9\usb9.c
                                                                                                                            E:\usb20\logger\system\usb\usb9\usb9.c
                                           /******************************************************************************  E:\usb20\logger\system\usb\usb9\usb9.c
                                            * Function:        void USBStdSetCfgHandler(void)                               E:\usb20\logger\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\logger\system\usb\usb9\usb9.c
                                            * PreCondition:    None                                                         E:\usb20\logger\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\logger\system\usb\usb9\usb9.c
                                            * Input:           None                                                         E:\usb20\logger\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\logger\system\usb\usb9\usb9.c
                                            * Output:          None                                                         E:\usb20\logger\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\logger\system\usb\usb9\usb9.c
                                            * Side Effects:    None                                                         E:\usb20\logger\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\logger\system\usb\usb9\usb9.c
                                            * Overview:        This routine first disables all endpoints by clearing        E:\usb20\logger\system\usb\usb9\usb9.c
                                            *                  UEP registers. It then configures (initializes) endpoints    E:\usb20\logger\system\usb\usb9\usb9.c
                                            *                  specified in the modifiable section.                         E:\usb20\logger\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\logger\system\usb\usb9\usb9.c
                                            * Note:            None                                                         E:\usb20\logger\system\usb\usb9\usb9.c
                                            *****************************************************************************/  E:\usb20\logger\system\usb\usb9\usb9.c
                                           void USBStdSetCfgHandler(void)                                                   E:\usb20\logger\system\usb\usb9\usb9.c
                                           {                                                                                E:\usb20\logger\system\usb\usb9\usb9.c
001720   0101     MOVLB     0x1                ctrl_trf_session_owner = MUID_USB9;                                          E:\usb20\logger\system\usb\usb9\usb9.c
001722   0e01     MOVLW     0x1                                                                                             
001724   6ff6     MOVWF     0xf6,0x1                                                                                        
001726   0e0f     MOVLW     0xf                mDisableEP1to15();                          // See usbdrv.h                  E:\usb20\logger\system\usb\usb9\usb9.c
001728   6ee6     MOVWF     0xe6,0x0                                                                                        
00172a   0e71     MOVLW     0x71                                                                                            
00172c   6ee6     MOVWF     0xe6,0x0                                                                                        
00172e   0e0f     MOVLW     0xf                                                                                             
001730   6ee6     MOVWF     0xe6,0x0                                                                                        
001732   ec4a     CALL      0x1e94,0x0                                                                                      
001734   f00f                                                                                                               
001736   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001738   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00173a   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00173c   0e01     MOVLW     0x1                ClearArray((byte*)&usb_alt_intf,MAX_NUM_INT);                                E:\usb20\logger\system\usb\usb9\usb9.c
00173e   6ee6     MOVWF     0xe6,0x0                                                                                        
001740   0efd     MOVLW     0xfd                                                                                            
001742   6ee6     MOVWF     0xe6,0x0                                                                                        
001744   0e00     MOVLW     0x0                                                                                             
001746   6ee6     MOVWF     0xe6,0x0                                                                                        
001748   ec4a     CALL      0x1e94,0x0                                                                                      
00174a   f00f                                                                                                               
00174c   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00174e   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001750   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001752   c422     MOVFF     0x422,0xfc         usb_active_cfg = SetupPkt.bCfgValue;                                         E:\usb20\logger\system\usb\usb9\usb9.c
001754   f0fc                                                                                                               
001756   0104     MOVLB     0x4                if(SetupPkt.bCfgValue == 0)                                                  E:\usb20\logger\system\usb\usb9\usb9.c
001758   5122     MOVF      0x22,0x0,0x1                                                                                    
00175a   e104     BNZ       0x1764                                                                                          
00175c   0100     MOVLB     0x0                    usb_device_state = ADDRESS_STATE;                                        E:\usb20\logger\system\usb\usb9\usb9.c
00175e   0e05     MOVLW     0x5                                                                                             
001760   6ffa     MOVWF     0xfa,0x1                                                                                        
001762   d005     BRA       0x176e             else                                                                         E:\usb20\logger\system\usb\usb9\usb9.c
                                               {                                                                            E:\usb20\logger\system\usb\usb9\usb9.c
001764   0100     MOVLB     0x0                    usb_device_state = CONFIGURED_STATE;                                     E:\usb20\logger\system\usb\usb9\usb9.c
001766   0e06     MOVLW     0x6                                                                                             
001768   6ffa     MOVWF     0xfa,0x1                                                                                        
                                                                                                                            E:\usb20\logger\system\usb\usb9\usb9.c
                                                   /* Modifiable Section */                                                 E:\usb20\logger\system\usb\usb9\usb9.c
                                                                                                                            E:\usb20\logger\system\usb\usb9\usb9.c
                                                   #if defined(USB_USE_CDC)                // See autofiles\usbcfg.h        E:\usb20\logger\system\usb\usb9\usb9.c
00176a   ec78     CALL      0x12f0,0x0             CDCInitEP();                                                             E:\usb20\logger\system\usb\usb9\usb9.c
00176c   f009                                                                                                               
                                                   #endif                                                                   E:\usb20\logger\system\usb\usb9\usb9.c
                                                                                                                            E:\usb20\logger\system\usb\usb9\usb9.c
                                                   /* End modifiable section */                                             E:\usb20\logger\system\usb\usb9\usb9.c
                                                                                                                            E:\usb20\logger\system\usb\usb9\usb9.c
                                               }//end if(SetupPkt.bcfgValue == 0)                                           E:\usb20\logger\system\usb\usb9\usb9.c
00176e   0012     RETURN    0x0            }//end USBStdSetCfgHandler                                                       E:\usb20\logger\system\usb\usb9\usb9.c
                                                                                                                            E:\usb20\logger\system\usb\usb9\usb9.c
                                           /******************************************************************************  E:\usb20\logger\system\usb\usb9\usb9.c
                                            * Function:        void USBStdGetStatusHandler(void)                            E:\usb20\logger\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\logger\system\usb\usb9\usb9.c
                                            * PreCondition:    None                                                         E:\usb20\logger\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\logger\system\usb\usb9\usb9.c
                                            * Input:           None                                                         E:\usb20\logger\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\logger\system\usb\usb9\usb9.c
                                            * Output:          None                                                         E:\usb20\logger\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\logger\system\usb\usb9\usb9.c
                                            * Side Effects:    None                                                         E:\usb20\logger\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\logger\system\usb\usb9\usb9.c
                                            * Overview:        This routine handles the standard GET_STATUS request         E:\usb20\logger\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\logger\system\usb\usb9\usb9.c
                                            * Note:            None                                                         E:\usb20\logger\system\usb\usb9\usb9.c
                                            *****************************************************************************/  E:\usb20\logger\system\usb\usb9\usb9.c
                                           void USBStdGetStatusHandler(void)                                                E:\usb20\logger\system\usb\usb9\usb9.c
                                           {                                                                                E:\usb20\logger\system\usb\usb9\usb9.c
001770   0104     MOVLB     0x4                CtrlTrfData._byte0 = 0;                         // Initialize content        E:\usb20\logger\system\usb\usb9\usb9.c
001772   6b28     CLRF      0x28,0x1                                                                                        
001774   6b29     CLRF      0x29,0x1           CtrlTrfData._byte1 = 0;                                                      E:\usb20\logger\system\usb\usb9\usb9.c
                                                                                                                            E:\usb20\logger\system\usb\usb9\usb9.c
001776   0104     MOVLB     0x4                switch(SetupPkt.Recipient)                                                   E:\usb20\logger\system\usb\usb9\usb9.c
001778   5120     MOVF      0x20,0x0,0x1                                                                                    
00177a   0b1f     ANDLW     0x1f                                                                                            
00177c   0a02     XORLW     0x2                                                                                             
00177e   e014     BZ        0x17a8                                                                                          
001780   0a03     XORLW     0x3                                                                                             
001782   e00e     BZ        0x17a0                                                                                          
001784   0a01     XORLW     0x1                                                                                             
001786   e001     BZ        0x178a                                                                                          
001788   d033     BRA       0x17f0                                                                                          
                                               {                                                                            E:\usb20\logger\system\usb\usb9\usb9.c
                                                   case RCPT_DEV:                                                           E:\usb20\logger\system\usb\usb9\usb9.c
00178a   0101     MOVLB     0x1                        ctrl_trf_session_owner = MUID_USB9;                                  E:\usb20\logger\system\usb\usb9\usb9.c
00178c   0e01     MOVLW     0x1                                                                                             
00178e   6ff6     MOVWF     0xf6,0x1                                                                                        
                                                       /*                                                                   E:\usb20\logger\system\usb\usb9\usb9.c
                                                        * _byte0: bit0: Self-Powered Status [0] Bus-Powered [1] Self-Powered E:\usb20\logger\system\usb\usb9\usb9.c
                                                        *         bit1: RemoteWakeup        [0] Disabled    [1] Enabled     E:\usb20\logger\system\usb\usb9\usb9.c
                                                        */                                                                  E:\usb20\logger\system\usb\usb9\usb9.c
                                                       if(self_power == 1)                     // self_power defined in io_cfg.h E:\usb20\logger\system\usb\usb9\usb9.c
001790   0104     MOVLB     0x4                            CtrlTrfData._byte0|=0b000000001;    // Set bit0                  E:\usb20\logger\system\usb\usb9\usb9.c
001792   8128     BSF       0x28,0x0,0x1                                                                                    
                                                                                                                            E:\usb20\logger\system\usb\usb9\usb9.c
001794   0100     MOVLB     0x0                        if(usb_stat.RemoteWakeup == 1)          // usb_stat defined in usbmmap.c E:\usb20\logger\system\usb\usb9\usb9.c
001796   a1fb     BTFSS     0xfb,0x0,0x1                                                                                    
001798   d002     BRA       0x179e                                                                                          
00179a   0104     MOVLB     0x4                            CtrlTrfData._byte0|=0b00000010;     // Set bit1                  E:\usb20\logger\system\usb\usb9\usb9.c
00179c   8328     BSF       0x28,0x1,0x1                                                                                    
00179e   d028     BRA       0x17f0                     break;                                                               E:\usb20\logger\system\usb\usb9\usb9.c
                                                   case RCPT_INTF:                                                          E:\usb20\logger\system\usb\usb9\usb9.c
0017a0   0101     MOVLB     0x1                        ctrl_trf_session_owner = MUID_USB9;     // No data to update         E:\usb20\logger\system\usb\usb9\usb9.c
0017a2   0e01     MOVLW     0x1                                                                                             
0017a4   6ff6     MOVWF     0xf6,0x1                                                                                        
0017a6   d024     BRA       0x17f0                     break;                                                               E:\usb20\logger\system\usb\usb9\usb9.c
                                                   case RCPT_EP:                                                            E:\usb20\logger\system\usb\usb9\usb9.c
0017a8   0101     MOVLB     0x1                        ctrl_trf_session_owner = MUID_USB9;                                  E:\usb20\logger\system\usb\usb9\usb9.c
0017aa   0e01     MOVLW     0x1                                                                                             
0017ac   6ff6     MOVWF     0xf6,0x1                                                                                        
                                                       /*                                                                   E:\usb20\logger\system\usb\usb9\usb9.c
                                                        * _byte0: bit0: Halt Status [0] Not Halted [1] Halted               E:\usb20\logger\system\usb\usb9\usb9.c
                                                        */                                                                  E:\usb20\logger\system\usb\usb9\usb9.c
0017ae   0104     MOVLB     0x4                        pDst.bRam = (byte*)&ep0Bo+(SetupPkt.EPNum*8)+(SetupPkt.EPDir*4);     E:\usb20\logger\system\usb\usb9\usb9.c
0017b0   5124     MOVF      0x24,0x0,0x1                                                                                    
0017b2   0b0f     ANDLW     0xf                                                                                             
0017b4   0d08     MULLW     0x8                                                                                             
0017b6   50f3     MOVF      0xf3,0x0,0x0                                                                                    
0017b8   6a15     CLRF      0x15,0x0                                                                                        
0017ba   0f00     ADDLW     0x0                                                                                             
0017bc   6e14     MOVWF     0x14,0x0                                                                                        
0017be   0e04     MOVLW     0x4                                                                                             
0017c0   2215     ADDWFC    0x15,0x1,0x0                                                                                    
0017c2   5124     MOVF      0x24,0x0,0x1                                                                                    
0017c4   0b80     ANDLW     0x80                                                                                            
0017c6   e001     BZ        0x17ca                                                                                          
0017c8   0e01     MOVLW     0x1                                                                                             
0017ca   0d04     MULLW     0x4                                                                                             
0017cc   50f3     MOVF      0xf3,0x0,0x0                                                                                    
0017ce   0101     MOVLB     0x1                                                                                             
0017d0   2414     ADDWF     0x14,0x0,0x0                                                                                    
0017d2   6ff9     MOVWF     0xf9,0x1                                                                                        
0017d4   0e00     MOVLW     0x0                                                                                             
0017d6   2015     ADDWFC    0x15,0x0,0x0                                                                                    
0017d8   6ffa     MOVWF     0xfa,0x1                                                                                        
0017da   c1f9     MOVFF     0x1f9,0xfe9                if(*pDst.bRam & _BSTALL)    // Use _BSTALL as a bit mask             E:\usb20\logger\system\usb\usb9\usb9.c
0017dc   ffe9                                                                                                               
0017de   c1fa     MOVFF     0x1fa,0xfea                                                                                     
0017e0   ffea                                                                                                               
0017e2   50ef     MOVF      0xef,0x0,0x0                                                                                    
0017e4   0b04     ANDLW     0x4                                                                                             
0017e6   e003     BZ        0x17ee                                                                                          
0017e8   0104     MOVLB     0x4                            CtrlTrfData._byte0=0x01;// Set bit0                              E:\usb20\logger\system\usb\usb9\usb9.c
0017ea   0e01     MOVLW     0x1                                                                                             
0017ec   6f28     MOVWF     0x28,0x1                                                                                        
0017ee   d000     BRA       0x17f0                     break;                                                               E:\usb20\logger\system\usb\usb9\usb9.c
                                               }//end switch                                                                E:\usb20\logger\system\usb\usb9\usb9.c
                                                                                                                            E:\usb20\logger\system\usb\usb9\usb9.c
0017f0   0101     MOVLB     0x1                if(ctrl_trf_session_owner == MUID_USB9)                                      E:\usb20\logger\system\usb\usb9\usb9.c
0017f2   05f6     DECF      0xf6,0x0,0x1                                                                                    
0017f4   e10a     BNZ       0x180a                                                                                          
                                               {                                                                            E:\usb20\logger\system\usb\usb9\usb9.c
0017f6   0101     MOVLB     0x1                    pSrc.bRam = (byte*)&CtrlTrfData;            // Set Source                E:\usb20\logger\system\usb\usb9\usb9.c
0017f8   0e28     MOVLW     0x28                                                                                            
0017fa   6ff7     MOVWF     0xf7,0x1                                                                                        
0017fc   0e04     MOVLW     0x4                                                                                             
0017fe   6ff8     MOVWF     0xf8,0x1                                                                                        
001800   0100     MOVLB     0x0                    usb_stat.ctrl_trf_mem = _RAM;               // Set memory type           E:\usb20\logger\system\usb\usb9\usb9.c
001802   93fb     BCF       0xfb,0x1,0x1                                                                                    
001804   0101     MOVLB     0x1                    LSB(wCount) = 2;                            // Set data count            E:\usb20\logger\system\usb\usb9\usb9.c
001806   0e02     MOVLW     0x2                                                                                             
001808   6ffb     MOVWF     0xfb,0x1                                                                                        
                                               }//end if(...)                                                               E:\usb20\logger\system\usb\usb9\usb9.c
00180a   0012     RETURN    0x0            }//end USBStdGetStatusHandler                                                    E:\usb20\logger\system\usb\usb9\usb9.c
                                                                                                                            E:\usb20\logger\system\usb\usb9\usb9.c
                                           /******************************************************************************  E:\usb20\logger\system\usb\usb9\usb9.c
                                            * Function:        void USBStdFeatureReqHandler(void)                           E:\usb20\logger\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\logger\system\usb\usb9\usb9.c
                                            * PreCondition:    None                                                         E:\usb20\logger\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\logger\system\usb\usb9\usb9.c
                                            * Input:           None                                                         E:\usb20\logger\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\logger\system\usb\usb9\usb9.c
                                            * Output:          None                                                         E:\usb20\logger\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\logger\system\usb\usb9\usb9.c
                                            * Side Effects:    None                                                         E:\usb20\logger\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\logger\system\usb\usb9\usb9.c
                                            * Overview:        This routine handles the standard SET & CLEAR FEATURES       E:\usb20\logger\system\usb\usb9\usb9.c
                                            *                  requests                                                     E:\usb20\logger\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\logger\system\usb\usb9\usb9.c
                                            * Note:            None                                                         E:\usb20\logger\system\usb\usb9\usb9.c
                                            *****************************************************************************/  E:\usb20\logger\system\usb\usb9\usb9.c
                                           void USBStdFeatureReqHandler(void)                                               E:\usb20\logger\system\usb\usb9\usb9.c
                                           {                                                                                E:\usb20\logger\system\usb\usb9\usb9.c
00180c   0104     MOVLB     0x4                if((SetupPkt.bFeature == DEVICE_REMOTE_WAKEUP)&&                             E:\usb20\logger\system\usb\usb9\usb9.c
00180e   0522     DECF      0x22,0x0,0x1                                                                                    
001810   e110     BNZ       0x1832                (SetupPkt.Recipient == RCPT_DEV))                                         E:\usb20\logger\system\usb\usb9\usb9.c
001812   5120     MOVF      0x20,0x0,0x1                                                                                    
001814   0b1f     ANDLW     0x1f                                                                                            
001816   0900     IORLW     0x0                                                                                             
001818   e10c     BNZ       0x1832                                                                                          
                                               {                                                                            E:\usb20\logger\system\usb\usb9\usb9.c
00181a   0101     MOVLB     0x1                    ctrl_trf_session_owner = MUID_USB9;                                      E:\usb20\logger\system\usb\usb9\usb9.c
00181c   0e01     MOVLW     0x1                                                                                             
00181e   6ff6     MOVWF     0xf6,0x1                                                                                        
001820   0e03     MOVLW     0x3                    if(SetupPkt.bRequest == SET_FEATURE)                                     E:\usb20\logger\system\usb\usb9\usb9.c
001822   0104     MOVLB     0x4                                                                                             
001824   5d21     SUBWF     0x21,0x0,0x1                                                                                    
001826   e103     BNZ       0x182e                                                                                          
001828   0100     MOVLB     0x0                        usb_stat.RemoteWakeup = 1;                                           E:\usb20\logger\system\usb\usb9\usb9.c
00182a   81fb     BSF       0xfb,0x0,0x1                                                                                    
00182c   d002     BRA       0x1832                 else                                                                     E:\usb20\logger\system\usb\usb9\usb9.c
00182e   0100     MOVLB     0x0                        usb_stat.RemoteWakeup = 0;                                           E:\usb20\logger\system\usb\usb9\usb9.c
001830   91fb     BCF       0xfb,0x0,0x1                                                                                    
                                               }//end if                                                                    E:\usb20\logger\system\usb\usb9\usb9.c
                                                                                                                            E:\usb20\logger\system\usb\usb9\usb9.c
001832   0104     MOVLB     0x4                if((SetupPkt.bFeature == ENDPOINT_HALT)&&                                    E:\usb20\logger\system\usb\usb9\usb9.c
001834   5122     MOVF      0x22,0x0,0x1                                                                                    
001836   e13a     BNZ       0x18ac                (SetupPkt.Recipient == RCPT_EP)&&                                         E:\usb20\logger\system\usb\usb9\usb9.c
001838   5120     MOVF      0x20,0x0,0x1                                                                                    
00183a   0b1f     ANDLW     0x1f                                                                                            
00183c   0802     SUBLW     0x2                                                                                             
00183e   e136     BNZ       0x18ac                                                                                          
001840   5124     MOVF      0x24,0x0,0x1          (SetupPkt.EPNum != 0))                                                    E:\usb20\logger\system\usb\usb9\usb9.c
001842   0b0f     ANDLW     0xf                                                                                             
001844   0900     IORLW     0x0                                                                                             
001846   e032     BZ        0x18ac                                                                                          
                                               {                                                                            E:\usb20\logger\system\usb\usb9\usb9.c
001848   0101     MOVLB     0x1                    ctrl_trf_session_owner = MUID_USB9;                                      E:\usb20\logger\system\usb\usb9\usb9.c
00184a   0e01     MOVLW     0x1                                                                                             
00184c   6ff6     MOVWF     0xf6,0x1                                                                                        
                                                   /* Must do address calculation here */                                   E:\usb20\logger\system\usb\usb9\usb9.c
00184e   0104     MOVLB     0x4                    pDst.bRam = (byte*)&ep0Bo+(SetupPkt.EPNum*8)+(SetupPkt.EPDir*4);         E:\usb20\logger\system\usb\usb9\usb9.c
001850   5124     MOVF      0x24,0x0,0x1                                                                                    
001852   0b0f     ANDLW     0xf                                                                                             
001854   0d08     MULLW     0x8                                                                                             
001856   50f3     MOVF      0xf3,0x0,0x0                                                                                    
001858   6a15     CLRF      0x15,0x0                                                                                        
00185a   0f00     ADDLW     0x0                                                                                             
00185c   6e14     MOVWF     0x14,0x0                                                                                        
00185e   0e04     MOVLW     0x4                                                                                             
001860   2215     ADDWFC    0x15,0x1,0x0                                                                                    
001862   5124     MOVF      0x24,0x0,0x1                                                                                    
001864   0b80     ANDLW     0x80                                                                                            
001866   e001     BZ        0x186a                                                                                          
001868   0e01     MOVLW     0x1                                                                                             
00186a   0d04     MULLW     0x4                                                                                             
00186c   50f3     MOVF      0xf3,0x0,0x0                                                                                    
00186e   0101     MOVLB     0x1                                                                                             
001870   2414     ADDWF     0x14,0x0,0x0                                                                                    
001872   6ff9     MOVWF     0xf9,0x1                                                                                        
001874   0e00     MOVLW     0x0                                                                                             
001876   2015     ADDWFC    0x15,0x0,0x0                                                                                    
001878   6ffa     MOVWF     0xfa,0x1                                                                                        
                                                                                                                            E:\usb20\logger\system\usb\usb9\usb9.c
00187a   0e03     MOVLW     0x3                    if(SetupPkt.bRequest == SET_FEATURE)                                     E:\usb20\logger\system\usb\usb9\usb9.c
00187c   0104     MOVLB     0x4                                                                                             
00187e   5d21     SUBWF     0x21,0x0,0x1                                                                                    
001880   e107     BNZ       0x1890                                                                                          
001882   0e84     MOVLW     0x84                       *pDst.bRam = _USIE|_BSTALL;                                          E:\usb20\logger\system\usb\usb9\usb9.c
001884   c1f9     MOVFF     0x1f9,0xfe9                                                                                     
001886   ffe9                                                                                                               
001888   c1fa     MOVFF     0x1fa,0xfea                                                                                     
00188a   ffea                                                                                                               
00188c   6eef     MOVWF     0xef,0x0                                                                                        
00188e   d00e     BRA       0x18ac                 else                                                                     E:\usb20\logger\system\usb\usb9\usb9.c
                                                   {                                                                        E:\usb20\logger\system\usb\usb9\usb9.c
001890   af24     BTFSS     0x24,0x7,0x1               if(SetupPkt.EPDir == 1) // IN                                        E:\usb20\logger\system\usb\usb9\usb9.c
001892   d006     BRA       0x18a0                                                                                          
001894   c1f9     MOVFF     0x1f9,0xfe9                    *pDst.bRam = _UCPU;                                              E:\usb20\logger\system\usb\usb9\usb9.c
001896   ffe9                                                                                                               
001898   c1fa     MOVFF     0x1fa,0xfea                                                                                     
00189a   ffea                                                                                                               
00189c   6aef     CLRF      0xef,0x0                                                                                        
00189e   d006     BRA       0x18ac                     else                                                                 E:\usb20\logger\system\usb\usb9\usb9.c
0018a0   0e88     MOVLW     0x88                           *pDst.bRam = _USIE|_DAT0|_DTSEN;                                 E:\usb20\logger\system\usb\usb9\usb9.c
0018a2   c1f9     MOVFF     0x1f9,0xfe9                                                                                     
0018a4   ffe9                                                                                                               
0018a6   c1fa     MOVFF     0x1fa,0xfea                                                                                     
0018a8   ffea                                                                                                               
0018aa   6eef     MOVWF     0xef,0x0                                                                                        
                                                   }//end if                                                                E:\usb20\logger\system\usb\usb9\usb9.c
                                               }//end if                                                                    E:\usb20\logger\system\usb\usb9\usb9.c
0018ac   0012     RETURN    0x0            }//end USBStdFeatureReqHandler                                                   E:\usb20\logger\system\usb\usb9\usb9.c
                                                                                                                            E:\usb20\logger\system\usb\usb9\usb9.c
                                           /** EOF usb9.c ***************************************************************/  E:\usb20\logger\system\usb\usb9\usb9.c
                                           /*********************************************************************           E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            *             Microchip USB C18 Firmware -  CDC Version 1.0                     E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            *********************************************************************           E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            * FileName:        cdc.c                                                        E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            * Dependencies:    See INCLUDES section below                                   E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            * Processor:       PIC18                                                        E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            * Compiler:        C18 2.30.01+                                                 E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            * Company:         Microchip Technology, Inc.                                   E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            * Software License Agreement                                                    E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            * The software supplied herewith by Microchip Technology Incorporated           E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            * (the 鼎ompany) for its PICmicroｮ Microcontroller is intended and             E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            * supplied to you, the Company痴 customer, for use solely and                   E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            * exclusively on Microchip PICmicro Microcontroller products. The               E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            * software is owned by the Company and/or its supplier, and is                  E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            * protected under applicable copyright laws. All rights are reserved.           E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            * Any use in violation of the foregoing restrictions may subject the            E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            * user to criminal sanctions under applicable laws, as well as to               E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            * civil liability for the breach of the terms and conditions of this            E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            * license.                                                                      E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            * THIS SOFTWARE IS PROVIDED IN AN 鄭S IS CONDITION. NO WARRANTIES,             E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            * WHETHER EXPRESS, IMPLIED OR STATUTORY, INCLUDING, BUT NOT LIMITED             E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            * TO, IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A                   E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            * PARTICULAR PURPOSE APPLY TO THIS SOFTWARE. THE COMPANY SHALL NOT,             E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            * IN ANY CIRCUMSTANCES, BE LIABLE FOR SPECIAL, INCIDENTAL OR                    E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            * CONSEQUENTIAL DAMAGES, FOR ANY REASON WHATSOEVER.                             E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            * Author               Date        Comment                                      E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            *~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~           E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            * Rawin Rojvanit       11/19/04    Original. RS-232 Emulation Subset            E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            ********************************************************************/           E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                                                                                            E:\usb20\logger\system\usb\class\cdc\cdc.c
                                           /** I N C L U D E S **********************************************************/  E:\usb20\logger\system\usb\class\cdc\cdc.c
                                           #include <p18cxxx.h>                                                             E:\usb20\logger\system\usb\class\cdc\cdc.c
                                           #include "system\typedefs.h"                                                     E:\usb20\logger\system\usb\class\cdc\cdc.c
                                           #include "system\usb\usb.h"                                                      E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                                                                                            E:\usb20\logger\system\usb\class\cdc\cdc.c
                                           #ifdef USB_USE_CDC                                                               E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                                                                                            E:\usb20\logger\system\usb\class\cdc\cdc.c
                                           /** V A R I A B L E S ********************************************************/  E:\usb20\logger\system\usb\class\cdc\cdc.c
                                           #pragma udata                                                                    E:\usb20\logger\system\usb\class\cdc\cdc.c
                                           byte cdc_rx_len;            // total rx length                                   E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                                                                                            E:\usb20\logger\system\usb\class\cdc\cdc.c
                                           byte cdc_trf_state;         // States are defined cdc.h                          E:\usb20\logger\system\usb\class\cdc\cdc.c
                                           POINTER pCDCSrc;            // Dedicated source pointer                          E:\usb20\logger\system\usb\class\cdc\cdc.c
                                           POINTER pCDCDst;            // Dedicated destination pointer                     E:\usb20\logger\system\usb\class\cdc\cdc.c
                                           byte cdc_tx_len;            // total tx length                                   E:\usb20\logger\system\usb\class\cdc\cdc.c
                                           byte cdc_mem_type;          // _ROM, _RAM                                        E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                                                                                            E:\usb20\logger\system\usb\class\cdc\cdc.c
                                           LINE_CODING line_coding;    // Buffer to store line coding information           E:\usb20\logger\system\usb\class\cdc\cdc.c
                                           CONTROL_SIGNAL_BITMAP control_signal_bitmap;                                     E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                                                                                            E:\usb20\logger\system\usb\class\cdc\cdc.c
                                           /*                                                                               E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            * SEND_ENCAPSULATED_COMMAND and GET_ENCAPSULATED_RESPONSE are required          E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            * requests according to the CDC specification.                                  E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            * However, it is not really being used here, therefore a dummy buffer is        E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            * used for conformance.                                                         E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            */                                                                              E:\usb20\logger\system\usb\class\cdc\cdc.c
                                           #define dummy_length    0x08                                                     E:\usb20\logger\system\usb\class\cdc\cdc.c
                                           byte dummy_encapsulated_cmd_response[dummy_length];                              E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                                                                                            E:\usb20\logger\system\usb\class\cdc\cdc.c
                                           /** P R I V A T E  P R O T O T Y P E S ***************************************/  E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                                                                                            E:\usb20\logger\system\usb\class\cdc\cdc.c
                                           /** D E C L A R A T I O N S **************************************************/  E:\usb20\logger\system\usb\class\cdc\cdc.c
                                           #pragma code                                                                     E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                                                                                            E:\usb20\logger\system\usb\class\cdc\cdc.c
                                           /** C L A S S  S P E C I F I C  R E Q ****************************************/  E:\usb20\logger\system\usb\class\cdc\cdc.c
                                           /******************************************************************************  E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            * Function:        void USBCheckCDCRequest(void)                                E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            * PreCondition:    None                                                         E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            * Input:           None                                                         E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            * Output:          None                                                         E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            * Side Effects:    None                                                         E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            * Overview:        This routine checks the setup data packet to see if it       E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            *                  knows how to handle it                                       E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            * Note:            None                                                         E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            *****************************************************************************/  E:\usb20\logger\system\usb\class\cdc\cdc.c
                                           void USBCheckCDCRequest(void)                                                    E:\usb20\logger\system\usb\class\cdc\cdc.c
                                           {                                                                                E:\usb20\logger\system\usb\class\cdc\cdc.c
                                               /*                                                                           E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                * If request recipient is not an interface then return                      E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                */                                                                          E:\usb20\logger\system\usb\class\cdc\cdc.c
00122c   0104     MOVLB     0x4                if(SetupPkt.Recipient != RCPT_INTF) return;                                  E:\usb20\logger\system\usb\class\cdc\cdc.c
00122e   5120     MOVF      0x20,0x0,0x1                                                                                    
001230   0b1f     ANDLW     0x1f                                                                                            
001232   0801     SUBLW     0x1                                                                                             
001234   e001     BZ        0x1238                                                                                          
001236   d05b     BRA       0x12ee                                                                                          
                                                                                                                            E:\usb20\logger\system\usb\class\cdc\cdc.c
                                               /*                                                                           E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                * If request type is not class-specific then return                         E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                */                                                                          E:\usb20\logger\system\usb\class\cdc\cdc.c
001238   5120     MOVF      0x20,0x0,0x1       if(SetupPkt.RequestType != CLASS) return;                                    E:\usb20\logger\system\usb\class\cdc\cdc.c
00123a   0b60     ANDLW     0x60                                                                                            
00123c   42e8     RRNCF     0xe8,0x1,0x0                                                                                    
00123e   42e8     RRNCF     0xe8,0x1,0x0                                                                                    
001240   42e8     RRNCF     0xe8,0x1,0x0                                                                                    
001242   42e8     RRNCF     0xe8,0x1,0x0                                                                                    
001244   42e8     RRNCF     0xe8,0x1,0x0                                                                                    
001246   0801     SUBLW     0x1                                                                                             
001248   e001     BZ        0x124c                                                                                          
00124a   d051     BRA       0x12ee                                                                                          
                                                                                                                            E:\usb20\logger\system\usb\class\cdc\cdc.c
                                               /*                                                                           E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                * Interface ID must match interface numbers associated with                 E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                * CDC class, else return                                                    E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                */                                                                          E:\usb20\logger\system\usb\class\cdc\cdc.c
00124c   5124     MOVF      0x24,0x0,0x1       if((SetupPkt.bIntfID != CDC_COMM_INTF_ID)&&                                  E:\usb20\logger\system\usb\class\cdc\cdc.c
00124e   e003     BZ        0x1256                (SetupPkt.bIntfID != CDC_DATA_INTF_ID)) return;                           E:\usb20\logger\system\usb\class\cdc\cdc.c
001250   0524     DECF      0x24,0x0,0x1                                                                                    
001252   e001     BZ        0x1256                                                                                          
001254   d04c     BRA       0x12ee                                                                                          
                                                                                                                            E:\usb20\logger\system\usb\class\cdc\cdc.c
001256   5121     MOVF      0x21,0x0,0x1       switch(SetupPkt.bRequest)                                                    E:\usb20\logger\system\usb\class\cdc\cdc.c
001258   0a23     XORLW     0x23                                                                                            
00125a   e048     BZ        0x12ec                                                                                          
00125c   0a01     XORLW     0x1                                                                                             
00125e   e040     BZ        0x12e0                                                                                          
001260   0a03     XORLW     0x3                                                                                             
001262   e030     BZ        0x12c4                                                                                          
001264   0a01     XORLW     0x1                                                                                             
001266   e025     BZ        0x12b2                                                                                          
001268   0a24     XORLW     0x24                                                                                            
00126a   e022     BZ        0x12b0                                                                                          
00126c   0a07     XORLW     0x7                                                                                             
00126e   e01f     BZ        0x12ae                                                                                          
001270   0a01     XORLW     0x1                                                                                             
001272   e01c     BZ        0x12ac                                                                                          
001274   0a03     XORLW     0x3                                                                                             
001276   e011     BZ        0x129a                                                                                          
001278   0a01     XORLW     0x1                                                                                             
00127a   e001     BZ        0x127e                                                                                          
                                               {                                                                            E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                   case SEND_ENCAPSULATED_COMMAND:                                          E:\usb20\logger\system\usb\class\cdc\cdc.c
00127e   0101     MOVLB     0x1                        ctrl_trf_session_owner = MUID_CDC;                                   E:\usb20\logger\system\usb\class\cdc\cdc.c
001280   0e03     MOVLW     0x3                                                                                             
001282   6ff6     MOVWF     0xf6,0x1                                                                                        
001284   0101     MOVLB     0x1                        pSrc.bRam = (byte*)&dummy_encapsulated_cmd_response;                 E:\usb20\logger\system\usb\class\cdc\cdc.c
001286   0ee3     MOVLW     0xe3                                                                                            
001288   6ff7     MOVWF     0xf7,0x1                                                                                        
00128a   0e01     MOVLW     0x1                                                                                             
00128c   6ff8     MOVWF     0xf8,0x1                                                                                        
00128e   0100     MOVLB     0x0                        usb_stat.ctrl_trf_mem = _RAM;                                        E:\usb20\logger\system\usb\class\cdc\cdc.c
001290   93fb     BCF       0xfb,0x1,0x1                                                                                    
001292   0101     MOVLB     0x1                        LSB(wCount) = dummy_length;                                          E:\usb20\logger\system\usb\class\cdc\cdc.c
001294   0e08     MOVLW     0x8                                                                                             
001296   6ffb     MOVWF     0xfb,0x1                                                                                        
001298   d02a     BRA       0x12ee                     break;                                                               E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                   case GET_ENCAPSULATED_RESPONSE:                                          E:\usb20\logger\system\usb\class\cdc\cdc.c
00129a   0101     MOVLB     0x1                        ctrl_trf_session_owner = MUID_CDC;                                   E:\usb20\logger\system\usb\class\cdc\cdc.c
00129c   0e03     MOVLW     0x3                                                                                             
00129e   6ff6     MOVWF     0xf6,0x1                                                                                        
                                                       // Populate dummy_encapsulated_cmd_response first.                   E:\usb20\logger\system\usb\class\cdc\cdc.c
0012a0   0101     MOVLB     0x1                        pDst.bRam = (byte*)&dummy_encapsulated_cmd_response;                 E:\usb20\logger\system\usb\class\cdc\cdc.c
0012a2   0ee3     MOVLW     0xe3                                                                                            
0012a4   6ff9     MOVWF     0xf9,0x1                                                                                        
0012a6   0e01     MOVLW     0x1                                                                                             
0012a8   6ffa     MOVWF     0xfa,0x1                                                                                        
0012aa   d021     BRA       0x12ee                     break;                                                               E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                   case SET_COMM_FEATURE:                  // Optional                      E:\usb20\logger\system\usb\class\cdc\cdc.c
0012ac   d020     BRA       0x12ee                     break;                                                               E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                   case GET_COMM_FEATURE:                  // Optional                      E:\usb20\logger\system\usb\class\cdc\cdc.c
0012ae   d01f     BRA       0x12ee                     break;                                                               E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                   case CLEAR_COMM_FEATURE:                // Optional                      E:\usb20\logger\system\usb\class\cdc\cdc.c
0012b0   d01e     BRA       0x12ee                     break;                                                               E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                   case SET_LINE_CODING:                                                    E:\usb20\logger\system\usb\class\cdc\cdc.c
0012b2   0101     MOVLB     0x1                        ctrl_trf_session_owner = MUID_CDC;                                   E:\usb20\logger\system\usb\class\cdc\cdc.c
0012b4   0e03     MOVLW     0x3                                                                                             
0012b6   6ff6     MOVWF     0xf6,0x1                                                                                        
0012b8   0101     MOVLB     0x1                        pDst.bRam = (byte*)&line_coding;    // Set destination               E:\usb20\logger\system\usb\class\cdc\cdc.c
0012ba   0ed8     MOVLW     0xd8                                                                                            
0012bc   6ff9     MOVWF     0xf9,0x1                                                                                        
0012be   0e01     MOVLW     0x1                                                                                             
0012c0   6ffa     MOVWF     0xfa,0x1                                                                                        
0012c2   d015     BRA       0x12ee                     break;                                                               E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                   case GET_LINE_CODING:                                                    E:\usb20\logger\system\usb\class\cdc\cdc.c
0012c4   0101     MOVLB     0x1                        ctrl_trf_session_owner = MUID_CDC;                                   E:\usb20\logger\system\usb\class\cdc\cdc.c
0012c6   0e03     MOVLW     0x3                                                                                             
0012c8   6ff6     MOVWF     0xf6,0x1                                                                                        
0012ca   0101     MOVLB     0x1                        pSrc.bRam = (byte*)&line_coding;    // Set source                    E:\usb20\logger\system\usb\class\cdc\cdc.c
0012cc   0ed8     MOVLW     0xd8                                                                                            
0012ce   6ff7     MOVWF     0xf7,0x1                                                                                        
0012d0   0e01     MOVLW     0x1                                                                                             
0012d2   6ff8     MOVWF     0xf8,0x1                                                                                        
0012d4   0100     MOVLB     0x0                        usb_stat.ctrl_trf_mem = _RAM;       // Set memory type               E:\usb20\logger\system\usb\class\cdc\cdc.c
0012d6   93fb     BCF       0xfb,0x1,0x1                                                                                    
0012d8   0101     MOVLB     0x1                        LSB(wCount) = LINE_CODING_LENGTH;   // Set data count                E:\usb20\logger\system\usb\class\cdc\cdc.c
0012da   0e07     MOVLW     0x7                                                                                             
0012dc   6ffb     MOVWF     0xfb,0x1                                                                                        
0012de   d007     BRA       0x12ee                     break;                                                               E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                   case SET_CONTROL_LINE_STATE:                                             E:\usb20\logger\system\usb\class\cdc\cdc.c
0012e0   0101     MOVLB     0x1                        ctrl_trf_session_owner = MUID_CDC;                                   E:\usb20\logger\system\usb\class\cdc\cdc.c
0012e2   0e03     MOVLW     0x3                                                                                             
0012e4   6ff6     MOVWF     0xf6,0x1                                                                                        
0012e6   c422     MOVFF     0x422,0x1df                control_signal_bitmap._byte = LSB(SetupPkt.W_Value);                 E:\usb20\logger\system\usb\class\cdc\cdc.c
0012e8   f1df                                                                                                               
0012ea   d001     BRA       0x12ee                     break;                                                               E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                   case SEND_BREAK:                        // Optional                      E:\usb20\logger\system\usb\class\cdc\cdc.c
0012ec   d000     BRA       0x12ee                     break;                                                               E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                   default:                                                                 E:\usb20\logger\system\usb\class\cdc\cdc.c
00127c   d038     BRA       0x12ee                     break;                                                               E:\usb20\logger\system\usb\class\cdc\cdc.c
                                               }//end switch(SetupPkt.bRequest)                                             E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                                                                                            E:\usb20\logger\system\usb\class\cdc\cdc.c
0012ee   0012     RETURN    0x0            }//end USBCheckCDCRequest                                                        E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                                                                                            E:\usb20\logger\system\usb\class\cdc\cdc.c
                                           /** U S E R  A P I ***********************************************************/  E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                                                                                            E:\usb20\logger\system\usb\class\cdc\cdc.c
                                           /******************************************************************************  E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            * Function:        void CDCInitEP(void)                                         E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            * PreCondition:    None                                                         E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            * Input:           None                                                         E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            * Output:          None                                                         E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            * Side Effects:    None                                                         E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            * Overview:        CDCInitEP initializes CDC endpoints, buffer descriptors,     E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            *                  internal state-machine, and variables.                       E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            *                  It should be called after the USB host has sent out a        E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            *                  SET_CONFIGURATION request.                                   E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            *                  See USBStdSetCfgHandler() in usb9.c for examples.            E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            * Note:            None                                                         E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            *****************************************************************************/  E:\usb20\logger\system\usb\class\cdc\cdc.c
                                           void CDCInitEP(void)                                                             E:\usb20\logger\system\usb\class\cdc\cdc.c
                                           {                                                                                E:\usb20\logger\system\usb\class\cdc\cdc.c
                                               //Abstract line coding information                                           E:\usb20\logger\system\usb\class\cdc\cdc.c
0012f0   0101     MOVLB     0x1                line_coding.dwDTERate._dword = 115200;      // baud rate                     E:\usb20\logger\system\usb\class\cdc\cdc.c
0012f2   6bd8     CLRF      0xd8,0x1                                                                                        
0012f4   0ec2     MOVLW     0xc2                                                                                            
0012f6   6fd9     MOVWF     0xd9,0x1                                                                                        
0012f8   0e01     MOVLW     0x1                                                                                             
0012fa   6fda     MOVWF     0xda,0x1                                                                                        
0012fc   6bdb     CLRF      0xdb,0x1                                                                                        
0012fe   6bdc     CLRF      0xdc,0x1           line_coding.bCharFormat = 0x00;             // 1 stop bit                    E:\usb20\logger\system\usb\class\cdc\cdc.c
001300   6bdd     CLRF      0xdd,0x1           line_coding.bParityType = 0x00;             // None                          E:\usb20\logger\system\usb\class\cdc\cdc.c
001302   0e08     MOVLW     0x8                line_coding.bDataBits = 0x08;               // 5,6,7,8, or 16                E:\usb20\logger\system\usb\class\cdc\cdc.c
001304   6fde     MOVWF     0xde,0x1                                                                                        
                                                                                                                            E:\usb20\logger\system\usb\class\cdc\cdc.c
001306   6bd1     CLRF      0xd1,0x1           cdc_trf_state = CDC_TX_READY;                                                E:\usb20\logger\system\usb\class\cdc\cdc.c
001308   6bd0     CLRF      0xd0,0x1           cdc_rx_len = 0;                                                              E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                                                                                            E:\usb20\logger\system\usb\class\cdc\cdc.c
00130a   0e1a     MOVLW     0x1a               CDC_COMM_UEP = EP_IN|HSHK_EN;               // Enable 1 Comm pipe            E:\usb20\logger\system\usb\class\cdc\cdc.c
00130c   6e72     MOVWF     0x72,0x0                                                                                        
00130e   0e1e     MOVLW     0x1e               CDC_DATA_UEP = EP_OUT_IN|HSHK_EN;           // Enable 2 data pipes           E:\usb20\logger\system\usb\class\cdc\cdc.c
001310   6e73     MOVWF     0x73,0x0                                                                                        
                                                                                                                            E:\usb20\logger\system\usb\class\cdc\cdc.c
                                               /*                                                                           E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                * Do not have to init Cnt of IN pipes here.                                 E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                * Reason:  Number of bytes to send to the host                              E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                *          varies from one transaction to                                   E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                *          another. Cnt should equal the exact                              E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                *          number of bytes to transmit for                                  E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                *          a given IN transaction.                                          E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                *          This number of bytes will only                                   E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                *          be known right before the data is                                E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                *          sent.                                                            E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                */                                                                          E:\usb20\logger\system\usb\class\cdc\cdc.c
001312   0104     MOVLB     0x4                CDC_INT_BD_IN.ADR = (byte*)&cdc_notice;     // Set buffer address            E:\usb20\logger\system\usb\class\cdc\cdc.c
001314   0e00     MOVLW     0x0                                                                                             
001316   6f16     MOVWF     0x16,0x1                                                                                        
001318   0e05     MOVLW     0x5                                                                                             
00131a   6f17     MOVWF     0x17,0x1                                                                                        
00131c   0e40     MOVLW     0x40               CDC_INT_BD_IN.Stat._byte = _UCPU|_DAT1;     // Set status                    E:\usb20\logger\system\usb\class\cdc\cdc.c
00131e   6f14     MOVWF     0x14,0x1                                                                                        
                                                                                                                            E:\usb20\logger\system\usb\class\cdc\cdc.c
001320   0104     MOVLB     0x4                CDC_BULK_BD_OUT.Cnt = sizeof(cdc_data_rx);  // Set buffer size               E:\usb20\logger\system\usb\class\cdc\cdc.c
001322   6f19     MOVWF     0x19,0x1                                                                                        
001324   0e08     MOVLW     0x8                CDC_BULK_BD_OUT.ADR = (byte*)&cdc_data_rx;  // Set buffer address            E:\usb20\logger\system\usb\class\cdc\cdc.c
001326   6f1a     MOVWF     0x1a,0x1                                                                                        
001328   0e05     MOVLW     0x5                                                                                             
00132a   6f1b     MOVWF     0x1b,0x1                                                                                        
00132c   0e88     MOVLW     0x88               CDC_BULK_BD_OUT.Stat._byte = _USIE|_DAT0|_DTSEN;// Set status                E:\usb20\logger\system\usb\class\cdc\cdc.c
00132e   6f18     MOVWF     0x18,0x1                                                                                        
                                                                                                                            E:\usb20\logger\system\usb\class\cdc\cdc.c
001330   0104     MOVLB     0x4                CDC_BULK_BD_IN.ADR = (byte*)&cdc_data_tx;   // Set buffer size               E:\usb20\logger\system\usb\class\cdc\cdc.c
001332   0e48     MOVLW     0x48                                                                                            
001334   6f1e     MOVWF     0x1e,0x1                                                                                        
001336   0e05     MOVLW     0x5                                                                                             
001338   6f1f     MOVWF     0x1f,0x1                                                                                        
00133a   0e40     MOVLW     0x40               CDC_BULK_BD_IN.Stat._byte = _UCPU|_DAT1;    // Set buffer address            E:\usb20\logger\system\usb\class\cdc\cdc.c
00133c   6f1c     MOVWF     0x1c,0x1                                                                                        
                                                                                                                            E:\usb20\logger\system\usb\class\cdc\cdc.c
00133e   0012     RETURN    0x0            }//end CDCInitEP                                                                 E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                                                                                            E:\usb20\logger\system\usb\class\cdc\cdc.c
                                           /******************************************************************************  E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            * Function:        byte getsUSBUSART(char *buffer,                              E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            *                                    byte len)                                  E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            * PreCondition:    Value of input argument 'len' should be smaller than the     E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            *                  maximum endpoint size responsible for receiving bulk         E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            *                  data from USB host for CDC class.                            E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            *                  Input argument 'buffer' should point to a buffer area that   E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            *                  is bigger or equal to the size specified by 'len'.           E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            * Input:           buffer  : Pointer to where received bytes are to be stored   E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            *                  len     : The number of bytes expected.                      E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            * Output:          The number of bytes copied to buffer.                        E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            * Side Effects:    Publicly accessible variable cdc_rx_len is updated with      E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            *                  the number of bytes copied to buffer.                        E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            *                  Once getsUSBUSART is called, subsequent retrieval of         E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            *                  cdc_rx_len can be done by calling macro mCDCGetRxLength().   E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            * Overview:        getsUSBUSART copies a string of bytes received through       E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            *                  USB CDC Bulk OUT endpoint to a user's specified location.    E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            *                  It is a non-blocking function. It does not wait              E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            *                  for data if there is no data available. Instead it returns   E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            *                  '0' to notify the caller that there is no data available.    E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            * Note:            If the actual number of bytes received is larger than the    E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            *                  number of bytes expected (len), only the expected number     E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            *                  of bytes specified will be copied to buffer.                 E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            *                  If the actual number of bytes received is smaller than the   E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            *                  number of bytes expected (len), only the actual number       E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            *                  of bytes received will be copied to buffer.                  E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            *****************************************************************************/  E:\usb20\logger\system\usb\class\cdc\cdc.c
001340   cfd9     MOVFF     0xfd9,0xfe6    byte getsUSBUSART(char *buffer, byte len)                                        E:\usb20\logger\system\usb\class\cdc\cdc.c
001342   ffe6                                                                                                               
001344   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
001346   ffd9                                                                                                               
                                           {                                                                                E:\usb20\logger\system\usb\class\cdc\cdc.c
001348   0101     MOVLB     0x1                cdc_rx_len = 0;                                                              E:\usb20\logger\system\usb\class\cdc\cdc.c
00134a   6bd0     CLRF      0xd0,0x1                                                                                        
                                                                                                                            E:\usb20\logger\system\usb\class\cdc\cdc.c
00134c   0104     MOVLB     0x4                if(!mCDCUsartRxIsBusy())                                                     E:\usb20\logger\system\usb\class\cdc\cdc.c
00134e   bf18     BTFSC     0x18,0x7,0x1                                                                                    
001350   d030     BRA       0x13b2                                                                                          
                                               {                                                                            E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                   /*                                                                       E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                    * Adjust the expected number of bytes to equal                          E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                    * the actual number of bytes received.                                  E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                    */                                                                      E:\usb20\logger\system\usb\class\cdc\cdc.c
001352   0efc     MOVLW     0xfc                   if(len > CDC_BULK_BD_OUT.Cnt)                                            E:\usb20\logger\system\usb\class\cdc\cdc.c
001354   cfdb     MOVFF     0xfdb,0x14                                                                                      
001356   f014                                                                                                               
001358   5119     MOVF      0x19,0x0,0x1                                                                                    
00135a   80d8     BSF       0xd8,0x0,0x0                                                                                    
00135c   5414     SUBFWB    0x14,0x0,0x0                                                                                    
00135e   e203     BC        0x1366                                                                                          
001360   0efc     MOVLW     0xfc                       len = CDC_BULK_BD_OUT.Cnt;                                           E:\usb20\logger\system\usb\class\cdc\cdc.c
001362   c419     MOVFF     0x419,0xfdb                                                                                     
001364   ffdb                                                                                                               
                                                                                                                            E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                   /*                                                                       E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                    * Copy data from dual-ram buffer to user's buffer                       E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                    */                                                                      E:\usb20\logger\system\usb\class\cdc\cdc.c
001366   0101     MOVLB     0x1                    for(cdc_rx_len = 0; cdc_rx_len < len; cdc_rx_len++)                      E:\usb20\logger\system\usb\class\cdc\cdc.c
001368   6bd0     CLRF      0xd0,0x1                                                                                        
00136a   0efc     MOVLW     0xfc                                                                                            
00136c   50db     MOVF      0xdb,0x0,0x0                                                                                    
00136e   5dd0     SUBWF     0xd0,0x0,0x1                                                                                    
001370   e219     BC        0x13a4                                                                                          
0013a0   2bd0     INCF      0xd0,0x1,0x1                                                                                    
0013a2   d7e3     BRA       0x136a                                                                                          
001372   51d0     MOVF      0xd0,0x0,0x1               buffer[cdc_rx_len] = cdc_data_rx[cdc_rx_len];                        E:\usb20\logger\system\usb\class\cdc\cdc.c
001374   6aea     CLRF      0xea,0x0                                                                                        
001376   0f08     ADDLW     0x8                                                                                             
001378   6ee9     MOVWF     0xe9,0x0                                                                                        
00137a   0e05     MOVLW     0x5                                                                                             
00137c   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
00137e   50ef     MOVF      0xef,0x0,0x0                                                                                    
001380   6ee6     MOVWF     0xe6,0x0                                                                                        
001382   51d0     MOVF      0xd0,0x0,0x1                                                                                    
001384   6ee7     MOVWF     0xe7,0x0                                                                                        
001386   0efd     MOVLW     0xfd                                                                                            
001388   cfdb     MOVFF     0xfdb,0xfe9                                                                                     
00138a   ffe9                                                                                                               
00138c   0efe     MOVLW     0xfe                                                                                            
00138e   cfdb     MOVFF     0xfdb,0xfea                                                                                     
001390   ffea                                                                                                               
001392   50e7     MOVF      0xe7,0x0,0x0                                                                                    
001394   26e9     ADDWF     0xe9,0x1,0x0                                                                                    
001396   0e00     MOVLW     0x0                                                                                             
001398   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
00139a   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00139c   50e7     MOVF      0xe7,0x0,0x0                                                                                    
00139e   6eef     MOVWF     0xef,0x0                                                                                        
                                                                                                                            E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                   /*                                                                       E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                    * Prepare dual-ram buffer for next OUT transaction                      E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                    */                                                                      E:\usb20\logger\system\usb\class\cdc\cdc.c
0013a4   0104     MOVLB     0x4                    CDC_BULK_BD_OUT.Cnt = sizeof(cdc_data_rx);                               E:\usb20\logger\system\usb\class\cdc\cdc.c
0013a6   0e40     MOVLW     0x40                                                                                            
0013a8   6f19     MOVWF     0x19,0x1                                                                                        
0013aa   1718     ANDWF     0x18,0x1,0x1           mUSBBufferReady(CDC_BULK_BD_OUT);                                        E:\usb20\logger\system\usb\class\cdc\cdc.c
0013ac   7d18     BTG       0x18,0x6,0x1                                                                                    
0013ae   0e88     MOVLW     0x88                                                                                            
0013b0   1318     IORWF     0x18,0x1,0x1                                                                                    
                                               }//end if                                                                    E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                                                                                            E:\usb20\logger\system\usb\class\cdc\cdc.c
0013b2   0101     MOVLB     0x1                return cdc_rx_len;                                                           E:\usb20\logger\system\usb\class\cdc\cdc.c
0013b4   51d0     MOVF      0xd0,0x0,0x1                                                                                    
0013b6   d000     BRA       0x13b8                                                                                          
                                                                                                                            E:\usb20\logger\system\usb\class\cdc\cdc.c
0013b8   52e5     MOVF      0xe5,0x1,0x0   }//end getsUSBUSART                                                              E:\usb20\logger\system\usb\class\cdc\cdc.c
0013ba   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
0013bc   ffd9                                                                                                               
0013be   0012     RETURN    0x0                                                                                             
                                                                                                                            E:\usb20\logger\system\usb\class\cdc\cdc.c
                                           /******************************************************************************  E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            * Function:        void putsUSBUSART(char *data)                                E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            * PreCondition:    cdc_trf_state must be in the CDC_TX_READY state.             E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            *                  The string of characters pointed to by 'data' must equal     E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            *                  to or smaller than 255 bytes.                                E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            * Input:           data    : Pointer to a null-terminated string of data.       E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            *                            If a null character is not found, 255 bytes        E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            *                            of data will be transferred to the host.           E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            * Output:          None                                                         E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            * Side Effects:    None                                                         E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            * Overview:        putsUSBUSART writes a string of data to the USB including    E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            *                  the null character. Use this version, 'puts', to transfer    E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            *                  data located in data memory.                                 E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            * Note:            The transfer mechanism for device-to-host(put) is more       E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            *                  flexible than host-to-device(get). It can handle             E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            *                  a string of data larger than the maximum size of bulk IN     E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            *                  endpoint. A state machine is used to transfer a long         E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            *                  string of data over multiple USB transactions.               E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            *                  See CDCTxService() for more details.                         E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            *****************************************************************************/  E:\usb20\logger\system\usb\class\cdc\cdc.c
0013c0   cfd9     MOVFF     0xfd9,0xfe6    void putsUSBUSART(char *data)                                                    E:\usb20\logger\system\usb\class\cdc\cdc.c
0013c2   ffe6                                                                                                               
0013c4   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
0013c6   ffd9                                                                                                               
0013c8   52e6     MOVF      0xe6,0x1,0x0                                                                                    
                                           {                                                                                E:\usb20\logger\system\usb\class\cdc\cdc.c
                                               byte len;                                                                    E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                                                                                            E:\usb20\logger\system\usb\class\cdc\cdc.c
                                               /*                                                                           E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                * User should have checked that cdc_trf_state is in CDC_TX_READY state      E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                * before calling this function.                                             E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                * As a safety precaution, this fuction checks the state one more time       E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                * to make sure it does not override any pending transactions.               E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                *                                                                           E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                * Currently it just quits the routine without reporting any errors back     E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                * to the user.                                                              E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                *                                                                           E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                * Bottomline: User MUST make sure that mUSBUSARTIsTxTrfReady()==1           E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                *             before calling this function!                                 E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                * Example:                                                                  E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                * if(mUSBUSARTIsTxTrfReady())                                               E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                *     putsUSBUSART(pData);                                                  E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                *                                                                           E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                * IMPORTANT: Never use the following blocking while loop to wait:           E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                * while(!mUSBUSARTIsTxTrfReady())                                           E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                *     putsUSBUSART(pData);                                                  E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                *                                                                           E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                * The whole firmware framework is written based on cooperative              E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                * multi-tasking and a blocking code is not acceptable.                      E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                * Use a state machine instead.                                              E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                */                                                                          E:\usb20\logger\system\usb\class\cdc\cdc.c
0013ca   0101     MOVLB     0x1                if(cdc_trf_state != CDC_TX_READY) return;                                    E:\usb20\logger\system\usb\class\cdc\cdc.c
0013cc   51d1     MOVF      0xd1,0x0,0x1                                                                                    
0013ce   e001     BZ        0x13d2                                                                                          
0013d0   d02f     BRA       0x1430                                                                                          
                                                                                                                            E:\usb20\logger\system\usb\class\cdc\cdc.c
                                               /*                                                                           E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                * While loop counts the number of bytes to send including the               E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                * null character.                                                           E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                */                                                                          E:\usb20\logger\system\usb\class\cdc\cdc.c
0013d2   6adf     CLRF      0xdf,0x0           len = 0;                                                                     E:\usb20\logger\system\usb\class\cdc\cdc.c
                                               do                                                                           E:\usb20\logger\system\usb\class\cdc\cdc.c
                                               {                                                                            E:\usb20\logger\system\usb\class\cdc\cdc.c
0013d4   2adf     INCF      0xdf,0x1,0x0           len++;                                                                   E:\usb20\logger\system\usb\class\cdc\cdc.c
0013d6   50df     MOVF      0xdf,0x0,0x0           if(len == 255) break;       // Break loop once max len is reached.       E:\usb20\logger\system\usb\class\cdc\cdc.c
0013d8   6e14     MOVWF     0x14,0x0                                                                                        
0013da   6a15     CLRF      0x15,0x0                                                                                        
0013dc   0eff     MOVLW     0xff                                                                                            
0013de   1814     XORWF     0x14,0x0,0x0                                                                                    
0013e0   e101     BNZ       0x13e4                                                                                          
0013e2   5015     MOVF      0x15,0x0,0x0                                                                                    
0013e4   e101     BNZ       0x13e8                                                                                          
0013e6   d00b     BRA       0x13fe                                                                                          
0013e8   0efd     MOVLW     0xfd               }while(*data++);                                                             E:\usb20\logger\system\usb\class\cdc\cdc.c
0013ea   cfdb     MOVFF     0xfdb,0xfe9                                                                                     
0013ec   ffe9                                                                                                               
0013ee   2adb     INCF      0xdb,0x1,0x0                                                                                    
0013f0   0efe     MOVLW     0xfe                                                                                            
0013f2   cfdb     MOVFF     0xfdb,0xfea                                                                                     
0013f4   ffea                                                                                                               
0013f6   e301     BNC       0x13fa                                                                                          
0013f8   2adb     INCF      0xdb,0x1,0x0                                                                                    
0013fa   50ef     MOVF      0xef,0x0,0x0                                                                                    
0013fc   e1eb     BNZ       0x13d4                                                                                          
                                                                                                                            E:\usb20\logger\system\usb\class\cdc\cdc.c
                                               /*                                                                           E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                * Re-adjust pointer to its initial location                                 E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                */                                                                          E:\usb20\logger\system\usb\class\cdc\cdc.c
0013fe   50df     MOVF      0xdf,0x0,0x0       data-=len;                                                                   E:\usb20\logger\system\usb\class\cdc\cdc.c
001400   6e14     MOVWF     0x14,0x0                                                                                        
001402   6a15     CLRF      0x15,0x0                                                                                        
001404   50d9     MOVF      0xd9,0x0,0x0                                                                                    
001406   0ffd     ADDLW     0xfd                                                                                            
001408   6ee9     MOVWF     0xe9,0x0                                                                                        
00140a   0eff     MOVLW     0xff                                                                                            
00140c   20da     ADDWFC    0xda,0x0,0x0                                                                                    
00140e   6eea     MOVWF     0xea,0x0                                                                                        
001410   5014     MOVF      0x14,0x0,0x0                                                                                    
001412   5eee     SUBWF     0xee,0x1,0x0                                                                                    
001414   5015     MOVF      0x15,0x0,0x0                                                                                    
001416   5aed     SUBWFB    0xed,0x1,0x0                                                                                    
                                                                                                                            E:\usb20\logger\system\usb\class\cdc\cdc.c
                                               /*                                                                           E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                * Second piece of information (length of data to send) is ready.            E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                * Call mUSBUSARTTxRam to setup the transfer.                                E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                * The actual transfer process will be handled by CDCTxService(),            E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                * which should be called once per Main Program loop.                        E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                */                                                                          E:\usb20\logger\system\usb\class\cdc\cdc.c
001418   0efd     MOVLW     0xfd               mUSBUSARTTxRam((byte*)data,len);     // See cdc.h                            E:\usb20\logger\system\usb\class\cdc\cdc.c
00141a   cfdb     MOVFF     0xfdb,0x1d2                                                                                     
00141c   f1d2                                                                                                               
00141e   0efe     MOVLW     0xfe                                                                                            
001420   cfdb     MOVFF     0xfdb,0x1d3                                                                                     
001422   f1d3                                                                                                               
001424   cfdf     MOVFF     0xfdf,0x1d6                                                                                     
001426   f1d6                                                                                                               
001428   0101     MOVLB     0x1                                                                                             
00142a   6bd7     CLRF      0xd7,0x1                                                                                        
00142c   0e01     MOVLW     0x1                                                                                             
00142e   6fd1     MOVWF     0xd1,0x1                                                                                        
001430   52e5     MOVF      0xe5,0x1,0x0   }//end putsUSBUSART                                                              E:\usb20\logger\system\usb\class\cdc\cdc.c
001432   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001434   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
001436   ffd9                                                                                                               
001438   0012     RETURN    0x0                                                                                             
                                                                                                                            E:\usb20\logger\system\usb\class\cdc\cdc.c
                                           /******************************************************************************  E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            * Function:        void putrsUSBUSART(const rom char *data)                     E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            * PreCondition:    cdc_trf_state must be in the CDC_TX_READY state.             E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            *                  The string of characters pointed to by 'data' must equal     E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            *                  to or smaller than 255 bytes.                                E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            * Input:           data    : Pointer to a null-terminated string of data.       E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            *                            If a null character is not found, 255 bytes        E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            *                            of data will be transferred to the host.           E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            * Output:          None                                                         E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            * Side Effects:    None                                                         E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            * Overview:        putrsUSBUSART writes a string of data to the USB including   E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            *                  the null character. Use this version, 'putrs', to transfer   E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            *                  data literals and data located in program memory.            E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            * Note:            The transfer mechanism for device-to-host(put) is more       E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            *                  flexible than host-to-device(get). It can handle             E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            *                  a string of data larger than the maximum size of bulk IN     E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            *                  endpoint. A state machine is used to transfer a long         E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            *                  string of data over multiple USB transactions.               E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            *                  See CDCTxService() for more details.                         E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            *****************************************************************************/  E:\usb20\logger\system\usb\class\cdc\cdc.c
00143a   cfd9     MOVFF     0xfd9,0xfe6    void putrsUSBUSART(const rom char *data)                                         E:\usb20\logger\system\usb\class\cdc\cdc.c
00143c   ffe6                                                                                                               
00143e   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
001440   ffd9                                                                                                               
001442   52e6     MOVF      0xe6,0x1,0x0                                                                                    
                                           {                                                                                E:\usb20\logger\system\usb\class\cdc\cdc.c
                                               byte len;                                                                    E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                                                                                            E:\usb20\logger\system\usb\class\cdc\cdc.c
                                               /*                                                                           E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                * User should have checked that cdc_trf_state is in CDC_TX_READY state      E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                * before calling this function.                                             E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                * As a safety precaution, this fuction checks the state one more time       E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                * to make sure it does not override any pending transactions.               E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                *                                                                           E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                * Currently it just quits the routine without reporting any errors back     E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                * to the user.                                                              E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                *                                                                           E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                * Bottomline: User MUST make sure that mUSBUSARTIsTxTrfReady()              E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                *             before calling this function!                                 E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                * Example:                                                                  E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                * if(mUSBUSARTIsTxTrfReady())                                               E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                *     putsUSBUSART(pData);                                                  E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                *                                                                           E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                * IMPORTANT: Never use the following blocking while loop to wait:           E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                * while(cdc_trf_state != CDC_TX_READY)                                      E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                *     putsUSBUSART(pData);                                                  E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                *                                                                           E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                * The whole firmware framework is written based on cooperative              E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                * multi-tasking and a blocking code is not acceptable.                      E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                * Use a state machine instead.                                              E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                */                                                                          E:\usb20\logger\system\usb\class\cdc\cdc.c
001444   0101     MOVLB     0x1                if(cdc_trf_state != CDC_TX_READY) return;                                    E:\usb20\logger\system\usb\class\cdc\cdc.c
001446   51d1     MOVF      0xd1,0x0,0x1                                                                                    
001448   e001     BZ        0x144c                                                                                          
00144a   d030     BRA       0x14ac                                                                                          
                                                                                                                            E:\usb20\logger\system\usb\class\cdc\cdc.c
                                               /*                                                                           E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                * While loop counts the number of bytes to send including the               E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                * null character.                                                           E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                */                                                                          E:\usb20\logger\system\usb\class\cdc\cdc.c
00144c   6adf     CLRF      0xdf,0x0           len = 0;                                                                     E:\usb20\logger\system\usb\class\cdc\cdc.c
                                               do                                                                           E:\usb20\logger\system\usb\class\cdc\cdc.c
                                               {                                                                            E:\usb20\logger\system\usb\class\cdc\cdc.c
00144e   2adf     INCF      0xdf,0x1,0x0           len++;                                                                   E:\usb20\logger\system\usb\class\cdc\cdc.c
001450   50df     MOVF      0xdf,0x0,0x0           if(len == 255) break;       // Break loop once max len is reached.       E:\usb20\logger\system\usb\class\cdc\cdc.c
001452   6e14     MOVWF     0x14,0x0                                                                                        
001454   6a15     CLRF      0x15,0x0                                                                                        
001456   0eff     MOVLW     0xff                                                                                            
001458   1814     XORWF     0x14,0x0,0x0                                                                                    
00145a   e101     BNZ       0x145e                                                                                          
00145c   5015     MOVF      0x15,0x0,0x0                                                                                    
00145e   e101     BNZ       0x1462                                                                                          
001460   d00c     BRA       0x147a                                                                                          
001462   0efd     MOVLW     0xfd               }while(*data++);                                                             E:\usb20\logger\system\usb\class\cdc\cdc.c
001464   cfdb     MOVFF     0xfdb,0xff6                                                                                     
001466   fff6                                                                                                               
001468   2adb     INCF      0xdb,0x1,0x0                                                                                    
00146a   0efe     MOVLW     0xfe                                                                                            
00146c   cfdb     MOVFF     0xfdb,0xff7                                                                                     
00146e   fff7                                                                                                               
001470   e301     BNC       0x1474                                                                                          
001472   2adb     INCF      0xdb,0x1,0x0                                                                                    
001474   0008     TBLRD                                                                                                     
001476   50f5     MOVF      0xf5,0x0,0x0                                                                                    
001478   e1ea     BNZ       0x144e                                                                                          
                                                                                                                            E:\usb20\logger\system\usb\class\cdc\cdc.c
                                               /*                                                                           E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                * Re-adjust pointer to its initial location                                 E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                */                                                                          E:\usb20\logger\system\usb\class\cdc\cdc.c
00147a   50df     MOVF      0xdf,0x0,0x0       data-=len;                                                                   E:\usb20\logger\system\usb\class\cdc\cdc.c
00147c   6e14     MOVWF     0x14,0x0                                                                                        
00147e   6a15     CLRF      0x15,0x0                                                                                        
001480   50d9     MOVF      0xd9,0x0,0x0                                                                                    
001482   0ffd     ADDLW     0xfd                                                                                            
001484   6ee9     MOVWF     0xe9,0x0                                                                                        
001486   0eff     MOVLW     0xff                                                                                            
001488   20da     ADDWFC    0xda,0x0,0x0                                                                                    
00148a   6eea     MOVWF     0xea,0x0                                                                                        
00148c   5014     MOVF      0x14,0x0,0x0                                                                                    
00148e   5eee     SUBWF     0xee,0x1,0x0                                                                                    
001490   5015     MOVF      0x15,0x0,0x0                                                                                    
001492   5aed     SUBWFB    0xed,0x1,0x0                                                                                    
                                                                                                                            E:\usb20\logger\system\usb\class\cdc\cdc.c
                                               /*                                                                           E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                * Second piece of information (length of data to send) is ready.            E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                * Call mUSBUSARTTxRom to setup the transfer.                                E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                * The actual transfer process will be handled by CDCTxService(),            E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                * which should be called once per Main Program loop.                        E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                */                                                                          E:\usb20\logger\system\usb\class\cdc\cdc.c
001494   0efd     MOVLW     0xfd               mUSBUSARTTxRom((rom byte*)data,len); // See cdc.h                            E:\usb20\logger\system\usb\class\cdc\cdc.c
001496   cfdb     MOVFF     0xfdb,0x1d2                                                                                     
001498   f1d2                                                                                                               
00149a   0efe     MOVLW     0xfe                                                                                            
00149c   cfdb     MOVFF     0xfdb,0x1d3                                                                                     
00149e   f1d3                                                                                                               
0014a0   cfdf     MOVFF     0xfdf,0x1d6                                                                                     
0014a2   f1d6                                                                                                               
0014a4   0101     MOVLB     0x1                                                                                             
0014a6   0e01     MOVLW     0x1                                                                                             
0014a8   6fd7     MOVWF     0xd7,0x1                                                                                        
0014aa   6fd1     MOVWF     0xd1,0x1                                                                                        
                                                                                                                            E:\usb20\logger\system\usb\class\cdc\cdc.c
0014ac   52e5     MOVF      0xe5,0x1,0x0   }//end putrsUSBUSART                                                             E:\usb20\logger\system\usb\class\cdc\cdc.c
0014ae   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0014b0   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
0014b2   ffd9                                                                                                               
0014b4   0012     RETURN    0x0                                                                                             
                                                                                                                            E:\usb20\logger\system\usb\class\cdc\cdc.c
                                           /******************************************************************************  E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            * Function:        void CDCTxService(void)                                      E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            * PreCondition:    None                                                         E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            * Input:           None                                                         E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            * Output:          None                                                         E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            * Side Effects:    None                                                         E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            * Overview:        CDCTxService handles device-to-host transaction(s).          E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            *                  This function should be called once per Main Program loop.   E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            * Note:            None                                                         E:\usb20\logger\system\usb\class\cdc\cdc.c
                                            *****************************************************************************/  E:\usb20\logger\system\usb\class\cdc\cdc.c
0014b6   cfd9     MOVFF     0xfd9,0xfe6    void CDCTxService(void)                                                          E:\usb20\logger\system\usb\class\cdc\cdc.c
0014b8   ffe6                                                                                                               
0014ba   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
0014bc   ffd9                                                                                                               
0014be   52e6     MOVF      0xe6,0x1,0x0                                                                                    
                                           {                                                                                E:\usb20\logger\system\usb\class\cdc\cdc.c
                                               byte byte_to_send;                                                           E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                                                                                            E:\usb20\logger\system\usb\class\cdc\cdc.c
0014c0   0104     MOVLB     0x4                if(mCDCUsartTxIsBusy()) return;                                              E:\usb20\logger\system\usb\class\cdc\cdc.c
0014c2   bf1c     BTFSC     0x1c,0x7,0x1                                                                                    
0014c4   d06b     BRA       0x159c                                                                                          
                                               /*                                                                           E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                * Completing stage is necessary while [ mCDCUSartTxIsBusy()==1 ].           E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                * By having this stage, user can always check cdc_trf_state,                E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                * and not having to call mCDCUsartTxIsBusy() directly.                      E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                */                                                                          E:\usb20\logger\system\usb\class\cdc\cdc.c
0014c6   0e03     MOVLW     0x3                if(cdc_trf_state == CDC_TX_COMPLETING)                                       E:\usb20\logger\system\usb\class\cdc\cdc.c
0014c8   0101     MOVLB     0x1                                                                                             
0014ca   5dd1     SUBWF     0xd1,0x0,0x1                                                                                    
0014cc   e101     BNZ       0x14d0                                                                                          
0014ce   6bd1     CLRF      0xd1,0x1               cdc_trf_state = CDC_TX_READY;                                            E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                                                                                            E:\usb20\logger\system\usb\class\cdc\cdc.c
                                               /*                                                                           E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                * If CDC_TX_READY state, nothing to do, just return.                        E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                */                                                                          E:\usb20\logger\system\usb\class\cdc\cdc.c
0014d0   51d1     MOVF      0xd1,0x0,0x1       if(cdc_trf_state == CDC_TX_READY) return;                                    E:\usb20\logger\system\usb\class\cdc\cdc.c
0014d2   e101     BNZ       0x14d6                                                                                          
0014d4   d063     BRA       0x159c                                                                                          
                                                                                                                            E:\usb20\logger\system\usb\class\cdc\cdc.c
                                               /*                                                                           E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                * If CDC_TX_BUSY_ZLP state, send zero length packet                         E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                */                                                                          E:\usb20\logger\system\usb\class\cdc\cdc.c
0014d6   0e02     MOVLW     0x2                if(cdc_trf_state == CDC_TX_BUSY_ZLP)                                         E:\usb20\logger\system\usb\class\cdc\cdc.c
0014d8   5dd1     SUBWF     0xd1,0x0,0x1                                                                                    
0014da   e106     BNZ       0x14e8                                                                                          
                                               {                                                                            E:\usb20\logger\system\usb\class\cdc\cdc.c
0014dc   0104     MOVLB     0x4                    CDC_BULK_BD_IN.Cnt = 0;                                                  E:\usb20\logger\system\usb\class\cdc\cdc.c
0014de   6b1d     CLRF      0x1d,0x1                                                                                        
0014e0   0101     MOVLB     0x1                    cdc_trf_state = CDC_TX_COMPLETING;                                       E:\usb20\logger\system\usb\class\cdc\cdc.c
0014e2   0e03     MOVLW     0x3                                                                                             
0014e4   6fd1     MOVWF     0xd1,0x1                                                                                        
                                               }                                                                            E:\usb20\logger\system\usb\class\cdc\cdc.c
0014e6   d054     BRA       0x1590             else if(cdc_trf_state == CDC_TX_BUSY)                                        E:\usb20\logger\system\usb\class\cdc\cdc.c
0014e8   05d1     DECF      0xd1,0x0,0x1                                                                                    
0014ea   e152     BNZ       0x1590                                                                                          
                                               {                                                                            E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                   /*                                                                       E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                    * First, have to figure out how many byte of data to send.              E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                    */                                                                      E:\usb20\logger\system\usb\class\cdc\cdc.c
0014ec   0e40     MOVLW     0x40               	if(cdc_tx_len > sizeof(cdc_data_tx))                                        E:\usb20\logger\system\usb\class\cdc\cdc.c
0014ee   6e14     MOVWF     0x14,0x0                                                                                        
0014f0   6a15     CLRF      0x15,0x0                                                                                        
0014f2   51d6     MOVF      0xd6,0x0,0x1                                                                                    
0014f4   5c14     SUBWF     0x14,0x0,0x0                                                                                    
0014f6   0e00     MOVLW     0x0                                                                                             
0014f8   5815     SUBWFB    0x15,0x0,0x0                                                                                    
0014fa   e203     BC        0x1502                                                                                          
0014fc   0e40     MOVLW     0x40               	    byte_to_send = sizeof(cdc_data_tx);                                     E:\usb20\logger\system\usb\class\cdc\cdc.c
0014fe   6edf     MOVWF     0xdf,0x0                                                                                        
001500   d002     BRA       0x1506             	else                                                                        E:\usb20\logger\system\usb\class\cdc\cdc.c
001502   c1d6     MOVFF     0x1d6,0xfdf        	    byte_to_send = cdc_tx_len;                                              E:\usb20\logger\system\usb\class\cdc\cdc.c
001504   ffdf                                                                                                               
                                                                                                                            E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                   /*                                                                       E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                    * Next, load the number of bytes to send to Cnt in buffer descriptor    E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                    */                                                                      E:\usb20\logger\system\usb\class\cdc\cdc.c
001506   cfdf     MOVFF     0xfdf,0x41d            CDC_BULK_BD_IN.Cnt = byte_to_send;                                       E:\usb20\logger\system\usb\class\cdc\cdc.c
001508   f41d                                                                                                               
                                                                                                                            E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                   /*                                                                       E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                    * Subtract the number of bytes just about to be sent from the total.    E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                    */                                                                      E:\usb20\logger\system\usb\class\cdc\cdc.c
00150a   50df     MOVF      0xdf,0x0,0x0       	cdc_tx_len = cdc_tx_len - byte_to_send;                                     E:\usb20\logger\system\usb\class\cdc\cdc.c
00150c   5dd6     SUBWF     0xd6,0x0,0x1                                                                                    
00150e   6fd6     MOVWF     0xd6,0x1                                                                                        
                                               	                                                                            E:\usb20\logger\system\usb\class\cdc\cdc.c
001510   0e48     MOVLW     0x48                   pCDCDst.bRam = (byte*)&cdc_data_tx; // Set destination pointer           E:\usb20\logger\system\usb\class\cdc\cdc.c
001512   6fd4     MOVWF     0xd4,0x1                                                                                        
001514   0e05     MOVLW     0x5                                                                                             
001516   6fd5     MOVWF     0xd5,0x1                                                                                        
                                                                                                                            E:\usb20\logger\system\usb\class\cdc\cdc.c
001518   05d7     DECF      0xd7,0x0,0x1           if(cdc_mem_type == _ROM)            // Determine type of memory source   E:\usb20\logger\system\usb\class\cdc\cdc.c
00151a   e115     BNZ       0x1546                                                                                          
                                                   {                                                                        E:\usb20\logger\system\usb\class\cdc\cdc.c
00151c   50df     MOVF      0xdf,0x0,0x0               while(byte_to_send)                                                  E:\usb20\logger\system\usb\class\cdc\cdc.c
00151e   e012     BZ        0x1544                                                                                          
001542   d7ec     BRA       0x151c                                                                                          
                                                       {                                                                    E:\usb20\logger\system\usb\class\cdc\cdc.c
001520   c1d2     MOVFF     0x1d2,0xff6                    *pCDCDst.bRam = *pCDCSrc.bRom;                                   E:\usb20\logger\system\usb\class\cdc\cdc.c
001522   fff6                                                                                                               
001524   c1d3     MOVFF     0x1d3,0xff7                                                                                     
001526   fff7                                                                                                               
001528   0008     TBLRD                                                                                                     
00152a   50f5     MOVF      0xf5,0x0,0x0                                                                                    
00152c   c1d4     MOVFF     0x1d4,0xfe9                                                                                     
00152e   ffe9                                                                                                               
001530   c1d5     MOVFF     0x1d5,0xfea                                                                                     
001532   ffea                                                                                                               
001534   6eef     MOVWF     0xef,0x0                                                                                        
001536   2bd4     INCF      0xd4,0x1,0x1                   pCDCDst.bRam++;                                                  E:\usb20\logger\system\usb\class\cdc\cdc.c
001538   0e00     MOVLW     0x0                                                                                             
00153a   23d5     ADDWFC    0xd5,0x1,0x1                                                                                    
00153c   2bd2     INCF      0xd2,0x1,0x1                   pCDCSrc.bRom++;                                                  E:\usb20\logger\system\usb\class\cdc\cdc.c
00153e   23d3     ADDWFC    0xd3,0x1,0x1                                                                                    
001540   06df     DECF      0xdf,0x1,0x0                   byte_to_send--;                                                  E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                       }//end while(byte_to_send)                                           E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                   }                                                                        E:\usb20\logger\system\usb\class\cdc\cdc.c
001544   d013     BRA       0x156c                 else // _RAM                                                             E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                   {                                                                        E:\usb20\logger\system\usb\class\cdc\cdc.c
001546   50df     MOVF      0xdf,0x0,0x0               while(byte_to_send)                                                  E:\usb20\logger\system\usb\class\cdc\cdc.c
001548   e011     BZ        0x156c                                                                                          
00156a   d7ed     BRA       0x1546                                                                                          
                                                       {                                                                    E:\usb20\logger\system\usb\class\cdc\cdc.c
00154a   c1d2     MOVFF     0x1d2,0xfe9                    *pCDCDst.bRam = *pCDCSrc.bRam;                                   E:\usb20\logger\system\usb\class\cdc\cdc.c
00154c   ffe9                                                                                                               
00154e   c1d3     MOVFF     0x1d3,0xfea                                                                                     
001550   ffea                                                                                                               
001552   50ef     MOVF      0xef,0x0,0x0                                                                                    
001554   c1d4     MOVFF     0x1d4,0xfe9                                                                                     
001556   ffe9                                                                                                               
001558   c1d5     MOVFF     0x1d5,0xfea                                                                                     
00155a   ffea                                                                                                               
00155c   6eef     MOVWF     0xef,0x0                                                                                        
00155e   2bd4     INCF      0xd4,0x1,0x1                   pCDCDst.bRam++;                                                  E:\usb20\logger\system\usb\class\cdc\cdc.c
001560   0e00     MOVLW     0x0                                                                                             
001562   23d5     ADDWFC    0xd5,0x1,0x1                                                                                    
001564   2bd2     INCF      0xd2,0x1,0x1                   pCDCSrc.bRam++;                                                  E:\usb20\logger\system\usb\class\cdc\cdc.c
001566   23d3     ADDWFC    0xd3,0x1,0x1                                                                                    
001568   06df     DECF      0xdf,0x1,0x0                   byte_to_send--;                                                  E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                       }//end while(byte_to_send._word)                                     E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                   }//end if(cdc_mem_type...)                                               E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                                                                                            E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                   /*                                                                       E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                    * Lastly, determine if a zero length packet state is necessary.         E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                    * See explanation in USB Specification 2.0: Section 5.8.3               E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                    */                                                                      E:\usb20\logger\system\usb\class\cdc\cdc.c
00156c   51d6     MOVF      0xd6,0x0,0x1           if(cdc_tx_len == 0)                                                      E:\usb20\logger\system\usb\class\cdc\cdc.c
00156e   e110     BNZ       0x1590                                                                                          
                                                   {                                                                        E:\usb20\logger\system\usb\class\cdc\cdc.c
001570   0104     MOVLB     0x4                        if(CDC_BULK_BD_IN.Cnt == sizeof(cdc_data_tx))                        E:\usb20\logger\system\usb\class\cdc\cdc.c
001572   511d     MOVF      0x1d,0x0,0x1                                                                                    
001574   6e14     MOVWF     0x14,0x0                                                                                        
001576   6a15     CLRF      0x15,0x0                                                                                        
001578   0e40     MOVLW     0x40                                                                                            
00157a   1814     XORWF     0x14,0x0,0x0                                                                                    
00157c   e101     BNZ       0x1580                                                                                          
00157e   5015     MOVF      0x15,0x0,0x0                                                                                    
001580   e104     BNZ       0x158a                                                                                          
001582   0101     MOVLB     0x1                            cdc_trf_state = CDC_TX_BUSY_ZLP;                                 E:\usb20\logger\system\usb\class\cdc\cdc.c
001584   0e02     MOVLW     0x2                                                                                             
001586   6fd1     MOVWF     0xd1,0x1                                                                                        
001588   d003     BRA       0x1590                     else                                                                 E:\usb20\logger\system\usb\class\cdc\cdc.c
00158a   0101     MOVLB     0x1                            cdc_trf_state = CDC_TX_COMPLETING;                               E:\usb20\logger\system\usb\class\cdc\cdc.c
00158c   0e03     MOVLW     0x3                                                                                             
00158e   6fd1     MOVWF     0xd1,0x1                                                                                        
                                                   }//end if(cdc_tx_len...)                                                 E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                                                                                            E:\usb20\logger\system\usb\class\cdc\cdc.c
                                               }//end if(cdc_tx_sate == CDC_TX_BUSY)                                        E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                                                                                            E:\usb20\logger\system\usb\class\cdc\cdc.c
                                               /*                                                                           E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                * Both CDC_TX_BUSY and CDC_TX_BUSY_ZLP states use the following macro       E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                */                                                                          E:\usb20\logger\system\usb\class\cdc\cdc.c
001590   0e40     MOVLW     0x40               mUSBBufferReady(CDC_BULK_BD_IN);                                             E:\usb20\logger\system\usb\class\cdc\cdc.c
001592   0104     MOVLB     0x4                                                                                             
001594   171c     ANDWF     0x1c,0x1,0x1                                                                                    
001596   7d1c     BTG       0x1c,0x6,0x1                                                                                    
001598   0e88     MOVLW     0x88                                                                                            
00159a   131c     IORWF     0x1c,0x1,0x1                                                                                    
                                                                                                                            E:\usb20\logger\system\usb\class\cdc\cdc.c
00159c   52e5     MOVF      0xe5,0x1,0x0   }//end CDCTxService                                                              E:\usb20\logger\system\usb\class\cdc\cdc.c
00159e   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0015a0   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
0015a2   ffd9                                                                                                               
0015a4   0012     RETURN    0x0                                                                                             
                                                                                                                            E:\usb20\logger\system\usb\class\cdc\cdc.c
                                           #endif //USB_USE_CDC                                                             E:\usb20\logger\system\usb\class\cdc\cdc.c
                                                                                                                            E:\usb20\logger\system\usb\class\cdc\cdc.c
                                           /** EOF cdc.c ****************************************************************/  E:\usb20\logger\system\usb\class\cdc\cdc.c
                                           /*********************************************************************           E:\usb20\logger\autofiles\usbdsc.c
                                            *                                                                               E:\usb20\logger\autofiles\usbdsc.c
                                            *                Microchip USB C18 Firmware Version 1.0                         E:\usb20\logger\autofiles\usbdsc.c
                                            *                                                                               E:\usb20\logger\autofiles\usbdsc.c
                                            *********************************************************************           E:\usb20\logger\autofiles\usbdsc.c
                                            * FileName:        usbdsc.c                                                     E:\usb20\logger\autofiles\usbdsc.c
                                            * Dependencies:    See INCLUDES section below                                   E:\usb20\logger\autofiles\usbdsc.c
                                            * Processor:       PIC18                                                        E:\usb20\logger\autofiles\usbdsc.c
                                            * Compiler:        C18 2.30.01+                                                 E:\usb20\logger\autofiles\usbdsc.c
                                            * Company:         Microchip Technology, Inc.                                   E:\usb20\logger\autofiles\usbdsc.c
                                            *                                                                               E:\usb20\logger\autofiles\usbdsc.c
                                            * Software License Agreement                                                    E:\usb20\logger\autofiles\usbdsc.c
                                            *                                                                               E:\usb20\logger\autofiles\usbdsc.c
                                            * The software supplied herewith by Microchip Technology Incorporated           E:\usb20\logger\autofiles\usbdsc.c
                                            * (the 鼎ompany・ for its PICmicroｮ Microcontroller is intended and             E:\usb20\logger\autofiles\usbdsc.c
                                            * supplied to you, the Company痴 customer, for use solely and                   E:\usb20\logger\autofiles\usbdsc.c
                                            * exclusively on Microchip PICmicro Microcontroller products. The               E:\usb20\logger\autofiles\usbdsc.c
                                            * software is owned by the Company and/or its supplier, and is                  E:\usb20\logger\autofiles\usbdsc.c
                                            * protected under applicable copyright laws. All rights are reserved.           E:\usb20\logger\autofiles\usbdsc.c
                                            * Any use in violation of the foregoing restrictions may subject the            E:\usb20\logger\autofiles\usbdsc.c
                                            * user to criminal sanctions under applicable laws, as well as to               E:\usb20\logger\autofiles\usbdsc.c
                                            * civil liability for the breach of the terms and conditions of this            E:\usb20\logger\autofiles\usbdsc.c
                                            * license.                                                                      E:\usb20\logger\autofiles\usbdsc.c
                                            *                                                                               E:\usb20\logger\autofiles\usbdsc.c
                                            * THIS SOFTWARE IS PROVIDED IN AN 鄭S IS・CONDITION. NO WARRANTIES,             E:\usb20\logger\autofiles\usbdsc.c
                                            * WHETHER EXPRESS, IMPLIED OR STATUTORY, INCLUDING, BUT NOT LIMITED             E:\usb20\logger\autofiles\usbdsc.c
                                            * TO, IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A                   E:\usb20\logger\autofiles\usbdsc.c
                                            * PARTICULAR PURPOSE APPLY TO THIS SOFTWARE. THE COMPANY SHALL NOT,             E:\usb20\logger\autofiles\usbdsc.c
                                            * IN ANY CIRCUMSTANCES, BE LIABLE FOR SPECIAL, INCIDENTAL OR                    E:\usb20\logger\autofiles\usbdsc.c
                                            * CONSEQUENTIAL DAMAGES, FOR ANY REASON WHATSOEVER.                             E:\usb20\logger\autofiles\usbdsc.c
                                            *                                                                               E:\usb20\logger\autofiles\usbdsc.c
                                            ********************************************************************/           E:\usb20\logger\autofiles\usbdsc.c
                                                                                                                            E:\usb20\logger\autofiles\usbdsc.c
                                           /*********************************************************************           E:\usb20\logger\autofiles\usbdsc.c
                                            * -usbdsc.c-                                                                    E:\usb20\logger\autofiles\usbdsc.c
                                            * This file contains the USB descriptor information. It is used                 E:\usb20\logger\autofiles\usbdsc.c
                                            * in conjunction with the usbdsc.h file. When a descriptor is added             E:\usb20\logger\autofiles\usbdsc.c
                                            * or removed from the main configuration descriptor, i.e. CFG01,                E:\usb20\logger\autofiles\usbdsc.c
                                            * the user must also change the descriptor structure defined in                 E:\usb20\logger\autofiles\usbdsc.c
                                            * the usbdsc.h file. The structure is used to calculate the                     E:\usb20\logger\autofiles\usbdsc.c
                                            * descriptor size, i.e. sizeof(CFG01).                                          E:\usb20\logger\autofiles\usbdsc.c
                                            *                                                                               E:\usb20\logger\autofiles\usbdsc.c
                                            * A typical configuration descriptor consists of:                               E:\usb20\logger\autofiles\usbdsc.c
                                            * At least one configuration descriptor (USB_CFG_DSC)                           E:\usb20\logger\autofiles\usbdsc.c
                                            * One or more interface descriptors (USB_INTF_DSC)                              E:\usb20\logger\autofiles\usbdsc.c
                                            * One or more endpoint descriptors (USB_EP_DSC)                                 E:\usb20\logger\autofiles\usbdsc.c
                                            *                                                                               E:\usb20\logger\autofiles\usbdsc.c
                                            * Naming Convention:                                                            E:\usb20\logger\autofiles\usbdsc.c
                                            * To resolve ambiguity, the naming convention are as followed:                  E:\usb20\logger\autofiles\usbdsc.c
                                            * - USB_CFG_DSC type should be named cdxx, where xx is the                      E:\usb20\logger\autofiles\usbdsc.c
                                            *   configuration number. This number should match the actual                   E:\usb20\logger\autofiles\usbdsc.c
                                            *   index value of this configuration.                                          E:\usb20\logger\autofiles\usbdsc.c
                                            * - USB_INTF_DSC type should be named i<yy>a<zz>, where yy is the               E:\usb20\logger\autofiles\usbdsc.c
                                            *   interface number and zz is the alternate interface number.                  E:\usb20\logger\autofiles\usbdsc.c
                                            * - USB_EP_DSC type should be named ep<##><d>_i<yy>a<zz>, where                 E:\usb20\logger\autofiles\usbdsc.c
                                            *   ## is the endpoint number and d is the direction of transfer.               E:\usb20\logger\autofiles\usbdsc.c
                                            *   The interface name should also be listed as a suffix to identify            E:\usb20\logger\autofiles\usbdsc.c
                                            *   which interface does the endpoint belong to.                                E:\usb20\logger\autofiles\usbdsc.c
                                            *                                                                               E:\usb20\logger\autofiles\usbdsc.c
                                            * Example:                                                                      E:\usb20\logger\autofiles\usbdsc.c
                                            * If a device has one configuration, two interfaces; interface 0                E:\usb20\logger\autofiles\usbdsc.c
                                            * has two endpoints (in and out), and interface 1 has one endpoint(in).         E:\usb20\logger\autofiles\usbdsc.c
                                            * Then the CFG01 structure in the usbdsc.h should be:                           E:\usb20\logger\autofiles\usbdsc.c
                                            *                                                                               E:\usb20\logger\autofiles\usbdsc.c
                                            * #define CFG01 rom struct                            \                         E:\usb20\logger\autofiles\usbdsc.c
                                            * {   USB_CFG_DSC             cd01;                   \                         E:\usb20\logger\autofiles\usbdsc.c
                                            *     USB_INTF_DSC            i00a00;                 \                         E:\usb20\logger\autofiles\usbdsc.c
                                            *     USB_EP_DSC              ep01o_i00a00;           \                         E:\usb20\logger\autofiles\usbdsc.c
                                            *     USB_EP_DSC              ep01i_i00a00;           \                         E:\usb20\logger\autofiles\usbdsc.c
                                            *     USB_INTF_DSC            i01a00;                 \                         E:\usb20\logger\autofiles\usbdsc.c
                                            *     USB_EP_DSC              ep02i_i01a00;           \                         E:\usb20\logger\autofiles\usbdsc.c
                                            * } cfg01                                                                       E:\usb20\logger\autofiles\usbdsc.c
                                            *                                                                               E:\usb20\logger\autofiles\usbdsc.c
                                            * Note the hierarchy of the descriptors above, it follows the USB               E:\usb20\logger\autofiles\usbdsc.c
                                            * specification requirement. All endpoints belonging to an interface            E:\usb20\logger\autofiles\usbdsc.c
                                            * should be listed immediately after that interface.                            E:\usb20\logger\autofiles\usbdsc.c
                                            *                                                                               E:\usb20\logger\autofiles\usbdsc.c
                                            * -------------------------------------------------------------------           E:\usb20\logger\autofiles\usbdsc.c
                                            * Filling in the descriptor values in the usbdsc.c file:                        E:\usb20\logger\autofiles\usbdsc.c
                                            * -------------------------------------------------------------------           E:\usb20\logger\autofiles\usbdsc.c
                                            * Most items should be self-explanatory, however, a few will be                 E:\usb20\logger\autofiles\usbdsc.c
                                            * explained for clarification.                                                  E:\usb20\logger\autofiles\usbdsc.c
                                            *                                                                               E:\usb20\logger\autofiles\usbdsc.c
                                            * [Configuration Descriptor(USB_CFG_DSC)]                                       E:\usb20\logger\autofiles\usbdsc.c
                                            * The configuration attribute must always have the _DEFAULT                     E:\usb20\logger\autofiles\usbdsc.c
                                            * definition at the minimum. Additional options can be ORed                     E:\usb20\logger\autofiles\usbdsc.c
                                            * to the _DEFAULT attribute. Available options are _SELF and _RWU.              E:\usb20\logger\autofiles\usbdsc.c
                                            * These definitions are defined in the usbdefs_std_dsc.h file. The              E:\usb20\logger\autofiles\usbdsc.c
                                            * _SELF tells the USB host that this device is self-powered. The                E:\usb20\logger\autofiles\usbdsc.c
                                            * _RWU tells the USB host that this device supports Remote Wakeup.              E:\usb20\logger\autofiles\usbdsc.c
                                            *                                                                               E:\usb20\logger\autofiles\usbdsc.c
                                            * [Endpoint Descriptor(USB_EP_DSC)]                                             E:\usb20\logger\autofiles\usbdsc.c
                                            * Assume the following example:                                                 E:\usb20\logger\autofiles\usbdsc.c
                                            * sizeof(USB_EP_DSC),DSC_EP,_EP01_OUT,_BULK,64,0x00                             E:\usb20\logger\autofiles\usbdsc.c
                                            *                                                                               E:\usb20\logger\autofiles\usbdsc.c
                                            * The first two parameters are self-explanatory. They specify the               E:\usb20\logger\autofiles\usbdsc.c
                                            * length of this endpoint descriptor (7) and the descriptor type.               E:\usb20\logger\autofiles\usbdsc.c
                                            * The next parameter identifies the endpoint, the definitions are               E:\usb20\logger\autofiles\usbdsc.c
                                            * defined in usbdefs_std_dsc.h and has the following naming                     E:\usb20\logger\autofiles\usbdsc.c
                                            * convention:                                                                   E:\usb20\logger\autofiles\usbdsc.c
                                            * _EP<##>_<dir>                                                                 E:\usb20\logger\autofiles\usbdsc.c
                                            * where ## is the endpoint number and dir is the direction of                   E:\usb20\logger\autofiles\usbdsc.c
                                            * transfer. The dir has the value of either 'OUT' or 'IN'.                      E:\usb20\logger\autofiles\usbdsc.c
                                            * The next parameter identifies the type of the endpoint. Available             E:\usb20\logger\autofiles\usbdsc.c
                                            * options are _BULK, _INT, _ISO, and _CTRL. The _CTRL is not                    E:\usb20\logger\autofiles\usbdsc.c
                                            * typically used because the default control transfer endpoint is               E:\usb20\logger\autofiles\usbdsc.c
                                            * not defined in the USB descriptors. When _ISO option is used,                 E:\usb20\logger\autofiles\usbdsc.c
                                            * addition options can be ORed to _ISO. Example:                                E:\usb20\logger\autofiles\usbdsc.c
                                            * _ISO|_AD|_FE                                                                  E:\usb20\logger\autofiles\usbdsc.c
                                            * This describes the endpoint as an isochronous pipe with adaptive              E:\usb20\logger\autofiles\usbdsc.c
                                            * and feedback attributes. See usbdefs_std_dsc.h and the USB                    E:\usb20\logger\autofiles\usbdsc.c
                                            * specification for details. The next parameter defines the size of             E:\usb20\logger\autofiles\usbdsc.c
                                            * the endpoint. The last parameter in the polling interval.                     E:\usb20\logger\autofiles\usbdsc.c
                                            *                                                                               E:\usb20\logger\autofiles\usbdsc.c
                                            * -------------------------------------------------------------------           E:\usb20\logger\autofiles\usbdsc.c
                                            * Adding a USB String                                                           E:\usb20\logger\autofiles\usbdsc.c
                                            * -------------------------------------------------------------------           E:\usb20\logger\autofiles\usbdsc.c
                                            * A string descriptor array should have the following format:                   E:\usb20\logger\autofiles\usbdsc.c
                                            *                                                                               E:\usb20\logger\autofiles\usbdsc.c
                                            * rom struct{byte bLength;byte bDscType;word string[size];}sdxxx={              E:\usb20\logger\autofiles\usbdsc.c
                                            * sizeof(sdxxx),DSC_STR,<text>};                                                E:\usb20\logger\autofiles\usbdsc.c
                                            *                                                                               E:\usb20\logger\autofiles\usbdsc.c
                                            * The above structure provides a means for the C compiler to                    E:\usb20\logger\autofiles\usbdsc.c
                                            * calculate the length of string descriptor sdxxx, where xxx is the             E:\usb20\logger\autofiles\usbdsc.c
                                            * index number. The first two bytes of the descriptor are descriptor            E:\usb20\logger\autofiles\usbdsc.c
                                            * length and type. The rest <text> are string texts which must be               E:\usb20\logger\autofiles\usbdsc.c
                                            * in the unicode format. The unicode format is achieved by declaring            E:\usb20\logger\autofiles\usbdsc.c
                                            * each character as a word type. The whole text string is declared              E:\usb20\logger\autofiles\usbdsc.c
                                            * as a word array with the number of characters equals to <size>.               E:\usb20\logger\autofiles\usbdsc.c
                                            * <size> has to be manually counted and entered into the array                  E:\usb20\logger\autofiles\usbdsc.c
                                            * declaration. Let's study this through an example:                             E:\usb20\logger\autofiles\usbdsc.c
                                            * if the string is "USB" , then the string descriptor should be:                E:\usb20\logger\autofiles\usbdsc.c
                                            * (Using index 02)                                                              E:\usb20\logger\autofiles\usbdsc.c
                                            * rom struct{byte bLength;byte bDscType;word string[3];}sd002={                 E:\usb20\logger\autofiles\usbdsc.c
                                            * sizeof(sd002),DSC_STR,'U','S','B'};                                           E:\usb20\logger\autofiles\usbdsc.c
                                            *                                                                               E:\usb20\logger\autofiles\usbdsc.c
                                            * A USB project may have multiple strings and the firmware supports             E:\usb20\logger\autofiles\usbdsc.c
                                            * the management of multiple strings through a look-up table.                   E:\usb20\logger\autofiles\usbdsc.c
                                            * The look-up table is defined as:                                              E:\usb20\logger\autofiles\usbdsc.c
                                            * rom const unsigned char *rom USB_SD_Ptr[]={&sd000,&sd001,&sd002};             E:\usb20\logger\autofiles\usbdsc.c
                                            *                                                                               E:\usb20\logger\autofiles\usbdsc.c
                                            * The above declaration has 3 strings, sd000, sd001, and sd002.                 E:\usb20\logger\autofiles\usbdsc.c
                                            * Strings can be removed or added. sd000 is a specialized string                E:\usb20\logger\autofiles\usbdsc.c
                                            * descriptor. It defines the language code, usually this is                     E:\usb20\logger\autofiles\usbdsc.c
                                            * US English (0x0409). The index of the string must match the index             E:\usb20\logger\autofiles\usbdsc.c
                                            * position of the USB_SD_Ptr array, &sd000 must be in position                  E:\usb20\logger\autofiles\usbdsc.c
                                            * USB_SD_Ptr[0], &sd001 must be in position USB_SD_Ptr[1] and so on.            E:\usb20\logger\autofiles\usbdsc.c
                                            * The look-up table USB_SD_Ptr is used by the get string handler                E:\usb20\logger\autofiles\usbdsc.c
                                            * function in usb9.c.                                                           E:\usb20\logger\autofiles\usbdsc.c
                                            *                                                                               E:\usb20\logger\autofiles\usbdsc.c
                                            * -------------------------------------------------------------------           E:\usb20\logger\autofiles\usbdsc.c
                                            *                                                                               E:\usb20\logger\autofiles\usbdsc.c
                                            * The look-up table scheme also applies to the configuration                    E:\usb20\logger\autofiles\usbdsc.c
                                            * descriptor. A USB device may have multiple configuration                      E:\usb20\logger\autofiles\usbdsc.c
                                            * descriptors, i.e. CFG01, CFG02, etc. To add a configuration                   E:\usb20\logger\autofiles\usbdsc.c
                                            * descriptor, user must implement a structure similar to CFG01.                 E:\usb20\logger\autofiles\usbdsc.c
                                            * The next step is to add the configuration descriptor name, i.e.               E:\usb20\logger\autofiles\usbdsc.c
                                            * cfg01, cfg02,.., to the look-up table USB_CD_Ptr. USB_CD_Ptr[0]               E:\usb20\logger\autofiles\usbdsc.c
                                            * is a dummy place holder since configuration 0 is the un-configured            E:\usb20\logger\autofiles\usbdsc.c
                                            * state according to the definition in the USB specification.                   E:\usb20\logger\autofiles\usbdsc.c
                                            *                                                                               E:\usb20\logger\autofiles\usbdsc.c
                                            ********************************************************************/           E:\usb20\logger\autofiles\usbdsc.c
                                                                                                                            E:\usb20\logger\autofiles\usbdsc.c
                                           /*********************************************************************           E:\usb20\logger\autofiles\usbdsc.c
                                            * Descriptor specific type definitions are defined in:                          E:\usb20\logger\autofiles\usbdsc.c
                                            * system\usb\usbdefs\usbdefs_std_dsc.h                                          E:\usb20\logger\autofiles\usbdsc.c
                                            *                                                                               E:\usb20\logger\autofiles\usbdsc.c
                                            * Configuration information is defined in:                                      E:\usb20\logger\autofiles\usbdsc.c
                                            * autofiles\usbcfg.h                                                            E:\usb20\logger\autofiles\usbdsc.c
                                            ********************************************************************/           E:\usb20\logger\autofiles\usbdsc.c
                                                                                                                            E:\usb20\logger\autofiles\usbdsc.c
                                           /** I N C L U D E S *************************************************/           E:\usb20\logger\autofiles\usbdsc.c
                                           #include "system\typedefs.h"                                                     E:\usb20\logger\autofiles\usbdsc.c
                                           #include "system\usb\usb.h"                                                      E:\usb20\logger\autofiles\usbdsc.c
                                                                                                                            E:\usb20\logger\autofiles\usbdsc.c
                                           /** C O N S T A N T S ************************************************/          E:\usb20\logger\autofiles\usbdsc.c
                                           #pragma romdata                                                                  E:\usb20\logger\autofiles\usbdsc.c
                                                                                                                            E:\usb20\logger\autofiles\usbdsc.c
                                           /* Device Descriptor */                                                          E:\usb20\logger\autofiles\usbdsc.c
                                           rom USB_DEV_DSC device_dsc=                                                      E:\usb20\logger\autofiles\usbdsc.c
                                           {                                                                                E:\usb20\logger\autofiles\usbdsc.c
                                               sizeof(USB_DEV_DSC),    // Size of this descriptor in bytes                  E:\usb20\logger\autofiles\usbdsc.c
                                               DSC_DEV,                // DEVICE descriptor type                            E:\usb20\logger\autofiles\usbdsc.c
                                               0x0200,                 // USB Spec Release Number in BCD format             E:\usb20\logger\autofiles\usbdsc.c
                                               CDC_DEVICE,             // Class Code                                        E:\usb20\logger\autofiles\usbdsc.c
                                               0x00,                   // Subclass code                                     E:\usb20\logger\autofiles\usbdsc.c
                                               0x00,                   // Protocol code                                     E:\usb20\logger\autofiles\usbdsc.c
                                               EP0_BUFF_SIZE,          // Max packet size for EP0, see usbcfg.h             E:\usb20\logger\autofiles\usbdsc.c
                                               0x09B9,                 // Vendor ID                                         E:\usb20\logger\autofiles\usbdsc.c
                                               0x0047,                 // Product ID: CDC RS-232 Emulation Demo             E:\usb20\logger\autofiles\usbdsc.c
                                               0x0000,                 // Device release number in BCD format               E:\usb20\logger\autofiles\usbdsc.c
                                               0x01,                   // Manufacturer string index                         E:\usb20\logger\autofiles\usbdsc.c
                                               0x02,                   // Product string index                              E:\usb20\logger\autofiles\usbdsc.c
                                               0x00,                   // Device serial number string index                 E:\usb20\logger\autofiles\usbdsc.c
                                               0x01                    // Number of possible configurations                 E:\usb20\logger\autofiles\usbdsc.c
                                           };                                                                               E:\usb20\logger\autofiles\usbdsc.c
                                                                                                                            E:\usb20\logger\autofiles\usbdsc.c
                                           /* Configuration 1 Descriptor */                                                 E:\usb20\logger\autofiles\usbdsc.c
                                           CFG01=                                                                           E:\usb20\logger\autofiles\usbdsc.c
                                           {                                                                                E:\usb20\logger\autofiles\usbdsc.c
                                               /* Configuration Descriptor */                                               E:\usb20\logger\autofiles\usbdsc.c
                                               sizeof(USB_CFG_DSC),    // Size of this descriptor in bytes                  E:\usb20\logger\autofiles\usbdsc.c
                                               DSC_CFG,                // CONFIGURATION descriptor type                     E:\usb20\logger\autofiles\usbdsc.c
                                               sizeof(cfg01),          // Total length of data for this cfg                 E:\usb20\logger\autofiles\usbdsc.c
                                               2,                      // Number of interfaces in this cfg                  E:\usb20\logger\autofiles\usbdsc.c
                                               1,                      // Index value of this configuration                 E:\usb20\logger\autofiles\usbdsc.c
                                               0,                      // Configuration string index                        E:\usb20\logger\autofiles\usbdsc.c
                                               _DEFAULT,               // Attributes, see usbdefs_std_dsc.h                 E:\usb20\logger\autofiles\usbdsc.c
                                               50,                     // Max power consumption (2X mA)                     E:\usb20\logger\autofiles\usbdsc.c
                                                                                                                            E:\usb20\logger\autofiles\usbdsc.c
                                               /* Interface Descriptor */                                                   E:\usb20\logger\autofiles\usbdsc.c
                                               sizeof(USB_INTF_DSC),   // Size of this descriptor in bytes                  E:\usb20\logger\autofiles\usbdsc.c
                                               DSC_INTF,               // INTERFACE descriptor type                         E:\usb20\logger\autofiles\usbdsc.c
                                               0,                      // Interface Number                                  E:\usb20\logger\autofiles\usbdsc.c
                                               0,                      // Alternate Setting Number                          E:\usb20\logger\autofiles\usbdsc.c
                                               1,                      // Number of endpoints in this intf                  E:\usb20\logger\autofiles\usbdsc.c
                                               COMM_INTF,              // Class code                                        E:\usb20\logger\autofiles\usbdsc.c
                                               ABSTRACT_CONTROL_MODEL, // Subclass code                                     E:\usb20\logger\autofiles\usbdsc.c
                                               V25TER,                 // Protocol code                                     E:\usb20\logger\autofiles\usbdsc.c
                                               0,                      // Interface string index                            E:\usb20\logger\autofiles\usbdsc.c
                                                                                                                            E:\usb20\logger\autofiles\usbdsc.c
                                               /* CDC Class-Specific Descriptors */                                         E:\usb20\logger\autofiles\usbdsc.c
                                               sizeof(USB_CDC_HEADER_FN_DSC),CS_INTERFACE,DSC_FN_HEADER,0x0110,             E:\usb20\logger\autofiles\usbdsc.c
                                               sizeof(USB_CDC_ACM_FN_DSC),CS_INTERFACE,DSC_FN_ACM,0x02,                     E:\usb20\logger\autofiles\usbdsc.c
                                               sizeof(USB_CDC_UNION_FN_DSC),CS_INTERFACE,DSC_FN_UNION,CDC_COMM_INTF_ID,CDC_DATA_INTF_ID, E:\usb20\logger\autofiles\usbdsc.c
                                               sizeof(USB_CDC_CALL_MGT_FN_DSC),CS_INTERFACE,DSC_FN_CALL_MGT,0x00,CDC_DATA_INTF_ID, E:\usb20\logger\autofiles\usbdsc.c
                                                                                                                            E:\usb20\logger\autofiles\usbdsc.c
                                               /* Endpoint Descriptor */                                                    E:\usb20\logger\autofiles\usbdsc.c
                                               sizeof(USB_EP_DSC),DSC_EP,_EP02_IN,_INT,CDC_INT_EP_SIZE,0x02,                E:\usb20\logger\autofiles\usbdsc.c
                                                                                                                            E:\usb20\logger\autofiles\usbdsc.c
                                               /* Interface Descriptor */                                                   E:\usb20\logger\autofiles\usbdsc.c
                                               sizeof(USB_INTF_DSC),   // Size of this descriptor in bytes                  E:\usb20\logger\autofiles\usbdsc.c
                                               DSC_INTF,               // INTERFACE descriptor type                         E:\usb20\logger\autofiles\usbdsc.c
                                               1,                      // Interface Number                                  E:\usb20\logger\autofiles\usbdsc.c
                                               0,                      // Alternate Setting Number                          E:\usb20\logger\autofiles\usbdsc.c
                                               2,                      // Number of endpoints in this intf                  E:\usb20\logger\autofiles\usbdsc.c
                                               DATA_INTF,              // Class code                                        E:\usb20\logger\autofiles\usbdsc.c
                                               0,                      // Subclass code                                     E:\usb20\logger\autofiles\usbdsc.c
                                               NO_PROTOCOL,            // Protocol code                                     E:\usb20\logger\autofiles\usbdsc.c
                                               0,                      // Interface string index                            E:\usb20\logger\autofiles\usbdsc.c
                                                                                                                            E:\usb20\logger\autofiles\usbdsc.c
                                               /* Endpoint Descriptors */                                                   E:\usb20\logger\autofiles\usbdsc.c
                                               sizeof(USB_EP_DSC),DSC_EP,_EP03_OUT,_BULK,CDC_BULK_OUT_EP_SIZE,0x00,         E:\usb20\logger\autofiles\usbdsc.c
                                               sizeof(USB_EP_DSC),DSC_EP,_EP03_IN,_BULK,CDC_BULK_IN_EP_SIZE,0x00            E:\usb20\logger\autofiles\usbdsc.c
                                           };                                                                               E:\usb20\logger\autofiles\usbdsc.c
                                                                                                                            E:\usb20\logger\autofiles\usbdsc.c
                                           rom struct{byte bLength;byte bDscType;word string[1];}sd000={                    E:\usb20\logger\autofiles\usbdsc.c
                                           sizeof(sd000),DSC_STR,0x0409};                                                   E:\usb20\logger\autofiles\usbdsc.c
                                                                                                                            E:\usb20\logger\autofiles\usbdsc.c
                                           rom struct{byte bLength;byte bDscType;word string[25];}sd001={                   E:\usb20\logger\autofiles\usbdsc.c
                                           sizeof(sd001),DSC_STR,                                                           E:\usb20\logger\autofiles\usbdsc.c
                                           'M','i','c','r','o','c','h','i','p',' ',                                         E:\usb20\logger\autofiles\usbdsc.c
                                           'T','e','c','h','n','o','l','o','g','y',' ','I','n','c','.'};                    E:\usb20\logger\autofiles\usbdsc.c
                                                                                                                            E:\usb20\logger\autofiles\usbdsc.c
                                           rom struct{byte bLength;byte bDscType;word string[25];}sd002={                   E:\usb20\logger\autofiles\usbdsc.c
                                           sizeof(sd002),DSC_STR,                                                           E:\usb20\logger\autofiles\usbdsc.c
                                           'C','D','C',' ','R','S','-','2','3','2',' ',                                     E:\usb20\logger\autofiles\usbdsc.c
                                           'E','m','u','l','a','t','i','o','n',' ','D','e','m','o'};                        E:\usb20\logger\autofiles\usbdsc.c
                                                                                                                            E:\usb20\logger\autofiles\usbdsc.c
                                           rom const unsigned char *rom USB_CD_Ptr[]={&cfg01,&cfg01};                       E:\usb20\logger\autofiles\usbdsc.c
                                           rom const unsigned char *rom USB_SD_Ptr[]={&sd000,&sd001,&sd002};                E:\usb20\logger\autofiles\usbdsc.c
                                                                                                                            E:\usb20\logger\autofiles\usbdsc.c
                                           rom pFunc ClassReqHandler[1]=                                                    E:\usb20\logger\autofiles\usbdsc.c
                                           {                                                                                E:\usb20\logger\autofiles\usbdsc.c
                                               &USBCheckCDCRequest                                                          E:\usb20\logger\autofiles\usbdsc.c
                                           };                                                                               E:\usb20\logger\autofiles\usbdsc.c
                                                                                                                            E:\usb20\logger\autofiles\usbdsc.c
                                           #pragma code                                                                     E:\usb20\logger\autofiles\usbdsc.c
                                                                                                                            E:\usb20\logger\autofiles\usbdsc.c
                                           /** EOF usbdsc.c ****************************************************/           E:\usb20\logger\autofiles\usbdsc.c
