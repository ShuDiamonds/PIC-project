MP2COD 4.00, COFF to COD File Converter
Copyright (c) 2005 Microchip Technology Inc.
Listing File Generated: Sun Nov 06 21:49:01 2005


Address  Value    Disassembly              Source                                                                           File
-------  -------  -----------------------  -------------------------------------------------------------------------------  -----
                                           /*********************************************************************           E:\usb20\FCounter20\main.c
                                           *                                                                                E:\usb20\FCounter20\main.c
                                           *　USB接続 周波数カウンタプログラム                                              E:\usb20\FCounter20\main.c
                                           *	USBフレームワーク修正情報                                                      E:\usb20\FCounter20\main.c
                                           *　　コンフィギュレーションの設定変更                                            E:\usb20\FCounter20\main.c
                                           *　　main.c　の変更　初期化削除　IO設定変更                                      E:\usb20\FCounter20\main.c
                                           *　　io_cfg.hの変更　LED削除　IOモニタ削除                                       E:\usb20\FCounter20\main.c
                                           *　　user.cの変更　　実行内容削除                                                E:\usb20\FCounter20\main.c
                                           *　　usbcfg.hの変更　IOモニタ削除                                                E:\usb20\FCounter20\main.c
                                           *                                                                                E:\usb20\FCounter20\main.c
                                           *********************************************************************            E:\usb20\FCounter20\main.c
                                           /** I N C L U D E S *************************************************/           E:\usb20\FCounter20\main.c
                                           #include <p18cxxx.h>                                                             E:\usb20\FCounter20\main.c
                                           #include "system\typedefs.h"                        // Required                  E:\usb20\FCounter20\main.c
                                           #include "system\usb\usb.h"                         // Required                  E:\usb20\FCounter20\main.c
                                           #include "io_cfg.h"                                 // Required                  E:\usb20\FCounter20\main.c
                                           #include "system\usb\usb_compile_time_validation.h" // Optional                  E:\usb20\FCounter20\main.c
                                           #include	"delays.h"                                                              E:\usb20\FCounter20\main.c
                                           #include "lcd_lib.h"                                                             E:\usb20\FCounter20\main.c
                                                                                                                            E:\usb20\FCounter20\main.c
                                           /*** Configuration *******/                                                      E:\usb20\FCounter20\main.c
                                           #pragma config FOSC = HSPLL_HS                                                   E:\usb20\FCounter20\main.c
                                           #pragma config WDT = OFF                                                         E:\usb20\FCounter20\main.c
                                           #pragma config PLLDIV = 5                                                        E:\usb20\FCounter20\main.c
                                           #pragma config CPUDIV = OSC1_PLL2                                                E:\usb20\FCounter20\main.c
                                           #pragma config USBDIV = 2                                                        E:\usb20\FCounter20\main.c
                                           #pragma config PWRT = ON                                                         E:\usb20\FCounter20\main.c
                                           #pragma config BOR = ON                                                          E:\usb20\FCounter20\main.c
                                           #pragma config BORV = 43                                                         E:\usb20\FCounter20\main.c
                                           #pragma config LVP = OFF                                                         E:\usb20\FCounter20\main.c
                                           #pragma config VREGEN = ON                                                       E:\usb20\FCounter20\main.c
                                           #pragma config MCLRE = ON                                                        E:\usb20\FCounter20\main.c
                                           #pragma config PBADEN = OFF                                                      E:\usb20\FCounter20\main.c
                                                                                                                            E:\usb20\FCounter20\main.c
                                           /** V A R I A B L E S ***********************************************/           E:\usb20\FCounter20\main.c
                                           #pragma udata                                                                    E:\usb20\FCounter20\main.c
                                           char input_buffer[64];					// USB入力バッファ                                    E:\usb20\FCounter20\main.c
                                           char output_buffer[64];					// USB出力バッファ                                   E:\usb20\FCounter20\main.c
                                                                                                                            E:\usb20\FCounter20\main.c
                                           char Prescale;							// プリセーラフラグ                                         E:\usb20\FCounter20\main.c
                                           char EndFlag = 0;							// カウント終了フラグ                                    E:\usb20\FCounter20\main.c
                                           char SecCounter;							// 1秒カウント                                            E:\usb20\FCounter20\main.c
                                           unsigned long FreqHigh;					// 周波数カウンタ上位                                E:\usb20\FCounter20\main.c
                                           unsigned long dumy;						// 周波数計算用ワーク                                   E:\usb20\FCounter20\main.c
                                                                                                                            E:\usb20\FCounter20\main.c
                                                                                                                            E:\usb20\FCounter20\main.c
                                           char MsgFreq[] = "Freq=         Hz";		// 液晶表示用メッセージ                    E:\usb20\FCounter20\main.c
                                           char MsgSend[] = "        \r\n";			// USB送信用メッセージ                        E:\usb20\FCounter20\main.c
                                           char MsgStart[] ="Start!";					// 初期メッセージ                                 E:\usb20\FCounter20\main.c
                                           char MsgPre8[] = "Scale1/8Max50MHz";		// プリスケーラ設定表示                    E:\usb20\FCounter20\main.c
                                           char MsgPre1[] = "Scale1/1Max10MHz";                                             E:\usb20\FCounter20\main.c
                                           char MsgAns[] = " ";                                                             E:\usb20\FCounter20\main.c
                                                                                                                            E:\usb20\FCounter20\main.c
                                                                                                                            E:\usb20\FCounter20\main.c
                                           /** P R I V A T E  P R O T O T Y P E S *******************************/          E:\usb20\FCounter20\main.c
                                           void Display(unsigned long Freq);                                                E:\usb20\FCounter20\main.c
                                           void ltostring(char digit, unsigned long data, char *buffer);                    E:\usb20\FCounter20\main.c
                                           void ISRProcess(void);                                                           E:\usb20\FCounter20\main.c
                                                                                                                            E:\usb20\FCounter20\main.c
                                           /** V E C T O R  M A P P I N G ***********************************/              E:\usb20\FCounter20\main.c
                                           #pragma code high_vector=0x08                                                    E:\usb20\FCounter20\main.c
                                           void interrupt_at_high_vector(void)                                              E:\usb20\FCounter20\main.c
                                           {                                                                                E:\usb20\FCounter20\main.c
000008   ef1c     GOTO      0x38               _asm goto ISRProcess _endasm                                                 E:\usb20\FCounter20\main.c
00000a   f000                                                                                                               
00000c   0012     RETURN    0x0            }                                                                                E:\usb20\FCounter20\main.c
                                           #pragma code                                                                     E:\usb20\FCounter20\main.c
                                                                                                                            E:\usb20\FCounter20\main.c
                                           ////// CCP1 Interrupt Process                                                    E:\usb20\FCounter20\main.c
                                           #pragma interrupt ISRProcess                                                     E:\usb20\FCounter20\main.c
000038   cfda     MOVFF     0xfda,0xfe4    void ISRProcess(void)                                                            E:\usb20\FCounter20\main.c
00003a   ffe4                                                                                                               
00003c   cfe2     MOVFF     0xfe2,0xfda                                                                                     
00003e   ffda                                                                                                               
000040   52e6     MOVF      0xe6,0x1,0x0                                                                                    
                                           {                                                                                E:\usb20\FCounter20\main.c
000042   949e     BCF       0x9e,0x2,0x0   	PIR1bits.CCP1IF = 0;				// Interrupt Flag Clear		                               E:\usb20\FCounter20\main.c
000044   0100     MOVLB     0x0            	SecCounter--;                                                                   E:\usb20\FCounter20\main.c
000046   07e1     DECF      0xe1,0x1,0x1                                                                                    
000048   51e1     MOVF      0xe1,0x0,0x1   	if(SecCounter == 0)                                                             E:\usb20\FCounter20\main.c
00004a   e106     BNZ       0x58                                                                                            
                                           	{                                                                               E:\usb20\FCounter20\main.c
00004c   7c8b     BTG       0x8b,0x6,0x0    		GreenLED = !GreenLED;                                                         E:\usb20\FCounter20\main.c
00004e   9ed5     BCF       0xd5,0x7,0x0   		T0CONbits.TMR0ON = 0;			// Stop Count                                          E:\usb20\FCounter20\main.c
000050   90cd     BCF       0xcd,0x0,0x0   		T1CONbits.TMR1ON = 0;                                                          E:\usb20\FCounter20\main.c
000052   0101     MOVLB     0x1            		EndFlag = 1;					// Count End Flag                                             E:\usb20\FCounter20\main.c
000054   0e01     MOVLW     0x1                                                                                             
000056   6f00     MOVWF     0x0,0x1                                                                                         
                                           	}                                                                               E:\usb20\FCounter20\main.c
000058   52e5     MOVF      0xe5,0x1,0x0   }                                                                                E:\usb20\FCounter20\main.c
00005a   cfe5     MOVFF     0xfe5,0xfda                                                                                     
00005c   ffda                                                                                                               
00005e   0011     RETFIE    0x1                                                                                             
                                                                                                                            E:\usb20\FCounter20\main.c
                                                                                                                            E:\usb20\FCounter20\main.c
                                                                                                                            E:\usb20\FCounter20\main.c
                                           #pragma code                                                                     E:\usb20\FCounter20\main.c
                                           /*********************************************************************           E:\usb20\FCounter20\main.c
                                            * Function:        void main(void)                                              E:\usb20\FCounter20\main.c
                                            ********************************************************************/           E:\usb20\FCounter20\main.c
000060   cfd9     MOVFF     0xfd9,0xfe6    void main(void)                                                                  E:\usb20\FCounter20\main.c
000062   ffe6                                                                                                               
000064   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
000066   ffd9                                                                                                               
000068   0e02     MOVLW     0x2                                                                                             
00006a   26e1     ADDWF     0xe1,0x1,0x0                                                                                    
                                           {                                                                                E:\usb20\FCounter20\main.c
                                           	int i;                                                                          E:\usb20\FCounter20\main.c
                                           	                                                                                E:\usb20\FCounter20\main.c
00006c   0e0f     MOVLW     0xf            	ADCON1 |= 0x0F;    	             	// 全ディジタルに設定                         E:\usb20\FCounter20\main.c
00006e   12c1     IORWF     0xc1,0x1,0x0                                                                                    
000070   0e07     MOVLW     0x7            	CMCON = 0x07;						// コンパレータオフ                                          E:\usb20\FCounter20\main.c
000072   6eb4     MOVWF     0xb4,0x0                                                                                        
000074   6a8a     CLRF      0x8a,0x0          	LATB = 0;						// 液晶表示ポートリセット                                     E:\usb20\FCounter20\main.c
000076   0ec0     MOVLW     0xc0             	LATC  = 0xC0;						// LED off                                                 E:\usb20\FCounter20\main.c
000078   6e8b     MOVWF     0x8b,0x0                                                                                        
00007a   0e10     MOVLW     0x10            	TRISA = 0x10;						// T0CKI                                                    E:\usb20\FCounter20\main.c
00007c   6e92     MOVWF     0x92,0x0                                                                                        
00007e   6a93     CLRF      0x93,0x0       	TRISB = 0x0;						// 液晶表示                                                   E:\usb20\FCounter20\main.c
000080   0e31     MOVLW     0x31            	TRISC = 0x31;						// LED Output Mode                                          E:\usb20\FCounter20\main.c
000082   6e94     MOVWF     0x94,0x0                                                                                        
                                            	// タイマ初期化                                                                E:\usb20\FCounter20\main.c
000084   0eb2     MOVLW     0xb2            	T1CON = 0xB2;						// ExtClock 1/8                                             E:\usb20\FCounter20\main.c
000086   6ecd     MOVWF     0xcd,0x0                                                                                        
000088   6acf     CLRF      0xcf,0x0        	TMR1H = 0;						// 64000 Count                                                 E:\usb20\FCounter20\main.c
00008a   6ace     CLRF      0xce,0x0        	TMR1L = 0;                                                                     E:\usb20\FCounter20\main.c
00008c   0e22     MOVLW     0x22           	T0CON = 0x22;						// Ext Counter 1/8                                           E:\usb20\FCounter20\main.c
00008e   6ed5     MOVWF     0xd5,0x0                                                                                        
000090   6ad7     CLRF      0xd7,0x0       	TMR0H = 0;                                                                      E:\usb20\FCounter20\main.c
000092   6ad6     CLRF      0xd6,0x0       	TMR0L = 0;                                                                      E:\usb20\FCounter20\main.c
000094   6ab1     CLRF      0xb1,0x0       	T3CON = 0;						// Timer1 for CCP1                                              E:\usb20\FCounter20\main.c
                                            	// CCP1初期化                                                                  E:\usb20\FCounter20\main.c
000096   0e0b     MOVLW     0xb             	CCP1CON = 0x0B;					// Timer Clear, Interrupt                                  E:\usb20\FCounter20\main.c
000098   6ebd     MOVWF     0xbd,0x0                                                                                        
00009a   6abe     CLRF      0xbe,0x0       	CCPR1 = 64000;					// 12.8MHz÷8÷64000=25Hz					                               E:\usb20\FCounter20\main.c
00009c   0efa     MOVLW     0xfa                                                                                            
00009e   6ebf     MOVWF     0xbf,0x0                                                                                        
                                           	/// USB初期化                                                                   E:\usb20\FCounter20\main.c
0000a0   0e14     MOVLW     0x14           	mInitializeUSBDriver();         	// See usbdrv.h                                E:\usb20\FCounter20\main.c
0000a2   6e6f     MOVWF     0x6f,0x0                                                                                        
0000a4   0100     MOVLB     0x0                                                                                             
0000a6   6bfc     CLRF      0xfc,0x1                                                                                        
0000a8   0100     MOVLB     0x0                                                                                             
0000aa   6bfd     CLRF      0xfd,0x1                                                                                        
0000ac   0100     MOVLB     0x0                                                                                             
0000ae   6bfe     CLRF      0xfe,0x1                                                                                        
                                           	/// 液晶表示器初期化                                                            E:\usb20\FCounter20\main.c
0000b0   eca9     CALL      0xf52,0x0      	lcd_init();						// LCD初期化                                                   E:\usb20\FCounter20\main.c
0000b2   f007                                                                                                               
0000b4   0e1d     MOVLW     0x1d           	lcd_str(MsgStart);				// 初期メッセージ表示                                     E:\usb20\FCounter20\main.c
0000b6   6ee6     MOVWF     0xe6,0x0                                                                                        
0000b8   0e01     MOVLW     0x1                                                                                             
0000ba   6ee6     MOVWF     0xe6,0x0                                                                                        
0000bc   ec89     CALL      0xf12,0x0                                                                                       
0000be   f007                                                                                                               
0000c0   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0000c2   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0000c4   0ef4     MOVLW     0xf4           	Delay10KTCYx(500);				// 0.5秒                                                  E:\usb20\FCounter20\main.c
0000c6   6ee6     MOVWF     0xe6,0x0                                                                                        
0000c8   ecb2     CALL      0x1364,0x0                                                                                      
0000ca   f009                                                                                                               
0000cc   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                           	/// 変数初期化                                                                  E:\usb20\FCounter20\main.c
0000ce   0100     MOVLB     0x0            	Prescale = 0;						// default 1/1                                               E:\usb20\FCounter20\main.c
0000d0   6be0     CLRF      0xe0,0x1                                                                                        
0000d2   6be2     CLRF      0xe2,0x1       	FreqHigh = 0;                                                                   E:\usb20\FCounter20\main.c
0000d4   6be3     CLRF      0xe3,0x1                                                                                        
0000d6   6be4     CLRF      0xe4,0x1                                                                                        
0000d8   6be5     CLRF      0xe5,0x1                                                                                        
0000da   0101     MOVLB     0x1            	EndFlag = 1;                                                                    E:\usb20\FCounter20\main.c
0000dc   0e01     MOVLW     0x1                                                                                             
0000de   6f00     MOVWF     0x0,0x1                                                                                         
                                           	// Enable Interrupt                                                             E:\usb20\FCounter20\main.c
0000e0   9ed0     BCF       0xd0,0x7,0x0   	RCONbits.IPEN = 0;				// No Priority                                            E:\usb20\FCounter20\main.c
0000e2   849d     BSF       0x9d,0x2,0x0    	PIE1bits.CCP1IE = 1;				// Enable CCP1		                                       E:\usb20\FCounter20\main.c
0000e4   0ec0     MOVLW     0xc0           	INTCON = 0xC0;					// Enable Interrupt                                          E:\usb20\FCounter20\main.c
0000e6   6ef2     MOVWF     0xf2,0x0                                                                                        
                                               /// メインループ                                                             E:\usb20\FCounter20\main.c
0002ec   d6fd     BRA       0xe8               while(1)                                                                     E:\usb20\FCounter20\main.c
                                               {                                                                            E:\usb20\FCounter20\main.c
0000e8   ecf3     CALL      0xfe6,0x0          		USBCheckBusStatus();        	// USB接続チェック                            E:\usb20\FCounter20\main.c
0000ea   f007                                                                                                               
0000ec   be6f     BTFSC     0x6f,0x7,0x0       		if(UCFGbits.UTEYE!=1)			// アイパターンモードオフか                        E:\usb20\FCounter20\main.c
0000ee   d002     BRA       0xf4                                                                                            
0000f0   ec12     CALL      0x1024,0x0             		USBDriverService();		// USBイベントポーリング                          E:\usb20\FCounter20\main.c
0000f2   f008                                                                                                               
0000f4   eca9     CALL      0x752,0x0      		CDCTxService();				// クラス送受信実行                                         E:\usb20\FCounter20\main.c
0000f6   f003                                                                                                               
                                           		/// 送受信データの処理実行                                                     E:\usb20\FCounter20\main.c
0000f8   0e06     MOVLW     0x6            		if((usb_device_state >= CONFIGURED_STATE)&&(UCONbits.SUSPND==0))               E:\usb20\FCounter20\main.c
0000fa   0100     MOVLB     0x0                                                                                             
0000fc   5dfc     SUBWF     0xfc,0x0,0x1                                                                                    
0000fe   e361     BNC       0x1c2                                                                                           
000100   506d     MOVF      0x6d,0x0,0x0                                                                                    
000102   0b02     ANDLW     0x2                                                                                             
000104   e15e     BNZ       0x1c2                                                                                           
                                           		{                                                                              E:\usb20\FCounter20\main.c
000106   0e40     MOVLW     0x40               			if(getsUSBUSART(input_buffer,64))			// データ受信ポール                   E:\usb20\FCounter20\main.c
000108   6ee6     MOVWF     0xe6,0x0                                                                                        
00010a   0e60     MOVLW     0x60                                                                                            
00010c   6ee6     MOVWF     0xe6,0x0                                                                                        
00010e   0e00     MOVLW     0x0                                                                                             
000110   6ee6     MOVWF     0xe6,0x0                                                                                        
000112   ecee     CALL      0x5dc,0x0                                                                                       
000114   f002                                                                                                               
000116   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000118   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00011a   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00011c   0900     IORLW     0x0                                                                                             
00011e   e051     BZ        0x1c2                                                                                           
                                               			{                                                                         E:\usb20\FCounter20\main.c
000120   0100     MOVLB     0x0            	    			switch(input_buffer[0])				// 最初の１文字チェック                       E:\usb20\FCounter20\main.c
000122   5160     MOVF      0x60,0x0,0x1                                                                                    
000124   0a33     XORLW     0x33                                                                                            
000126   e03c     BZ        0x1a0                                                                                           
000128   0a01     XORLW     0x1                                                                                             
00012a   e025     BZ        0x176                                                                                           
00012c   0a03     XORLW     0x3                                                                                             
00012e   e00f     BZ        0x14e                                                                                           
000130   0a01     XORLW     0x1                                                                                             
000132   e001     BZ        0x136                                                                                           
                                           	    			{                                                                        E:\usb20\FCounter20\main.c
                                           		    			case '0':						// OK応答                                                E:\usb20\FCounter20\main.c
000136   0101     MOVLB     0x1                     				if(mUSBUSARTIsTxTrfReady())                                         E:\usb20\FCounter20\main.c
000138   5149     MOVF      0x49,0x0,0x1                                                                                    
00013a   e108     BNZ       0x14c                                                                                           
00013c   0ec0     MOVLW     0xc0                      			 		putrsUSBUSART("OK");                                            E:\usb20\FCounter20\main.c
00013e   6ee6     MOVWF     0xe6,0x0                                                                                        
000140   0e13     MOVLW     0x13                                                                                            
000142   6ee6     MOVWF     0xe6,0x0                                                                                        
000144   ec6b     CALL      0x6d6,0x0                                                                                       
000146   f003                                                                                                               
000148   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00014a   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00014c   d03a     BRA       0x1c2                     			 	break;                                                           E:\usb20\FCounter20\main.c
                                                      			case '1':                                                          E:\usb20\FCounter20\main.c
00014e   6be0     CLRF      0xe0,0x1                  				Prescale = 0;                                                     E:\usb20\FCounter20\main.c
000150   0101     MOVLB     0x1                       				MsgAns[0] = '0';                                                  E:\usb20\FCounter20\main.c
000152   0e30     MOVLW     0x30                                                                                            
000154   6f46     MOVWF     0x46,0x1                                                                                        
000156   0101     MOVLB     0x1                     				if(mUSBUSARTIsTxTrfReady())                                         E:\usb20\FCounter20\main.c
000158   5149     MOVF      0x49,0x0,0x1                                                                                    
00015a   e10c     BNZ       0x174                                                                                           
00015c   0101     MOVLB     0x1                       			 		mUSBUSARTTxRam((byte*)MsgAns, 1);           				                E:\usb20\FCounter20\main.c
00015e   0e46     MOVLW     0x46                                                                                            
000160   6f4a     MOVWF     0x4a,0x1                                                                                        
000162   0e01     MOVLW     0x1                                                                                             
000164   6f4b     MOVWF     0x4b,0x1                                                                                        
000166   0101     MOVLB     0x1                                                                                             
000168   0e01     MOVLW     0x1                                                                                             
00016a   6f4e     MOVWF     0x4e,0x1                                                                                        
00016c   0101     MOVLB     0x1                                                                                             
00016e   6b4f     CLRF      0x4f,0x1                                                                                        
000170   0101     MOVLB     0x1                                                                                             
000172   6f49     MOVWF     0x49,0x1                                                                                        
000174   d026     BRA       0x1c2                     				break;                                                            E:\usb20\FCounter20\main.c
                                                      			case '2':                                                          E:\usb20\FCounter20\main.c
000176   0e01     MOVLW     0x1                       				Prescale = 1;                                                     E:\usb20\FCounter20\main.c
000178   6fe0     MOVWF     0xe0,0x1                                                                                        
00017a   0101     MOVLB     0x1                       				MsgAns[0] = '1';                                                  E:\usb20\FCounter20\main.c
00017c   0e31     MOVLW     0x31                                                                                            
00017e   6f46     MOVWF     0x46,0x1                                                                                        
000180   0101     MOVLB     0x1                     				if(mUSBUSARTIsTxTrfReady())                                         E:\usb20\FCounter20\main.c
000182   5149     MOVF      0x49,0x0,0x1                                                                                    
000184   e10c     BNZ       0x19e                                                                                           
000186   0101     MOVLB     0x1                       			 		mUSBUSARTTxRam((byte*)MsgAns, 1);            				               E:\usb20\FCounter20\main.c
000188   0e46     MOVLW     0x46                                                                                            
00018a   6f4a     MOVWF     0x4a,0x1                                                                                        
00018c   0e01     MOVLW     0x1                                                                                             
00018e   6f4b     MOVWF     0x4b,0x1                                                                                        
000190   0101     MOVLB     0x1                                                                                             
000192   0e01     MOVLW     0x1                                                                                             
000194   6f4e     MOVWF     0x4e,0x1                                                                                        
000196   0101     MOVLB     0x1                                                                                             
000198   6b4f     CLRF      0x4f,0x1                                                                                        
00019a   0101     MOVLB     0x1                                                                                             
00019c   6f49     MOVWF     0x49,0x1                                                                                        
00019e   d011     BRA       0x1c2                     				break;		    				                                                  E:\usb20\FCounter20\main.c
                                           					case '3':                                                                   E:\usb20\FCounter20\main.c
0001a0   0101     MOVLB     0x1                     				if(mUSBUSARTIsTxTrfReady())                                         E:\usb20\FCounter20\main.c
0001a2   5149     MOVF      0x49,0x0,0x1                                                                                    
0001a4   e10d     BNZ       0x1c0                                                                                           
0001a6   0101     MOVLB     0x1                       			 		mUSBUSARTTxRam((byte*)MsgSend, 10);                             E:\usb20\FCounter20\main.c
0001a8   0e12     MOVLW     0x12                                                                                            
0001aa   6f4a     MOVWF     0x4a,0x1                                                                                        
0001ac   0e01     MOVLW     0x1                                                                                             
0001ae   6f4b     MOVWF     0x4b,0x1                                                                                        
0001b0   0101     MOVLB     0x1                                                                                             
0001b2   0e0a     MOVLW     0xa                                                                                             
0001b4   6f4e     MOVWF     0x4e,0x1                                                                                        
0001b6   0101     MOVLB     0x1                                                                                             
0001b8   6b4f     CLRF      0x4f,0x1                                                                                        
0001ba   0101     MOVLB     0x1                                                                                             
0001bc   0e01     MOVLW     0x1                                                                                             
0001be   6f49     MOVWF     0x49,0x1                                                                                        
0001c0   d000     BRA       0x1c2                     			 	break;					                                                      E:\usb20\FCounter20\main.c
                                                                                                                            E:\usb20\FCounter20\main.c
000134   d046     BRA       0x1c2          		    			default: break;                                                         E:\usb20\FCounter20\main.c
                                           		    		}                                                                        E:\usb20\FCounter20\main.c
                                               			}                                                                         E:\usb20\FCounter20\main.c
                                               		}                                                                          E:\usb20\FCounter20\main.c
                                           		//// 周波数カウンタ機能実行                                                    E:\usb20\FCounter20\main.c
0001c2   a4f2     BTFSS     0xf2,0x2,0x0   		if(INTCONbits.TMR0IF)				// タイマ0オーバーフロー                              E:\usb20\FCounter20\main.c
0001c4   d007     BRA       0x1d4                                                                                           
                                            		{                                                                             E:\usb20\FCounter20\main.c
0001c6   94f2     BCF       0xf2,0x2,0x0   	 		INTCONbits.TMR0IF = 0;		                                                     E:\usb20\FCounter20\main.c
0001c8   0100     MOVLB     0x0             			FreqHigh++;					// カウンタ変数＋１                                          E:\usb20\FCounter20\main.c
0001ca   2be2     INCF      0xe2,0x1,0x1                                                                                    
0001cc   0e00     MOVLW     0x0                                                                                             
0001ce   23e3     ADDWFC    0xe3,0x1,0x1                                                                                    
0001d0   23e4     ADDWFC    0xe4,0x1,0x1                                                                                    
0001d2   23e5     ADDWFC    0xe5,0x1,0x1                                                                                    
                                            		}		                                                                           E:\usb20\FCounter20\main.c
0001d4   0101     MOVLB     0x1                		if(EndFlag == 1)					// １秒ゲート終了か？                                 E:\usb20\FCounter20\main.c
0001d6   0500     DECF      0x0,0x0,0x1                                                                                     
0001d8   e001     BZ        0x1dc                                                                                           
0001da   d088     BRA       0x2ec                                                                                           
                                               		{                                                                          E:\usb20\FCounter20\main.c
                                           	    		/// 周波数計算                                                            E:\usb20\FCounter20\main.c
0001dc   cfd6     MOVFF     0xfd6,0xe6     	    		dumy = (unsigned long)TMR0L;	                                             E:\usb20\FCounter20\main.c
0001de   f0e6                                                                                                               
0001e0   0100     MOVLB     0x0                                                                                             
0001e2   6be7     CLRF      0xe7,0x1                                                                                        
0001e4   6be8     CLRF      0xe8,0x1                                                                                        
0001e6   6be9     CLRF      0xe9,0x1                                                                                        
0001e8   50d7     MOVF      0xd7,0x0,0x0   			dumy = dumy + (unsigned long)TMR0H*256;                                       E:\usb20\FCounter20\main.c
0001ea   6e04     MOVWF     0x4,0x0                                                                                         
0001ec   6a05     CLRF      0x5,0x0                                                                                         
0001ee   6a06     CLRF      0x6,0x0                                                                                         
0001f0   6a07     CLRF      0x7,0x0                                                                                         
0001f2   6a09     CLRF      0x9,0x0                                                                                         
0001f4   0e01     MOVLW     0x1                                                                                             
0001f6   6e0a     MOVWF     0xa,0x0                                                                                         
0001f8   6a0b     CLRF      0xb,0x0                                                                                         
0001fa   6a0c     CLRF      0xc,0x0                                                                                         
0001fc   ec56     CALL      0x12ac,0x0                                                                                      
0001fe   f009                                                                                                               
000200   0100     MOVLB     0x0                                                                                             
000202   51e6     MOVF      0xe6,0x0,0x1                                                                                    
000204   2400     ADDWF     0x0,0x0,0x0                                                                                     
000206   6fe6     MOVWF     0xe6,0x1                                                                                        
000208   51e7     MOVF      0xe7,0x0,0x1                                                                                    
00020a   2001     ADDWFC    0x1,0x0,0x0                                                                                     
00020c   6fe7     MOVWF     0xe7,0x1                                                                                        
00020e   51e8     MOVF      0xe8,0x0,0x1                                                                                    
000210   2002     ADDWFC    0x2,0x0,0x0                                                                                     
000212   6fe8     MOVWF     0xe8,0x1                                                                                        
000214   51e9     MOVF      0xe9,0x0,0x1                                                                                    
000216   2003     ADDWFC    0x3,0x0,0x0                                                                                     
000218   6fe9     MOVWF     0xe9,0x1                                                                                        
00021a   51e0     MOVF      0xe0,0x0,0x1   			if(Prescale)                                                                  E:\usb20\FCounter20\main.c
00021c   e025     BZ        0x268                                                                                           
00021e   c0e2     MOVFF     0xe2,0x4       				dumy = 8*(FreqHigh*65536 + dumy);			                                         E:\usb20\FCounter20\main.c
000220   f004                                                                                                               
000222   c0e3     MOVFF     0xe3,0x5                                                                                        
000224   f005                                                                                                               
000226   c0e4     MOVFF     0xe4,0x6                                                                                        
000228   f006                                                                                                               
00022a   c0e5     MOVFF     0xe5,0x7                                                                                        
00022c   f007                                                                                                               
00022e   6a09     CLRF      0x9,0x0                                                                                         
000230   6a0a     CLRF      0xa,0x0                                                                                         
000232   0e01     MOVLW     0x1                                                                                             
000234   6e0b     MOVWF     0xb,0x0                                                                                         
000236   6a0c     CLRF      0xc,0x0                                                                                         
000238   ec56     CALL      0x12ac,0x0                                                                                      
00023a   f009                                                                                                               
00023c   5000     MOVF      0x0,0x0,0x0                                                                                     
00023e   0100     MOVLB     0x0                                                                                             
000240   25e6     ADDWF     0xe6,0x0,0x1                                                                                    
000242   6fe6     MOVWF     0xe6,0x1                                                                                        
000244   5001     MOVF      0x1,0x0,0x0                                                                                     
000246   21e7     ADDWFC    0xe7,0x0,0x1                                                                                    
000248   6fe7     MOVWF     0xe7,0x1                                                                                        
00024a   5002     MOVF      0x2,0x0,0x0                                                                                     
00024c   21e8     ADDWFC    0xe8,0x0,0x1                                                                                    
00024e   6fe8     MOVWF     0xe8,0x1                                                                                        
000250   5003     MOVF      0x3,0x0,0x0                                                                                     
000252   21e9     ADDWFC    0xe9,0x0,0x1                                                                                    
000254   6fe9     MOVWF     0xe9,0x1                                                                                        
000256   0e03     MOVLW     0x3                                                                                             
000258   90d8     BCF       0xd8,0x0,0x0                                                                                    
00025a   37e6     RLCF      0xe6,0x1,0x1                                                                                    
00025c   37e7     RLCF      0xe7,0x1,0x1                                                                                    
00025e   37e8     RLCF      0xe8,0x1,0x1                                                                                    
000260   37e9     RLCF      0xe9,0x1,0x1                                                                                    
000262   06e8     DECF      0xe8,0x1,0x0                                                                                    
000264   e1f9     BNZ       0x258                                                                                           
000266   d01c     BRA       0x2a0          			else                                                                          E:\usb20\FCounter20\main.c
000268   c0e2     MOVFF     0xe2,0x4       				dumy = FreqHigh*65536 + dumy;                                                E:\usb20\FCounter20\main.c
00026a   f004                                                                                                               
00026c   c0e3     MOVFF     0xe3,0x5                                                                                        
00026e   f005                                                                                                               
000270   c0e4     MOVFF     0xe4,0x6                                                                                        
000272   f006                                                                                                               
000274   c0e5     MOVFF     0xe5,0x7                                                                                        
000276   f007                                                                                                               
000278   6a09     CLRF      0x9,0x0                                                                                         
00027a   6a0a     CLRF      0xa,0x0                                                                                         
00027c   0e01     MOVLW     0x1                                                                                             
00027e   6e0b     MOVWF     0xb,0x0                                                                                         
000280   6a0c     CLRF      0xc,0x0                                                                                         
000282   ec56     CALL      0x12ac,0x0                                                                                      
000284   f009                                                                                                               
000286   5000     MOVF      0x0,0x0,0x0                                                                                     
000288   0100     MOVLB     0x0                                                                                             
00028a   25e6     ADDWF     0xe6,0x0,0x1                                                                                    
00028c   6fe6     MOVWF     0xe6,0x1                                                                                        
00028e   5001     MOVF      0x1,0x0,0x0                                                                                     
000290   21e7     ADDWFC    0xe7,0x0,0x1                                                                                    
000292   6fe7     MOVWF     0xe7,0x1                                                                                        
000294   5002     MOVF      0x2,0x0,0x0                                                                                     
000296   21e8     ADDWFC    0xe8,0x0,0x1                                                                                    
000298   6fe8     MOVWF     0xe8,0x1                                                                                        
00029a   5003     MOVF      0x3,0x0,0x0                                                                                     
00029c   21e9     ADDWFC    0xe9,0x0,0x1                                                                                    
00029e   6fe9     MOVWF     0xe9,0x1                                                                                        
                                           			// 周波数表示			                                                              E:\usb20\FCounter20\main.c
0002a0   c0e6     MOVFF     0xe6,0xfe6     	    		Display(dumy);                                                            E:\usb20\FCounter20\main.c
0002a2   ffe6                                                                                                               
0002a4   c0e7     MOVFF     0xe7,0xfe6                                                                                      
0002a6   ffe6                                                                                                               
0002a8   c0e8     MOVFF     0xe8,0xfe6                                                                                      
0002aa   ffe6                                                                                                               
0002ac   c0e9     MOVFF     0xe9,0xfe6                                                                                      
0002ae   ffe6                                                                                                               
0002b0   d82a     RCALL     0x306                                                                                           
0002b2   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0002b4   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0002b6   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0002b8   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                           			// 次の計測準備                                                               E:\usb20\FCounter20\main.c
0002ba   0100     MOVLB     0x0            			if(Prescale)                                                                  E:\usb20\FCounter20\main.c
0002bc   51e0     MOVF      0xe0,0x0,0x1                                                                                    
0002be   e004     BZ        0x2c8                                                                                           
                                           			{                                                                             E:\usb20\FCounter20\main.c
0002c0   0e22     MOVLW     0x22           				T0CON = 0x22;				// 1/8                                                      E:\usb20\FCounter20\main.c
0002c2   6ed5     MOVWF     0xd5,0x0                                                                                        
0002c4   8e8b     BSF       0x8b,0x7,0x0   				RedLED = 1;				// LED Off                                                    E:\usb20\FCounter20\main.c
                                           			}                                                                             E:\usb20\FCounter20\main.c
0002c6   d003     BRA       0x2ce          			else                                                                          E:\usb20\FCounter20\main.c
                                           			{                                                                             E:\usb20\FCounter20\main.c
0002c8   0e28     MOVLW     0x28           				T0CON = 0x28;				// 1/1                                                      E:\usb20\FCounter20\main.c
0002ca   6ed5     MOVWF     0xd5,0x0                                                                                        
0002cc   9e8b     BCF       0x8b,0x7,0x0   				RedLED = 0;				// LED On                                                     E:\usb20\FCounter20\main.c
                                           			}                                                                             E:\usb20\FCounter20\main.c
0002ce   0101     MOVLB     0x1            	    		EndFlag = 0;                                                              E:\usb20\FCounter20\main.c
0002d0   6b00     CLRF      0x0,0x1                                                                                         
0002d2   6ad7     CLRF      0xd7,0x0       	    		TMR0H = 0;					// reset counter                                           E:\usb20\FCounter20\main.c
0002d4   6ad6     CLRF      0xd6,0x0       	    		TMR0L = 0;                                                                E:\usb20\FCounter20\main.c
0002d6   0100     MOVLB     0x0            			FreqHigh = 0;                                                                 E:\usb20\FCounter20\main.c
0002d8   6be2     CLRF      0xe2,0x1                                                                                        
0002da   6be3     CLRF      0xe3,0x1                                                                                        
0002dc   6be4     CLRF      0xe4,0x1                                                                                        
0002de   6be5     CLRF      0xe5,0x1                                                                                        
0002e0   0e19     MOVLW     0x19           	    		SecCounter = 25;				// Reset 1 sec counter                                E:\usb20\FCounter20\main.c
0002e2   6fe1     MOVWF     0xe1,0x1                                                                                        
0002e4   6acf     CLRF      0xcf,0x0       	    		TMR1H = 0;					// Reset Timer1                                            E:\usb20\FCounter20\main.c
0002e6   6ace     CLRF      0xce,0x0       			TMR1L = 0;                                                                    E:\usb20\FCounter20\main.c
                                           			// 次の計測開始                                                               E:\usb20\FCounter20\main.c
0002e8   80cd     BSF       0xcd,0x0,0x0   			T1CONbits.TMR1ON = 1;                                                         E:\usb20\FCounter20\main.c
0002ea   8ed5     BSF       0xd5,0x7,0x0   	    		T0CONbits.TMR0ON = 1;			// Start Count                                    E:\usb20\FCounter20\main.c
                                           	    }		                                                                         E:\usb20\FCounter20\main.c
                                                }                                                                           E:\usb20\FCounter20\main.c
0002ee   6ef5     MOVWF     0xf5,0x0       }                                                                                E:\usb20\FCounter20\main.c
0002f0   0e02     MOVLW     0x2                                                                                             
0002f2   5ce1     SUBWF     0xe1,0x0,0x0                                                                                    
0002f4   e202     BC        0x2fa                                                                                           
0002f6   6ae1     CLRF      0xe1,0x0                                                                                        
0002f8   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0002fa   6ee1     MOVWF     0xe1,0x0                                                                                        
0002fc   50f5     MOVF      0xf5,0x0,0x0                                                                                    
0002fe   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000300   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
000302   ffd9                                                                                                               
000304   0012     RETURN    0x0                                                                                             
                                                                                                                            E:\usb20\FCounter20\main.c
                                           /// データ表示関数                                                               E:\usb20\FCounter20\main.c
000306   cfd9     MOVFF     0xfd9,0xfe6    void Display(unsigned long Freq)                                                 E:\usb20\FCounter20\main.c
000308   ffe6                                                                                                               
00030a   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
00030c   ffd9                                                                                                               
                                           {                                                                                E:\usb20\FCounter20\main.c
                                           	//// 周波数可変幅表示                                                           E:\usb20\FCounter20\main.c
00030e   0e80     MOVLW     0x80           	lcd_cmd(0x80);						//１行目へ                                                  E:\usb20\FCounter20\main.c
000310   6ee6     MOVWF     0xe6,0x0                                                                                        
000312   ec5c     CALL      0xeb8,0x0                                                                                       
000314   f007                                                                                                               
000316   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000318   0e07     MOVLW     0x7            	ltostring(8, Freq, &MsgFreq[0]+6);		// 周波数表示                               E:\usb20\FCounter20\main.c
00031a   6ee6     MOVWF     0xe6,0x0                                                                                        
00031c   0e01     MOVLW     0x1                                                                                             
00031e   6ee6     MOVWF     0xe6,0x0                                                                                        
000320   50d9     MOVF      0xd9,0x0,0x0                                                                                    
000322   0ffb     ADDLW     0xfb                                                                                            
000324   6ee9     MOVWF     0xe9,0x0                                                                                        
000326   0eff     MOVLW     0xff                                                                                            
000328   20da     ADDWFC    0xda,0x0,0x0                                                                                    
00032a   6eea     MOVWF     0xea,0x0                                                                                        
00032c   cfee     MOVFF     0xfee,0xfe6                                                                                     
00032e   ffe6                                                                                                               
000330   cfee     MOVFF     0xfee,0xfe6                                                                                     
000332   ffe6                                                                                                               
000334   cfee     MOVFF     0xfee,0xfe6                                                                                     
000336   ffe6                                                                                                               
000338   cfef     MOVFF     0xfef,0xfe6                                                                                     
00033a   ffe6                                                                                                               
00033c   0e08     MOVLW     0x8                                                                                             
00033e   6ee6     MOVWF     0xe6,0x0                                                                                        
000340   d842     RCALL     0x3c6                                                                                           
000342   6ef5     MOVWF     0xf5,0x0                                                                                        
000344   0e07     MOVLW     0x7                                                                                             
000346   5ee1     SUBWF     0xe1,0x1,0x0                                                                                    
000348   50f5     MOVF      0xf5,0x0,0x0                                                                                    
00034a   0e12     MOVLW     0x12           	ltostring(8, Freq, &MsgSend[0]);                                                E:\usb20\FCounter20\main.c
00034c   6ee6     MOVWF     0xe6,0x0                                                                                        
00034e   0e01     MOVLW     0x1                                                                                             
000350   6ee6     MOVWF     0xe6,0x0                                                                                        
000352   50d9     MOVF      0xd9,0x0,0x0                                                                                    
000354   0ffb     ADDLW     0xfb                                                                                            
000356   6ee9     MOVWF     0xe9,0x0                                                                                        
000358   0eff     MOVLW     0xff                                                                                            
00035a   20da     ADDWFC    0xda,0x0,0x0                                                                                    
00035c   6eea     MOVWF     0xea,0x0                                                                                        
00035e   cfee     MOVFF     0xfee,0xfe6                                                                                     
000360   ffe6                                                                                                               
000362   cfee     MOVFF     0xfee,0xfe6                                                                                     
000364   ffe6                                                                                                               
000366   cfee     MOVFF     0xfee,0xfe6                                                                                     
000368   ffe6                                                                                                               
00036a   cfef     MOVFF     0xfef,0xfe6                                                                                     
00036c   ffe6                                                                                                               
00036e   0e08     MOVLW     0x8                                                                                             
000370   6ee6     MOVWF     0xe6,0x0                                                                                        
000372   d829     RCALL     0x3c6                                                                                           
000374   6ef5     MOVWF     0xf5,0x0                                                                                        
000376   0e07     MOVLW     0x7                                                                                             
000378   5ee1     SUBWF     0xe1,0x1,0x0                                                                                    
00037a   50f5     MOVF      0xf5,0x0,0x0                                                                                    
00037c   0e01     MOVLW     0x1            	lcd_str((char *)MsgFreq);				// 見出し表示                                      E:\usb20\FCounter20\main.c
00037e   6ee6     MOVWF     0xe6,0x0                                                                                        
000380   0e01     MOVLW     0x1                                                                                             
000382   6ee6     MOVWF     0xe6,0x0                                                                                        
000384   ec89     CALL      0xf12,0x0                                                                                       
000386   f007                                                                                                               
000388   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00038a   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00038c   0ec0     MOVLW     0xc0           	lcd_cmd(0xC0);						// 2行目へ                                                  E:\usb20\FCounter20\main.c
00038e   6ee6     MOVWF     0xe6,0x0                                                                                        
000390   ec5c     CALL      0xeb8,0x0                                                                                       
000392   f007                                                                                                               
000394   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000396   0100     MOVLB     0x0            	if(Prescale)                                                                    E:\usb20\FCounter20\main.c
000398   51e0     MOVF      0xe0,0x0,0x1                                                                                    
00039a   e009     BZ        0x3ae                                                                                           
00039c   0e24     MOVLW     0x24           		lcd_str(MsgPre8);                                                              E:\usb20\FCounter20\main.c
00039e   6ee6     MOVWF     0xe6,0x0                                                                                        
0003a0   0e01     MOVLW     0x1                                                                                             
0003a2   6ee6     MOVWF     0xe6,0x0                                                                                        
0003a4   ec89     CALL      0xf12,0x0                                                                                       
0003a6   f007                                                                                                               
0003a8   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0003aa   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0003ac   d008     BRA       0x3be          	else                                                                            E:\usb20\FCounter20\main.c
0003ae   0e35     MOVLW     0x35           		lcd_str(MsgPre1);                                                              E:\usb20\FCounter20\main.c
0003b0   6ee6     MOVWF     0xe6,0x0                                                                                        
0003b2   0e01     MOVLW     0x1                                                                                             
0003b4   6ee6     MOVWF     0xe6,0x0                                                                                        
0003b6   ec89     CALL      0xf12,0x0                                                                                       
0003b8   f007                                                                                                               
0003ba   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0003bc   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0003be   52e5     MOVF      0xe5,0x1,0x0   }                                                                                E:\usb20\FCounter20\main.c
0003c0   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
0003c2   ffd9                                                                                                               
0003c4   0012     RETURN    0x0                                                                                             
                                                                                                                            E:\usb20\FCounter20\main.c
                                           ///// 数値から文字列に変換                                                       E:\usb20\FCounter20\main.c
0003c6   cfd9     MOVFF     0xfd9,0xfe6    void ltostring(char digit, unsigned long data, char *buffer)                     E:\usb20\FCounter20\main.c
0003c8   ffe6                                                                                                               
0003ca   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
0003cc   ffd9                                                                                                               
0003ce   52e6     MOVF      0xe6,0x1,0x0                                                                                    
                                           {                                                                                E:\usb20\FCounter20\main.c
                                           	char i;                                                                         E:\usb20\FCounter20\main.c
0003d0   0efe     MOVLW     0xfe           	buffer += digit;					// 文字列の最後                                            E:\usb20\FCounter20\main.c
0003d2   cfdb     MOVFF     0xfdb,0x10                                                                                      
0003d4   f010                                                                                                               
0003d6   6a11     CLRF      0x11,0x0                                                                                        
0003d8   be10     BTFSC     0x10,0x7,0x0                                                                                    
0003da   6811     SETF      0x11,0x0                                                                                        
0003dc   50d9     MOVF      0xd9,0x0,0x0                                                                                    
0003de   0ff8     ADDLW     0xf8                                                                                            
0003e0   6ee9     MOVWF     0xe9,0x0                                                                                        
0003e2   0eff     MOVLW     0xff                                                                                            
0003e4   20da     ADDWFC    0xda,0x0,0x0                                                                                    
0003e6   6eea     MOVWF     0xea,0x0                                                                                        
0003e8   5010     MOVF      0x10,0x0,0x0                                                                                    
0003ea   26ee     ADDWF     0xee,0x1,0x0                                                                                    
0003ec   5011     MOVF      0x11,0x0,0x0                                                                                    
0003ee   22ed     ADDWFC    0xed,0x1,0x0                                                                                    
0003f0   0efe     MOVLW     0xfe           	for(i=digit; i>0; i--) {			// 最下位桁から上位へ                                E:\usb20\FCounter20\main.c
0003f2   50db     MOVF      0xdb,0x0,0x0                                                                                    
0003f4   6edf     MOVWF     0xdf,0x0                                                                                        
0003f6   cfdf     MOVFF     0xfdf,0x10                                                                                      
0003f8   f010                                                                                                               
0003fa   0e00     MOVLW     0x0                                                                                             
0003fc   6ee7     MOVWF     0xe7,0x0                                                                                        
0003fe   1810     XORWF     0x10,0x0,0x0                                                                                    
000400   aee8     BTFSS     0xe8,0x7,0x0                                                                                    
000402   d002     BRA       0x408                                                                                           
000404   3410     RLCF      0x10,0x0,0x0                                                                                    
000406   d003     BRA       0x40e                                                                                           
000408   50e7     MOVF      0xe7,0x0,0x0                                                                                    
00040a   80d8     BSF       0xd8,0x0,0x0                                                                                    
00040c   5410     SUBFWB    0x10,0x0,0x0                                                                                    
00040e   e257     BC        0x4be                                                                                           
0004ba   06df     DECF      0xdf,0x1,0x0                                                                                    
0004bc   d79c     BRA       0x3f6                                                                                           
000410   0ef8     MOVLW     0xf8           		buffer--;					// ポインター１                                                  E:\usb20\FCounter20\main.c
000412   06db     DECF      0xdb,0x1,0x0                                                                                    
000414   0ef9     MOVLW     0xf9                                                                                            
000416   e201     BC        0x41a                                                                                           
000418   06db     DECF      0xdb,0x1,0x0                                                                                    
00041a   0efa     MOVLW     0xfa           		*buffer = (data % 10) + '0';	// その桁数値を文字にして格納                     E:\usb20\FCounter20\main.c
00041c   cfdb     MOVFF     0xfdb,0x10                                                                                      
00041e   f010                                                                                                               
000420   0efb     MOVLW     0xfb                                                                                            
000422   cfdb     MOVFF     0xfdb,0x11                                                                                      
000424   f011                                                                                                               
000426   0efc     MOVLW     0xfc                                                                                            
000428   cfdb     MOVFF     0xfdb,0x12                                                                                      
00042a   f012                                                                                                               
00042c   0efd     MOVLW     0xfd                                                                                            
00042e   cfdb     MOVFF     0xfdb,0x13                                                                                      
000430   f013                                                                                                               
000432   0e0a     MOVLW     0xa                                                                                             
000434   6e09     MOVWF     0x9,0x0                                                                                         
000436   6a0a     CLRF      0xa,0x0                                                                                         
000438   6a0b     CLRF      0xb,0x0                                                                                         
00043a   6a0c     CLRF      0xc,0x0                                                                                         
00043c   c010     MOVFF     0x10,0x4                                                                                        
00043e   f004                                                                                                               
000440   c011     MOVFF     0x11,0x5                                                                                        
000442   f005                                                                                                               
000444   c012     MOVFF     0x12,0x6                                                                                        
000446   f006                                                                                                               
000448   c013     MOVFF     0x13,0x7                                                                                        
00044a   f007                                                                                                               
00044c   ec8e     CALL      0x131c,0x0                                                                                      
00044e   f009                                                                                                               
000450   c000     MOVFF     0x0,0x10                                                                                        
000452   f010                                                                                                               
000454   c001     MOVFF     0x1,0x11                                                                                        
000456   f011                                                                                                               
000458   c002     MOVFF     0x2,0x12                                                                                        
00045a   f012                                                                                                               
00045c   c003     MOVFF     0x3,0x13                                                                                        
00045e   f013                                                                                                               
000460   0e30     MOVLW     0x30                                                                                            
000462   2610     ADDWF     0x10,0x1,0x0                                                                                    
000464   0e00     MOVLW     0x0                                                                                             
000466   2211     ADDWFC    0x11,0x1,0x0                                                                                    
000468   2212     ADDWFC    0x12,0x1,0x0                                                                                    
00046a   2213     ADDWFC    0x13,0x1,0x0                                                                                    
00046c   0ef8     MOVLW     0xf8                                                                                            
00046e   cfdb     MOVFF     0xfdb,0xfe9                                                                                     
000470   ffe9                                                                                                               
000472   0ef9     MOVLW     0xf9                                                                                            
000474   cfdb     MOVFF     0xfdb,0xfea                                                                                     
000476   ffea                                                                                                               
000478   c010     MOVFF     0x10,0xfef                                                                                      
00047a   ffef                                                                                                               
00047c   0efa     MOVLW     0xfa           		data = data / 10;				// 桁-1                                                   E:\usb20\FCounter20\main.c
00047e   cfdb     MOVFF     0xfdb,0x4                                                                                       
000480   f004                                                                                                               
000482   0efb     MOVLW     0xfb                                                                                            
000484   cfdb     MOVFF     0xfdb,0x5                                                                                       
000486   f005                                                                                                               
000488   0efc     MOVLW     0xfc                                                                                            
00048a   cfdb     MOVFF     0xfdb,0x6                                                                                       
00048c   f006                                                                                                               
00048e   0efd     MOVLW     0xfd                                                                                            
000490   cfdb     MOVFF     0xfdb,0x7                                                                                       
000492   f007                                                                                                               
000494   0e0a     MOVLW     0xa                                                                                             
000496   6e09     MOVWF     0x9,0x0                                                                                         
000498   6a0a     CLRF      0xa,0x0                                                                                         
00049a   6a0b     CLRF      0xb,0x0                                                                                         
00049c   6a0c     CLRF      0xc,0x0                                                                                         
00049e   ec8e     CALL      0x131c,0x0                                                                                      
0004a0   f009                                                                                                               
0004a2   0efa     MOVLW     0xfa                                                                                            
0004a4   c004     MOVFF     0x4,0xfdb                                                                                       
0004a6   ffdb                                                                                                               
0004a8   0efb     MOVLW     0xfb                                                                                            
0004aa   c005     MOVFF     0x5,0xfdb                                                                                       
0004ac   ffdb                                                                                                               
0004ae   0efc     MOVLW     0xfc                                                                                            
0004b0   c006     MOVFF     0x6,0xfdb                                                                                       
0004b2   ffdb                                                                                                               
0004b4   0efd     MOVLW     0xfd                                                                                            
0004b6   c007     MOVFF     0x7,0xfdb                                                                                       
0004b8   ffdb                                                                                                               
                                           	}                                                                               E:\usb20\FCounter20\main.c
0004be   52e5     MOVF      0xe5,0x1,0x0   }                                                                                E:\usb20\FCounter20\main.c
0004c0   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0004c2   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
0004c4   ffd9                                                                                                               
0004c6   0012     RETURN    0x0                                                                                             
                                                                                                                            E:\usb20\FCounter20\main.c
                                                                                                                            E:\usb20\FCounter20\main.c
                                           ///////////////////////////////////////////////                                  E:\usb20\FCounter20\lcd_lib.c
                                           //  液晶表示器制御ライブラリ　for PIC18Fxxxx                                     E:\usb20\FCounter20\lcd_lib.c
                                           //  内蔵関数は以下                                                               E:\usb20\FCounter20\lcd_lib.c
                                           //    lcd_init()    ----- 初期化                                                 E:\usb20\FCounter20\lcd_lib.c
                                           //    lcd_cmd(cmd)  ----- コマンド出力                                           E:\usb20\FCounter20\lcd_lib.c
                                           //    lcd_data(chr) ----- １文字表示出力                                         E:\usb20\FCounter20\lcd_lib.c
                                           //    lcd_clear()   ----- 全消去                                                 E:\usb20\FCounter20\lcd_lib.c
                                           //////////////////////////////////////////////                                   E:\usb20\FCounter20\lcd_lib.c
                                           #include <p18cxxx.h>                                                             E:\usb20\FCounter20\lcd_lib.c
                                           #include "io_cfg.h"                                                              E:\usb20\FCounter20\lcd_lib.c
                                           #include	"delays.h"                                                              E:\usb20\FCounter20\lcd_lib.c
                                           #include "lcd_lib.h"                                                             E:\usb20\FCounter20\lcd_lib.c
                                                                                                                            E:\usb20\FCounter20\lcd_lib.c
                                           //////// データ出力サブ関数                                                      E:\usb20\FCounter20\lcd_lib.c
000e4c   cfd9     MOVFF     0xfd9,0xfe6    void lcd_out(char code, char flag)                                               E:\usb20\FCounter20\lcd_lib.c
000e4e   ffe6                                                                                                               
000e50   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
000e52   ffd9                                                                                                               
                                           {                                                                                E:\usb20\FCounter20\lcd_lib.c
000e54   0efe     MOVLW     0xfe           	lcd_port = code & 0xF0;                                                         E:\usb20\FCounter20\lcd_lib.c
000e56   50db     MOVF      0xdb,0x0,0x0                                                                                    
000e58   0bf0     ANDLW     0xf0                                                                                            
000e5a   6e8a     MOVWF     0x8a,0x0                                                                                        
000e5c   0efd     MOVLW     0xfd           	if (flag == 0)                                                                  E:\usb20\FCounter20\lcd_lib.c
000e5e   50db     MOVF      0xdb,0x0,0x0                                                                                    
000e60   e102     BNZ       0xe66                                                                                           
000e62   848a     BSF       0x8a,0x2,0x0   		lcd_rs = 1;			//表示データの場合                                               E:\usb20\FCounter20\lcd_lib.c
000e64   d001     BRA       0xe68          	else                                                                            E:\usb20\FCounter20\lcd_lib.c
000e66   948a     BCF       0x8a,0x2,0x0   		lcd_rs = 0;			//コマンドデータの場合                                           E:\usb20\FCounter20\lcd_lib.c
000e68   0000     NOP                      	Delay1TCY();				//NOP		                                                         E:\usb20\FCounter20\lcd_lib.c
000e6a   868a     BSF       0x8a,0x3,0x0   	lcd_stb = 1;				//strobe out                                                    E:\usb20\FCounter20\lcd_lib.c
000e6c   0e01     MOVLW     0x1            	Delay10TCYx(1);			//10NOP                                                       E:\usb20\FCounter20\lcd_lib.c
000e6e   6ee6     MOVWF     0xe6,0x0                                                                                        
000e70   ecd5     CALL      0x13aa,0x0                                                                                      
000e72   f009                                                                                                               
000e74   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000e76   968a     BCF       0x8a,0x3,0x0   	lcd_stb = 0;				//reset strobe                                                  E:\usb20\FCounter20\lcd_lib.c
000e78   52e5     MOVF      0xe5,0x1,0x0   }                                                                                E:\usb20\FCounter20\lcd_lib.c
000e7a   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
000e7c   ffd9                                                                                                               
000e7e   0012     RETURN    0x0                                                                                             
                                           //////// １文字表示関数                                                          E:\usb20\FCounter20\lcd_lib.c
000e80   cfd9     MOVFF     0xfd9,0xfe6    void lcd_data(char asci)                                                         E:\usb20\FCounter20\lcd_lib.c
000e82   ffe6                                                                                                               
000e84   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
000e86   ffd9                                                                                                               
                                           {                                                                                E:\usb20\FCounter20\lcd_lib.c
000e88   6ae6     CLRF      0xe6,0x0       	lcd_out(asci, 0);			//上位４ビット出力                                          E:\usb20\FCounter20\lcd_lib.c
000e8a   0efe     MOVLW     0xfe                                                                                            
000e8c   cfdb     MOVFF     0xfdb,0xfe6                                                                                     
000e8e   ffe6                                                                                                               
000e90   dfdd     RCALL     0xe4c                                                                                           
000e92   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000e94   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000e96   6ae6     CLRF      0xe6,0x0       	lcd_out(asci<<4, 0);		//下位４ビット出力                                        E:\usb20\FCounter20\lcd_lib.c
000e98   0efe     MOVLW     0xfe                                                                                            
000e9a   38db     SWAPF     0xdb,0x0,0x0                                                                                    
000e9c   0bf0     ANDLW     0xf0                                                                                            
000e9e   6ee6     MOVWF     0xe6,0x0                                                                                        
000ea0   dfd5     RCALL     0xe4c                                                                                           
000ea2   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000ea4   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000ea6   0e32     MOVLW     0x32           	Delay10TCYx(50);			//50μsec待ち                                                E:\usb20\FCounter20\lcd_lib.c
000ea8   6ee6     MOVWF     0xe6,0x0                                                                                        
000eaa   ecd5     CALL      0x13aa,0x0                                                                                      
000eac   f009                                                                                                               
000eae   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000eb0   52e5     MOVF      0xe5,0x1,0x0   }                                                                                E:\usb20\FCounter20\lcd_lib.c
000eb2   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
000eb4   ffd9                                                                                                               
000eb6   0012     RETURN    0x0                                                                                             
                                           /////// コマンド出力関数                                                         E:\usb20\FCounter20\lcd_lib.c
000eb8   cfd9     MOVFF     0xfd9,0xfe6    void lcd_cmd(char cmd)                                                           E:\usb20\FCounter20\lcd_lib.c
000eba   ffe6                                                                                                               
000ebc   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
000ebe   ffd9                                                                                                               
                                           {                                                                                E:\usb20\FCounter20\lcd_lib.c
000ec0   0e01     MOVLW     0x1            	lcd_out(cmd, 1);			//上位４ビット出力                                           E:\usb20\FCounter20\lcd_lib.c
000ec2   6ee6     MOVWF     0xe6,0x0                                                                                        
000ec4   0efe     MOVLW     0xfe                                                                                            
000ec6   cfdb     MOVFF     0xfdb,0xfe6                                                                                     
000ec8   ffe6                                                                                                               
000eca   dfc0     RCALL     0xe4c                                                                                           
000ecc   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000ece   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000ed0   0e01     MOVLW     0x1            	lcd_out(cmd<<4, 1);		//下位４ビット出力                                         E:\usb20\FCounter20\lcd_lib.c
000ed2   6ee6     MOVWF     0xe6,0x0                                                                                        
000ed4   0efe     MOVLW     0xfe                                                                                            
000ed6   38db     SWAPF     0xdb,0x0,0x0                                                                                    
000ed8   0bf0     ANDLW     0xf0                                                                                            
000eda   6ee6     MOVWF     0xe6,0x0                                                                                        
000edc   dfb7     RCALL     0xe4c                                                                                           
000ede   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000ee0   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000ee2   0efe     MOVLW     0xfe           	if((cmd & 0x03) != 0)                                                           E:\usb20\FCounter20\lcd_lib.c
000ee4   50db     MOVF      0xdb,0x0,0x0                                                                                    
000ee6   0b03     ANDLW     0x3                                                                                             
000ee8   e006     BZ        0xef6                                                                                           
000eea   0e02     MOVLW     0x2            		Delay10KTCYx(2);		//2msec待ち                                                  E:\usb20\FCounter20\lcd_lib.c
000eec   6ee6     MOVWF     0xe6,0x0                                                                                        
000eee   ecb2     CALL      0x1364,0x0                                                                                      
000ef0   f009                                                                                                               
000ef2   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000ef4   d005     BRA       0xf00          	else                                                                            E:\usb20\FCounter20\lcd_lib.c
000ef6   0e32     MOVLW     0x32           		Delay10TCYx(50);		//50usec待ち                                                 E:\usb20\FCounter20\lcd_lib.c
000ef8   6ee6     MOVWF     0xe6,0x0                                                                                        
000efa   ecd5     CALL      0x13aa,0x0                                                                                      
000efc   f009                                                                                                               
000efe   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000f00   52e5     MOVF      0xe5,0x1,0x0   }                                                                                E:\usb20\FCounter20\lcd_lib.c
000f02   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
000f04   ffd9                                                                                                               
000f06   0012     RETURN    0x0                                                                                             
                                           /////// 全消去関数                                                               E:\usb20\FCounter20\lcd_lib.c
                                           void lcd_clear(void)                                                             E:\usb20\FCounter20\lcd_lib.c
                                           {                                                                                E:\usb20\FCounter20\lcd_lib.c
000f08   0e01     MOVLW     0x1            	lcd_cmd(0x01);			//初期化コマンド出力                                           E:\usb20\FCounter20\lcd_lib.c
000f0a   6ee6     MOVWF     0xe6,0x0                                                                                        
000f0c   dfd5     RCALL     0xeb8                                                                                           
000f0e   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000f10   0012     RETURN    0x0            }                                                                                E:\usb20\FCounter20\lcd_lib.c
                                                                                                                            E:\usb20\FCounter20\lcd_lib.c
                                           /////// 文字列出力関数                                                           E:\usb20\FCounter20\lcd_lib.c
000f12   cfd9     MOVFF     0xfd9,0xfe6    void lcd_str(char *str)                                                          E:\usb20\FCounter20\lcd_lib.c
000f14   ffe6                                                                                                               
000f16   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
000f18   ffd9                                                                                                               
                                           {                                                                                E:\usb20\FCounter20\lcd_lib.c
000f1a   0efd     MOVLW     0xfd           	while(*str != 0x00)			//文字列の終わり判定                                      E:\usb20\FCounter20\lcd_lib.c
000f1c   cfdb     MOVFF     0xfdb,0xfe9                                                                                     
000f1e   ffe9                                                                                                               
000f20   0efe     MOVLW     0xfe                                                                                            
000f22   cfdb     MOVFF     0xfdb,0xfea                                                                                     
000f24   ffea                                                                                                               
000f26   50ef     MOVF      0xef,0x0,0x0                                                                                    
000f28   e010     BZ        0xf4a                                                                                           
000f48   d7e8     BRA       0xf1a                                                                                           
                                           	{                                                                               E:\usb20\FCounter20\lcd_lib.c
000f2a   0efd     MOVLW     0xfd           		lcd_data(*str);			//文字列１文字出力                                           E:\usb20\FCounter20\lcd_lib.c
000f2c   cfdb     MOVFF     0xfdb,0xfe9                                                                                     
000f2e   ffe9                                                                                                               
000f30   0efe     MOVLW     0xfe                                                                                            
000f32   cfdb     MOVFF     0xfdb,0xfea                                                                                     
000f34   ffea                                                                                                               
000f36   50ef     MOVF      0xef,0x0,0x0                                                                                    
000f38   6ee6     MOVWF     0xe6,0x0                                                                                        
000f3a   dfa2     RCALL     0xe80                                                                                           
000f3c   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000f3e   0efd     MOVLW     0xfd           		str++;					//ポインタ＋１                                                      E:\usb20\FCounter20\lcd_lib.c
000f40   2adb     INCF      0xdb,0x1,0x0                                                                                    
000f42   0efe     MOVLW     0xfe                                                                                            
000f44   e301     BNC       0xf48                                                                                           
000f46   2adb     INCF      0xdb,0x1,0x0                                                                                    
                                           	}                                                                               E:\usb20\FCounter20\lcd_lib.c
000f4a   52e5     MOVF      0xe5,0x1,0x0   }                                                                                E:\usb20\FCounter20\lcd_lib.c
000f4c   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
000f4e   ffd9                                                                                                               
000f50   0012     RETURN    0x0                                                                                             
                                                                                                                            E:\usb20\FCounter20\lcd_lib.c
                                           /////// 初期化関数                                                               E:\usb20\FCounter20\lcd_lib.c
                                           void lcd_init(void)                                                              E:\usb20\FCounter20\lcd_lib.c
                                           {                                                                                E:\usb20\FCounter20\lcd_lib.c
000f52   0e14     MOVLW     0x14           	Delay10KTCYx(20);                                                               E:\usb20\FCounter20\lcd_lib.c
000f54   6ee6     MOVWF     0xe6,0x0                                                                                        
000f56   ecb2     CALL      0x1364,0x0                                                                                      
000f58   f009                                                                                                               
000f5a   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000f5c   0e01     MOVLW     0x1            	lcd_out(0x30, 1);			//8bit mode set                                             E:\usb20\FCounter20\lcd_lib.c
000f5e   6ee6     MOVWF     0xe6,0x0                                                                                        
000f60   0e30     MOVLW     0x30                                                                                            
000f62   6ee6     MOVWF     0xe6,0x0                                                                                        
000f64   df73     RCALL     0xe4c                                                                                           
000f66   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000f68   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000f6a   0e05     MOVLW     0x5            	Delay10KTCYx(5);                                                                E:\usb20\FCounter20\lcd_lib.c
000f6c   6ee6     MOVWF     0xe6,0x0                                                                                        
000f6e   ecb2     CALL      0x1364,0x0                                                                                      
000f70   f009                                                                                                               
000f72   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000f74   0e01     MOVLW     0x1            	lcd_out(0x30, 1);			//8bit mode set                                             E:\usb20\FCounter20\lcd_lib.c
000f76   6ee6     MOVWF     0xe6,0x0                                                                                        
000f78   0e30     MOVLW     0x30                                                                                            
000f7a   6ee6     MOVWF     0xe6,0x0                                                                                        
000f7c   df67     RCALL     0xe4c                                                                                           
000f7e   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000f80   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000f82   0e01     MOVLW     0x1            	Delay10KTCYx(1);                                                                E:\usb20\FCounter20\lcd_lib.c
000f84   6ee6     MOVWF     0xe6,0x0                                                                                        
000f86   ecb2     CALL      0x1364,0x0                                                                                      
000f88   f009                                                                                                               
000f8a   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000f8c   0e01     MOVLW     0x1            	lcd_out(0x30, 1);			//8bit mode set                                             E:\usb20\FCounter20\lcd_lib.c
000f8e   6ee6     MOVWF     0xe6,0x0                                                                                        
000f90   0e30     MOVLW     0x30                                                                                            
000f92   6ee6     MOVWF     0xe6,0x0                                                                                        
000f94   df5b     RCALL     0xe4c                                                                                           
000f96   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000f98   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000f9a   0e01     MOVLW     0x1            	Delay10KTCYx(1);                                                                E:\usb20\FCounter20\lcd_lib.c
000f9c   6ee6     MOVWF     0xe6,0x0                                                                                        
000f9e   ecb2     CALL      0x1364,0x0                                                                                      
000fa0   f009                                                                                                               
000fa2   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000fa4   0e01     MOVLW     0x1            	lcd_out(0x20, 1);			//4bit mode set                                             E:\usb20\FCounter20\lcd_lib.c
000fa6   6ee6     MOVWF     0xe6,0x0                                                                                        
000fa8   0e20     MOVLW     0x20                                                                                            
000faa   6ee6     MOVWF     0xe6,0x0                                                                                        
000fac   df4f     RCALL     0xe4c                                                                                           
000fae   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000fb0   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000fb2   0e01     MOVLW     0x1            	Delay10KTCYx(1);                                                                E:\usb20\FCounter20\lcd_lib.c
000fb4   6ee6     MOVWF     0xe6,0x0                                                                                        
000fb6   ecb2     CALL      0x1364,0x0                                                                                      
000fb8   f009                                                                                                               
000fba   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000fbc   0e2e     MOVLW     0x2e           	lcd_cmd(0x2E);			//DL=0 4bit mode                                               E:\usb20\FCounter20\lcd_lib.c
000fbe   6ee6     MOVWF     0xe6,0x0                                                                                        
000fc0   df7b     RCALL     0xeb8                                                                                           
000fc2   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000fc4   0e08     MOVLW     0x8            	lcd_cmd(0x08);			//display off C=D=B=0                                          E:\usb20\FCounter20\lcd_lib.c
000fc6   6ee6     MOVWF     0xe6,0x0                                                                                        
000fc8   df77     RCALL     0xeb8                                                                                           
000fca   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000fcc   0e0d     MOVLW     0xd            	lcd_cmd(0x0D);			//display on C=D=1 B=0                                         E:\usb20\FCounter20\lcd_lib.c
000fce   6ee6     MOVWF     0xe6,0x0                                                                                        
000fd0   df73     RCALL     0xeb8                                                                                           
000fd2   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000fd4   0e06     MOVLW     0x6            	lcd_cmd(0x06);			//entry I/D=1 S=0                                              E:\usb20\FCounter20\lcd_lib.c
000fd6   6ee6     MOVWF     0xe6,0x0                                                                                        
000fd8   df6f     RCALL     0xeb8                                                                                           
000fda   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000fdc   0e01     MOVLW     0x1            	lcd_cmd(0x01);			//all clear                                                    E:\usb20\FCounter20\lcd_lib.c
000fde   6ee6     MOVWF     0xe6,0x0                                                                                        
000fe0   df6b     RCALL     0xeb8                                                                                           
000fe2   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000fe4   0012     RETURN    0x0            }                                                                                E:\usb20\FCounter20\lcd_lib.c
                                           /*********************************************************************           E:\usb20\FCounter20\system\usb\usbmmap.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbmmap.c
                                            *                Microchip USB C18 Firmware Version 1.0                         E:\usb20\FCounter20\system\usb\usbmmap.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbmmap.c
                                            *********************************************************************           E:\usb20\FCounter20\system\usb\usbmmap.c
                                            * FileName:        usbmmap.c                                                    E:\usb20\FCounter20\system\usb\usbmmap.c
                                            * Dependencies:    See INCLUDES section below                                   E:\usb20\FCounter20\system\usb\usbmmap.c
                                            * Processor:       PIC18                                                        E:\usb20\FCounter20\system\usb\usbmmap.c
                                            * Compiler:        C18 2.30.01+                                                 E:\usb20\FCounter20\system\usb\usbmmap.c
                                            * Company:         Microchip Technology, Inc.                                   E:\usb20\FCounter20\system\usb\usbmmap.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbmmap.c
                                            * Software License Agreement                                                    E:\usb20\FCounter20\system\usb\usbmmap.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbmmap.c
                                            * The software supplied herewith by Microchip Technology Incorporated           E:\usb20\FCounter20\system\usb\usbmmap.c
                                            * (the 鼎ompany) for its PICmicroｮ Microcontroller is intended and             E:\usb20\FCounter20\system\usb\usbmmap.c
                                            * supplied to you, the Company痴 customer, for use solely and                   E:\usb20\FCounter20\system\usb\usbmmap.c
                                            * exclusively on Microchip PICmicro Microcontroller products. The               E:\usb20\FCounter20\system\usb\usbmmap.c
                                            * software is owned by the Company and/or its supplier, and is                  E:\usb20\FCounter20\system\usb\usbmmap.c
                                            * protected under applicable copyright laws. All rights are reserved.           E:\usb20\FCounter20\system\usb\usbmmap.c
                                            * Any use in violation of the foregoing restrictions may subject the            E:\usb20\FCounter20\system\usb\usbmmap.c
                                            * user to criminal sanctions under applicable laws, as well as to               E:\usb20\FCounter20\system\usb\usbmmap.c
                                            * civil liability for the breach of the terms and conditions of this            E:\usb20\FCounter20\system\usb\usbmmap.c
                                            * license.                                                                      E:\usb20\FCounter20\system\usb\usbmmap.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbmmap.c
                                            * THIS SOFTWARE IS PROVIDED IN AN 鄭S IS CONDITION. NO WARRANTIES,             E:\usb20\FCounter20\system\usb\usbmmap.c
                                            * WHETHER EXPRESS, IMPLIED OR STATUTORY, INCLUDING, BUT NOT LIMITED             E:\usb20\FCounter20\system\usb\usbmmap.c
                                            * TO, IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A                   E:\usb20\FCounter20\system\usb\usbmmap.c
                                            * PARTICULAR PURPOSE APPLY TO THIS SOFTWARE. THE COMPANY SHALL NOT,             E:\usb20\FCounter20\system\usb\usbmmap.c
                                            * IN ANY CIRCUMSTANCES, BE LIABLE FOR SPECIAL, INCIDENTAL OR                    E:\usb20\FCounter20\system\usb\usbmmap.c
                                            * CONSEQUENTIAL DAMAGES, FOR ANY REASON WHATSOEVER.                             E:\usb20\FCounter20\system\usb\usbmmap.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbmmap.c
                                            * Author               Date        Comment                                      E:\usb20\FCounter20\system\usb\usbmmap.c
                                            *~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~           E:\usb20\FCounter20\system\usb\usbmmap.c
                                            * Rawin Rojvanit       11/19/04    Original.                                    E:\usb20\FCounter20\system\usb\usbmmap.c
                                            ********************************************************************/           E:\usb20\FCounter20\system\usb\usbmmap.c
                                                                                                                            E:\usb20\FCounter20\system\usb\usbmmap.c
                                           /******************************************************************************  E:\usb20\FCounter20\system\usb\usbmmap.c
                                            * -usbmmap.c-                                                                   E:\usb20\FCounter20\system\usb\usbmmap.c
                                            * USB Memory Map                                                                E:\usb20\FCounter20\system\usb\usbmmap.c
                                            * This file is the USB memory manager; it serves as a compile-time memory       E:\usb20\FCounter20\system\usb\usbmmap.c
                                            * allocator for the USB endpoints. It uses the compile time options passed      E:\usb20\FCounter20\system\usb\usbmmap.c
                                            * from usbcfg.h to instantiate endpoints and endpoint buffer.                   E:\usb20\FCounter20\system\usb\usbmmap.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbmmap.c
                                            * Each endpoint requires to have a set of Buffer Descriptor registers(BDT).     E:\usb20\FCounter20\system\usb\usbmmap.c
                                            * A BDT is 4-byte long and has a specific RAM location for each endpoint.       E:\usb20\FCounter20\system\usb\usbmmap.c
                                            * The BDT for endpoint 0 out is located at address 0x400 to 0x403.              E:\usb20\FCounter20\system\usb\usbmmap.c
                                            * The BDT for endpoint 0 in is located at address 0x404 to 0x407.               E:\usb20\FCounter20\system\usb\usbmmap.c
                                            * The BDT for endpoint 1 out is located at address 0x408 to 0x40B.              E:\usb20\FCounter20\system\usb\usbmmap.c
                                            * and so on... The above allocation assumes the Ping-Pong Buffer Mode 0 is      E:\usb20\FCounter20\system\usb\usbmmap.c
                                            * used. These locations are already hard-wired in the silicon. The point        E:\usb20\FCounter20\system\usb\usbmmap.c
                                            * of doing instantiation, i.e. volatile far BDT ep0Bo;, is to provide the       E:\usb20\FCounter20\system\usb\usbmmap.c
                                            * C compiler a way to address each variable directly. This is very important    E:\usb20\FCounter20\system\usb\usbmmap.c
                                            * because when a register can be accessed directly, it saves execution time     E:\usb20\FCounter20\system\usb\usbmmap.c
                                            * and reduces program size.                                                     E:\usb20\FCounter20\system\usb\usbmmap.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbmmap.c
                                            * Endpoints are defined using the endpoint number and the direction             E:\usb20\FCounter20\system\usb\usbmmap.c
                                            * of transfer. For simplicity, usbmmap.c only uses the endpoint number          E:\usb20\FCounter20\system\usb\usbmmap.c
                                            * in the BDT register allocation scheme. This means if the usbcfg.h states      E:\usb20\FCounter20\system\usb\usbmmap.c
                                            * that the MAX_EP_NUMBER is number 1, then four BDTs will be                    E:\usb20\FCounter20\system\usb\usbmmap.c
                                            * instantiated: one each for endpoint0 in and endpoint0 out, which must         E:\usb20\FCounter20\system\usb\usbmmap.c
                                            * always be instantiated for control transfer by default, and one each sets     E:\usb20\FCounter20\system\usb\usbmmap.c
                                            * for endpoint1 in and endpoint1 out. The naming convention for instantiating   E:\usb20\FCounter20\system\usb\usbmmap.c
                                            * BDT is                                                                        E:\usb20\FCounter20\system\usb\usbmmap.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbmmap.c
                                            * ep<#>B<d>                                                                     E:\usb20\FCounter20\system\usb\usbmmap.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbmmap.c
                                            * where # is the endpoint number, and d is the direction of                     E:\usb20\FCounter20\system\usb\usbmmap.c
                                            * transfer, which could be either <i> or <o>.                                   E:\usb20\FCounter20\system\usb\usbmmap.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbmmap.c
                                            * The USB memory manager uses MAX_EP_NUMBER, as defined in usbcfg.h, to define  E:\usb20\FCounter20\system\usb\usbmmap.c
                                            * the endpoints to be instantiated. This represents the highest endpoint        E:\usb20\FCounter20\system\usb\usbmmap.c
                                            * number to be allocated, not how many endpoints are used. Since the BDTs for   E:\usb20\FCounter20\system\usb\usbmmap.c
                                            * endpoints have hardware-assigned addresses in Bank 4, setting this value too  E:\usb20\FCounter20\system\usb\usbmmap.c
                                            * high may lead to inefficient use of data RAM. For example, if an application  E:\usb20\FCounter20\system\usb\usbmmap.c
                                            * uses only endpoints EP0 and EP4, then the MAX_EP_NUMBER is 4, and not 2.      E:\usb20\FCounter20\system\usb\usbmmap.c
                                            * The in-between endpoint BDTs in this example (EP1, EP2, and EP3) go unused,   E:\usb20\FCounter20\system\usb\usbmmap.c
                                            * and the 24 bytes of memory associated with them are wasted. It does not make  E:\usb20\FCounter20\system\usb\usbmmap.c
                                            * much sense to skip endpoints, but the final decision lies with the user.      E:\usb20\FCounter20\system\usb\usbmmap.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbmmap.c
                                            * The next step is to assign the instantiated BDTs to different                 E:\usb20\FCounter20\system\usb\usbmmap.c
                                            * USB functions. The firmware framework fundamentally assumes that every USB    E:\usb20\FCounter20\system\usb\usbmmap.c
                                            * function should know which endpoint it is using, i.e., the default control    E:\usb20\FCounter20\system\usb\usbmmap.c
                                            * transfer should know that it is using endpoint 0 in and endpoint 0 out.       E:\usb20\FCounter20\system\usb\usbmmap.c
                                            * A HID class can choose which endpoint it wants to use, but once chosen, it    E:\usb20\FCounter20\system\usb\usbmmap.c
                                            * should always know the number of the endpoint.                                E:\usb20\FCounter20\system\usb\usbmmap.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbmmap.c
                                            * The assignment of endpoints to USB functions is managed centrally             E:\usb20\FCounter20\system\usb\usbmmap.c
                                            * in usbcfg.h. This helps prevent the mistake of having more                    E:\usb20\FCounter20\system\usb\usbmmap.c
                                            * than one USB function using the same endpoint. The "Endpoint Allocation"      E:\usb20\FCounter20\system\usb\usbmmap.c
                                            * section in usbcfg.h provides examples for how to map USB endpoints to USB     E:\usb20\FCounter20\system\usb\usbmmap.c
                                            * functions.                                                                    E:\usb20\FCounter20\system\usb\usbmmap.c
                                            * Quite a few things can be mapped in that section. There is no                 E:\usb20\FCounter20\system\usb\usbmmap.c
                                            * one correct way to do the mapping and the user has the choice to              E:\usb20\FCounter20\system\usb\usbmmap.c
                                            * choose a method that is most suitable to the application.                     E:\usb20\FCounter20\system\usb\usbmmap.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbmmap.c
                                            * Typically, however, a user will want to map the following for a given         E:\usb20\FCounter20\system\usb\usbmmap.c
                                            * USB interface function:                                                       E:\usb20\FCounter20\system\usb\usbmmap.c
                                            * 1. The USB interface ID                                                       E:\usb20\FCounter20\system\usb\usbmmap.c
                                            * 2. The endpoint control registers (UEPn)                                      E:\usb20\FCounter20\system\usb\usbmmap.c
                                            * 3. The BDT registers (ep<#>B<d>)                                              E:\usb20\FCounter20\system\usb\usbmmap.c
                                            * 4. The endpoint size                                                          E:\usb20\FCounter20\system\usb\usbmmap.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbmmap.c
                                            * Example: Assume a USB device class "foo", which uses one out endpoint         E:\usb20\FCounter20\system\usb\usbmmap.c
                                            *          of size 64-byte and one in endpoint of size 64-byte, then:           E:\usb20\FCounter20\system\usb\usbmmap.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbmmap.c
                                            * #define FOO_INTF_ID          0x00                                             E:\usb20\FCounter20\system\usb\usbmmap.c
                                            * #define FOO_UEP              UEP1                                             E:\usb20\FCounter20\system\usb\usbmmap.c
                                            * #define FOO_BD_OUT           ep1Bo                                            E:\usb20\FCounter20\system\usb\usbmmap.c
                                            * #define FOO_BD_IN            ep1Bi                                            E:\usb20\FCounter20\system\usb\usbmmap.c
                                            * #define FOO_EP_SIZE          64                                               E:\usb20\FCounter20\system\usb\usbmmap.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbmmap.c
                                            * The mapping above has chosen class "foo" to use endpoint 1.                   E:\usb20\FCounter20\system\usb\usbmmap.c
                                            * The names are arbitrary and can be anything other than FOO_??????.            E:\usb20\FCounter20\system\usb\usbmmap.c
                                            * For abstraction, the code for class "foo" should use the abstract             E:\usb20\FCounter20\system\usb\usbmmap.c
                                            * definitions of FOO_BD_OUT,FOO_BD_IN, and not ep1Bo or ep1Bi.                  E:\usb20\FCounter20\system\usb\usbmmap.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbmmap.c
                                            * Note that the endpoint size defined in the usbcfg.h file is again             E:\usb20\FCounter20\system\usb\usbmmap.c
                                            * used in the usbmmap.c file. This shows that the relationship between          E:\usb20\FCounter20\system\usb\usbmmap.c
                                            * the two files are tightly related.                                            E:\usb20\FCounter20\system\usb\usbmmap.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbmmap.c
                                            * The endpoint buffer for each USB function must be located in the              E:\usb20\FCounter20\system\usb\usbmmap.c
                                            * dual-port RAM area and has to come after all the BDTs have been               E:\usb20\FCounter20\system\usb\usbmmap.c
                                            * instantiated. An example declaration is:                                      E:\usb20\FCounter20\system\usb\usbmmap.c
                                            * volatile far unsigned char[FOO_EP_SIZE] data;                                 E:\usb20\FCounter20\system\usb\usbmmap.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbmmap.c
                                            * The 'volatile' keyword tells the compiler not to perform any code             E:\usb20\FCounter20\system\usb\usbmmap.c
                                            * optimization on this variable because its content could be modified           E:\usb20\FCounter20\system\usb\usbmmap.c
                                            * by the hardware. The 'far' keyword tells the compiler that this variable      E:\usb20\FCounter20\system\usb\usbmmap.c
                                            * is not located in the Access RAM area (0x000 - 0x05F).                        E:\usb20\FCounter20\system\usb\usbmmap.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbmmap.c
                                            * For the variable to be globally accessible by other files, it should be       E:\usb20\FCounter20\system\usb\usbmmap.c
                                            * declared in the header file usbmmap.h as an extern definition, such as        E:\usb20\FCounter20\system\usb\usbmmap.c
                                            * extern volatile far unsigned char[FOO_EP_SIZE] data;                          E:\usb20\FCounter20\system\usb\usbmmap.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbmmap.c
                                            * Conclusion:                                                                   E:\usb20\FCounter20\system\usb\usbmmap.c
                                            * In a short summary, the dependencies between usbcfg and usbmmap can           E:\usb20\FCounter20\system\usb\usbmmap.c
                                            * be shown as:                                                                  E:\usb20\FCounter20\system\usb\usbmmap.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbmmap.c
                                            * usbcfg[MAX_EP_NUMBER] -> usbmmap                                              E:\usb20\FCounter20\system\usb\usbmmap.c
                                            * usbmmap[ep<#>B<d>] -> usbcfg                                                  E:\usb20\FCounter20\system\usb\usbmmap.c
                                            * usbcfg[EP size] -> usbmmap                                                    E:\usb20\FCounter20\system\usb\usbmmap.c
                                            * usbcfg[abstract ep definitions] -> usb9/hid/cdc/etc class code                E:\usb20\FCounter20\system\usb\usbmmap.c
                                            * usbmmap[endpoint buffer variable] -> usb9/hid/cdc/etc class code              E:\usb20\FCounter20\system\usb\usbmmap.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbmmap.c
                                            * Data mapping provides a means for direct addressing of BDT and endpoint       E:\usb20\FCounter20\system\usb\usbmmap.c
                                            * buffer. This means less usage of pointers, which equates to a faster and      E:\usb20\FCounter20\system\usb\usbmmap.c
                                            * smaller program code.                                                         E:\usb20\FCounter20\system\usb\usbmmap.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbmmap.c
                                            *****************************************************************************/  E:\usb20\FCounter20\system\usb\usbmmap.c
                                                                                                                            E:\usb20\FCounter20\system\usb\usbmmap.c
                                           /** I N C L U D E S **********************************************************/  E:\usb20\FCounter20\system\usb\usbmmap.c
                                           #include "system\typedefs.h"                                                     E:\usb20\FCounter20\system\usb\usbmmap.c
                                           #include "system\usb\usb.h"                                                      E:\usb20\FCounter20\system\usb\usbmmap.c
                                                                                                                            E:\usb20\FCounter20\system\usb\usbmmap.c
                                           /** U S B  G L O B A L  V A R I A B L E S ************************************/  E:\usb20\FCounter20\system\usb\usbmmap.c
                                           #pragma udata                                                                    E:\usb20\FCounter20\system\usb\usbmmap.c
                                           byte usb_device_state;          // Device States: DETACHED, ATTACHED, ...        E:\usb20\FCounter20\system\usb\usbmmap.c
                                           USB_DEVICE_STATUS usb_stat;     // Global USB flags                              E:\usb20\FCounter20\system\usb\usbmmap.c
                                           byte usb_active_cfg;            // Value of current configuration                E:\usb20\FCounter20\system\usb\usbmmap.c
                                           byte usb_alt_intf[MAX_NUM_INT]; // Array to keep track of the current alternate  E:\usb20\FCounter20\system\usb\usbmmap.c
                                                                           // setting for each interface ID                 E:\usb20\FCounter20\system\usb\usbmmap.c
                                                                                                                            E:\usb20\FCounter20\system\usb\usbmmap.c
                                           /** U S B  F I X E D  L O C A T I O N  V A R I A B L E S *********************/  E:\usb20\FCounter20\system\usb\usbmmap.c
                                           #pragma udata usbram4=0x400     //See Linker Script,usb4:0x400-0x4FF(256-byte)   E:\usb20\FCounter20\system\usb\usbmmap.c
                                                                                                                            E:\usb20\FCounter20\system\usb\usbmmap.c
                                           /******************************************************************************  E:\usb20\FCounter20\system\usb\usbmmap.c
                                            * Section A: Buffer Descriptor Table                                            E:\usb20\FCounter20\system\usb\usbmmap.c
                                            * - 0x400 - 0x4FF(max)                                                          E:\usb20\FCounter20\system\usb\usbmmap.c
                                            * - MAX_EP_NUMBER is defined in autofiles\usbcfg.h                              E:\usb20\FCounter20\system\usb\usbmmap.c
                                            * - BDT data type is defined in system\usb\usbmmap.h                            E:\usb20\FCounter20\system\usb\usbmmap.c
                                            *****************************************************************************/  E:\usb20\FCounter20\system\usb\usbmmap.c
                                                                                                                            E:\usb20\FCounter20\system\usb\usbmmap.c
                                           #if(0 <= MAX_EP_NUMBER)                                                          E:\usb20\FCounter20\system\usb\usbmmap.c
                                           volatile far BDT ep0Bo;         //Endpoint #0 BD Out                             E:\usb20\FCounter20\system\usb\usbmmap.c
                                           volatile far BDT ep0Bi;         //Endpoint #0 BD In                              E:\usb20\FCounter20\system\usb\usbmmap.c
                                           #endif                                                                           E:\usb20\FCounter20\system\usb\usbmmap.c
                                                                                                                            E:\usb20\FCounter20\system\usb\usbmmap.c
                                           #if(1 <= MAX_EP_NUMBER)                                                          E:\usb20\FCounter20\system\usb\usbmmap.c
                                           volatile far BDT ep1Bo;         //Endpoint #1 BD Out                             E:\usb20\FCounter20\system\usb\usbmmap.c
                                           volatile far BDT ep1Bi;         //Endpoint #1 BD In                              E:\usb20\FCounter20\system\usb\usbmmap.c
                                           #endif                                                                           E:\usb20\FCounter20\system\usb\usbmmap.c
                                                                                                                            E:\usb20\FCounter20\system\usb\usbmmap.c
                                           #if(2 <= MAX_EP_NUMBER)                                                          E:\usb20\FCounter20\system\usb\usbmmap.c
                                           volatile far BDT ep2Bo;         //Endpoint #2 BD Out                             E:\usb20\FCounter20\system\usb\usbmmap.c
                                           volatile far BDT ep2Bi;         //Endpoint #2 BD In                              E:\usb20\FCounter20\system\usb\usbmmap.c
                                           #endif                                                                           E:\usb20\FCounter20\system\usb\usbmmap.c
                                                                                                                            E:\usb20\FCounter20\system\usb\usbmmap.c
                                           #if(3 <= MAX_EP_NUMBER)                                                          E:\usb20\FCounter20\system\usb\usbmmap.c
                                           volatile far BDT ep3Bo;         //Endpoint #3 BD Out                             E:\usb20\FCounter20\system\usb\usbmmap.c
                                           volatile far BDT ep3Bi;         //Endpoint #3 BD In                              E:\usb20\FCounter20\system\usb\usbmmap.c
                                           #endif                                                                           E:\usb20\FCounter20\system\usb\usbmmap.c
                                                                                                                            E:\usb20\FCounter20\system\usb\usbmmap.c
                                           #if(4 <= MAX_EP_NUMBER)                                                          E:\usb20\FCounter20\system\usb\usbmmap.c
                                           volatile far BDT ep4Bo;         //Endpoint #4 BD Out                             E:\usb20\FCounter20\system\usb\usbmmap.c
                                           volatile far BDT ep4Bi;         //Endpoint #4 BD In                              E:\usb20\FCounter20\system\usb\usbmmap.c
                                           #endif                                                                           E:\usb20\FCounter20\system\usb\usbmmap.c
                                                                                                                            E:\usb20\FCounter20\system\usb\usbmmap.c
                                           #if(5 <= MAX_EP_NUMBER)                                                          E:\usb20\FCounter20\system\usb\usbmmap.c
                                           volatile far BDT ep5Bo;         //Endpoint #5 BD Out                             E:\usb20\FCounter20\system\usb\usbmmap.c
                                           volatile far BDT ep5Bi;         //Endpoint #5 BD In                              E:\usb20\FCounter20\system\usb\usbmmap.c
                                           #endif                                                                           E:\usb20\FCounter20\system\usb\usbmmap.c
                                                                                                                            E:\usb20\FCounter20\system\usb\usbmmap.c
                                           #if(6 <= MAX_EP_NUMBER)                                                          E:\usb20\FCounter20\system\usb\usbmmap.c
                                           volatile far BDT ep6Bo;         //Endpoint #6 BD Out                             E:\usb20\FCounter20\system\usb\usbmmap.c
                                           volatile far BDT ep6Bi;         //Endpoint #6 BD In                              E:\usb20\FCounter20\system\usb\usbmmap.c
                                           #endif                                                                           E:\usb20\FCounter20\system\usb\usbmmap.c
                                                                                                                            E:\usb20\FCounter20\system\usb\usbmmap.c
                                           #if(7 <= MAX_EP_NUMBER)                                                          E:\usb20\FCounter20\system\usb\usbmmap.c
                                           volatile far BDT ep7Bo;         //Endpoint #7 BD Out                             E:\usb20\FCounter20\system\usb\usbmmap.c
                                           volatile far BDT ep7Bi;         //Endpoint #7 BD In                              E:\usb20\FCounter20\system\usb\usbmmap.c
                                           #endif                                                                           E:\usb20\FCounter20\system\usb\usbmmap.c
                                                                                                                            E:\usb20\FCounter20\system\usb\usbmmap.c
                                           #if(8 <= MAX_EP_NUMBER)                                                          E:\usb20\FCounter20\system\usb\usbmmap.c
                                           volatile far BDT ep8Bo;         //Endpoint #8 BD Out                             E:\usb20\FCounter20\system\usb\usbmmap.c
                                           volatile far BDT ep8Bi;         //Endpoint #8 BD In                              E:\usb20\FCounter20\system\usb\usbmmap.c
                                           #endif                                                                           E:\usb20\FCounter20\system\usb\usbmmap.c
                                                                                                                            E:\usb20\FCounter20\system\usb\usbmmap.c
                                           #if(9 <= MAX_EP_NUMBER)                                                          E:\usb20\FCounter20\system\usb\usbmmap.c
                                           volatile far BDT ep9Bo;         //Endpoint #9 BD Out                             E:\usb20\FCounter20\system\usb\usbmmap.c
                                           volatile far BDT ep9Bi;         //Endpoint #9 BD In                              E:\usb20\FCounter20\system\usb\usbmmap.c
                                           #endif                                                                           E:\usb20\FCounter20\system\usb\usbmmap.c
                                                                                                                            E:\usb20\FCounter20\system\usb\usbmmap.c
                                           #if(10 <= MAX_EP_NUMBER)                                                         E:\usb20\FCounter20\system\usb\usbmmap.c
                                           volatile far BDT ep10Bo;        //Endpoint #10 BD Out                            E:\usb20\FCounter20\system\usb\usbmmap.c
                                           volatile far BDT ep10Bi;        //Endpoint #10 BD In                             E:\usb20\FCounter20\system\usb\usbmmap.c
                                           #endif                                                                           E:\usb20\FCounter20\system\usb\usbmmap.c
                                                                                                                            E:\usb20\FCounter20\system\usb\usbmmap.c
                                           #if(11 <= MAX_EP_NUMBER)                                                         E:\usb20\FCounter20\system\usb\usbmmap.c
                                           volatile far BDT ep11Bo;        //Endpoint #11 BD Out                            E:\usb20\FCounter20\system\usb\usbmmap.c
                                           volatile far BDT ep11Bi;        //Endpoint #11 BD In                             E:\usb20\FCounter20\system\usb\usbmmap.c
                                           #endif                                                                           E:\usb20\FCounter20\system\usb\usbmmap.c
                                                                                                                            E:\usb20\FCounter20\system\usb\usbmmap.c
                                           #if(12 <= MAX_EP_NUMBER)                                                         E:\usb20\FCounter20\system\usb\usbmmap.c
                                           volatile far BDT ep12Bo;        //Endpoint #12 BD Out                            E:\usb20\FCounter20\system\usb\usbmmap.c
                                           volatile far BDT ep12Bi;        //Endpoint #12 BD In                             E:\usb20\FCounter20\system\usb\usbmmap.c
                                           #endif                                                                           E:\usb20\FCounter20\system\usb\usbmmap.c
                                                                                                                            E:\usb20\FCounter20\system\usb\usbmmap.c
                                           #if(13 <= MAX_EP_NUMBER)                                                         E:\usb20\FCounter20\system\usb\usbmmap.c
                                           volatile far BDT ep13Bo;        //Endpoint #13 BD Out                            E:\usb20\FCounter20\system\usb\usbmmap.c
                                           volatile far BDT ep13Bi;        //Endpoint #13 BD In                             E:\usb20\FCounter20\system\usb\usbmmap.c
                                           #endif                                                                           E:\usb20\FCounter20\system\usb\usbmmap.c
                                                                                                                            E:\usb20\FCounter20\system\usb\usbmmap.c
                                           #if(14 <= MAX_EP_NUMBER)                                                         E:\usb20\FCounter20\system\usb\usbmmap.c
                                           volatile far BDT ep14Bo;        //Endpoint #14 BD Out                            E:\usb20\FCounter20\system\usb\usbmmap.c
                                           volatile far BDT ep14Bi;        //Endpoint #14 BD In                             E:\usb20\FCounter20\system\usb\usbmmap.c
                                           #endif                                                                           E:\usb20\FCounter20\system\usb\usbmmap.c
                                                                                                                            E:\usb20\FCounter20\system\usb\usbmmap.c
                                           #if(15 <= MAX_EP_NUMBER)                                                         E:\usb20\FCounter20\system\usb\usbmmap.c
                                           volatile far BDT ep15Bo;        //Endpoint #15 BD Out                            E:\usb20\FCounter20\system\usb\usbmmap.c
                                           volatile far BDT ep15Bi;        //Endpoint #15 BD In                             E:\usb20\FCounter20\system\usb\usbmmap.c
                                           #endif                                                                           E:\usb20\FCounter20\system\usb\usbmmap.c
                                                                                                                            E:\usb20\FCounter20\system\usb\usbmmap.c
                                           /******************************************************************************  E:\usb20\FCounter20\system\usb\usbmmap.c
                                            * Section B: EP0 Buffer Space                                                   E:\usb20\FCounter20\system\usb\usbmmap.c
                                            ******************************************************************************  E:\usb20\FCounter20\system\usb\usbmmap.c
                                            * - Two buffer areas are defined:                                               E:\usb20\FCounter20\system\usb\usbmmap.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbmmap.c
                                            *   A. CTRL_TRF_SETUP                                                           E:\usb20\FCounter20\system\usb\usbmmap.c
                                            *      - Size = EP0_BUFF_SIZE as defined in autofiles\usbcfg.h                  E:\usb20\FCounter20\system\usb\usbmmap.c
                                            *      - Detailed data structure allows direct adddressing of bits and bytes.   E:\usb20\FCounter20\system\usb\usbmmap.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbmmap.c
                                            *   B. CTRL_TRF_DATA                                                            E:\usb20\FCounter20\system\usb\usbmmap.c
                                            *      - Size = EP0_BUFF_SIZE as defined in autofiles\usbcfg.h                  E:\usb20\FCounter20\system\usb\usbmmap.c
                                            *      - Data structure allows direct adddressing of the first 8 bytes.         E:\usb20\FCounter20\system\usb\usbmmap.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbmmap.c
                                            * - Both data types are defined in system\usb\usbdefs\usbdefs_ep0_buff.h        E:\usb20\FCounter20\system\usb\usbmmap.c
                                            *****************************************************************************/  E:\usb20\FCounter20\system\usb\usbmmap.c
                                           volatile far CTRL_TRF_SETUP SetupPkt;                                            E:\usb20\FCounter20\system\usb\usbmmap.c
                                           volatile far CTRL_TRF_DATA CtrlTrfData;                                          E:\usb20\FCounter20\system\usb\usbmmap.c
                                                                                                                            E:\usb20\FCounter20\system\usb\usbmmap.c
                                           /******************************************************************************  E:\usb20\FCounter20\system\usb\usbmmap.c
                                            * Section C: CDC Buffer                                                         E:\usb20\FCounter20\system\usb\usbmmap.c
                                            ******************************************************************************  E:\usb20\FCounter20\system\usb\usbmmap.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbmmap.c
                                            *****************************************************************************/  E:\usb20\FCounter20\system\usb\usbmmap.c
                                           #pragma udata usbram5a=0x500    //See Linker Script,usb5:0x500-...               E:\usb20\FCounter20\system\usb\usbmmap.c
                                           #if defined(USB_USE_CDC)                                                         E:\usb20\FCounter20\system\usb\usbmmap.c
                                           volatile far unsigned char cdc_notice[CDC_INT_EP_SIZE];                          E:\usb20\FCounter20\system\usb\usbmmap.c
                                           volatile far unsigned char cdc_data_rx[CDC_BULK_OUT_EP_SIZE];                    E:\usb20\FCounter20\system\usb\usbmmap.c
                                           volatile far unsigned char cdc_data_tx[CDC_BULK_IN_EP_SIZE];                     E:\usb20\FCounter20\system\usb\usbmmap.c
                                           #endif                                                                           E:\usb20\FCounter20\system\usb\usbmmap.c
                                           #pragma udata                                                                    E:\usb20\FCounter20\system\usb\usbmmap.c
                                                                                                                            E:\usb20\FCounter20\system\usb\usbmmap.c
                                           /** EOF usbmmap.c ************************************************************/  E:\usb20\FCounter20\system\usb\usbmmap.c
                                           /*********************************************************************           E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            *             Microchip USB C18 Firmware -  CDC Version 1.0                     E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            *********************************************************************           E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            * FileName:        cdc.c                                                        E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            * Dependencies:    See INCLUDES section below                                   E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            * Processor:       PIC18                                                        E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            * Compiler:        C18 2.30.01+                                                 E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            * Company:         Microchip Technology, Inc.                                   E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            * Software License Agreement                                                    E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            * The software supplied herewith by Microchip Technology Incorporated           E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            * (the 鼎ompany) for its PICmicroｮ Microcontroller is intended and             E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            * supplied to you, the Company痴 customer, for use solely and                   E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            * exclusively on Microchip PICmicro Microcontroller products. The               E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            * software is owned by the Company and/or its supplier, and is                  E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            * protected under applicable copyright laws. All rights are reserved.           E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            * Any use in violation of the foregoing restrictions may subject the            E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            * user to criminal sanctions under applicable laws, as well as to               E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            * civil liability for the breach of the terms and conditions of this            E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            * license.                                                                      E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            * THIS SOFTWARE IS PROVIDED IN AN 鄭S IS CONDITION. NO WARRANTIES,             E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            * WHETHER EXPRESS, IMPLIED OR STATUTORY, INCLUDING, BUT NOT LIMITED             E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            * TO, IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A                   E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            * PARTICULAR PURPOSE APPLY TO THIS SOFTWARE. THE COMPANY SHALL NOT,             E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            * IN ANY CIRCUMSTANCES, BE LIABLE FOR SPECIAL, INCIDENTAL OR                    E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            * CONSEQUENTIAL DAMAGES, FOR ANY REASON WHATSOEVER.                             E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            * Author               Date        Comment                                      E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            *~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~           E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            * Rawin Rojvanit       11/19/04    Original. RS-232 Emulation Subset            E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            ********************************************************************/           E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                                                                                            E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                           /** I N C L U D E S **********************************************************/  E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                           #include <p18cxxx.h>                                                             E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                           #include "system\typedefs.h"                                                     E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                           #include "system\usb\usb.h"                                                      E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                                                                                            E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                           #ifdef USB_USE_CDC                                                               E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                                                                                            E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                           /** V A R I A B L E S ********************************************************/  E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                           #pragma udata                                                                    E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                           byte cdc_rx_len;            // total rx length                                   E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                                                                                            E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                           byte cdc_trf_state;         // States are defined cdc.h                          E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                           POINTER pCDCSrc;            // Dedicated source pointer                          E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                           POINTER pCDCDst;            // Dedicated destination pointer                     E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                           byte cdc_tx_len;            // total tx length                                   E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                           byte cdc_mem_type;          // _ROM, _RAM                                        E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                                                                                            E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                           LINE_CODING line_coding;    // Buffer to store line coding information           E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                           CONTROL_SIGNAL_BITMAP control_signal_bitmap;                                     E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                                                                                            E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                           /*                                                                               E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            * SEND_ENCAPSULATED_COMMAND and GET_ENCAPSULATED_RESPONSE are required          E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            * requests according to the CDC specification.                                  E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            * However, it is not really being used here, therefore a dummy buffer is        E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            * used for conformance.                                                         E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            */                                                                              E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                           #define dummy_length    0x08                                                     E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                           byte dummy_encapsulated_cmd_response[dummy_length];                              E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                                                                                            E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                           /** P R I V A T E  P R O T O T Y P E S ***************************************/  E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                                                                                            E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                           /** D E C L A R A T I O N S **************************************************/  E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                           #pragma code                                                                     E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                                                                                            E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                           /** C L A S S  S P E C I F I C  R E Q ****************************************/  E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                           /******************************************************************************  E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            * Function:        void USBCheckCDCRequest(void)                                E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            * PreCondition:    None                                                         E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            * Input:           None                                                         E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            * Output:          None                                                         E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            * Side Effects:    None                                                         E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            * Overview:        This routine checks the setup data packet to see if it       E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            *                  knows how to handle it                                       E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            * Note:            None                                                         E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            *****************************************************************************/  E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                           void USBCheckCDCRequest(void)                                                    E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                           {                                                                                E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                               /*                                                                           E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                * If request recipient is not an interface then return                      E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                */                                                                          E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
0004c8   0104     MOVLB     0x4                if(SetupPkt.Recipient != RCPT_INTF) return;                                  E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
0004ca   5120     MOVF      0x20,0x0,0x1                                                                                    
0004cc   0b1f     ANDLW     0x1f                                                                                            
0004ce   0801     SUBLW     0x1                                                                                             
0004d0   e001     BZ        0x4d4                                                                                           
0004d2   d05b     BRA       0x58a                                                                                           
                                                                                                                            E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                               /*                                                                           E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                * If request type is not class-specific then return                         E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                */                                                                          E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
0004d4   5120     MOVF      0x20,0x0,0x1       if(SetupPkt.RequestType != CLASS) return;                                    E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
0004d6   0b60     ANDLW     0x60                                                                                            
0004d8   42e8     RRNCF     0xe8,0x1,0x0                                                                                    
0004da   42e8     RRNCF     0xe8,0x1,0x0                                                                                    
0004dc   42e8     RRNCF     0xe8,0x1,0x0                                                                                    
0004de   42e8     RRNCF     0xe8,0x1,0x0                                                                                    
0004e0   42e8     RRNCF     0xe8,0x1,0x0                                                                                    
0004e2   0801     SUBLW     0x1                                                                                             
0004e4   e001     BZ        0x4e8                                                                                           
0004e6   d051     BRA       0x58a                                                                                           
                                                                                                                            E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                               /*                                                                           E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                * Interface ID must match interface numbers associated with                 E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                * CDC class, else return                                                    E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                */                                                                          E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
0004e8   5124     MOVF      0x24,0x0,0x1       if((SetupPkt.bIntfID != CDC_COMM_INTF_ID)&&                                  E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
0004ea   e003     BZ        0x4f2                 (SetupPkt.bIntfID != CDC_DATA_INTF_ID)) return;                           E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
0004ec   0524     DECF      0x24,0x0,0x1                                                                                    
0004ee   e001     BZ        0x4f2                                                                                           
0004f0   d04c     BRA       0x58a                                                                                           
                                                                                                                            E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
0004f2   5121     MOVF      0x21,0x0,0x1       switch(SetupPkt.bRequest)                                                    E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
0004f4   0a23     XORLW     0x23                                                                                            
0004f6   e048     BZ        0x588                                                                                           
0004f8   0a01     XORLW     0x1                                                                                             
0004fa   e040     BZ        0x57c                                                                                           
0004fc   0a03     XORLW     0x3                                                                                             
0004fe   e030     BZ        0x560                                                                                           
000500   0a01     XORLW     0x1                                                                                             
000502   e025     BZ        0x54e                                                                                           
000504   0a24     XORLW     0x24                                                                                            
000506   e022     BZ        0x54c                                                                                           
000508   0a07     XORLW     0x7                                                                                             
00050a   e01f     BZ        0x54a                                                                                           
00050c   0a01     XORLW     0x1                                                                                             
00050e   e01c     BZ        0x548                                                                                           
000510   0a03     XORLW     0x3                                                                                             
000512   e011     BZ        0x536                                                                                           
000514   0a01     XORLW     0x1                                                                                             
000516   e001     BZ        0x51a                                                                                           
                                               {                                                                            E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                   case SEND_ENCAPSULATED_COMMAND:                                          E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
00051a   0100     MOVLB     0x0                        ctrl_trf_session_owner = MUID_CDC;                                   E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
00051c   0e03     MOVLW     0x3                                                                                             
00051e   6ff5     MOVWF     0xf5,0x1                                                                                        
000520   0100     MOVLB     0x0                        pSrc.bRam = (byte*)&dummy_encapsulated_cmd_response;                 E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
000522   0e5b     MOVLW     0x5b                                                                                            
000524   6ff6     MOVWF     0xf6,0x1                                                                                        
000526   0e01     MOVLW     0x1                                                                                             
000528   6ff7     MOVWF     0xf7,0x1                                                                                        
00052a   0100     MOVLB     0x0                        usb_stat.ctrl_trf_mem = _RAM;                                        E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
00052c   93fd     BCF       0xfd,0x1,0x1                                                                                    
00052e   0100     MOVLB     0x0                        LSB(wCount) = dummy_length;                                          E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
000530   0e08     MOVLW     0x8                                                                                             
000532   6ffa     MOVWF     0xfa,0x1                                                                                        
000534   d02a     BRA       0x58a                      break;                                                               E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                   case GET_ENCAPSULATED_RESPONSE:                                          E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
000536   0100     MOVLB     0x0                        ctrl_trf_session_owner = MUID_CDC;                                   E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
000538   0e03     MOVLW     0x3                                                                                             
00053a   6ff5     MOVWF     0xf5,0x1                                                                                        
                                                       // Populate dummy_encapsulated_cmd_response first.                   E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
00053c   0100     MOVLB     0x0                        pDst.bRam = (byte*)&dummy_encapsulated_cmd_response;                 E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
00053e   0e5b     MOVLW     0x5b                                                                                            
000540   6ff8     MOVWF     0xf8,0x1                                                                                        
000542   0e01     MOVLW     0x1                                                                                             
000544   6ff9     MOVWF     0xf9,0x1                                                                                        
000546   d021     BRA       0x58a                      break;                                                               E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                   case SET_COMM_FEATURE:                  // Optional                      E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
000548   d020     BRA       0x58a                      break;                                                               E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                   case GET_COMM_FEATURE:                  // Optional                      E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
00054a   d01f     BRA       0x58a                      break;                                                               E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                   case CLEAR_COMM_FEATURE:                // Optional                      E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
00054c   d01e     BRA       0x58a                      break;                                                               E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                   case SET_LINE_CODING:                                                    E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
00054e   0100     MOVLB     0x0                        ctrl_trf_session_owner = MUID_CDC;                                   E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
000550   0e03     MOVLW     0x3                                                                                             
000552   6ff5     MOVWF     0xf5,0x1                                                                                        
000554   0100     MOVLB     0x0                        pDst.bRam = (byte*)&line_coding;    // Set destination               E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
000556   0e50     MOVLW     0x50                                                                                            
000558   6ff8     MOVWF     0xf8,0x1                                                                                        
00055a   0e01     MOVLW     0x1                                                                                             
00055c   6ff9     MOVWF     0xf9,0x1                                                                                        
00055e   d015     BRA       0x58a                      break;                                                               E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                   case GET_LINE_CODING:                                                    E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
000560   0100     MOVLB     0x0                        ctrl_trf_session_owner = MUID_CDC;                                   E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
000562   0e03     MOVLW     0x3                                                                                             
000564   6ff5     MOVWF     0xf5,0x1                                                                                        
000566   0100     MOVLB     0x0                        pSrc.bRam = (byte*)&line_coding;    // Set source                    E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
000568   0e50     MOVLW     0x50                                                                                            
00056a   6ff6     MOVWF     0xf6,0x1                                                                                        
00056c   0e01     MOVLW     0x1                                                                                             
00056e   6ff7     MOVWF     0xf7,0x1                                                                                        
000570   0100     MOVLB     0x0                        usb_stat.ctrl_trf_mem = _RAM;       // Set memory type               E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
000572   93fd     BCF       0xfd,0x1,0x1                                                                                    
000574   0100     MOVLB     0x0                        LSB(wCount) = LINE_CODING_LENGTH;   // Set data count                E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
000576   0e07     MOVLW     0x7                                                                                             
000578   6ffa     MOVWF     0xfa,0x1                                                                                        
00057a   d007     BRA       0x58a                      break;                                                               E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                   case SET_CONTROL_LINE_STATE:                                             E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
00057c   0100     MOVLB     0x0                        ctrl_trf_session_owner = MUID_CDC;                                   E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
00057e   0e03     MOVLW     0x3                                                                                             
000580   6ff5     MOVWF     0xf5,0x1                                                                                        
000582   c422     MOVFF     0x422,0x157                control_signal_bitmap._byte = LSB(SetupPkt.W_Value);                 E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
000584   f157                                                                                                               
000586   d001     BRA       0x58a                      break;                                                               E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                   case SEND_BREAK:                        // Optional                      E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
000588   d000     BRA       0x58a                      break;                                                               E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                   default:                                                                 E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
000518   d038     BRA       0x58a                      break;                                                               E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                               }//end switch(SetupPkt.bRequest)                                             E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                                                                                            E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
00058a   0012     RETURN    0x0            }//end USBCheckCDCRequest                                                        E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                                                                                            E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                           /** U S E R  A P I ***********************************************************/  E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                                                                                            E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                           /******************************************************************************  E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            * Function:        void CDCInitEP(void)                                         E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            * PreCondition:    None                                                         E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            * Input:           None                                                         E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            * Output:          None                                                         E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            * Side Effects:    None                                                         E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            * Overview:        CDCInitEP initializes CDC endpoints, buffer descriptors,     E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            *                  internal state-machine, and variables.                       E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            *                  It should be called after the USB host has sent out a        E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            *                  SET_CONFIGURATION request.                                   E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            *                  See USBStdSetCfgHandler() in usb9.c for examples.            E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            * Note:            None                                                         E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            *****************************************************************************/  E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                           void CDCInitEP(void)                                                             E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                           {                                                                                E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                               //Abstract line coding information                                           E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
00058c   0101     MOVLB     0x1                line_coding.dwDTERate._dword = 115200;      // baud rate                     E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
00058e   6b50     CLRF      0x50,0x1                                                                                        
000590   0ec2     MOVLW     0xc2                                                                                            
000592   6f51     MOVWF     0x51,0x1                                                                                        
000594   0e01     MOVLW     0x1                                                                                             
000596   6f52     MOVWF     0x52,0x1                                                                                        
000598   6b53     CLRF      0x53,0x1                                                                                        
00059a   6b54     CLRF      0x54,0x1           line_coding.bCharFormat = 0x00;             // 1 stop bit                    E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
00059c   6b55     CLRF      0x55,0x1           line_coding.bParityType = 0x00;             // None                          E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
00059e   0e08     MOVLW     0x8                line_coding.bDataBits = 0x08;               // 5,6,7,8, or 16                E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
0005a0   6f56     MOVWF     0x56,0x1                                                                                        
                                                                                                                            E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
0005a2   6b49     CLRF      0x49,0x1           cdc_trf_state = CDC_TX_READY;                                                E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
0005a4   6b48     CLRF      0x48,0x1           cdc_rx_len = 0;                                                              E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                                                                                            E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
0005a6   0e1a     MOVLW     0x1a               CDC_COMM_UEP = EP_IN|HSHK_EN;               // Enable 1 Comm pipe            E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
0005a8   6e72     MOVWF     0x72,0x0                                                                                        
0005aa   0e1e     MOVLW     0x1e               CDC_DATA_UEP = EP_OUT_IN|HSHK_EN;           // Enable 2 data pipes           E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
0005ac   6e73     MOVWF     0x73,0x0                                                                                        
                                                                                                                            E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                               /*                                                                           E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                * Do not have to init Cnt of IN pipes here.                                 E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                * Reason:  Number of bytes to send to the host                              E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                *          varies from one transaction to                                   E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                *          another. Cnt should equal the exact                              E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                *          number of bytes to transmit for                                  E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                *          a given IN transaction.                                          E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                *          This number of bytes will only                                   E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                *          be known right before the data is                                E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                *          sent.                                                            E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                */                                                                          E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
0005ae   0104     MOVLB     0x4                CDC_INT_BD_IN.ADR = (byte*)&cdc_notice;     // Set buffer address            E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
0005b0   0e00     MOVLW     0x0                                                                                             
0005b2   6f16     MOVWF     0x16,0x1                                                                                        
0005b4   0e05     MOVLW     0x5                                                                                             
0005b6   6f17     MOVWF     0x17,0x1                                                                                        
0005b8   0e40     MOVLW     0x40               CDC_INT_BD_IN.Stat._byte = _UCPU|_DAT1;     // Set status                    E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
0005ba   6f14     MOVWF     0x14,0x1                                                                                        
                                                                                                                            E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
0005bc   0104     MOVLB     0x4                CDC_BULK_BD_OUT.Cnt = sizeof(cdc_data_rx);  // Set buffer size               E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
0005be   6f19     MOVWF     0x19,0x1                                                                                        
0005c0   0e08     MOVLW     0x8                CDC_BULK_BD_OUT.ADR = (byte*)&cdc_data_rx;  // Set buffer address            E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
0005c2   6f1a     MOVWF     0x1a,0x1                                                                                        
0005c4   0e05     MOVLW     0x5                                                                                             
0005c6   6f1b     MOVWF     0x1b,0x1                                                                                        
0005c8   0e88     MOVLW     0x88               CDC_BULK_BD_OUT.Stat._byte = _USIE|_DAT0|_DTSEN;// Set status                E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
0005ca   6f18     MOVWF     0x18,0x1                                                                                        
                                                                                                                            E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
0005cc   0104     MOVLB     0x4                CDC_BULK_BD_IN.ADR = (byte*)&cdc_data_tx;   // Set buffer size               E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
0005ce   0e48     MOVLW     0x48                                                                                            
0005d0   6f1e     MOVWF     0x1e,0x1                                                                                        
0005d2   0e05     MOVLW     0x5                                                                                             
0005d4   6f1f     MOVWF     0x1f,0x1                                                                                        
0005d6   0e40     MOVLW     0x40               CDC_BULK_BD_IN.Stat._byte = _UCPU|_DAT1;    // Set buffer address            E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
0005d8   6f1c     MOVWF     0x1c,0x1                                                                                        
                                                                                                                            E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
0005da   0012     RETURN    0x0            }//end CDCInitEP                                                                 E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                                                                                            E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                           /******************************************************************************  E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            * Function:        byte getsUSBUSART(char *buffer,                              E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            *                                    byte len)                                  E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            * PreCondition:    Value of input argument 'len' should be smaller than the     E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            *                  maximum endpoint size responsible for receiving bulk         E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            *                  data from USB host for CDC class.                            E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            *                  Input argument 'buffer' should point to a buffer area that   E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            *                  is bigger or equal to the size specified by 'len'.           E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            * Input:           buffer  : Pointer to where received bytes are to be stored   E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            *                  len     : The number of bytes expected.                      E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            * Output:          The number of bytes copied to buffer.                        E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            * Side Effects:    Publicly accessible variable cdc_rx_len is updated with      E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            *                  the number of bytes copied to buffer.                        E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            *                  Once getsUSBUSART is called, subsequent retrieval of         E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            *                  cdc_rx_len can be done by calling macro mCDCGetRxLength().   E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            * Overview:        getsUSBUSART copies a string of bytes received through       E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            *                  USB CDC Bulk OUT endpoint to a user's specified location.    E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            *                  It is a non-blocking function. It does not wait              E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            *                  for data if there is no data available. Instead it returns   E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            *                  '0' to notify the caller that there is no data available.    E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            * Note:            If the actual number of bytes received is larger than the    E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            *                  number of bytes expected (len), only the expected number     E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            *                  of bytes specified will be copied to buffer.                 E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            *                  If the actual number of bytes received is smaller than the   E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            *                  number of bytes expected (len), only the actual number       E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            *                  of bytes received will be copied to buffer.                  E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            *****************************************************************************/  E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
0005dc   cfd9     MOVFF     0xfd9,0xfe6    byte getsUSBUSART(char *buffer, byte len)                                        E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
0005de   ffe6                                                                                                               
0005e0   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
0005e2   ffd9                                                                                                               
                                           {                                                                                E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
0005e4   0101     MOVLB     0x1                cdc_rx_len = 0;                                                              E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
0005e6   6b48     CLRF      0x48,0x1                                                                                        
                                                                                                                            E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
0005e8   0104     MOVLB     0x4                if(!mCDCUsartRxIsBusy())                                                     E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
0005ea   bf18     BTFSC     0x18,0x7,0x1                                                                                    
0005ec   d030     BRA       0x64e                                                                                           
                                               {                                                                            E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                   /*                                                                       E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                    * Adjust the expected number of bytes to equal                          E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                    * the actual number of bytes received.                                  E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                    */                                                                      E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
0005ee   0efc     MOVLW     0xfc                   if(len > CDC_BULK_BD_OUT.Cnt)                                            E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
0005f0   cfdb     MOVFF     0xfdb,0x10                                                                                      
0005f2   f010                                                                                                               
0005f4   5119     MOVF      0x19,0x0,0x1                                                                                    
0005f6   80d8     BSF       0xd8,0x0,0x0                                                                                    
0005f8   5410     SUBFWB    0x10,0x0,0x0                                                                                    
0005fa   e203     BC        0x602                                                                                           
0005fc   0efc     MOVLW     0xfc                       len = CDC_BULK_BD_OUT.Cnt;                                           E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
0005fe   c419     MOVFF     0x419,0xfdb                                                                                     
000600   ffdb                                                                                                               
                                                                                                                            E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                   /*                                                                       E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                    * Copy data from dual-ram buffer to user's buffer                       E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                    */                                                                      E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
000602   0101     MOVLB     0x1                    for(cdc_rx_len = 0; cdc_rx_len < len; cdc_rx_len++)                      E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
000604   6b48     CLRF      0x48,0x1                                                                                        
000606   0efc     MOVLW     0xfc                                                                                            
000608   50db     MOVF      0xdb,0x0,0x0                                                                                    
00060a   5d48     SUBWF     0x48,0x0,0x1                                                                                    
00060c   e219     BC        0x640                                                                                           
00063c   2b48     INCF      0x48,0x1,0x1                                                                                    
00063e   d7e3     BRA       0x606                                                                                           
00060e   5148     MOVF      0x48,0x0,0x1               buffer[cdc_rx_len] = cdc_data_rx[cdc_rx_len];                        E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
000610   6aea     CLRF      0xea,0x0                                                                                        
000612   0f08     ADDLW     0x8                                                                                             
000614   6ee9     MOVWF     0xe9,0x0                                                                                        
000616   0e05     MOVLW     0x5                                                                                             
000618   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
00061a   50ef     MOVF      0xef,0x0,0x0                                                                                    
00061c   6ee6     MOVWF     0xe6,0x0                                                                                        
00061e   5148     MOVF      0x48,0x0,0x1                                                                                    
000620   6ee7     MOVWF     0xe7,0x0                                                                                        
000622   0efd     MOVLW     0xfd                                                                                            
000624   cfdb     MOVFF     0xfdb,0xfe9                                                                                     
000626   ffe9                                                                                                               
000628   0efe     MOVLW     0xfe                                                                                            
00062a   cfdb     MOVFF     0xfdb,0xfea                                                                                     
00062c   ffea                                                                                                               
00062e   50e7     MOVF      0xe7,0x0,0x0                                                                                    
000630   26e9     ADDWF     0xe9,0x1,0x0                                                                                    
000632   0e00     MOVLW     0x0                                                                                             
000634   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
000636   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000638   50e7     MOVF      0xe7,0x0,0x0                                                                                    
00063a   6eef     MOVWF     0xef,0x0                                                                                        
                                                                                                                            E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                   /*                                                                       E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                    * Prepare dual-ram buffer for next OUT transaction                      E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                    */                                                                      E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
000640   0104     MOVLB     0x4                    CDC_BULK_BD_OUT.Cnt = sizeof(cdc_data_rx);                               E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
000642   0e40     MOVLW     0x40                                                                                            
000644   6f19     MOVWF     0x19,0x1                                                                                        
000646   1718     ANDWF     0x18,0x1,0x1           mUSBBufferReady(CDC_BULK_BD_OUT);                                        E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
000648   7d18     BTG       0x18,0x6,0x1                                                                                    
00064a   0e88     MOVLW     0x88                                                                                            
00064c   1318     IORWF     0x18,0x1,0x1                                                                                    
                                               }//end if                                                                    E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                                                                                            E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
00064e   0101     MOVLB     0x1                return cdc_rx_len;                                                           E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
000650   5148     MOVF      0x48,0x0,0x1                                                                                    
000652   d000     BRA       0x654                                                                                           
                                                                                                                            E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
000654   52e5     MOVF      0xe5,0x1,0x0   }//end getsUSBUSART                                                              E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
000656   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
000658   ffd9                                                                                                               
00065a   0012     RETURN    0x0                                                                                             
                                                                                                                            E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                           /******************************************************************************  E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            * Function:        void putsUSBUSART(char *data)                                E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            * PreCondition:    cdc_trf_state must be in the CDC_TX_READY state.             E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            *                  The string of characters pointed to by 'data' must equal     E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            *                  to or smaller than 255 bytes.                                E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            * Input:           data    : Pointer to a null-terminated string of data.       E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            *                            If a null character is not found, 255 bytes        E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            *                            of data will be transferred to the host.           E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            * Output:          None                                                         E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            * Side Effects:    None                                                         E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            * Overview:        putsUSBUSART writes a string of data to the USB including    E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            *                  the null character. Use this version, 'puts', to transfer    E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            *                  data located in data memory.                                 E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            * Note:            The transfer mechanism for device-to-host(put) is more       E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            *                  flexible than host-to-device(get). It can handle             E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            *                  a string of data larger than the maximum size of bulk IN     E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            *                  endpoint. A state machine is used to transfer a long         E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            *                  string of data over multiple USB transactions.               E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            *                  See CDCTxService() for more details.                         E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            *****************************************************************************/  E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
00065c   cfd9     MOVFF     0xfd9,0xfe6    void putsUSBUSART(char *data)                                                    E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
00065e   ffe6                                                                                                               
000660   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
000662   ffd9                                                                                                               
000664   52e6     MOVF      0xe6,0x1,0x0                                                                                    
                                           {                                                                                E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                               byte len;                                                                    E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                                                                                            E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                               /*                                                                           E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                * User should have checked that cdc_trf_state is in CDC_TX_READY state      E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                * before calling this function.                                             E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                * As a safety precaution, this fuction checks the state one more time       E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                * to make sure it does not override any pending transactions.               E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                *                                                                           E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                * Currently it just quits the routine without reporting any errors back     E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                * to the user.                                                              E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                *                                                                           E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                * Bottomline: User MUST make sure that mUSBUSARTIsTxTrfReady()==1           E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                *             before calling this function!                                 E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                * Example:                                                                  E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                * if(mUSBUSARTIsTxTrfReady())                                               E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                *     putsUSBUSART(pData);                                                  E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                *                                                                           E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                * IMPORTANT: Never use the following blocking while loop to wait:           E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                * while(!mUSBUSARTIsTxTrfReady())                                           E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                *     putsUSBUSART(pData);                                                  E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                *                                                                           E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                * The whole firmware framework is written based on cooperative              E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                * multi-tasking and a blocking code is not acceptable.                      E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                * Use a state machine instead.                                              E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                */                                                                          E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
000666   0101     MOVLB     0x1                if(cdc_trf_state != CDC_TX_READY) return;                                    E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
000668   5149     MOVF      0x49,0x0,0x1                                                                                    
00066a   e001     BZ        0x66e                                                                                           
00066c   d02f     BRA       0x6cc                                                                                           
                                                                                                                            E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                               /*                                                                           E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                * While loop counts the number of bytes to send including the               E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                * null character.                                                           E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                */                                                                          E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
00066e   6adf     CLRF      0xdf,0x0           len = 0;                                                                     E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                               do                                                                           E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                               {                                                                            E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
000670   2adf     INCF      0xdf,0x1,0x0           len++;                                                                   E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
000672   50df     MOVF      0xdf,0x0,0x0           if(len == 255) break;       // Break loop once max len is reached.       E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
000674   6e10     MOVWF     0x10,0x0                                                                                        
000676   6a11     CLRF      0x11,0x0                                                                                        
000678   0eff     MOVLW     0xff                                                                                            
00067a   1810     XORWF     0x10,0x0,0x0                                                                                    
00067c   e101     BNZ       0x680                                                                                           
00067e   5011     MOVF      0x11,0x0,0x0                                                                                    
000680   e101     BNZ       0x684                                                                                           
000682   d00b     BRA       0x69a                                                                                           
000684   0efd     MOVLW     0xfd               }while(*data++);                                                             E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
000686   cfdb     MOVFF     0xfdb,0xfe9                                                                                     
000688   ffe9                                                                                                               
00068a   2adb     INCF      0xdb,0x1,0x0                                                                                    
00068c   0efe     MOVLW     0xfe                                                                                            
00068e   cfdb     MOVFF     0xfdb,0xfea                                                                                     
000690   ffea                                                                                                               
000692   e301     BNC       0x696                                                                                           
000694   2adb     INCF      0xdb,0x1,0x0                                                                                    
000696   50ef     MOVF      0xef,0x0,0x0                                                                                    
000698   e1eb     BNZ       0x670                                                                                           
                                                                                                                            E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                               /*                                                                           E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                * Re-adjust pointer to its initial location                                 E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                */                                                                          E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
00069a   50df     MOVF      0xdf,0x0,0x0       data-=len;                                                                   E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
00069c   6e10     MOVWF     0x10,0x0                                                                                        
00069e   6a11     CLRF      0x11,0x0                                                                                        
0006a0   50d9     MOVF      0xd9,0x0,0x0                                                                                    
0006a2   0ffd     ADDLW     0xfd                                                                                            
0006a4   6ee9     MOVWF     0xe9,0x0                                                                                        
0006a6   0eff     MOVLW     0xff                                                                                            
0006a8   20da     ADDWFC    0xda,0x0,0x0                                                                                    
0006aa   6eea     MOVWF     0xea,0x0                                                                                        
0006ac   5010     MOVF      0x10,0x0,0x0                                                                                    
0006ae   5eee     SUBWF     0xee,0x1,0x0                                                                                    
0006b0   5011     MOVF      0x11,0x0,0x0                                                                                    
0006b2   5aed     SUBWFB    0xed,0x1,0x0                                                                                    
                                                                                                                            E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                               /*                                                                           E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                * Second piece of information (length of data to send) is ready.            E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                * Call mUSBUSARTTxRam to setup the transfer.                                E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                * The actual transfer process will be handled by CDCTxService(),            E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                * which should be called once per Main Program loop.                        E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                */                                                                          E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
0006b4   0efd     MOVLW     0xfd               mUSBUSARTTxRam((byte*)data,len);     // See cdc.h                            E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
0006b6   cfdb     MOVFF     0xfdb,0x14a                                                                                     
0006b8   f14a                                                                                                               
0006ba   0efe     MOVLW     0xfe                                                                                            
0006bc   cfdb     MOVFF     0xfdb,0x14b                                                                                     
0006be   f14b                                                                                                               
0006c0   cfdf     MOVFF     0xfdf,0x14e                                                                                     
0006c2   f14e                                                                                                               
0006c4   0101     MOVLB     0x1                                                                                             
0006c6   6b4f     CLRF      0x4f,0x1                                                                                        
0006c8   0e01     MOVLW     0x1                                                                                             
0006ca   6f49     MOVWF     0x49,0x1                                                                                        
0006cc   52e5     MOVF      0xe5,0x1,0x0   }//end putsUSBUSART                                                              E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
0006ce   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0006d0   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
0006d2   ffd9                                                                                                               
0006d4   0012     RETURN    0x0                                                                                             
                                                                                                                            E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                           /******************************************************************************  E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            * Function:        void putrsUSBUSART(const rom char *data)                     E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            * PreCondition:    cdc_trf_state must be in the CDC_TX_READY state.             E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            *                  The string of characters pointed to by 'data' must equal     E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            *                  to or smaller than 255 bytes.                                E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            * Input:           data    : Pointer to a null-terminated string of data.       E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            *                            If a null character is not found, 255 bytes        E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            *                            of data will be transferred to the host.           E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            * Output:          None                                                         E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            * Side Effects:    None                                                         E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            * Overview:        putrsUSBUSART writes a string of data to the USB including   E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            *                  the null character. Use this version, 'putrs', to transfer   E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            *                  data literals and data located in program memory.            E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            * Note:            The transfer mechanism for device-to-host(put) is more       E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            *                  flexible than host-to-device(get). It can handle             E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            *                  a string of data larger than the maximum size of bulk IN     E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            *                  endpoint. A state machine is used to transfer a long         E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            *                  string of data over multiple USB transactions.               E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            *                  See CDCTxService() for more details.                         E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            *****************************************************************************/  E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
0006d6   cfd9     MOVFF     0xfd9,0xfe6    void putrsUSBUSART(const rom char *data)                                         E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
0006d8   ffe6                                                                                                               
0006da   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
0006dc   ffd9                                                                                                               
0006de   52e6     MOVF      0xe6,0x1,0x0                                                                                    
                                           {                                                                                E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                               byte len;                                                                    E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                                                                                            E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                               /*                                                                           E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                * User should have checked that cdc_trf_state is in CDC_TX_READY state      E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                * before calling this function.                                             E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                * As a safety precaution, this fuction checks the state one more time       E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                * to make sure it does not override any pending transactions.               E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                *                                                                           E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                * Currently it just quits the routine without reporting any errors back     E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                * to the user.                                                              E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                *                                                                           E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                * Bottomline: User MUST make sure that mUSBUSARTIsTxTrfReady()              E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                *             before calling this function!                                 E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                * Example:                                                                  E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                * if(mUSBUSARTIsTxTrfReady())                                               E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                *     putsUSBUSART(pData);                                                  E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                *                                                                           E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                * IMPORTANT: Never use the following blocking while loop to wait:           E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                * while(cdc_trf_state != CDC_TX_READY)                                      E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                *     putsUSBUSART(pData);                                                  E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                *                                                                           E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                * The whole firmware framework is written based on cooperative              E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                * multi-tasking and a blocking code is not acceptable.                      E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                * Use a state machine instead.                                              E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                */                                                                          E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
0006e0   0101     MOVLB     0x1                if(cdc_trf_state != CDC_TX_READY) return;                                    E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
0006e2   5149     MOVF      0x49,0x0,0x1                                                                                    
0006e4   e001     BZ        0x6e8                                                                                           
0006e6   d030     BRA       0x748                                                                                           
                                                                                                                            E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                               /*                                                                           E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                * While loop counts the number of bytes to send including the               E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                * null character.                                                           E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                */                                                                          E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
0006e8   6adf     CLRF      0xdf,0x0           len = 0;                                                                     E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                               do                                                                           E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                               {                                                                            E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
0006ea   2adf     INCF      0xdf,0x1,0x0           len++;                                                                   E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
0006ec   50df     MOVF      0xdf,0x0,0x0           if(len == 255) break;       // Break loop once max len is reached.       E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
0006ee   6e10     MOVWF     0x10,0x0                                                                                        
0006f0   6a11     CLRF      0x11,0x0                                                                                        
0006f2   0eff     MOVLW     0xff                                                                                            
0006f4   1810     XORWF     0x10,0x0,0x0                                                                                    
0006f6   e101     BNZ       0x6fa                                                                                           
0006f8   5011     MOVF      0x11,0x0,0x0                                                                                    
0006fa   e101     BNZ       0x6fe                                                                                           
0006fc   d00c     BRA       0x716                                                                                           
0006fe   0efd     MOVLW     0xfd               }while(*data++);                                                             E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
000700   cfdb     MOVFF     0xfdb,0xff6                                                                                     
000702   fff6                                                                                                               
000704   2adb     INCF      0xdb,0x1,0x0                                                                                    
000706   0efe     MOVLW     0xfe                                                                                            
000708   cfdb     MOVFF     0xfdb,0xff7                                                                                     
00070a   fff7                                                                                                               
00070c   e301     BNC       0x710                                                                                           
00070e   2adb     INCF      0xdb,0x1,0x0                                                                                    
000710   0008     TBLRD                                                                                                     
000712   50f5     MOVF      0xf5,0x0,0x0                                                                                    
000714   e1ea     BNZ       0x6ea                                                                                           
                                                                                                                            E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                               /*                                                                           E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                * Re-adjust pointer to its initial location                                 E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                */                                                                          E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
000716   50df     MOVF      0xdf,0x0,0x0       data-=len;                                                                   E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
000718   6e10     MOVWF     0x10,0x0                                                                                        
00071a   6a11     CLRF      0x11,0x0                                                                                        
00071c   50d9     MOVF      0xd9,0x0,0x0                                                                                    
00071e   0ffd     ADDLW     0xfd                                                                                            
000720   6ee9     MOVWF     0xe9,0x0                                                                                        
000722   0eff     MOVLW     0xff                                                                                            
000724   20da     ADDWFC    0xda,0x0,0x0                                                                                    
000726   6eea     MOVWF     0xea,0x0                                                                                        
000728   5010     MOVF      0x10,0x0,0x0                                                                                    
00072a   5eee     SUBWF     0xee,0x1,0x0                                                                                    
00072c   5011     MOVF      0x11,0x0,0x0                                                                                    
00072e   5aed     SUBWFB    0xed,0x1,0x0                                                                                    
                                                                                                                            E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                               /*                                                                           E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                * Second piece of information (length of data to send) is ready.            E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                * Call mUSBUSARTTxRom to setup the transfer.                                E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                * The actual transfer process will be handled by CDCTxService(),            E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                * which should be called once per Main Program loop.                        E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                */                                                                          E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
000730   0efd     MOVLW     0xfd               mUSBUSARTTxRom((rom byte*)data,len); // See cdc.h                            E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
000732   cfdb     MOVFF     0xfdb,0x14a                                                                                     
000734   f14a                                                                                                               
000736   0efe     MOVLW     0xfe                                                                                            
000738   cfdb     MOVFF     0xfdb,0x14b                                                                                     
00073a   f14b                                                                                                               
00073c   cfdf     MOVFF     0xfdf,0x14e                                                                                     
00073e   f14e                                                                                                               
000740   0101     MOVLB     0x1                                                                                             
000742   0e01     MOVLW     0x1                                                                                             
000744   6f4f     MOVWF     0x4f,0x1                                                                                        
000746   6f49     MOVWF     0x49,0x1                                                                                        
                                                                                                                            E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
000748   52e5     MOVF      0xe5,0x1,0x0   }//end putrsUSBUSART                                                             E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
00074a   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00074c   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
00074e   ffd9                                                                                                               
000750   0012     RETURN    0x0                                                                                             
                                                                                                                            E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                           /******************************************************************************  E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            * Function:        void CDCTxService(void)                                      E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            * PreCondition:    None                                                         E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            * Input:           None                                                         E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            * Output:          None                                                         E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            * Side Effects:    None                                                         E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            * Overview:        CDCTxService handles device-to-host transaction(s).          E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            *                  This function should be called once per Main Program loop.   E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            * Note:            None                                                         E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                            *****************************************************************************/  E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
000752   cfd9     MOVFF     0xfd9,0xfe6    void CDCTxService(void)                                                          E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
000754   ffe6                                                                                                               
000756   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
000758   ffd9                                                                                                               
00075a   52e6     MOVF      0xe6,0x1,0x0                                                                                    
                                           {                                                                                E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                               byte byte_to_send;                                                           E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                                                                                            E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
00075c   0104     MOVLB     0x4                if(mCDCUsartTxIsBusy()) return;                                              E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
00075e   bf1c     BTFSC     0x1c,0x7,0x1                                                                                    
000760   d06b     BRA       0x838                                                                                           
                                               /*                                                                           E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                * Completing stage is necessary while [ mCDCUSartTxIsBusy()==1 ].           E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                * By having this stage, user can always check cdc_trf_state,                E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                * and not having to call mCDCUsartTxIsBusy() directly.                      E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                */                                                                          E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
000762   0e03     MOVLW     0x3                if(cdc_trf_state == CDC_TX_COMPLETING)                                       E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
000764   0101     MOVLB     0x1                                                                                             
000766   5d49     SUBWF     0x49,0x0,0x1                                                                                    
000768   e101     BNZ       0x76c                                                                                           
00076a   6b49     CLRF      0x49,0x1               cdc_trf_state = CDC_TX_READY;                                            E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                                                                                            E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                               /*                                                                           E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                * If CDC_TX_READY state, nothing to do, just return.                        E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                */                                                                          E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
00076c   5149     MOVF      0x49,0x0,0x1       if(cdc_trf_state == CDC_TX_READY) return;                                    E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
00076e   e101     BNZ       0x772                                                                                           
000770   d063     BRA       0x838                                                                                           
                                                                                                                            E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                               /*                                                                           E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                * If CDC_TX_BUSY_ZLP state, send zero length packet                         E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                */                                                                          E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
000772   0e02     MOVLW     0x2                if(cdc_trf_state == CDC_TX_BUSY_ZLP)                                         E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
000774   5d49     SUBWF     0x49,0x0,0x1                                                                                    
000776   e106     BNZ       0x784                                                                                           
                                               {                                                                            E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
000778   0104     MOVLB     0x4                    CDC_BULK_BD_IN.Cnt = 0;                                                  E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
00077a   6b1d     CLRF      0x1d,0x1                                                                                        
00077c   0101     MOVLB     0x1                    cdc_trf_state = CDC_TX_COMPLETING;                                       E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
00077e   0e03     MOVLW     0x3                                                                                             
000780   6f49     MOVWF     0x49,0x1                                                                                        
                                               }                                                                            E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
000782   d054     BRA       0x82c              else if(cdc_trf_state == CDC_TX_BUSY)                                        E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
000784   0549     DECF      0x49,0x0,0x1                                                                                    
000786   e152     BNZ       0x82c                                                                                           
                                               {                                                                            E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                   /*                                                                       E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                    * First, have to figure out how many byte of data to send.              E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                    */                                                                      E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
000788   0e40     MOVLW     0x40               	if(cdc_tx_len > sizeof(cdc_data_tx))                                        E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
00078a   6e10     MOVWF     0x10,0x0                                                                                        
00078c   6a11     CLRF      0x11,0x0                                                                                        
00078e   514e     MOVF      0x4e,0x0,0x1                                                                                    
000790   5c10     SUBWF     0x10,0x0,0x0                                                                                    
000792   0e00     MOVLW     0x0                                                                                             
000794   5811     SUBWFB    0x11,0x0,0x0                                                                                    
000796   e203     BC        0x79e                                                                                           
000798   0e40     MOVLW     0x40               	    byte_to_send = sizeof(cdc_data_tx);                                     E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
00079a   6edf     MOVWF     0xdf,0x0                                                                                        
00079c   d002     BRA       0x7a2              	else                                                                        E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
00079e   c14e     MOVFF     0x14e,0xfdf        	    byte_to_send = cdc_tx_len;                                              E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
0007a0   ffdf                                                                                                               
                                                                                                                            E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                   /*                                                                       E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                    * Next, load the number of bytes to send to Cnt in buffer descriptor    E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                    */                                                                      E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
0007a2   cfdf     MOVFF     0xfdf,0x41d            CDC_BULK_BD_IN.Cnt = byte_to_send;                                       E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
0007a4   f41d                                                                                                               
                                                                                                                            E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                   /*                                                                       E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                    * Subtract the number of bytes just about to be sent from the total.    E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                    */                                                                      E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
0007a6   50df     MOVF      0xdf,0x0,0x0       	cdc_tx_len = cdc_tx_len - byte_to_send;                                     E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
0007a8   5d4e     SUBWF     0x4e,0x0,0x1                                                                                    
0007aa   6f4e     MOVWF     0x4e,0x1                                                                                        
                                               	                                                                            E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
0007ac   0e48     MOVLW     0x48                   pCDCDst.bRam = (byte*)&cdc_data_tx; // Set destination pointer           E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
0007ae   6f4c     MOVWF     0x4c,0x1                                                                                        
0007b0   0e05     MOVLW     0x5                                                                                             
0007b2   6f4d     MOVWF     0x4d,0x1                                                                                        
                                                                                                                            E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
0007b4   054f     DECF      0x4f,0x0,0x1           if(cdc_mem_type == _ROM)            // Determine type of memory source   E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
0007b6   e115     BNZ       0x7e2                                                                                           
                                                   {                                                                        E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
0007b8   50df     MOVF      0xdf,0x0,0x0               while(byte_to_send)                                                  E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
0007ba   e012     BZ        0x7e0                                                                                           
0007de   d7ec     BRA       0x7b8                                                                                           
                                                       {                                                                    E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
0007bc   c14a     MOVFF     0x14a,0xff6                    *pCDCDst.bRam = *pCDCSrc.bRom;                                   E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
0007be   fff6                                                                                                               
0007c0   c14b     MOVFF     0x14b,0xff7                                                                                     
0007c2   fff7                                                                                                               
0007c4   0008     TBLRD                                                                                                     
0007c6   50f5     MOVF      0xf5,0x0,0x0                                                                                    
0007c8   c14c     MOVFF     0x14c,0xfe9                                                                                     
0007ca   ffe9                                                                                                               
0007cc   c14d     MOVFF     0x14d,0xfea                                                                                     
0007ce   ffea                                                                                                               
0007d0   6eef     MOVWF     0xef,0x0                                                                                        
0007d2   2b4c     INCF      0x4c,0x1,0x1                   pCDCDst.bRam++;                                                  E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
0007d4   0e00     MOVLW     0x0                                                                                             
0007d6   234d     ADDWFC    0x4d,0x1,0x1                                                                                    
0007d8   2b4a     INCF      0x4a,0x1,0x1                   pCDCSrc.bRom++;                                                  E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
0007da   234b     ADDWFC    0x4b,0x1,0x1                                                                                    
0007dc   06df     DECF      0xdf,0x1,0x0                   byte_to_send--;                                                  E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                       }//end while(byte_to_send)                                           E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                   }                                                                        E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
0007e0   d013     BRA       0x808                  else // _RAM                                                             E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                   {                                                                        E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
0007e2   50df     MOVF      0xdf,0x0,0x0               while(byte_to_send)                                                  E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
0007e4   e011     BZ        0x808                                                                                           
000806   d7ed     BRA       0x7e2                                                                                           
                                                       {                                                                    E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
0007e6   c14a     MOVFF     0x14a,0xfe9                    *pCDCDst.bRam = *pCDCSrc.bRam;                                   E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
0007e8   ffe9                                                                                                               
0007ea   c14b     MOVFF     0x14b,0xfea                                                                                     
0007ec   ffea                                                                                                               
0007ee   50ef     MOVF      0xef,0x0,0x0                                                                                    
0007f0   c14c     MOVFF     0x14c,0xfe9                                                                                     
0007f2   ffe9                                                                                                               
0007f4   c14d     MOVFF     0x14d,0xfea                                                                                     
0007f6   ffea                                                                                                               
0007f8   6eef     MOVWF     0xef,0x0                                                                                        
0007fa   2b4c     INCF      0x4c,0x1,0x1                   pCDCDst.bRam++;                                                  E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
0007fc   0e00     MOVLW     0x0                                                                                             
0007fe   234d     ADDWFC    0x4d,0x1,0x1                                                                                    
000800   2b4a     INCF      0x4a,0x1,0x1                   pCDCSrc.bRam++;                                                  E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
000802   234b     ADDWFC    0x4b,0x1,0x1                                                                                    
000804   06df     DECF      0xdf,0x1,0x0                   byte_to_send--;                                                  E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                       }//end while(byte_to_send._word)                                     E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                   }//end if(cdc_mem_type...)                                               E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                                                                                            E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                   /*                                                                       E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                    * Lastly, determine if a zero length packet state is necessary.         E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                    * See explanation in USB Specification 2.0: Section 5.8.3               E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                    */                                                                      E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
000808   514e     MOVF      0x4e,0x0,0x1           if(cdc_tx_len == 0)                                                      E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
00080a   e110     BNZ       0x82c                                                                                           
                                                   {                                                                        E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
00080c   0104     MOVLB     0x4                        if(CDC_BULK_BD_IN.Cnt == sizeof(cdc_data_tx))                        E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
00080e   511d     MOVF      0x1d,0x0,0x1                                                                                    
000810   6e10     MOVWF     0x10,0x0                                                                                        
000812   6a11     CLRF      0x11,0x0                                                                                        
000814   0e40     MOVLW     0x40                                                                                            
000816   1810     XORWF     0x10,0x0,0x0                                                                                    
000818   e101     BNZ       0x81c                                                                                           
00081a   5011     MOVF      0x11,0x0,0x0                                                                                    
00081c   e104     BNZ       0x826                                                                                           
00081e   0101     MOVLB     0x1                            cdc_trf_state = CDC_TX_BUSY_ZLP;                                 E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
000820   0e02     MOVLW     0x2                                                                                             
000822   6f49     MOVWF     0x49,0x1                                                                                        
000824   d003     BRA       0x82c                      else                                                                 E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
000826   0101     MOVLB     0x1                            cdc_trf_state = CDC_TX_COMPLETING;                               E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
000828   0e03     MOVLW     0x3                                                                                             
00082a   6f49     MOVWF     0x49,0x1                                                                                        
                                                   }//end if(cdc_tx_len...)                                                 E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                                                                                            E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                               }//end if(cdc_tx_sate == CDC_TX_BUSY)                                        E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                                                                                            E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                               /*                                                                           E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                * Both CDC_TX_BUSY and CDC_TX_BUSY_ZLP states use the following macro       E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                */                                                                          E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
00082c   0e40     MOVLW     0x40               mUSBBufferReady(CDC_BULK_BD_IN);                                             E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
00082e   0104     MOVLB     0x4                                                                                             
000830   171c     ANDWF     0x1c,0x1,0x1                                                                                    
000832   7d1c     BTG       0x1c,0x6,0x1                                                                                    
000834   0e88     MOVLW     0x88                                                                                            
000836   131c     IORWF     0x1c,0x1,0x1                                                                                    
                                                                                                                            E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
000838   52e5     MOVF      0xe5,0x1,0x0   }//end CDCTxService                                                              E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
00083a   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00083c   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
00083e   ffd9                                                                                                               
000840   0012     RETURN    0x0                                                                                             
                                                                                                                            E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                           #endif //USB_USE_CDC                                                             E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                                                                                                            E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                           /** EOF cdc.c ****************************************************************/  E:\usb20\FCounter20\system\usb\class\cdc\cdc.c
                                           /*********************************************************************           E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                            *                Microchip USB C18 Firmware Version 1.0                         E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                            *********************************************************************           E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                            * FileName:        usb9.c                                                       E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                            * Dependencies:    See INCLUDES section below                                   E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                            * Processor:       PIC18                                                        E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                            * Compiler:        C18 2.30.01+                                                 E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                            * Company:         Microchip Technology, Inc.                                   E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                            * Software License Agreement                                                    E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                            * The software supplied herewith by Microchip Technology Incorporated           E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                            * (the 鼎ompany・ for its PICmicroｮ Microcontroller is intended and             E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                            * supplied to you, the Company痴 customer, for use solely and                   E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                            * exclusively on Microchip PICmicro Microcontroller products. The               E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                            * software is owned by the Company and/or its supplier, and is                  E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                            * protected under applicable copyright laws. All rights are reserved.           E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                            * Any use in violation of the foregoing restrictions may subject the            E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                            * user to criminal sanctions under applicable laws, as well as to               E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                            * civil liability for the breach of the terms and conditions of this            E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                            * license.                                                                      E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                            * THIS SOFTWARE IS PROVIDED IN AN 鄭S IS・CONDITION. NO WARRANTIES,             E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                            * WHETHER EXPRESS, IMPLIED OR STATUTORY, INCLUDING, BUT NOT LIMITED             E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                            * TO, IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A                   E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                            * PARTICULAR PURPOSE APPLY TO THIS SOFTWARE. THE COMPANY SHALL NOT,             E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                            * IN ANY CIRCUMSTANCES, BE LIABLE FOR SPECIAL, INCIDENTAL OR                    E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                            * CONSEQUENTIAL DAMAGES, FOR ANY REASON WHATSOEVER.                             E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                            * Author               Date        Comment                                      E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                            *~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~           E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                            * Rawin Rojvanit       11/19/04    Original.                                    E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                            ********************************************************************/           E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                                                                                                            E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                           /** I N C L U D E S **********************************************************/  E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                           #include <p18cxxx.h>                                                             E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                           #include "system\typedefs.h"                                                     E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                           #include "system\usb\usb.h"                                                      E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                           #include "io_cfg.h"                     // Required for self_power status        E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                                                                                                            E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                           /** V A R I A B L E S ********************************************************/  E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                           #pragma udata                                                                    E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                                                                                                            E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                           /** P R I V A T E  P R O T O T Y P E S ***************************************/  E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                           void USBStdGetDscHandler(void);                                                  E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                           void USBStdSetCfgHandler(void);                                                  E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                           void USBStdGetStatusHandler(void);                                               E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                           void USBStdFeatureReqHandler(void);                                              E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                                                                                                            E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                           /** D E C L A R A T I O N S **************************************************/  E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                           #pragma code                                                                     E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                           /******************************************************************************  E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                            * Function:        void USBCheckStdRequest(void)                                E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                            * PreCondition:    None                                                         E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                            * Input:           None                                                         E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                            * Output:          None                                                         E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                            * Side Effects:    None                                                         E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                            * Overview:        This routine checks the setup data packet to see if it       E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                            *                  knows how to handle it                                       E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                            * Note:            None                                                         E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                            *****************************************************************************/  E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                           void USBCheckStdRequest(void)                                                    E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                           {                                                                                E:\usb20\FCounter20\system\usb\usb9\usb9.c
000842   0104     MOVLB     0x4                if(SetupPkt.RequestType != STANDARD) return;                                 E:\usb20\FCounter20\system\usb\usb9\usb9.c
000844   5120     MOVF      0x20,0x0,0x1                                                                                    
000846   0b60     ANDLW     0x60                                                                                            
000848   42e8     RRNCF     0xe8,0x1,0x0                                                                                    
00084a   42e8     RRNCF     0xe8,0x1,0x0                                                                                    
00084c   42e8     RRNCF     0xe8,0x1,0x0                                                                                    
00084e   42e8     RRNCF     0xe8,0x1,0x0                                                                                    
000850   42e8     RRNCF     0xe8,0x1,0x0                                                                                    
000852   0900     IORLW     0x0                                                                                             
000854   e001     BZ        0x858                                                                                           
000856   d055     BRA       0x902                                                                                           
                                                                                                                            E:\usb20\FCounter20\system\usb\usb9\usb9.c
000858   5121     MOVF      0x21,0x0,0x1       switch(SetupPkt.bRequest)                                                    E:\usb20\FCounter20\system\usb\usb9\usb9.c
00085a   0a07     XORLW     0x7                                                                                             
00085c   e051     BZ        0x900                                                                                           
00085e   0a0b     XORLW     0xb                                                                                             
000860   e04f     BZ        0x900                                                                                           
000862   0a07     XORLW     0x7                                                                                             
000864   e040     BZ        0x8e6                                                                                           
000866   0a01     XORLW     0x1                                                                                             
000868   e02c     BZ        0x8c2                                                                                           
00086a   0a0b     XORLW     0xb                                                                                             
00086c   e028     BZ        0x8be                                                                                           
00086e   0a02     XORLW     0x2                                                                                             
000870   e026     BZ        0x8be                                                                                           
000872   0a03     XORLW     0x3                                                                                             
000874   e022     BZ        0x8ba                                                                                           
000876   0a08     XORLW     0x8                                                                                             
000878   e012     BZ        0x89e                                                                                           
00087a   0a01     XORLW     0x1                                                                                             
00087c   e00e     BZ        0x89a                                                                                           
00087e   0a0f     XORLW     0xf                                                                                             
000880   e00a     BZ        0x896                                                                                           
000882   0a03     XORLW     0x3                                                                                             
000884   e001     BZ        0x888                                                                                           
000886   d03c     BRA       0x900                                                                                           
                                               {                                                                            E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                                   case SET_ADR:                                                            E:\usb20\FCounter20\system\usb\usb9\usb9.c
000888   0100     MOVLB     0x0                        ctrl_trf_session_owner = MUID_USB9;                                  E:\usb20\FCounter20\system\usb\usb9\usb9.c
00088a   0e01     MOVLW     0x1                                                                                             
00088c   6ff5     MOVWF     0xf5,0x1                                                                                        
00088e   0100     MOVLB     0x0                        usb_device_state = ADR_PENDING_STATE;       // Update state only     E:\usb20\FCounter20\system\usb\usb9\usb9.c
000890   0e04     MOVLW     0x4                                                                                             
000892   6ffc     MOVWF     0xfc,0x1                                                                                        
                                                       /* See USBCtrlTrfInHandler() in usbctrltrf.c for the next step */    E:\usb20\FCounter20\system\usb\usb9\usb9.c
000894   d036     BRA       0x902                      break;                                                               E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                                   case GET_DSC:                                                            E:\usb20\FCounter20\system\usb\usb9\usb9.c
000896   d836     RCALL     0x904                      USBStdGetDscHandler();                                               E:\usb20\FCounter20\system\usb\usb9\usb9.c
000898   d034     BRA       0x902                      break;                                                               E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                                   case SET_CFG:                                                            E:\usb20\FCounter20\system\usb\usb9\usb9.c
00089a   d890     RCALL     0x9bc                      USBStdSetCfgHandler();                                               E:\usb20\FCounter20\system\usb\usb9\usb9.c
00089c   d032     BRA       0x902                      break;                                                               E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                                   case GET_CFG:                                                            E:\usb20\FCounter20\system\usb\usb9\usb9.c
00089e   0100     MOVLB     0x0                        ctrl_trf_session_owner = MUID_USB9;                                  E:\usb20\FCounter20\system\usb\usb9\usb9.c
0008a0   0e01     MOVLW     0x1                                                                                             
0008a2   6ff5     MOVWF     0xf5,0x1                                                                                        
0008a4   0100     MOVLB     0x0                        pSrc.bRam = (byte*)&usb_active_cfg;         // Set Source            E:\usb20\FCounter20\system\usb\usb9\usb9.c
0008a6   0efe     MOVLW     0xfe                                                                                            
0008a8   6ff6     MOVWF     0xf6,0x1                                                                                        
0008aa   0e00     MOVLW     0x0                                                                                             
0008ac   6ff7     MOVWF     0xf7,0x1                                                                                        
0008ae   0100     MOVLB     0x0                        usb_stat.ctrl_trf_mem = _RAM;               // Set memory type       E:\usb20\FCounter20\system\usb\usb9\usb9.c
0008b0   93fd     BCF       0xfd,0x1,0x1                                                                                    
0008b2   0100     MOVLB     0x0                        LSB(wCount) = 1;                            // Set data count        E:\usb20\FCounter20\system\usb\usb9\usb9.c
0008b4   0e01     MOVLW     0x1                                                                                             
0008b6   6ffa     MOVWF     0xfa,0x1                                                                                        
0008b8   d024     BRA       0x902                      break;                                                               E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                                   case GET_STATUS:                                                         E:\usb20\FCounter20\system\usb\usb9\usb9.c
0008ba   d8a8     RCALL     0xa0c                      USBStdGetStatusHandler();                                            E:\usb20\FCounter20\system\usb\usb9\usb9.c
0008bc   d022     BRA       0x902                      break;                                                               E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                                   case CLR_FEATURE:                                                        E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                                   case SET_FEATURE:                                                        E:\usb20\FCounter20\system\usb\usb9\usb9.c
0008be   d8f4     RCALL     0xaa8                      USBStdFeatureReqHandler();                                           E:\usb20\FCounter20\system\usb\usb9\usb9.c
0008c0   d020     BRA       0x902                      break;                                                               E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                                   case GET_INTF:                                                           E:\usb20\FCounter20\system\usb\usb9\usb9.c
0008c2   0100     MOVLB     0x0                        ctrl_trf_session_owner = MUID_USB9;                                  E:\usb20\FCounter20\system\usb\usb9\usb9.c
0008c4   0e01     MOVLW     0x1                                                                                             
0008c6   6ff5     MOVWF     0xf5,0x1                                                                                        
0008c8   0104     MOVLB     0x4                        pSrc.bRam = (byte*)&usb_alt_intf+SetupPkt.bIntfID;  // Set source    E:\usb20\FCounter20\system\usb\usb9\usb9.c
0008ca   5124     MOVF      0x24,0x0,0x1                                                                                    
0008cc   0100     MOVLB     0x0                                                                                             
0008ce   6ff6     MOVWF     0xf6,0x1                                                                                        
0008d0   6bf7     CLRF      0xf7,0x1                                                                                        
0008d2   0eff     MOVLW     0xff                                                                                            
0008d4   27f6     ADDWF     0xf6,0x1,0x1                                                                                    
0008d6   0e00     MOVLW     0x0                                                                                             
0008d8   23f7     ADDWFC    0xf7,0x1,0x1                                                                                    
0008da   0100     MOVLB     0x0                        usb_stat.ctrl_trf_mem = _RAM;               // Set memory type       E:\usb20\FCounter20\system\usb\usb9\usb9.c
0008dc   93fd     BCF       0xfd,0x1,0x1                                                                                    
0008de   0100     MOVLB     0x0                        LSB(wCount) = 1;                            // Set data count        E:\usb20\FCounter20\system\usb\usb9\usb9.c
0008e0   0e01     MOVLW     0x1                                                                                             
0008e2   6ffa     MOVWF     0xfa,0x1                                                                                        
0008e4   d00e     BRA       0x902                      break;                                                               E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                                   case SET_INTF:                                                           E:\usb20\FCounter20\system\usb\usb9\usb9.c
0008e6   0100     MOVLB     0x0                        ctrl_trf_session_owner = MUID_USB9;                                  E:\usb20\FCounter20\system\usb\usb9\usb9.c
0008e8   0e01     MOVLW     0x1                                                                                             
0008ea   6ff5     MOVWF     0xf5,0x1                                                                                        
0008ec   0104     MOVLB     0x4                        usb_alt_intf[SetupPkt.bIntfID] = SetupPkt.bAltID;                    E:\usb20\FCounter20\system\usb\usb9\usb9.c
0008ee   5124     MOVF      0x24,0x0,0x1                                                                                    
0008f0   6aea     CLRF      0xea,0x0                                                                                        
0008f2   0fff     ADDLW     0xff                                                                                            
0008f4   6ee9     MOVWF     0xe9,0x0                                                                                        
0008f6   0e00     MOVLW     0x0                                                                                             
0008f8   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
0008fa   c422     MOVFF     0x422,0xfef                                                                                     
0008fc   ffef                                                                                                               
0008fe   d001     BRA       0x902                      break;                                                               E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                                   case SET_DSC:                                                            E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                                   case SYNCH_FRAME:                                                        E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                                   default:                                                                 E:\usb20\FCounter20\system\usb\usb9\usb9.c
000900   d000     BRA       0x902                      break;                                                               E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                               }//end switch                                                                E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                                                                                                            E:\usb20\FCounter20\system\usb\usb9\usb9.c
000902   0012     RETURN    0x0            }//end USBCheckStdRequest                                                        E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                                                                                                            E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                           /******************************************************************************  E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                            * Function:        void USBStdGetDscHandler(void)                               E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                            * PreCondition:    None                                                         E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                            * Input:           None                                                         E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                            * Output:          None                                                         E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                            * Side Effects:    None                                                         E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                            * Overview:        This routine handles the standard GET_DESCRIPTOR request.    E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                            *                  It utilizes tables dynamically looks up descriptor size.     E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                            *                  This routine should never have to be modified if the tables  E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                            *                  in usbdsc.c are declared correctly.                          E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                            * Note:            None                                                         E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                            *****************************************************************************/  E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                           void USBStdGetDscHandler(void)                                                   E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                           {                                                                                E:\usb20\FCounter20\system\usb\usb9\usb9.c
000904   0e80     MOVLW     0x80               if(SetupPkt.bmRequestType == 0x80)                                           E:\usb20\FCounter20\system\usb\usb9\usb9.c
000906   0104     MOVLB     0x4                                                                                             
000908   5d20     SUBWF     0x20,0x0,0x1                                                                                    
00090a   e157     BNZ       0x9ba                                                                                           
                                               {                                                                            E:\usb20\FCounter20\system\usb\usb9\usb9.c
00090c   5123     MOVF      0x23,0x0,0x1           switch(SetupPkt.bDscType)                                                E:\usb20\FCounter20\system\usb\usb9\usb9.c
00090e   0a03     XORLW     0x3                                                                                             
000910   e034     BZ        0x97a                                                                                           
000912   0a01     XORLW     0x1                                                                                             
000914   e010     BZ        0x936                                                                                           
000916   0a03     XORLW     0x3                                                                                             
000918   e001     BZ        0x91c                                                                                           
00091a   d04d     BRA       0x9b6                                                                                           
                                                   {                                                                        E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                                       case DSC_DEV:                                                        E:\usb20\FCounter20\system\usb\usb9\usb9.c
00091c   0100     MOVLB     0x0                            ctrl_trf_session_owner = MUID_USB9;                              E:\usb20\FCounter20\system\usb\usb9\usb9.c
00091e   0e01     MOVLW     0x1                                                                                             
000920   6ff5     MOVWF     0xf5,0x1                                                                                        
000922   0100     MOVLB     0x0                            pSrc.bRom = (rom byte*)&device_dsc;                              E:\usb20\FCounter20\system\usb\usb9\usb9.c
000924   0e5a     MOVLW     0x5a                                                                                            
000926   6ff6     MOVWF     0xf6,0x1                                                                                        
000928   0e11     MOVLW     0x11                                                                                            
00092a   6ff7     MOVWF     0xf7,0x1                                                                                        
00092c   0e12     MOVLW     0x12                           wCount._word = sizeof(device_dsc);          // Set data count    E:\usb20\FCounter20\system\usb\usb9\usb9.c
00092e   0100     MOVLB     0x0                                                                                             
000930   6ffa     MOVWF     0xfa,0x1                                                                                        
000932   6bfb     CLRF      0xfb,0x1                                                                                        
000934   d040     BRA       0x9b6                          break;                                                           E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                                       case DSC_CFG:                                                        E:\usb20\FCounter20\system\usb\usb9\usb9.c
000936   0100     MOVLB     0x0                            ctrl_trf_session_owner = MUID_USB9;                              E:\usb20\FCounter20\system\usb\usb9\usb9.c
000938   0e01     MOVLW     0x1                                                                                             
00093a   6ff5     MOVWF     0xf5,0x1                                                                                        
00093c   0104     MOVLB     0x4                            pSrc.bRom = *(USB_CD_Ptr+SetupPkt.bDscIndex);                    E:\usb20\FCounter20\system\usb\usb9\usb9.c
00093e   5122     MOVF      0x22,0x0,0x1                                                                                    
000940   6ef6     MOVWF     0xf6,0x0                                                                                        
000942   6af7     CLRF      0xf7,0x0                                                                                        
000944   90d8     BCF       0xd8,0x0,0x0                                                                                    
000946   36f6     RLCF      0xf6,0x1,0x0                                                                                    
000948   36f7     RLCF      0xf7,0x1,0x0                                                                                    
00094a   0e01     MOVLW     0x1                                                                                             
00094c   26f6     ADDWF     0xf6,0x1,0x0                                                                                    
00094e   0e12     MOVLW     0x12                                                                                            
000950   22f7     ADDWFC    0xf7,0x1,0x0                                                                                    
000952   0009     TBLRDPOSTINC                                                                                              
000954   cff5     MOVFF     0xff5,0xf6                                                                                      
000956   f0f6                                                                                                               
000958   000a     TBLRDPOSTDEC                                                                                              
00095a   cff5     MOVFF     0xff5,0xf7                                                                                      
00095c   f0f7                                                                                                               
00095e   0e02     MOVLW     0x2                            wCount._word = *(pSrc.wRom+1);              // Set data count    E:\usb20\FCounter20\system\usb\usb9\usb9.c
000960   0100     MOVLB     0x0                                                                                             
000962   6af7     CLRF      0xf7,0x0                                                                                        
000964   25f6     ADDWF     0xf6,0x0,0x1                                                                                    
000966   6ef6     MOVWF     0xf6,0x0                                                                                        
000968   51f7     MOVF      0xf7,0x0,0x1                                                                                    
00096a   22f7     ADDWFC    0xf7,0x1,0x0                                                                                    
00096c   0009     TBLRDPOSTINC                                                                                              
00096e   cff5     MOVFF     0xff5,0xfa                                                                                      
000970   f0fa                                                                                                               
000972   000a     TBLRDPOSTDEC                                                                                              
000974   cff5     MOVFF     0xff5,0xfb                                                                                      
000976   f0fb                                                                                                               
000978   d01e     BRA       0x9b6                          break;                                                           E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                                       case DSC_STR:                                                        E:\usb20\FCounter20\system\usb\usb9\usb9.c
00097a   0100     MOVLB     0x0                            ctrl_trf_session_owner = MUID_USB9;                              E:\usb20\FCounter20\system\usb\usb9\usb9.c
00097c   0e01     MOVLW     0x1                                                                                             
00097e   6ff5     MOVWF     0xf5,0x1                                                                                        
000980   0104     MOVLB     0x4                            pSrc.bRom = *(USB_SD_Ptr+SetupPkt.bDscIndex);                    E:\usb20\FCounter20\system\usb\usb9\usb9.c
000982   5122     MOVF      0x22,0x0,0x1                                                                                    
000984   6ef6     MOVWF     0xf6,0x0                                                                                        
000986   6af7     CLRF      0xf7,0x0                                                                                        
000988   90d8     BCF       0xd8,0x0,0x0                                                                                    
00098a   36f6     RLCF      0xf6,0x1,0x0                                                                                    
00098c   36f7     RLCF      0xf7,0x1,0x0                                                                                    
00098e   0e05     MOVLW     0x5                                                                                             
000990   26f6     ADDWF     0xf6,0x1,0x0                                                                                    
000992   0e12     MOVLW     0x12                                                                                            
000994   22f7     ADDWFC    0xf7,0x1,0x0                                                                                    
000996   0009     TBLRDPOSTINC                                                                                              
000998   cff5     MOVFF     0xff5,0xf6                                                                                      
00099a   f0f6                                                                                                               
00099c   000a     TBLRDPOSTDEC                                                                                              
00099e   cff5     MOVFF     0xff5,0xf7                                                                                      
0009a0   f0f7                                                                                                               
0009a2   c0f6     MOVFF     0xf6,0xff6                     wCount._word = *pSrc.bRom;                  // Set data count    E:\usb20\FCounter20\system\usb\usb9\usb9.c
0009a4   fff6                                                                                                               
0009a6   c0f7     MOVFF     0xf7,0xff7                                                                                      
0009a8   fff7                                                                                                               
0009aa   0008     TBLRD                                                                                                     
0009ac   50f5     MOVF      0xf5,0x0,0x0                                                                                    
0009ae   0100     MOVLB     0x0                                                                                             
0009b0   6ffa     MOVWF     0xfa,0x1                                                                                        
0009b2   6bfb     CLRF      0xfb,0x1                                                                                        
0009b4   d000     BRA       0x9b6                          break;                                                           E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                                   }//end switch                                                            E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                                                                                                            E:\usb20\FCounter20\system\usb\usb9\usb9.c
0009b6   0100     MOVLB     0x0                    usb_stat.ctrl_trf_mem = _ROM;                       // Set memory type   E:\usb20\FCounter20\system\usb\usb9\usb9.c
0009b8   83fd     BSF       0xfd,0x1,0x1                                                                                    
                                               }//end if                                                                    E:\usb20\FCounter20\system\usb\usb9\usb9.c
0009ba   0012     RETURN    0x0            }//end USBStdGetDscHandler                                                       E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                                                                                                            E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                           /******************************************************************************  E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                            * Function:        void USBStdSetCfgHandler(void)                               E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                            * PreCondition:    None                                                         E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                            * Input:           None                                                         E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                            * Output:          None                                                         E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                            * Side Effects:    None                                                         E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                            * Overview:        This routine first disables all endpoints by clearing        E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                            *                  UEP registers. It then configures (initializes) endpoints    E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                            *                  specified in the modifiable section.                         E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                            * Note:            None                                                         E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                            *****************************************************************************/  E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                           void USBStdSetCfgHandler(void)                                                   E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                           {                                                                                E:\usb20\FCounter20\system\usb\usb9\usb9.c
0009bc   0100     MOVLB     0x0                ctrl_trf_session_owner = MUID_USB9;                                          E:\usb20\FCounter20\system\usb\usb9\usb9.c
0009be   0e01     MOVLW     0x1                                                                                             
0009c0   6ff5     MOVWF     0xf5,0x1                                                                                        
0009c2   0e0f     MOVLW     0xf                mDisableEP1to15();                          // See usbdrv.h                  E:\usb20\FCounter20\system\usb\usb9\usb9.c
0009c4   6ee6     MOVWF     0xe6,0x0                                                                                        
0009c6   0e71     MOVLW     0x71                                                                                            
0009c8   6ee6     MOVWF     0xe6,0x0                                                                                        
0009ca   0e0f     MOVLW     0xf                                                                                             
0009cc   6ee6     MOVWF     0xe6,0x0                                                                                        
0009ce   ec98     CALL      0x1130,0x0                                                                                      
0009d0   f008                                                                                                               
0009d2   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0009d4   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0009d6   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0009d8   0e01     MOVLW     0x1                ClearArray((byte*)&usb_alt_intf,MAX_NUM_INT);                                E:\usb20\FCounter20\system\usb\usb9\usb9.c
0009da   6ee6     MOVWF     0xe6,0x0                                                                                        
0009dc   0eff     MOVLW     0xff                                                                                            
0009de   6ee6     MOVWF     0xe6,0x0                                                                                        
0009e0   0e00     MOVLW     0x0                                                                                             
0009e2   6ee6     MOVWF     0xe6,0x0                                                                                        
0009e4   ec98     CALL      0x1130,0x0                                                                                      
0009e6   f008                                                                                                               
0009e8   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0009ea   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0009ec   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0009ee   c422     MOVFF     0x422,0xfe         usb_active_cfg = SetupPkt.bCfgValue;                                         E:\usb20\FCounter20\system\usb\usb9\usb9.c
0009f0   f0fe                                                                                                               
0009f2   0104     MOVLB     0x4                if(SetupPkt.bCfgValue == 0)                                                  E:\usb20\FCounter20\system\usb\usb9\usb9.c
0009f4   5122     MOVF      0x22,0x0,0x1                                                                                    
0009f6   e104     BNZ       0xa00                                                                                           
0009f8   0100     MOVLB     0x0                    usb_device_state = ADDRESS_STATE;                                        E:\usb20\FCounter20\system\usb\usb9\usb9.c
0009fa   0e05     MOVLW     0x5                                                                                             
0009fc   6ffc     MOVWF     0xfc,0x1                                                                                        
0009fe   d005     BRA       0xa0a              else                                                                         E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                               {                                                                            E:\usb20\FCounter20\system\usb\usb9\usb9.c
000a00   0100     MOVLB     0x0                    usb_device_state = CONFIGURED_STATE;                                     E:\usb20\FCounter20\system\usb\usb9\usb9.c
000a02   0e06     MOVLW     0x6                                                                                             
000a04   6ffc     MOVWF     0xfc,0x1                                                                                        
                                                                                                                            E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                                   /* Modifiable Section */                                                 E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                                                                                                            E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                                   #if defined(USB_USE_CDC)                // See autofiles\usbcfg.h        E:\usb20\FCounter20\system\usb\usb9\usb9.c
000a06   ecc6     CALL      0x58c,0x0              CDCInitEP();                                                             E:\usb20\FCounter20\system\usb\usb9\usb9.c
000a08   f002                                                                                                               
                                                   #endif                                                                   E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                                                                                                            E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                                   /* End modifiable section */                                             E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                                                                                                            E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                               }//end if(SetupPkt.bcfgValue == 0)                                           E:\usb20\FCounter20\system\usb\usb9\usb9.c
000a0a   0012     RETURN    0x0            }//end USBStdSetCfgHandler                                                       E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                                                                                                            E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                           /******************************************************************************  E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                            * Function:        void USBStdGetStatusHandler(void)                            E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                            * PreCondition:    None                                                         E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                            * Input:           None                                                         E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                            * Output:          None                                                         E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                            * Side Effects:    None                                                         E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                            * Overview:        This routine handles the standard GET_STATUS request         E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                            * Note:            None                                                         E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                            *****************************************************************************/  E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                           void USBStdGetStatusHandler(void)                                                E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                           {                                                                                E:\usb20\FCounter20\system\usb\usb9\usb9.c
000a0c   0104     MOVLB     0x4                CtrlTrfData._byte0 = 0;                         // Initialize content        E:\usb20\FCounter20\system\usb\usb9\usb9.c
000a0e   6b28     CLRF      0x28,0x1                                                                                        
000a10   6b29     CLRF      0x29,0x1           CtrlTrfData._byte1 = 0;                                                      E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                                                                                                            E:\usb20\FCounter20\system\usb\usb9\usb9.c
000a12   0104     MOVLB     0x4                switch(SetupPkt.Recipient)                                                   E:\usb20\FCounter20\system\usb\usb9\usb9.c
000a14   5120     MOVF      0x20,0x0,0x1                                                                                    
000a16   0b1f     ANDLW     0x1f                                                                                            
000a18   0a02     XORLW     0x2                                                                                             
000a1a   e014     BZ        0xa44                                                                                           
000a1c   0a03     XORLW     0x3                                                                                             
000a1e   e00e     BZ        0xa3c                                                                                           
000a20   0a01     XORLW     0x1                                                                                             
000a22   e001     BZ        0xa26                                                                                           
000a24   d033     BRA       0xa8c                                                                                           
                                               {                                                                            E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                                   case RCPT_DEV:                                                           E:\usb20\FCounter20\system\usb\usb9\usb9.c
000a26   0100     MOVLB     0x0                        ctrl_trf_session_owner = MUID_USB9;                                  E:\usb20\FCounter20\system\usb\usb9\usb9.c
000a28   0e01     MOVLW     0x1                                                                                             
000a2a   6ff5     MOVWF     0xf5,0x1                                                                                        
                                                       /*                                                                   E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                                        * _byte0: bit0: Self-Powered Status [0] Bus-Powered [1] Self-Powered E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                                        *         bit1: RemoteWakeup        [0] Disabled    [1] Enabled     E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                                        */                                                                  E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                                       if(self_power == 1)                     // self_power defined in io_cfg.h E:\usb20\FCounter20\system\usb\usb9\usb9.c
000a2c   0104     MOVLB     0x4                            CtrlTrfData._byte0|=0b000000001;    // Set bit0                  E:\usb20\FCounter20\system\usb\usb9\usb9.c
000a2e   8128     BSF       0x28,0x0,0x1                                                                                    
                                                                                                                            E:\usb20\FCounter20\system\usb\usb9\usb9.c
000a30   0100     MOVLB     0x0                        if(usb_stat.RemoteWakeup == 1)          // usb_stat defined in usbmmap.c E:\usb20\FCounter20\system\usb\usb9\usb9.c
000a32   a1fd     BTFSS     0xfd,0x0,0x1                                                                                    
000a34   d002     BRA       0xa3a                                                                                           
000a36   0104     MOVLB     0x4                            CtrlTrfData._byte0|=0b00000010;     // Set bit1                  E:\usb20\FCounter20\system\usb\usb9\usb9.c
000a38   8328     BSF       0x28,0x1,0x1                                                                                    
000a3a   d028     BRA       0xa8c                      break;                                                               E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                                   case RCPT_INTF:                                                          E:\usb20\FCounter20\system\usb\usb9\usb9.c
000a3c   0100     MOVLB     0x0                        ctrl_trf_session_owner = MUID_USB9;     // No data to update         E:\usb20\FCounter20\system\usb\usb9\usb9.c
000a3e   0e01     MOVLW     0x1                                                                                             
000a40   6ff5     MOVWF     0xf5,0x1                                                                                        
000a42   d024     BRA       0xa8c                      break;                                                               E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                                   case RCPT_EP:                                                            E:\usb20\FCounter20\system\usb\usb9\usb9.c
000a44   0100     MOVLB     0x0                        ctrl_trf_session_owner = MUID_USB9;                                  E:\usb20\FCounter20\system\usb\usb9\usb9.c
000a46   0e01     MOVLW     0x1                                                                                             
000a48   6ff5     MOVWF     0xf5,0x1                                                                                        
                                                       /*                                                                   E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                                        * _byte0: bit0: Halt Status [0] Not Halted [1] Halted               E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                                        */                                                                  E:\usb20\FCounter20\system\usb\usb9\usb9.c
000a4a   0104     MOVLB     0x4                        pDst.bRam = (byte*)&ep0Bo+(SetupPkt.EPNum*8)+(SetupPkt.EPDir*4);     E:\usb20\FCounter20\system\usb\usb9\usb9.c
000a4c   5124     MOVF      0x24,0x0,0x1                                                                                    
000a4e   0b0f     ANDLW     0xf                                                                                             
000a50   0d08     MULLW     0x8                                                                                             
000a52   50f3     MOVF      0xf3,0x0,0x0                                                                                    
000a54   6a11     CLRF      0x11,0x0                                                                                        
000a56   0f00     ADDLW     0x0                                                                                             
000a58   6e10     MOVWF     0x10,0x0                                                                                        
000a5a   0e04     MOVLW     0x4                                                                                             
000a5c   2211     ADDWFC    0x11,0x1,0x0                                                                                    
000a5e   5124     MOVF      0x24,0x0,0x1                                                                                    
000a60   0b80     ANDLW     0x80                                                                                            
000a62   e001     BZ        0xa66                                                                                           
000a64   0e01     MOVLW     0x1                                                                                             
000a66   0d04     MULLW     0x4                                                                                             
000a68   50f3     MOVF      0xf3,0x0,0x0                                                                                    
000a6a   0100     MOVLB     0x0                                                                                             
000a6c   2410     ADDWF     0x10,0x0,0x0                                                                                    
000a6e   6ff8     MOVWF     0xf8,0x1                                                                                        
000a70   0e00     MOVLW     0x0                                                                                             
000a72   2011     ADDWFC    0x11,0x0,0x0                                                                                    
000a74   6ff9     MOVWF     0xf9,0x1                                                                                        
000a76   c0f8     MOVFF     0xf8,0xfe9                 if(*pDst.bRam & _BSTALL)    // Use _BSTALL as a bit mask             E:\usb20\FCounter20\system\usb\usb9\usb9.c
000a78   ffe9                                                                                                               
000a7a   c0f9     MOVFF     0xf9,0xfea                                                                                      
000a7c   ffea                                                                                                               
000a7e   50ef     MOVF      0xef,0x0,0x0                                                                                    
000a80   0b04     ANDLW     0x4                                                                                             
000a82   e003     BZ        0xa8a                                                                                           
000a84   0104     MOVLB     0x4                            CtrlTrfData._byte0=0x01;// Set bit0                              E:\usb20\FCounter20\system\usb\usb9\usb9.c
000a86   0e01     MOVLW     0x1                                                                                             
000a88   6f28     MOVWF     0x28,0x1                                                                                        
000a8a   d000     BRA       0xa8c                      break;                                                               E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                               }//end switch                                                                E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                                                                                                            E:\usb20\FCounter20\system\usb\usb9\usb9.c
000a8c   0100     MOVLB     0x0                if(ctrl_trf_session_owner == MUID_USB9)                                      E:\usb20\FCounter20\system\usb\usb9\usb9.c
000a8e   05f5     DECF      0xf5,0x0,0x1                                                                                    
000a90   e10a     BNZ       0xaa6                                                                                           
                                               {                                                                            E:\usb20\FCounter20\system\usb\usb9\usb9.c
000a92   0100     MOVLB     0x0                    pSrc.bRam = (byte*)&CtrlTrfData;            // Set Source                E:\usb20\FCounter20\system\usb\usb9\usb9.c
000a94   0e28     MOVLW     0x28                                                                                            
000a96   6ff6     MOVWF     0xf6,0x1                                                                                        
000a98   0e04     MOVLW     0x4                                                                                             
000a9a   6ff7     MOVWF     0xf7,0x1                                                                                        
000a9c   0100     MOVLB     0x0                    usb_stat.ctrl_trf_mem = _RAM;               // Set memory type           E:\usb20\FCounter20\system\usb\usb9\usb9.c
000a9e   93fd     BCF       0xfd,0x1,0x1                                                                                    
000aa0   0100     MOVLB     0x0                    LSB(wCount) = 2;                            // Set data count            E:\usb20\FCounter20\system\usb\usb9\usb9.c
000aa2   0e02     MOVLW     0x2                                                                                             
000aa4   6ffa     MOVWF     0xfa,0x1                                                                                        
                                               }//end if(...)                                                               E:\usb20\FCounter20\system\usb\usb9\usb9.c
000aa6   0012     RETURN    0x0            }//end USBStdGetStatusHandler                                                    E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                                                                                                            E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                           /******************************************************************************  E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                            * Function:        void USBStdFeatureReqHandler(void)                           E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                            * PreCondition:    None                                                         E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                            * Input:           None                                                         E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                            * Output:          None                                                         E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                            * Side Effects:    None                                                         E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                            * Overview:        This routine handles the standard SET & CLEAR FEATURES       E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                            *                  requests                                                     E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                            * Note:            None                                                         E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                            *****************************************************************************/  E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                           void USBStdFeatureReqHandler(void)                                               E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                           {                                                                                E:\usb20\FCounter20\system\usb\usb9\usb9.c
000aa8   0104     MOVLB     0x4                if((SetupPkt.bFeature == DEVICE_REMOTE_WAKEUP)&&                             E:\usb20\FCounter20\system\usb\usb9\usb9.c
000aaa   0522     DECF      0x22,0x0,0x1                                                                                    
000aac   e110     BNZ       0xace                 (SetupPkt.Recipient == RCPT_DEV))                                         E:\usb20\FCounter20\system\usb\usb9\usb9.c
000aae   5120     MOVF      0x20,0x0,0x1                                                                                    
000ab0   0b1f     ANDLW     0x1f                                                                                            
000ab2   0900     IORLW     0x0                                                                                             
000ab4   e10c     BNZ       0xace                                                                                           
                                               {                                                                            E:\usb20\FCounter20\system\usb\usb9\usb9.c
000ab6   0100     MOVLB     0x0                    ctrl_trf_session_owner = MUID_USB9;                                      E:\usb20\FCounter20\system\usb\usb9\usb9.c
000ab8   0e01     MOVLW     0x1                                                                                             
000aba   6ff5     MOVWF     0xf5,0x1                                                                                        
000abc   0e03     MOVLW     0x3                    if(SetupPkt.bRequest == SET_FEATURE)                                     E:\usb20\FCounter20\system\usb\usb9\usb9.c
000abe   0104     MOVLB     0x4                                                                                             
000ac0   5d21     SUBWF     0x21,0x0,0x1                                                                                    
000ac2   e103     BNZ       0xaca                                                                                           
000ac4   0100     MOVLB     0x0                        usb_stat.RemoteWakeup = 1;                                           E:\usb20\FCounter20\system\usb\usb9\usb9.c
000ac6   81fd     BSF       0xfd,0x0,0x1                                                                                    
000ac8   d002     BRA       0xace                  else                                                                     E:\usb20\FCounter20\system\usb\usb9\usb9.c
000aca   0100     MOVLB     0x0                        usb_stat.RemoteWakeup = 0;                                           E:\usb20\FCounter20\system\usb\usb9\usb9.c
000acc   91fd     BCF       0xfd,0x0,0x1                                                                                    
                                               }//end if                                                                    E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                                                                                                            E:\usb20\FCounter20\system\usb\usb9\usb9.c
000ace   0104     MOVLB     0x4                if((SetupPkt.bFeature == ENDPOINT_HALT)&&                                    E:\usb20\FCounter20\system\usb\usb9\usb9.c
000ad0   5122     MOVF      0x22,0x0,0x1                                                                                    
000ad2   e13a     BNZ       0xb48                 (SetupPkt.Recipient == RCPT_EP)&&                                         E:\usb20\FCounter20\system\usb\usb9\usb9.c
000ad4   5120     MOVF      0x20,0x0,0x1                                                                                    
000ad6   0b1f     ANDLW     0x1f                                                                                            
000ad8   0802     SUBLW     0x2                                                                                             
000ada   e136     BNZ       0xb48                                                                                           
000adc   5124     MOVF      0x24,0x0,0x1          (SetupPkt.EPNum != 0))                                                    E:\usb20\FCounter20\system\usb\usb9\usb9.c
000ade   0b0f     ANDLW     0xf                                                                                             
000ae0   0900     IORLW     0x0                                                                                             
000ae2   e032     BZ        0xb48                                                                                           
                                               {                                                                            E:\usb20\FCounter20\system\usb\usb9\usb9.c
000ae4   0100     MOVLB     0x0                    ctrl_trf_session_owner = MUID_USB9;                                      E:\usb20\FCounter20\system\usb\usb9\usb9.c
000ae6   0e01     MOVLW     0x1                                                                                             
000ae8   6ff5     MOVWF     0xf5,0x1                                                                                        
                                                   /* Must do address calculation here */                                   E:\usb20\FCounter20\system\usb\usb9\usb9.c
000aea   0104     MOVLB     0x4                    pDst.bRam = (byte*)&ep0Bo+(SetupPkt.EPNum*8)+(SetupPkt.EPDir*4);         E:\usb20\FCounter20\system\usb\usb9\usb9.c
000aec   5124     MOVF      0x24,0x0,0x1                                                                                    
000aee   0b0f     ANDLW     0xf                                                                                             
000af0   0d08     MULLW     0x8                                                                                             
000af2   50f3     MOVF      0xf3,0x0,0x0                                                                                    
000af4   6a11     CLRF      0x11,0x0                                                                                        
000af6   0f00     ADDLW     0x0                                                                                             
000af8   6e10     MOVWF     0x10,0x0                                                                                        
000afa   0e04     MOVLW     0x4                                                                                             
000afc   2211     ADDWFC    0x11,0x1,0x0                                                                                    
000afe   5124     MOVF      0x24,0x0,0x1                                                                                    
000b00   0b80     ANDLW     0x80                                                                                            
000b02   e001     BZ        0xb06                                                                                           
000b04   0e01     MOVLW     0x1                                                                                             
000b06   0d04     MULLW     0x4                                                                                             
000b08   50f3     MOVF      0xf3,0x0,0x0                                                                                    
000b0a   0100     MOVLB     0x0                                                                                             
000b0c   2410     ADDWF     0x10,0x0,0x0                                                                                    
000b0e   6ff8     MOVWF     0xf8,0x1                                                                                        
000b10   0e00     MOVLW     0x0                                                                                             
000b12   2011     ADDWFC    0x11,0x0,0x0                                                                                    
000b14   6ff9     MOVWF     0xf9,0x1                                                                                        
                                                                                                                            E:\usb20\FCounter20\system\usb\usb9\usb9.c
000b16   0e03     MOVLW     0x3                    if(SetupPkt.bRequest == SET_FEATURE)                                     E:\usb20\FCounter20\system\usb\usb9\usb9.c
000b18   0104     MOVLB     0x4                                                                                             
000b1a   5d21     SUBWF     0x21,0x0,0x1                                                                                    
000b1c   e107     BNZ       0xb2c                                                                                           
000b1e   0e84     MOVLW     0x84                       *pDst.bRam = _USIE|_BSTALL;                                          E:\usb20\FCounter20\system\usb\usb9\usb9.c
000b20   c0f8     MOVFF     0xf8,0xfe9                                                                                      
000b22   ffe9                                                                                                               
000b24   c0f9     MOVFF     0xf9,0xfea                                                                                      
000b26   ffea                                                                                                               
000b28   6eef     MOVWF     0xef,0x0                                                                                        
000b2a   d00e     BRA       0xb48                  else                                                                     E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                                   {                                                                        E:\usb20\FCounter20\system\usb\usb9\usb9.c
000b2c   af24     BTFSS     0x24,0x7,0x1               if(SetupPkt.EPDir == 1) // IN                                        E:\usb20\FCounter20\system\usb\usb9\usb9.c
000b2e   d006     BRA       0xb3c                                                                                           
000b30   c0f8     MOVFF     0xf8,0xfe9                     *pDst.bRam = _UCPU;                                              E:\usb20\FCounter20\system\usb\usb9\usb9.c
000b32   ffe9                                                                                                               
000b34   c0f9     MOVFF     0xf9,0xfea                                                                                      
000b36   ffea                                                                                                               
000b38   6aef     CLRF      0xef,0x0                                                                                        
000b3a   d006     BRA       0xb48                      else                                                                 E:\usb20\FCounter20\system\usb\usb9\usb9.c
000b3c   0e88     MOVLW     0x88                           *pDst.bRam = _USIE|_DAT0|_DTSEN;                                 E:\usb20\FCounter20\system\usb\usb9\usb9.c
000b3e   c0f8     MOVFF     0xf8,0xfe9                                                                                      
000b40   ffe9                                                                                                               
000b42   c0f9     MOVFF     0xf9,0xfea                                                                                      
000b44   ffea                                                                                                               
000b46   6eef     MOVWF     0xef,0x0                                                                                        
                                                   }//end if                                                                E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                               }//end if                                                                    E:\usb20\FCounter20\system\usb\usb9\usb9.c
000b48   0012     RETURN    0x0            }//end USBStdFeatureReqHandler                                                   E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                                                                                                            E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                           /** EOF usb9.c ***************************************************************/  E:\usb20\FCounter20\system\usb\usb9\usb9.c
                                           /*********************************************************************           E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            *                Microchip USB C18 Firmware Version 1.0                         E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            *********************************************************************           E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            * FileName:        usbctrltrf.c                                                 E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            * Dependencies:    See INCLUDES section below                                   E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            * Processor:       PIC18                                                        E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            * Compiler:        C18 2.30.01+                                                 E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            * Company:         Microchip Technology, Inc.                                   E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            * Software License Agreement                                                    E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            * The software supplied herewith by Microchip Technology Incorporated           E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            * (the 鼎ompany) for its PICmicroｮ Microcontroller is intended and             E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            * supplied to you, the Company痴 customer, for use solely and                   E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            * exclusively on Microchip PICmicro Microcontroller products. The               E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            * software is owned by the Company and/or its supplier, and is                  E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            * protected under applicable copyright laws. All rights are reserved.           E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            * Any use in violation of the foregoing restrictions may subject the            E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            * user to criminal sanctions under applicable laws, as well as to               E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            * civil liability for the breach of the terms and conditions of this            E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            * license.                                                                      E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            * THIS SOFTWARE IS PROVIDED IN AN 鄭S IS CONDITION. NO WARRANTIES,             E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            * WHETHER EXPRESS, IMPLIED OR STATUTORY, INCLUDING, BUT NOT LIMITED             E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            * TO, IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A                   E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            * PARTICULAR PURPOSE APPLY TO THIS SOFTWARE. THE COMPANY SHALL NOT,             E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            * IN ANY CIRCUMSTANCES, BE LIABLE FOR SPECIAL, INCIDENTAL OR                    E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            * CONSEQUENTIAL DAMAGES, FOR ANY REASON WHATSOEVER.                             E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            * Author               Date        Comment                                      E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            *~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~           E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            * Rawin Rojvanit       11/19/04    Original.                                    E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            ********************************************************************/           E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                                                                                                            E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                           /** I N C L U D E S **********************************************************/  E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                           #include <p18cxxx.h>                                                             E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                           #include "system\typedefs.h"                                                     E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                           #include "system\usb\usb.h"                                                      E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                                                                                                            E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                           /** V A R I A B L E S ********************************************************/  E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                           #pragma udata                                                                    E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                           byte ctrl_trf_state;                // Control Transfer State                    E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                           byte ctrl_trf_session_owner;        // Current transfer session owner            E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                                                                                                            E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                           POINTER pSrc;                       // Data source pointer                       E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                           POINTER pDst;                       // Data destination pointer                  E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                           WORD wCount;                        // Data counter                              E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                                                                                                            E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                           /** P R I V A T E  P R O T O T Y P E S ***************************************/  E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                           void USBCtrlTrfSetupHandler(void);                                               E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                           void USBCtrlTrfOutHandler(void);                                                 E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                           void USBCtrlTrfInHandler(void);                                                  E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                                                                                                            E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                           /** D E C L A R A T I O N S **************************************************/  E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                           #pragma code                                                                     E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                           /******************************************************************************  E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            * Function:        void USBCtrlEPService(void)                                  E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            * PreCondition:    USTAT is loaded with a valid endpoint address.               E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            * Input:           None                                                         E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            * Output:          None                                                         E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            * Side Effects:    None                                                         E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            * Overview:        USBCtrlEPService checks for three transaction types that     E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  it knows how to service and services them:                   E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  1. EP0 SETUP                                                 E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  2. EP0 OUT                                                   E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  3. EP0 IN                                                    E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  It ignores all other types (i.e. EP1, EP2, etc.)             E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            * Note:            None                                                         E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            *****************************************************************************/  E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                           void USBCtrlEPService(void)                                                      E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                           {                                                                                E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
000b4a   506c     MOVF      0x6c,0x0,0x0       if(USTAT == EP00_OUT)                                                        E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
000b4c   e002     BZ        0xb52                                                                                           
000b4e   0e00     MOVLW     0x0                                                                                             
000b50   d001     BRA       0xb54                                                                                           
000b52   0e01     MOVLW     0x1                                                                                             
000b54   0900     IORLW     0x0                                                                                             
000b56   e00b     BZ        0xb6e                                                                                           
                                               {                                                                            E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
000b58   0104     MOVLB     0x4                    if(ep0Bo.Stat.PID == SETUP_TOKEN)           // EP0 SETUP                 E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
000b5a   5100     MOVF      0x0,0x0,0x1                                                                                     
000b5c   0b3c     ANDLW     0x3c                                                                                            
000b5e   42e8     RRNCF     0xe8,0x1,0x0                                                                                    
000b60   42e8     RRNCF     0xe8,0x1,0x0                                                                                    
000b62   080d     SUBLW     0xd                                                                                             
000b64   e102     BNZ       0xb6a                                                                                           
000b66   d80c     RCALL     0xb80                      USBCtrlTrfSetupHandler();                                            E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
000b68   d001     BRA       0xb6c                  else                                        // EP0 OUT                   E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
000b6a   d840     RCALL     0xbec                      USBCtrlTrfOutHandler();                                              E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                               }                                                                            E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
000b6c   d008     BRA       0xb7e              else if(USTAT == EP00_IN)                       // EP0 IN                    E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
000b6e   506c     MOVF      0x6c,0x0,0x0                                                                                    
000b70   e002     BZ        0xb76                                                                                           
000b72   0e00     MOVLW     0x0                                                                                             
000b74   d001     BRA       0xb78                                                                                           
000b76   0e01     MOVLW     0x1                                                                                             
000b78   0904     IORLW     0x4                                                                                             
000b7a   e001     BZ        0xb7e                                                                                           
000b7c   d847     RCALL     0xc0c                  USBCtrlTrfInHandler();                                                   E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                                                                                                            E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
000b7e   0012     RETURN    0x0            }//end USBCtrlEPService                                                          E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                                                                                                            E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                           /******************************************************************************  E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            * Function:        void USBCtrlTrfSetupHandler(void)                            E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            * PreCondition:    SetupPkt buffer is loaded with valid USB Setup Data          E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            * Input:           None                                                         E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            * Output:          None                                                         E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            * Side Effects:    None                                                         E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            * Overview:        This routine is a task dispatcher and has 3 stages.          E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  1. It initializes the control transfer state machine.        E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  2. It calls on each of the module that may know how to       E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            *                     service the Setup Request from the host.                  E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            *                     Module Example: USB9, HID, CDC, MSD, ...                  E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            *                     As new classes are added, ClassReqHandler table in        E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            *                     usbdsc.c should be updated to call all available          E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            *                     class handlers.                                           E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  3. Once each of the modules has had a chance to check if     E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            *                     it is responsible for servicing the request, stage 3      E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            *                     then checks direction of the transfer to determine how    E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            *                     to prepare EP0 for the control transfer.                  E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            *                     Refer to USBCtrlEPServiceComplete() for more details.     E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            * Note:            Microchip USB Firmware has three different states for        E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  the control transfer state machine:                          E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  1. WAIT_SETUP                                                E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  2. CTRL_TRF_TX                                               E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  3. CTRL_TRF_RX                                               E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  Refer to firmware manual to find out how one state           E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  is transitioned to another.                                  E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  A Control Transfer is composed of many USB transactions.     E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  When transferring data over multiple transactions,           E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  it is important to keep track of data source, data           E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  destination, and data count. These three parameters are      E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  stored in pSrc,pDst, and wCount. A flag is used to           E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  note if the data source is from ROM or RAM.                  E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            *****************************************************************************/  E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
000b80   cfd9     MOVFF     0xfd9,0xfe6    void USBCtrlTrfSetupHandler(void)                                                E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
000b82   ffe6                                                                                                               
000b84   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
000b86   ffd9                                                                                                               
000b88   52e6     MOVF      0xe6,0x1,0x0                                                                                    
                                           {                                                                                E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                               byte i;                                                                      E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                                                                                                            E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                               /* Stage 1 */                                                                E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
000b8a   0100     MOVLB     0x0                ctrl_trf_state = WAIT_SETUP;                                                 E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
000b8c   6bf4     CLRF      0xf4,0x1                                                                                        
000b8e   6bf5     CLRF      0xf5,0x1           ctrl_trf_session_owner = MUID_NULL;     // Set owner to NULL                 E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
000b90   6bfa     CLRF      0xfa,0x1           wCount._word = 0;                                                            E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
000b92   6bfb     CLRF      0xfb,0x1                                                                                        
                                                                                                                            E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                               /* Stage 2 */                                                                E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
000b94   ec21     CALL      0x842,0x0          USBCheckStdRequest();                   // See system\usb9\usb9.c            E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
000b96   f004                                                                                                               
                                                                                                                            E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
000b98   6adf     CLRF      0xdf,0x0           for(i=0;i < (sizeof(ClassReqHandler)/sizeof(pFunc));i++)                     E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
000b9a   50df     MOVF      0xdf,0x0,0x0                                                                                    
000b9c   6e10     MOVWF     0x10,0x0                                                                                        
000b9e   6a11     CLRF      0x11,0x0                                                                                        
000ba0   0e01     MOVLW     0x1                                                                                             
000ba2   5c10     SUBWF     0x10,0x0,0x0                                                                                    
000ba4   0e00     MOVLW     0x0                                                                                             
000ba6   5811     SUBWFB    0x11,0x0,0x0                                                                                    
000ba8   e21b     BC        0xbe0                                                                                           
000bdc   2adf     INCF      0xdf,0x1,0x0                                                                                    
000bde   d7dd     BRA       0xb9a                                                                                           
                                               {                                                                            E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
000baa   0100     MOVLB     0x0                    if(ctrl_trf_session_owner != MUID_NULL)break;                            E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
000bac   51f5     MOVF      0xf5,0x0,0x1                                                                                    
000bae   e001     BZ        0xbb2                                                                                           
000bb0   d017     BRA       0xbe0                                                                                           
000bb2   6af7     CLRF      0xf7,0x0               ClassReqHandler[i]();               // See autofiles\usbdsc.c            E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
000bb4   34df     RLCF      0xdf,0x0,0x0                                                                                    
000bb6   0bfe     ANDLW     0xfe                                                                                            
000bb8   36f7     RLCF      0xf7,0x1,0x0                                                                                    
000bba   6ef6     MOVWF     0xf6,0x0                                                                                        
000bbc   0e0b     MOVLW     0xb                                                                                             
000bbe   26f6     ADDWF     0xf6,0x1,0x0                                                                                    
000bc0   0e12     MOVLW     0x12                                                                                            
000bc2   22f7     ADDWFC    0xf7,0x1,0x0                                                                                    
000bc4   0009     TBLRDPOSTINC                                                                                              
000bc6   cff5     MOVFF     0xff5,0x10                                                                                      
000bc8   f010                                                                                                               
000bca   0008     TBLRD                                                                                                     
000bcc   cff5     MOVFF     0xff5,0x11                                                                                      
000bce   f011                                                                                                               
000bd0   d004     BRA       0xbda                                                                                           
000bd2   c011     MOVFF     0x11,0xffa                                                                                      
000bd4   fffa                                                                                                               
000bd6   5010     MOVF      0x10,0x0,0x0                                                                                    
000bd8   6ef9     MOVWF     0xf9,0x0                                                                                        
000bda   dffb     RCALL     0xbd2                                                                                           
                                               }//end while                                                                 E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                                                                                                            E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                               /* Stage 3 */                                                                E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
000be0   d8e1     RCALL     0xda4              USBCtrlEPServiceComplete();                                                  E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                                                                                                            E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
000be2   52e5     MOVF      0xe5,0x1,0x0   }//end USBCtrlTrfSetupHandler                                                    E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
000be4   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000be6   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
000be8   ffd9                                                                                                               
000bea   0012     RETURN    0x0                                                                                             
                                                                                                                            E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                           /******************************************************************************  E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            * Function:        void USBCtrlTrfOutHandler(void)                              E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            * PreCondition:    None                                                         E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            * Input:           None                                                         E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            * Output:          None                                                         E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            * Side Effects:    None                                                         E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            * Overview:        This routine handles an OUT transaction according to         E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  which control transfer state is currently active.            E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            * Note:            Note that if the the control transfer was from               E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  host to device, the session owner should be notified         E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  at the end of each OUT transaction to service the            E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  received data.                                               E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            *****************************************************************************/  E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                           void USBCtrlTrfOutHandler(void)                                                  E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                           {                                                                                E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
000bec   0e02     MOVLW     0x2                if(ctrl_trf_state == CTRL_TRF_RX)                                            E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
000bee   0100     MOVLB     0x0                                                                                             
000bf0   5df4     SUBWF     0xf4,0x0,0x1                                                                                    
000bf2   e10a     BNZ       0xc08                                                                                           
                                               {                                                                            E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
000bf4   d898     RCALL     0xd26                  USBCtrlTrfRxService();                                                   E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                                                                                                            E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                                   /*                                                                       E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                                    * Don't have to worry about overwriting _KEEP bit                       E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                                    * because if _KEEP was set, TRNIF would not have been                   E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                                    * generated in the first place.                                         E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                                    */                                                                      E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
000bf6   0104     MOVLB     0x4                    if(ep0Bo.Stat.DTS == 0)                                                  E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
000bf8   bd00     BTFSC     0x0,0x6,0x1                                                                                     
000bfa   d003     BRA       0xc02                                                                                           
000bfc   0ec8     MOVLW     0xc8                       ep0Bo.Stat._byte = _USIE|_DAT1|_DTSEN;                               E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
000bfe   6f00     MOVWF     0x0,0x1                                                                                         
000c00   d002     BRA       0xc06                  else                                                                     E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
000c02   0e88     MOVLW     0x88                       ep0Bo.Stat._byte = _USIE|_DAT0|_DTSEN;                               E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
000c04   6f00     MOVWF     0x0,0x1                                                                                         
                                               }                                                                            E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
000c06   d001     BRA       0xc0a              else    // CTRL_TRF_TX                                                       E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
000c08   d913     RCALL     0xe30                  USBPrepareForNextSetupTrf();                                             E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                                                                                                            E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
000c0a   0012     RETURN    0x0            }//end USBCtrlTrfOutHandler                                                      E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                                                                                                            E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                           /******************************************************************************  E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            * Function:        void USBCtrlTrfInHandler(void)                               E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            * PreCondition:    None                                                         E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            * Input:           None                                                         E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            * Output:          None                                                         E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            * Side Effects:    None                                                         E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            * Overview:        This routine handles an IN transaction according to          E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  which control transfer state is currently active.            E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            * Note:            A Set Address Request must not change the acutal address     E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  of the device until the completion of the control            E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  transfer. The end of the control transfer for Set Address    E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  Request is an IN transaction. Therefore it is necessary      E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  to service this unique situation when the condition is       E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  right. Macro mUSBCheckAdrPendingState is defined in          E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  usb9.h and its function is to specifically service this      E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  event.                                                       E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            *****************************************************************************/  E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                           void USBCtrlTrfInHandler(void)                                                   E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                           {                                                                                E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
000c0c   0e04     MOVLW     0x4                mUSBCheckAdrPendingState();         // Must check if in ADR_PENDING_STATE    E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
000c0e   0100     MOVLB     0x0                                                                                             
000c10   5dfc     SUBWF     0xfc,0x0,0x1                                                                                    
000c12   e10a     BNZ       0xc28                                                                                           
000c14   c422     MOVFF     0x422,0xf6e                                                                                     
000c16   ff6e                                                                                                               
000c18   506e     MOVF      0x6e,0x0,0x0                                                                                    
000c1a   0800     SUBLW     0x0                                                                                             
000c1c   e203     BC        0xc24                                                                                           
000c1e   0e05     MOVLW     0x5                                                                                             
000c20   6ffc     MOVWF     0xfc,0x1                                                                                        
000c22   d002     BRA       0xc28                                                                                           
000c24   0e03     MOVLW     0x3                                                                                             
000c26   6ffc     MOVWF     0xfc,0x1                                                                                        
                                                                                                                            E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
000c28   0100     MOVLB     0x0                if(ctrl_trf_state == CTRL_TRF_TX)                                            E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
000c2a   05f4     DECF      0xf4,0x0,0x1                                                                                    
000c2c   e10a     BNZ       0xc42                                                                                           
                                               {                                                                            E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
000c2e   d80b     RCALL     0xc46                  USBCtrlTrfTxService();                                                   E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                                                                                                            E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
000c30   0104     MOVLB     0x4                    if(ep0Bi.Stat.DTS == 0)                                                  E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
000c32   bd04     BTFSC     0x4,0x6,0x1                                                                                     
000c34   d003     BRA       0xc3c                                                                                           
000c36   0ec8     MOVLW     0xc8                       ep0Bi.Stat._byte = _USIE|_DAT1|_DTSEN;                               E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
000c38   6f04     MOVWF     0x4,0x1                                                                                         
000c3a   d002     BRA       0xc40                  else                                                                     E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
000c3c   0e88     MOVLW     0x88                       ep0Bi.Stat._byte = _USIE|_DAT0|_DTSEN;                               E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
000c3e   6f04     MOVWF     0x4,0x1                                                                                         
                                               }                                                                            E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
000c40   d001     BRA       0xc44              else // CTRL_TRF_RX                                                          E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
000c42   d8f6     RCALL     0xe30                  USBPrepareForNextSetupTrf();                                             E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                                                                                                            E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
000c44   0012     RETURN    0x0            }//end USBCtrlTrfInHandler                                                       E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                                                                                                            E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                           /******************************************************************************  E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            * Function:        void USBCtrlTrfTxService(void)                               E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            * PreCondition:    pSrc, wCount, and usb_stat.ctrl_trf_mem are setup properly.  E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            * Input:           None                                                         E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            * Output:          None                                                         E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            * Side Effects:    None                                                         E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            * Overview:        This routine should be called from only two places.          E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  One from USBCtrlEPServiceComplete() and one from             E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  USBCtrlTrfInHandler(). It takes care of managing a           E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  transfer over multiple USB transactions.                     E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            * Note:            This routine works with isochronous endpoint larger than     E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  256 bytes and is shown here as an example of how to deal     E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  with BC9 and BC8. In reality, a control endpoint can never   E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  be larger than 64 bytes.                                     E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            *****************************************************************************/  E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
000c46   cfd9     MOVFF     0xfd9,0xfe6    void USBCtrlTrfTxService(void)                                                   E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
000c48   ffe6                                                                                                               
000c4a   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
000c4c   ffd9                                                                                                               
000c4e   0e02     MOVLW     0x2                                                                                             
000c50   26e1     ADDWF     0xe1,0x1,0x0                                                                                    
                                           {                                                                                E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                               WORD byte_to_send;                                                           E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                                                                                                            E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                               /*                                                                           E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                                * First, have to figure out how many byte of data to send.                  E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                                */                                                                          E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
000c52   0100     MOVLB     0x0                if(wCount._word < EP0_BUFF_SIZE)                                             E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
000c54   0e08     MOVLW     0x8                                                                                             
000c56   5dfa     SUBWF     0xfa,0x0,0x1                                                                                    
000c58   0e00     MOVLW     0x0                                                                                             
000c5a   59fb     SUBWFB    0xfb,0x0,0x1                                                                                    
000c5c   e205     BC        0xc68                                                                                           
000c5e   c0fa     MOVFF     0xfa,0xfde             byte_to_send._word = wCount._word;                                       E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
000c60   ffde                                                                                                               
000c62   c0fb     MOVFF     0xfb,0xfdd                                                                                      
000c64   ffdd                                                                                                               
000c66   d003     BRA       0xc6e              else                                                                         E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
000c68   0e08     MOVLW     0x8                    byte_to_send._word = EP0_BUFF_SIZE;                                      E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
000c6a   6ede     MOVWF     0xde,0x0                                                                                        
000c6c   6add     CLRF      0xdd,0x0                                                                                        
                                                                                                                            E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                               /*                                                                           E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                                * Next, load the number of bytes to send to BC9..0 in buffer descriptor     E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                                */                                                                          E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
000c6e   0104     MOVLB     0x4                ep0Bi.Stat.BC9 = 0;                                                          E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
000c70   9304     BCF       0x4,0x1,0x1                                                                                     
000c72   9104     BCF       0x4,0x0,0x1        ep0Bi.Stat.BC8 = 0;                                                          E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
000c74   0e01     MOVLW     0x1                ep0Bi.Stat._byte |= MSB(byte_to_send);                                       E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
000c76   50db     MOVF      0xdb,0x0,0x0                                                                                    
000c78   1304     IORWF     0x4,0x1,0x1                                                                                     
000c7a   cfdf     MOVFF     0xfdf,0x405        ep0Bi.Cnt = LSB(byte_to_send);                                               E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
000c7c   f405                                                                                                               
                                                                                                                            E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                               /*                                                                           E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                                * Subtract the number of bytes just about to be sent from the total.        E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                                */                                                                          E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
000c7e   0e00     MOVLW     0x0                wCount._word = wCount._word - byte_to_send._word;                            E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
000c80   50db     MOVF      0xdb,0x0,0x0                                                                                    
000c82   0100     MOVLB     0x0                                                                                             
000c84   5ffa     SUBWF     0xfa,0x1,0x1                                                                                    
000c86   0e01     MOVLW     0x1                                                                                             
000c88   50db     MOVF      0xdb,0x0,0x0                                                                                    
000c8a   5bfb     SUBWFB    0xfb,0x1,0x1                                                                                    
                                                                                                                            E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
000c8c   0e28     MOVLW     0x28               pDst.bRam = (byte*)&CtrlTrfData;        // Set destination pointer           E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
000c8e   6ff8     MOVWF     0xf8,0x1                                                                                        
000c90   0e04     MOVLW     0x4                                                                                             
000c92   6ff9     MOVWF     0xf9,0x1                                                                                        
                                                                                                                            E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
000c94   0100     MOVLB     0x0                if(usb_stat.ctrl_trf_mem == _ROM)       // Determine type of memory source   E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
000c96   a3fd     BTFSS     0xfd,0x1,0x1                                                                                    
000c98   d01e     BRA       0xcd6                                                                                           
                                               {                                                                            E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
000c9a   cfd9     MOVFF     0xfd9,0xfe9            while(byte_to_send._word)                                                E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
000c9c   ffe9                                                                                                               
000c9e   cfda     MOVFF     0xfda,0xfea                                                                                     
000ca0   ffea                                                                                                               
000ca2   50ee     MOVF      0xee,0x0,0x0                                                                                    
000ca4   10ed     IORWF     0xed,0x0,0x0                                                                                    
000ca6   e016     BZ        0xcd4                                                                                           
000cd2   d7e3     BRA       0xc9a                                                                                           
                                                   {                                                                        E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
000ca8   c0f6     MOVFF     0xf6,0xff6                 *pDst.bRam = *pSrc.bRom;                                             E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
000caa   fff6                                                                                                               
000cac   c0f7     MOVFF     0xf7,0xff7                                                                                      
000cae   fff7                                                                                                               
000cb0   0008     TBLRD                                                                                                     
000cb2   50f5     MOVF      0xf5,0x0,0x0                                                                                    
000cb4   c0f8     MOVFF     0xf8,0xfe9                                                                                      
000cb6   ffe9                                                                                                               
000cb8   c0f9     MOVFF     0xf9,0xfea                                                                                      
000cba   ffea                                                                                                               
000cbc   6eef     MOVWF     0xef,0x0                                                                                        
000cbe   0100     MOVLB     0x0                        pDst.bRam++;                                                         E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
000cc0   2bf8     INCF      0xf8,0x1,0x1                                                                                    
000cc2   0e00     MOVLW     0x0                                                                                             
000cc4   23f9     ADDWFC    0xf9,0x1,0x1                                                                                    
000cc6   2bf6     INCF      0xf6,0x1,0x1               pSrc.bRom++;                                                         E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
000cc8   23f7     ADDWFC    0xf7,0x1,0x1                                                                                    
000cca   06df     DECF      0xdf,0x1,0x0               byte_to_send._word--;                                                E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
000ccc   0e01     MOVLW     0x1                                                                                             
000cce   e201     BC        0xcd2                                                                                           
000cd0   06db     DECF      0xdb,0x1,0x0                                                                                    
                                                   }//end while(byte_to_send._word)                                         E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                               }                                                                            E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
000cd4   d01c     BRA       0xd0e              else // RAM                                                                  E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                               {                                                                            E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
000cd6   cfd9     MOVFF     0xfd9,0xfe9            while(byte_to_send._word)                                                E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
000cd8   ffe9                                                                                                               
000cda   cfda     MOVFF     0xfda,0xfea                                                                                     
000cdc   ffea                                                                                                               
000cde   50ee     MOVF      0xee,0x0,0x0                                                                                    
000ce0   10ed     IORWF     0xed,0x0,0x0                                                                                    
000ce2   e015     BZ        0xd0e                                                                                           
000d0c   d7e4     BRA       0xcd6                                                                                           
                                                   {                                                                        E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
000ce4   c0f6     MOVFF     0xf6,0xfe9                 *pDst.bRam = *pSrc.bRam;                                             E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
000ce6   ffe9                                                                                                               
000ce8   c0f7     MOVFF     0xf7,0xfea                                                                                      
000cea   ffea                                                                                                               
000cec   50ef     MOVF      0xef,0x0,0x0                                                                                    
000cee   c0f8     MOVFF     0xf8,0xfe9                                                                                      
000cf0   ffe9                                                                                                               
000cf2   c0f9     MOVFF     0xf9,0xfea                                                                                      
000cf4   ffea                                                                                                               
000cf6   6eef     MOVWF     0xef,0x0                                                                                        
000cf8   0100     MOVLB     0x0                        pDst.bRam++;                                                         E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
000cfa   2bf8     INCF      0xf8,0x1,0x1                                                                                    
000cfc   0e00     MOVLW     0x0                                                                                             
000cfe   23f9     ADDWFC    0xf9,0x1,0x1                                                                                    
000d00   2bf6     INCF      0xf6,0x1,0x1               pSrc.bRam++;                                                         E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
000d02   23f7     ADDWFC    0xf7,0x1,0x1                                                                                    
000d04   06df     DECF      0xdf,0x1,0x0               byte_to_send._word--;                                                E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
000d06   0e01     MOVLW     0x1                                                                                             
000d08   e201     BC        0xd0c                                                                                           
000d0a   06db     DECF      0xdb,0x1,0x0                                                                                    
                                                   }//end while(byte_to_send._word)                                         E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                               }//end if(usb_stat.ctrl_trf_mem == _ROM)                                     E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                                                                                                            E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
000d0e   6ef5     MOVWF     0xf5,0x0       }//end USBCtrlTrfTxService                                                       E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
000d10   0e02     MOVLW     0x2                                                                                             
000d12   5ce1     SUBWF     0xe1,0x0,0x0                                                                                    
000d14   e202     BC        0xd1a                                                                                           
000d16   6ae1     CLRF      0xe1,0x0                                                                                        
000d18   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000d1a   6ee1     MOVWF     0xe1,0x0                                                                                        
000d1c   50f5     MOVF      0xf5,0x0,0x0                                                                                    
000d1e   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000d20   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
000d22   ffd9                                                                                                               
000d24   0012     RETURN    0x0                                                                                             
                                                                                                                            E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                           /******************************************************************************  E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            * Function:        void USBCtrlTrfRxService(void)                               E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            * PreCondition:    pDst and wCount are setup properly.                          E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  pSrc is always &CtrlTrfData                                  E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  usb_stat.ctrl_trf_mem is always _RAM.                        E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  wCount should be set to 0 at the start of each control       E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  transfer.                                                    E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            * Input:           None                                                         E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            * Output:          None                                                         E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            * Side Effects:    None                                                         E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            * Overview:        *** This routine is only partially complete. Check for       E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  new version of the firmware.                                 E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            * Note:            None                                                         E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            *****************************************************************************/  E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
000d26   cfd9     MOVFF     0xfd9,0xfe6    void USBCtrlTrfRxService(void)                                                   E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
000d28   ffe6                                                                                                               
000d2a   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
000d2c   ffd9                                                                                                               
000d2e   0e02     MOVLW     0x2                                                                                             
000d30   26e1     ADDWF     0xe1,0x1,0x0                                                                                    
                                           {                                                                                E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                               WORD byte_to_read;                                                           E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                                                                                                            E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
000d32   0e03     MOVLW     0x3                MSB(byte_to_read) = 0x03 & ep0Bo.Stat._byte;    // Filter out last 2 bits    E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
000d34   0104     MOVLB     0x4                                                                                             
000d36   1500     ANDWF     0x0,0x0,0x1                                                                                     
000d38   6ee7     MOVWF     0xe7,0x0                                                                                        
000d3a   0e01     MOVLW     0x1                                                                                             
000d3c   cfe7     MOVFF     0xfe7,0xfdb                                                                                     
000d3e   ffdb                                                                                                               
000d40   c401     MOVFF     0x401,0xfdf        LSB(byte_to_read) = ep0Bo.Cnt;                                               E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
000d42   ffdf                                                                                                               
                                                                                                                            E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                               /*                                                                           E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                                * Accumulate total number of bytes read                                     E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                                */                                                                          E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
000d44   50de     MOVF      0xde,0x0,0x0       wCount._word = wCount._word + byte_to_read._word;                            E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
000d46   0100     MOVLB     0x0                                                                                             
000d48   27fa     ADDWF     0xfa,0x1,0x1                                                                                    
000d4a   50dd     MOVF      0xdd,0x0,0x0                                                                                    
000d4c   23fb     ADDWFC    0xfb,0x1,0x1                                                                                    
                                                                                                                            E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
000d4e   0e28     MOVLW     0x28               pSrc.bRam = (byte*)&CtrlTrfData;                                             E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
000d50   6ff6     MOVWF     0xf6,0x1                                                                                        
000d52   0e04     MOVLW     0x4                                                                                             
000d54   6ff7     MOVWF     0xf7,0x1                                                                                        
                                                                                                                            E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
000d56   cfd9     MOVFF     0xfd9,0xfe9        while(byte_to_read._word)                                                    E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
000d58   ffe9                                                                                                               
000d5a   cfda     MOVFF     0xfda,0xfea                                                                                     
000d5c   ffea                                                                                                               
000d5e   50ee     MOVF      0xee,0x0,0x0                                                                                    
000d60   10ed     IORWF     0xed,0x0,0x0                                                                                    
000d62   e014     BZ        0xd8c                                                                                           
000d8a   d7e5     BRA       0xd56                                                                                           
                                               {                                                                            E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
000d64   c0f6     MOVFF     0xf6,0xfe9             *pDst.bRam = *pSrc.bRam;                                                 E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
000d66   ffe9                                                                                                               
000d68   c0f7     MOVFF     0xf7,0xfea                                                                                      
000d6a   ffea                                                                                                               
000d6c   50ef     MOVF      0xef,0x0,0x0                                                                                    
000d6e   c0f8     MOVFF     0xf8,0xfe9                                                                                      
000d70   ffe9                                                                                                               
000d72   c0f9     MOVFF     0xf9,0xfea                                                                                      
000d74   ffea                                                                                                               
000d76   6eef     MOVWF     0xef,0x0                                                                                        
000d78   2bf8     INCF      0xf8,0x1,0x1           pDst.bRam++;                                                             E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
000d7a   0e00     MOVLW     0x0                                                                                             
000d7c   23f9     ADDWFC    0xf9,0x1,0x1                                                                                    
000d7e   2bf6     INCF      0xf6,0x1,0x1           pSrc.bRam++;                                                             E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
000d80   23f7     ADDWFC    0xf7,0x1,0x1                                                                                    
000d82   06df     DECF      0xdf,0x1,0x0           byte_to_read._word--;                                                    E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
000d84   0e01     MOVLW     0x1                                                                                             
000d86   e201     BC        0xd8a                                                                                           
000d88   06db     DECF      0xdb,0x1,0x0                                                                                    
                                               }//end while(byte_to_read._word)                                             E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                                                                                                            E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
000d8c   6ef5     MOVWF     0xf5,0x0       }//end USBCtrlTrfRxService                                                       E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
000d8e   0e02     MOVLW     0x2                                                                                             
000d90   5ce1     SUBWF     0xe1,0x0,0x0                                                                                    
000d92   e202     BC        0xd98                                                                                           
000d94   6ae1     CLRF      0xe1,0x0                                                                                        
000d96   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000d98   6ee1     MOVWF     0xe1,0x0                                                                                        
000d9a   50f5     MOVF      0xf5,0x0,0x0                                                                                    
000d9c   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000d9e   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
000da0   ffd9                                                                                                               
000da2   0012     RETURN    0x0                                                                                             
                                                                                                                            E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                           /******************************************************************************  E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            * Function:        void USBCtrlEPServiceComplete(void)                          E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            * PreCondition:    None                                                         E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            * Input:           None                                                         E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            * Output:          None                                                         E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            * Side Effects:    None                                                         E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            * Overview:        This routine wrap up the ramaining tasks in servicing        E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  a Setup Request. Its main task is to set the endpoint        E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  controls appropriately for a given situation. See code       E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  below.                                                       E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  There are three main scenarios:                              E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  a) There was no handler for the Request, in this case        E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            *                     a STALL should be sent out.                               E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  b) The host has requested a read control transfer,           E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            *                     endpoints are required to be setup in a specific way.     E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  c) The host has requested a write control transfer, or       E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            *                     a control data stage is not required, endpoints are       E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            *                     required to be setup in a specific way.                   E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  Packet processing is resumed by clearing PKTDIS bit.         E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            * Note:            None                                                         E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            *****************************************************************************/  E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                           void USBCtrlEPServiceComplete(void)                                              E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                           {                                                                                E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
000da4   0100     MOVLB     0x0                if(ctrl_trf_session_owner == MUID_NULL)                                      E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
000da6   51f5     MOVF      0xf5,0x0,0x1                                                                                    
000da8   e10c     BNZ       0xdc2                                                                                           
                                               {                                                                            E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                                   /*                                                                       E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                                    * If no one knows how to service this request then stall.               E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                                    * Must also prepare EP0 to receive the next SETUP transaction.          E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                                    */                                                                      E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
000daa   0104     MOVLB     0x4                    ep0Bo.Cnt = EP0_BUFF_SIZE;                                               E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
000dac   0e08     MOVLW     0x8                                                                                             
000dae   6f01     MOVWF     0x1,0x1                                                                                         
000db0   0e20     MOVLW     0x20                   ep0Bo.ADR = (byte*)&SetupPkt;                                            E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
000db2   6f02     MOVWF     0x2,0x1                                                                                         
000db4   0e04     MOVLW     0x4                                                                                             
000db6   6f03     MOVWF     0x3,0x1                                                                                         
                                                                                                                            E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
000db8   0e84     MOVLW     0x84                   ep0Bo.Stat._byte = _USIE|_BSTALL;                                        E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
000dba   6f00     MOVWF     0x0,0x1                                                                                         
000dbc   0104     MOVLB     0x4                    ep0Bi.Stat._byte = _USIE|_BSTALL;                                        E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
000dbe   6f04     MOVWF     0x4,0x1                                                                                         
                                               }                                                                            E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
000dc0   d035     BRA       0xe2c              else    // A module has claimed ownership of the control transfer session.   E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                               {                                                                            E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
000dc2   0104     MOVLB     0x4                    if(SetupPkt.DataDir == DEV_TO_HOST)                                      E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
000dc4   af20     BTFSS     0x20,0x7,0x1                                                                                    
000dc6   d022     BRA       0xe0c                                                                                           
                                                   {                                                                        E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
000dc8   0100     MOVLB     0x0                        if(SetupPkt.wLength < wCount._word)                                  E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
000dca   51fa     MOVF      0xfa,0x0,0x1                                                                                    
000dcc   0104     MOVLB     0x4                                                                                             
000dce   5d26     SUBWF     0x26,0x0,0x1                                                                                    
000dd0   0100     MOVLB     0x0                                                                                             
000dd2   51fb     MOVF      0xfb,0x0,0x1                                                                                    
000dd4   0104     MOVLB     0x4                                                                                             
000dd6   5927     SUBWFB    0x27,0x0,0x1                                                                                    
000dd8   e204     BC        0xde2                                                                                           
000dda   c426     MOVFF     0x426,0xfa                     wCount._word = SetupPkt.wLength;                                 E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
000ddc   f0fa                                                                                                               
000dde   c427     MOVFF     0x427,0xfb                                                                                      
000de0   f0fb                                                                                                               
000de2   df31     RCALL     0xc46                      USBCtrlTrfTxService();                                               E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
000de4   0100     MOVLB     0x0                        ctrl_trf_state = CTRL_TRF_TX;                                        E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
000de6   0e01     MOVLW     0x1                                                                                             
000de8   6ff4     MOVWF     0xf4,0x1                                                                                        
                                                       /*                                                                   E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                                        * Control Read:                                                     E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                                        * <SETUP[0]><IN[1]><IN[0]>...<OUT[1]> | <SETUP[0]>                  E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                                        * 1. Prepare OUT EP to respond to early termination                 E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                                        *                                                                   E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                                        * NOTE:                                                             E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                                        * If something went wrong during the control transfer,              E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                                        * the last status stage may not be sent by the host.                E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                                        * When this happens, two different things could happen              E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                                        * depending on the host.                                            E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                                        * a) The host could send out a RESET.                               E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                                        * b) The host could send out a new SETUP transaction                E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                                        *    without sending a RESET first.                                 E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                                        * To properly handle case (b), the OUT EP must be setup             E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                                        * to receive either a zero length OUT transaction, or a             E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                                        * new SETUP transaction.                                            E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                                        *                                                                   E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                                        * Since the SETUP transaction requires the DTS bit to be            E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                                        * DAT0 while the zero length OUT status requires the DTS            E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                                        * bit to be DAT1, the DTS bit check by the hardware should          E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                                        * be disabled. This way the SIE could accept either of              E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                                        * the two transactions.                                             E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                                        *                                                                   E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                                        * Furthermore, the Cnt byte should be set to prepare for            E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                                        * the SETUP data (8-byte or more), and the buffer address           E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                                        * should be pointed to SetupPkt.                                    E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                                        */                                                                  E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
000dea   0104     MOVLB     0x4                        ep0Bo.Cnt = EP0_BUFF_SIZE;                                           E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
000dec   0e08     MOVLW     0x8                                                                                             
000dee   6f01     MOVWF     0x1,0x1                                                                                         
000df0   0e20     MOVLW     0x20                       ep0Bo.ADR = (byte*)&SetupPkt;                                        E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
000df2   6f02     MOVWF     0x2,0x1                                                                                         
000df4   0e04     MOVLW     0x4                                                                                             
000df6   6f03     MOVWF     0x3,0x1                                                                                         
000df8   0e80     MOVLW     0x80                       ep0Bo.Stat._byte = _USIE;           // Note: DTSEN is 0!             E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
000dfa   6f00     MOVWF     0x0,0x1                                                                                         
                                                                                                                            E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                                       /*                                                                   E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                                        * 2. Prepare IN EP to transfer data, Cnt should have                E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                                        *    been initialized by responsible request owner.                 E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                                        */                                                                  E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
000dfc   0104     MOVLB     0x4                        ep0Bi.ADR = (byte*)&CtrlTrfData;                                     E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
000dfe   0e28     MOVLW     0x28                                                                                            
000e00   6f06     MOVWF     0x6,0x1                                                                                         
000e02   0e04     MOVLW     0x4                                                                                             
000e04   6f07     MOVWF     0x7,0x1                                                                                         
000e06   0ec8     MOVLW     0xc8                       ep0Bi.Stat._byte = _USIE|_DAT1|_DTSEN;                               E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
000e08   6f04     MOVWF     0x4,0x1                                                                                         
                                                   }                                                                        E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
000e0a   d010     BRA       0xe2c                  else    // (SetupPkt.DataDir == HOST_TO_DEV)                             E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                                   {                                                                        E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
000e0c   0100     MOVLB     0x0                        ctrl_trf_state = CTRL_TRF_RX;                                        E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
000e0e   0e02     MOVLW     0x2                                                                                             
000e10   6ff4     MOVWF     0xf4,0x1                                                                                        
                                                       /*                                                                   E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                                        * Control Write:                                                    E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                                        * <SETUP[0]><OUT[1]><OUT[0]>...<IN[1]> | <SETUP[0]>                 E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                                        *                                                                   E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                                        * 1. Prepare IN EP to respond to early termination                  E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                                        *                                                                   E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                                        *    This is the same as a Zero Length Packet Response              E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                                        *    for control transfer without a data stage                      E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                                        */                                                                  E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
000e12   0104     MOVLB     0x4                        ep0Bi.Cnt = 0;                                                       E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
000e14   6b05     CLRF      0x5,0x1                                                                                         
000e16   0ec8     MOVLW     0xc8                       ep0Bi.Stat._byte = _USIE|_DAT1|_DTSEN;                               E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
000e18   6f04     MOVWF     0x4,0x1                                                                                         
                                                                                                                            E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                                       /*                                                                   E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                                        * 2. Prepare OUT EP to receive data.                                E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                                        */                                                                  E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
000e1a   0104     MOVLB     0x4                        ep0Bo.Cnt = EP0_BUFF_SIZE;                                           E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
000e1c   0e08     MOVLW     0x8                                                                                             
000e1e   6f01     MOVWF     0x1,0x1                                                                                         
000e20   0e28     MOVLW     0x28                       ep0Bo.ADR = (byte*)&CtrlTrfData;                                     E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
000e22   6f02     MOVWF     0x2,0x1                                                                                         
000e24   0e04     MOVLW     0x4                                                                                             
000e26   6f03     MOVWF     0x3,0x1                                                                                         
000e28   0ec8     MOVLW     0xc8                       ep0Bo.Stat._byte = _USIE|_DAT1|_DTSEN;                               E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
000e2a   6f00     MOVWF     0x0,0x1                                                                                         
                                                   }//end if(SetupPkt.DataDir == DEV_TO_HOST)                               E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                               }//end if(ctrl_trf_session_owner == MUID_NULL)                               E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                                                                                                            E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                               /*                                                                           E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                                * PKTDIS bit is set when a Setup Transaction is received.                   E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                                * Clear to resume packet processing.                                        E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                                */                                                                          E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
000e2c   986d     BCF       0x6d,0x4,0x0       UCONbits.PKTDIS = 0;                                                         E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                                                                                                            E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
000e2e   0012     RETURN    0x0            }//end USBCtrlEPServiceComplete                                                  E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                                                                                                            E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                           /******************************************************************************  E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            * Function:        void USBPrepareForNextSetupTrf(void)                         E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            * PreCondition:    None                                                         E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            * Input:           None                                                         E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            * Output:          None                                                         E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            * Side Effects:    None                                                         E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            * Overview:        The routine forces EP0 OUT to be ready for a new Setup       E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  transaction, and forces EP0 IN to be owned by CPU.           E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            * Note:            None                                                         E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                            *****************************************************************************/  E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                           void USBPrepareForNextSetupTrf(void)                                             E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                           {                                                                                E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
000e30   0100     MOVLB     0x0                ctrl_trf_state = WAIT_SETUP;            // See usbctrltrf.h                  E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
000e32   6bf4     CLRF      0xf4,0x1                                                                                        
000e34   0104     MOVLB     0x4                ep0Bo.Cnt = EP0_BUFF_SIZE;              // Defined in usbcfg.h               E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
000e36   0e08     MOVLW     0x8                                                                                             
000e38   6f01     MOVWF     0x1,0x1                                                                                         
000e3a   0e20     MOVLW     0x20               ep0Bo.ADR = (byte*)&SetupPkt;                                                E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
000e3c   6f02     MOVWF     0x2,0x1                                                                                         
000e3e   0e04     MOVLW     0x4                                                                                             
000e40   6f03     MOVWF     0x3,0x1                                                                                         
000e42   0e88     MOVLW     0x88               ep0Bo.Stat._byte = _USIE|_DAT0|_DTSEN;  // EP0 buff dsc init, see usbmmap.h  E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
000e44   6f00     MOVWF     0x0,0x1                                                                                         
000e46   0104     MOVLB     0x4                ep0Bi.Stat._byte = _UCPU;               // EP0 IN buffer initialization      E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
000e48   6b04     CLRF      0x4,0x1                                                                                         
000e4a   0012     RETURN    0x0            }//end USBPrepareForNextSetupTrf                                                 E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                                                                                                            E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                           /** EOF usbctrltrf.c *********************************************************/  E:\usb20\FCounter20\system\usb\usbctrltrf\usbctrltrf.c
                                           /*********************************************************************           E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                Microchip USB C18 Firmware Version 1.0                         E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *********************************************************************           E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            * FileName:        usbdrv.c                                                     E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            * Dependencies:    See INCLUDES section below                                   E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            * Processor:       PIC18                                                        E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            * Compiler:        C18 2.30.01+                                                 E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            * Company:         Microchip Technology, Inc.                                   E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            * Software License Agreement                                                    E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            * The software supplied herewith by Microchip Technology Incorporated           E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            * (the 鼎ompany・ for its PICmicroｮ Microcontroller is intended and             E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            * supplied to you, the Company痴 customer, for use solely and                   E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            * exclusively on Microchip PICmicro Microcontroller products. The               E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            * software is owned by the Company and/or its supplier, and is                  E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            * protected under applicable copyright laws. All rights are reserved.           E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            * Any use in violation of the foregoing restrictions may subject the            E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            * user to criminal sanctions under applicable laws, as well as to               E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            * civil liability for the breach of the terms and conditions of this            E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            * license.                                                                      E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            * THIS SOFTWARE IS PROVIDED IN AN 鄭S IS・CONDITION. NO WARRANTIES,             E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            * WHETHER EXPRESS, IMPLIED OR STATUTORY, INCLUDING, BUT NOT LIMITED             E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            * TO, IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A                   E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            * PARTICULAR PURPOSE APPLY TO THIS SOFTWARE. THE COMPANY SHALL NOT,             E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            * IN ANY CIRCUMSTANCES, BE LIABLE FOR SPECIAL, INCIDENTAL OR                    E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            * CONSEQUENTIAL DAMAGES, FOR ANY REASON WHATSOEVER.                             E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            * Author               Date        Comment                                      E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~           E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            * Rawin Rojvanit       11/19/04    Original.                                    E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            ********************************************************************/           E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                           /** I N C L U D E S **********************************************************/  E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                           #include <p18cxxx.h>                                                             E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                           #include "system\typedefs.h"                                                     E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                           #include "system\usb\usb.h"                                                      E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                           #include "io_cfg.h"             // Required for USBCheckBusStatus()              E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                           /** V A R I A B L E S ********************************************************/  E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                           #pragma udata                                                                    E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                           /** P R I V A T E  P R O T O T Y P E S ***************************************/  E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                           void USBModuleEnable(void);                                                      E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                           void USBModuleDisable(void);                                                     E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                           void USBSuspend(void);                                                           E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                           void USBWakeFromSuspend(void);                                                   E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                           void USBProtocolResetHandler(void);                                              E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                           void USB_SOF_Handler(void);                                                      E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                           void USBStallHandler(void);                                                      E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                           void USBErrorHandler(void);                                                      E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                           /** D E C L A R A T I O N S **************************************************/  E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                           #pragma code                                                                     E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                           /******************************************************************************  E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            * Function:        void USBCheckBusStatus(void)                                 E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            * PreCondition:    None                                                         E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            * Input:           None                                                         E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            * Output:          None                                                         E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            * Side Effects:    None                                                         E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            * Overview:        This routine enables/disables the USB module by monitoring   E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                  the USB power signal.                                        E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            * Note:            None                                                         E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *****************************************************************************/  E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                           void USBCheckBusStatus(void)                                                     E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                           {                                                                                E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                               /**************************************************************************  E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                                * Bus Attachment & Detachment Detection                                     E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                                * usb_bus_sense is an i/o pin defined in io_cfg.h                           E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                                *************************************************************************/  E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                               #define USB_BUS_ATTACHED    1                                                E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                               #define USB_BUS_DETACHED    0                                                E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                               if(usb_bus_sense == USB_BUS_ATTACHED)       // Is USB bus attached?          E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                               {                                                                            E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
000fe6   a66d     BTFSS     0x6d,0x3,0x0           if(UCONbits.USBEN == 0)                 // Is the module off?            E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
000fe8   d80f     RCALL     0x1008                     USBModuleEnable();                  // Is off, enable it             E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                               }                                                                            E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
000fea   d002     BRA       0xff0              else                                                                         E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                               {                                                                            E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
000fec   b66d     BTFSC     0x6d,0x3,0x0           if(UCONbits.USBEN == 1)                 // Is the module on?             E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
000fee   d813     RCALL     0x1016                     USBModuleDisable();                 // Is on, disable it             E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                               }//end if(usb_bus_sense...)                                                  E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                               /*                                                                           E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                                * After enabling the USB module, it takes some time for the voltage         E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                                * on the D+ or D- line to rise high enough to get out of the SE0 condition. E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                                * The USB Reset interrupt should not be unmasked until the SE0 condition is E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                                * cleared. This helps preventing the firmware from misinterpreting this     E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                                * unique event as a USB bus reset from the USB host.                        E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                                */                                                                          E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
000ff0   0100     MOVLB     0x0                if(usb_device_state == ATTACHED_STATE)                                       E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
000ff2   05fc     DECF      0xfc,0x0,0x1                                                                                    
000ff4   e108     BNZ       0x1006                                                                                          
                                               {                                                                            E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
000ff6   ba6d     BTFSC     0x6d,0x5,0x0           if(!UCONbits.SE0)                                                        E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
000ff8   d006     BRA       0x1006                                                                                          
                                                   {                                                                        E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
000ffa   6a68     CLRF      0x68,0x0                   UIR = 0;                        // Clear all USB interrupts          E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
000ffc   6a69     CLRF      0x69,0x0                   UIE = 0;                        // Mask all USB interrupts           E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
000ffe   8069     BSF       0x69,0x0,0x0               UIEbits.URSTIE = 1;             // Unmask RESET interrupt            E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
001000   8869     BSF       0x69,0x4,0x0               UIEbits.IDLEIE = 1;             // Unmask IDLE interrupt             E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
001002   0e02     MOVLW     0x2                        usb_device_state = POWERED_STATE;                                    E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
001004   6ffc     MOVWF     0xfc,0x1                                                                                        
                                                   }//end if                           // else wait until SE0 is cleared    E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                               }//end if(usb_device_state == ATTACHED_STATE)                                E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
001006   0012     RETURN    0x0            }//end USBCheckBusStatus                                                         E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                           /******************************************************************************  E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            * Function:        void USBModuleEnable(void)                                   E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            * PreCondition:    None                                                         E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            * Input:           None                                                         E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            * Output:          None                                                         E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            * Side Effects:    None                                                         E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            * Overview:        This routine enables the USB module.                         E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                  An end designer should never have to call this routine       E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                  manually. This routine should only be called from            E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                  USBCheckBusStatus().                                         E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            * Note:            See USBCheckBusStatus() for more information.                E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *****************************************************************************/  E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                           void USBModuleEnable(void)                                                       E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                           {                                                                                E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
001008   6a6d     CLRF      0x6d,0x0           UCON = 0;                                                                    E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
00100a   6a69     CLRF      0x69,0x0           UIE = 0;                                // Mask all USB interrupts           E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
00100c   866d     BSF       0x6d,0x3,0x0       UCONbits.USBEN = 1;                     // Enable module & attach to bus     E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
00100e   0100     MOVLB     0x0                usb_device_state = ATTACHED_STATE;      // Defined in usbmmap.c & .h         E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
001010   0e01     MOVLW     0x1                                                                                             
001012   6ffc     MOVWF     0xfc,0x1                                                                                        
001014   0012     RETURN    0x0            }//end USBModuleEnable                                                           E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                           /******************************************************************************  E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            * Function:        void USBModuleDisable(void)                                  E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            * PreCondition:    None                                                         E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            * Input:           None                                                         E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            * Output:          None                                                         E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            * Side Effects:    None                                                         E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            * Overview:        This routine disables the USB module.                        E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                  An end designer should never have to call this routine       E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                  manually. This routine should only be called from            E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                  USBCheckBusStatus().                                         E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            * Note:            See USBCheckBusStatus() for more information.                E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *****************************************************************************/  E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                           void USBModuleDisable(void)                                                      E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                           {                                                                                E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
001016   6a6d     CLRF      0x6d,0x0           UCON = 0;                               // Disable module & detach from bus  E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
001018   6a69     CLRF      0x69,0x0           UIE = 0;                                // Mask all USB interrupts           E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
00101a   0100     MOVLB     0x0                usb_device_state = DETACHED_STATE;      // Defined in usbmmap.c & .h         E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
00101c   6bfc     CLRF      0xfc,0x1                                                                                        
00101e   0012     RETURN    0x0            }//end USBModuleDisable                                                          E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                           /******************************************************************************  E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            * Function:        void USBSoftDetach(void)                                     E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            * PreCondition:    None                                                         E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            * Input:           None                                                         E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            * Output:          None                                                         E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            * Side Effects:    The device will have to be re-enumerated to function again.  E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            * Overview:        USBSoftDetach electrically disconnects the device from       E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                  the bus. This is done by stop supplying Vusb voltage to      E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                  pull-up resistor. The pull-down resistors on the host        E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                  side will pull both differential signal lines low and        E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                  the host registers the event as a disconnect.                E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                  Since the USB cable is not physically disconnected, the      E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                  power supply through the cable can still be sensed by        E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                  the device. The next time USBCheckBusStatus() function       E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                  is called, it will reconnect the device back to the bus.     E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            * Note:            None                                                         E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *****************************************************************************/  E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                           void USBSoftDetach(void)                                                         E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                           {                                                                                E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
001020   ef0b     GOTO      0x1016             USBModuleDisable();                                                          E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
001022   f008                                                                                                               
                                           }//end USBSoftDetach                                                             E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                           /******************************************************************************  E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            * Function:        void USBDriverService(void)                                  E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            * PreCondition:    None                                                         E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            * Input:           None                                                         E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            * Output:          None                                                         E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            * Side Effects:    None                                                         E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            * Overview:        This routine is the heart of this firmware. It manages       E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                  all USB interrupts.                                          E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            * Note:            Device state transitions through the following stages:       E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                  DETACHED -> ATTACHED -> POWERED -> DEFAULT ->                E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                  ADDRESS_PENDING -> ADDRESSED -> CONFIGURED -> READY          E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *****************************************************************************/  E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                           void USBDriverService(void)                                                      E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                           {                                                                                E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                               /*                                                                           E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                                * Pointless to continue servicing if USB cable is not even attached.        E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                                */                                                                          E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
001024   0100     MOVLB     0x0                if(usb_device_state == DETACHED_STATE) return;                               E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
001026   51fc     MOVF      0xfc,0x0,0x1                                                                                    
001028   e101     BNZ       0x102c                                                                                          
00102a   d03a     BRA       0x10a0                                                                                          
                                                                                                                            E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                               /*                                                                           E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                                * Task A: Service USB Activity Interrupt                                    E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                                */                                                                          E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
00102c   5068     MOVF      0x68,0x0,0x0       if(UIRbits.ACTVIF && UIEbits.ACTVIE)    USBWakeFromSuspend();                E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
00102e   0b04     ANDLW     0x4                                                                                             
001030   e004     BZ        0x103a                                                                                          
001032   5069     MOVF      0x69,0x0,0x0                                                                                    
001034   0b04     ANDLW     0x4                                                                                             
001036   e001     BZ        0x103a                                                                                          
001038   d838     RCALL     0x10aa                                                                                          
                                                                                                                            E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                               /*                                                                           E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                                * Pointless to continue servicing if the device is in suspend mode.         E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                                */                                                                          E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
00103a   b26d     BTFSC     0x6d,0x1,0x0       if(UCONbits.SUSPND==1) return;                                               E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
00103c   d031     BRA       0x10a0                                                                                          
                                                                                                                            E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                               /*                                                                           E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                                * Task B: Service USB Bus Reset Interrupt.                                  E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                                * When bus reset is received during suspend, ACTVIF will be set first,      E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                                * once the UCONbits.SUSPND is clear, then the URSTIF bit will be asserted.  E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                                * This is why URSTIF is checked after ACTVIF.                               E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                                */                                                                          E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
00103e   5068     MOVF      0x68,0x0,0x0       if(UIRbits.URSTIF && UIEbits.URSTIE)    USBProtocolResetHandler();           E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
001040   0b01     ANDLW     0x1                                                                                             
001042   e004     BZ        0x104c                                                                                          
001044   5069     MOVF      0x69,0x0,0x0                                                                                    
001046   0b01     ANDLW     0x1                                                                                             
001048   e001     BZ        0x104c                                                                                          
00104a   d850     RCALL     0x10ec                                                                                          
                                                                                                                            E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                               /*                                                                           E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                                * Task C: Service other USB interrupts                                      E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                                */                                                                          E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
00104c   5068     MOVF      0x68,0x0,0x0       if(UIRbits.IDLEIF && UIEbits.IDLEIE)    USBSuspend();                        E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
00104e   0b10     ANDLW     0x10                                                                                            
001050   e004     BZ        0x105a                                                                                          
001052   5069     MOVF      0x69,0x0,0x0                                                                                    
001054   0b10     ANDLW     0x10                                                                                            
001056   e001     BZ        0x105a                                                                                          
001058   d824     RCALL     0x10a2                                                                                          
00105a   5068     MOVF      0x68,0x0,0x0       if(UIRbits.SOFIF && UIEbits.SOFIE)      USB_SOF_Handler();                   E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
00105c   0b40     ANDLW     0x40                                                                                            
00105e   e004     BZ        0x1068                                                                                          
001060   5069     MOVF      0x69,0x0,0x0                                                                                    
001062   0b40     ANDLW     0x40                                                                                            
001064   e001     BZ        0x1068                                                                                          
001066   d837     RCALL     0x10d6                                                                                          
001068   5068     MOVF      0x68,0x0,0x0       if(UIRbits.STALLIF && UIEbits.STALLIE)  USBStallHandler();                   E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
00106a   0b20     ANDLW     0x20                                                                                            
00106c   e004     BZ        0x1076                                                                                          
00106e   5069     MOVF      0x69,0x0,0x0                                                                                    
001070   0b20     ANDLW     0x20                                                                                            
001072   e001     BZ        0x1076                                                                                          
001074   d832     RCALL     0x10da                                                                                          
001076   5068     MOVF      0x68,0x0,0x0       if(UIRbits.UERRIF && UIEbits.UERRIE)    USBErrorHandler();                   E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
001078   0b02     ANDLW     0x2                                                                                             
00107a   e004     BZ        0x1084                                                                                          
00107c   5069     MOVF      0x69,0x0,0x0                                                                                    
00107e   0b02     ANDLW     0x2                                                                                             
001080   e001     BZ        0x1084                                                                                          
001082   d832     RCALL     0x10e8                                                                                          
                                                                                                                            E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                               /*                                                                           E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                                * Pointless to continue servicing if the host has not sent a bus reset.     E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                                * Once bus reset is received, the device transitions into the DEFAULT       E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                                * state and is ready for communication.                                     E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                                */                                                                          E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
001084   0e03     MOVLW     0x3                if(usb_device_state < DEFAULT_STATE) return;                                 E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
001086   0100     MOVLB     0x0                                                                                             
001088   5dfc     SUBWF     0xfc,0x0,0x1                                                                                    
00108a   e201     BC        0x108e                                                                                          
00108c   d009     BRA       0x10a0                                                                                          
                                                                                                                            E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                               /*                                                                           E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                                * Task D: Servicing USB Transaction Complete Interrupt                      E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                                */                                                                          E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
00108e   5068     MOVF      0x68,0x0,0x0       if(UIRbits.TRNIF && UIEbits.TRNIE)                                           E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
001090   0b08     ANDLW     0x8                                                                                             
001092   e006     BZ        0x10a0                                                                                          
001094   5069     MOVF      0x69,0x0,0x0                                                                                    
001096   0b08     ANDLW     0x8                                                                                             
001098   e003     BZ        0x10a0                                                                                          
                                               {                                                                            E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                                   /*                                                                       E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                                    * USBCtrlEPService only services transactions over EP0.                 E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                                    * It ignores all other EP transactions.                                 E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                                    */                                                                      E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
00109a   eca5     CALL      0xb4a,0x0              USBCtrlEPService();                                                      E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
00109c   f005                                                                                                               
                                                                                                                            E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                                   /*                                                                       E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                                    * Other EP can be serviced later by responsible device class firmware.  E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                                    * Each device driver knows when an OUT or IN transaction is ready by    E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                                    * checking the buffer ownership bit.                                    E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                                    * An OUT EP should always be owned by SIE until the data is ready.      E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                                    * An IN EP should always be owned by CPU until the data is ready.       E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                                    *                                                                       E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                                    * Because of this logic, it is not necessary to save the USTAT value    E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                                    * of non-EP0 transactions.                                              E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                                    */                                                                      E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
00109e   9668     BCF       0x68,0x3,0x0           UIRbits.TRNIF = 0;                                                       E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                               }//end if(UIRbits.TRNIF && UIEbits.TRNIE)                                    E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
0010a0   0012     RETURN    0x0            }//end USBDriverService                                                          E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                           /******************************************************************************  E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            * Function:        void USBSuspend(void)                                        E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            * PreCondition:    None                                                         E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            * Input:           None                                                         E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            * Output:          None                                                         E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            * Side Effects:    None                                                         E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            * Overview:                                                                     E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            * Note:            None                                                         E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *****************************************************************************/  E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                           void USBSuspend(void)                                                            E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                           {                                                                                E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                               /*                                                                           E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                                * NOTE: Do not clear UIRbits.ACTVIF here!                                   E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                                * Reason:                                                                   E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                                * ACTVIF is only generated once an IDLEIF has been generated.               E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                                * This is a 1:1 ratio interrupt generation.                                 E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                                * For every IDLEIF, there will be only one ACTVIF regardless of             E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                                * the number of subsequent bus transitions.                                 E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                                *                                                                           E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                                * If the ACTIF is cleared here, a problem could occur when:                 E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                                * [       IDLE       ][bus activity ->                                      E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                                * <--- 3 ms ----->     ^                                                    E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                                *                ^     ACTVIF=1                                             E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                                *                IDLEIF=1                                                   E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                                *  #           #           #           #   (#=Program polling flags)        E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                                *                          ^                                                E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                                *                          This polling loop will see both                  E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                                *                          IDLEIF=1 and ACTVIF=1.                           E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                                *                          However, the program services IDLEIF first       E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                                *                          because ACTIVIE=0.                               E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                                *                          If this routine clears the only ACTIVIF,         E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                                *                          then it can never get out of the suspend         E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                                *                          mode.                                            E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                                */                                                                          E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
0010a2   8469     BSF       0x69,0x2,0x0       UIEbits.ACTVIE = 1;                     // Enable bus activity interrupt     E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
0010a4   9868     BCF       0x68,0x4,0x0       UIRbits.IDLEIF = 0;                                                          E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
0010a6   826d     BSF       0x6d,0x1,0x0       UCONbits.SUSPND = 1;                    // Put USB module in power conserve  E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                                                                       // mode, SIE clock inactive          E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                               /*                                                                           E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                                * At this point the PIC can go into sleep,idle, or                          E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                                * switch to a slower clock, etc.                                            E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                                */                                                                          E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                               /* Modifiable Section */                                                     E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                               /* End Modifiable Section */                                                 E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
0010a8   0012     RETURN    0x0            }//end USBSuspend                                                                E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                           /******************************************************************************  E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            * Function:        void USBWakeFromSuspend(void)                                E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            * PreCondition:    None                                                         E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            * Input:           None                                                         E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            * Output:          None                                                         E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            * Side Effects:    None                                                         E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            * Overview:                                                                     E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            * Note:            None                                                         E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *****************************************************************************/  E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                           void USBWakeFromSuspend(void)                                                    E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                           {                                                                                E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                               /*                                                                           E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                                * If using clock switching, this is the place to restore the                E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                                * original clock frequency.                                                 E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                                */                                                                          E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
0010aa   926d     BCF       0x6d,0x1,0x0       UCONbits.SUSPND = 0;                                                         E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
0010ac   9469     BCF       0x69,0x2,0x0       UIEbits.ACTVIE = 0;                                                          E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
0010ae   9468     BCF       0x68,0x2,0x0       UIRbits.ACTVIF = 0;                                                          E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
0010b0   0012     RETURN    0x0            }//end USBWakeFromSuspend                                                        E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                           /******************************************************************************  E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            * Function:        void USBRemoteWakeup(void)                                   E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            * PreCondition:    None                                                         E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            * Input:           None                                                         E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            * Output:          None                                                         E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            * Side Effects:    None                                                         E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            * Overview:        This function should be called by user when the device       E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                  is waken up by an external stimulus other than ACTIVIF.      E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                  Please read the note below to understand the limitations.    E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            * Note:            The modifiable section in this routine should be changed     E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                  to meet the application needs. Current implementation        E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                  temporary blocks other functions from executing for a        E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                  period of 1-13 ms depending on the core frequency.           E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                  According to USB 2.0 specification section 7.1.7.7,          E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                  "The remote wakeup device must hold the resume signaling     E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                  for at lest 1 ms but for no more than 15 ms."                E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                  The idea here is to use a delay counter loop, using a        E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                  common value that would work over a wide range of core       E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                  frequencies.                                                 E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                  That value selected is 1800. See table below:                E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                  ==========================================================   E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                  Core Freq(MHz)      MIP         RESUME Signal Period (ms)    E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                  ==========================================================   E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                      48              12          1.05                         E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                       4              1           12.6                         E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                  ==========================================================   E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                  * These timing could be incorrect when using code            E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                    optimization or extended instruction mode,                 E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                    or when having other interrupts enabled.                   E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                    Make sure to verify using the MPLAB SIM's Stopwatch        E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *****************************************************************************/  E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                           void USBRemoteWakeup(void)                                                       E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                           {                                                                                E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                               static word delay_count;                                                     E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
0010b2   0100     MOVLB     0x0                if(usb_stat.RemoteWakeup == 1)          // Check if RemoteWakeup function    E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
0010b4   a1fd     BTFSS     0xfd,0x0,0x1                                                                                    
0010b6   d00e     BRA       0x10d4                                                                                          
                                               {                                       // has been enabled by the host.     E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
0010b8   dff8     RCALL     0x10aa                 USBWakeFromSuspend();               // Unsuspend USB modue               E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
0010ba   846d     BSF       0x6d,0x2,0x0           UCONbits.RESUME = 1;                // Start RESUME signaling            E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                                   /* Modifiable Section */                                                 E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
0010bc   0101     MOVLB     0x1                    delay_count = 1800U;                // Set RESUME line for 1-13 ms       E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
0010be   0e08     MOVLW     0x8                                                                                             
0010c0   6f63     MOVWF     0x63,0x1                                                                                        
0010c2   0e07     MOVLW     0x7                                                                                             
0010c4   6f64     MOVWF     0x64,0x1                                                                                        
                                                   do                                                                       E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                                   {                                                                        E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
0010c6   0763     DECF      0x63,0x1,0x1               delay_count--;                                                       E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
0010c8   0e00     MOVLW     0x0                                                                                             
0010ca   5b64     SUBWFB    0x64,0x1,0x1                                                                                    
0010cc   5163     MOVF      0x63,0x0,0x1           }while(delay_count);                                                     E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
0010ce   1164     IORWF     0x64,0x0,0x1                                                                                    
0010d0   e1fa     BNZ       0x10c6                                                                                          
                                                                                                                            E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                                   /* End Modifiable Section */                                             E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
0010d2   946d     BCF       0x6d,0x2,0x0           UCONbits.RESUME = 0;                                                     E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                               }//endif                                                                     E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
0010d4   0012     RETURN    0x0            }//end USBRemoteWakeup                                                           E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                           /******************************************************************************  E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            * Function:        void USB_SOF_Handler(void)                                   E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            * PreCondition:    None                                                         E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            * Input:           None                                                         E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            * Output:          None                                                         E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            * Side Effects:    None                                                         E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            * Overview:        The USB host sends out a SOF packet to full-speed devices    E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                  every 1 ms. This interrupt may be useful for isochronous     E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                  pipes. End designers should implement callback routine       E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                  as necessary.                                                E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            * Note:            None                                                         E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *****************************************************************************/  E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                           void USB_SOF_Handler(void)                                                       E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                           {                                                                                E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                               /* Callback routine here */                                                  E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
0010d6   9c68     BCF       0x68,0x6,0x0       UIRbits.SOFIF = 0;                                                           E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
0010d8   0012     RETURN    0x0            }//end USB_SOF_Handler                                                           E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                           /******************************************************************************  E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            * Function:        void USBStallHandler(void)                                   E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            * PreCondition:    A STALL packet is sent to the host by the SIE.               E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            * Input:           None                                                         E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            * Output:          None                                                         E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            * Side Effects:    None                                                         E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            * Overview:        The STALLIF is set anytime the SIE sends out a STALL         E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                  packet regardless of which endpoint causes it.               E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                  A Setup transaction overrides the STALL function. A stalled  E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                  endpoint stops stalling once it receives a setup packet.     E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                  In this case, the SIE will accepts the Setup packet and      E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                  set the TRNIF flag to notify the firmware. STALL function    E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                  for that particular endpoint pipe will be automatically      E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                  disabled (direction specific).                               E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                  There are a few reasons for an endpoint to be stalled.       E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                  1. When a non-supported USB request is received.             E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                     Example: GET_DESCRIPTOR(DEVICE_QUALIFIER)                 E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                  2. When an endpoint is currently halted.                     E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                  3. When the device class specifies that an endpoint must     E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                     stall in response to a specific event.                    E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                     Example: Mass Storage Device Class                        E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                              If the CBW is not valid, the device shall        E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                              STALL the Bulk-In pipe.                          E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                              See USB Mass Storage Class Bulk-only Transport   E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                              Specification for more details.                  E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            * Note:            UEPn.EPSTALL can be scanned to see which endpoint causes     E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                  the stall event.                                             E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                  If                                                           E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *****************************************************************************/  E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                           void USBStallHandler(void)                                                       E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                           {                                                                                E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                               /*                                                                           E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                                * Does not really have to do anything here,                                 E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                                * even for the control endpoint.                                            E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                                * All BDs of Endpoint 0 are owned by SIE right now,                         E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                                * but once a Setup Transaction is received, the ownership                   E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                                * for EP0_OUT will be returned to CPU.                                      E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                                * When the Setup Transaction is serviced, the ownership                     E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                                * for EP0_IN will then be forced back to CPU by firmware.                   E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                                *                                                                           E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                                * NOTE: Above description is not quite true at this point.                  E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                                *       It seems the SIE never returns the UOWN bit to CPU,                 E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                                *       and a TRNIF is never generated upon successful                      E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                                *       reception of a SETUP transaction.                                   E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                                *       Firmware work-around is implemented below.                          E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                                */                                                                          E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
0010da   a070     BTFSS     0x70,0x0,0x0       if(UEP0bits.EPSTALL == 1)                                                    E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
0010dc   d003     BRA       0x10e4                                                                                          
                                               {                                                                            E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
0010de   ec18     CALL      0xe30,0x0              USBPrepareForNextSetupTrf();        // Firmware Work-Around              E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
0010e0   f007                                                                                                               
0010e2   9070     BCF       0x70,0x0,0x0           UEP0bits.EPSTALL = 0;                                                    E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                               }                                                                            E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
0010e4   9a68     BCF       0x68,0x5,0x0       UIRbits.STALLIF = 0;                                                         E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
0010e6   0012     RETURN    0x0            }//end USBStallHandler                                                           E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                           /******************************************************************************  E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            * Function:        void USBErrorHandler(void)                                   E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            * PreCondition:    None                                                         E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            * Input:           None                                                         E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            * Output:          None                                                         E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            * Side Effects:    None                                                         E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            * Overview:        The purpose of this interrupt is mainly for debugging        E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                  during development. Check UEIR to see which error causes     E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                  the interrupt.                                               E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            * Note:            None                                                         E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *****************************************************************************/  E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                           void USBErrorHandler(void)                                                       E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                           {                                                                                E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
0010e8   9268     BCF       0x68,0x1,0x0       UIRbits.UERRIF = 0;                                                          E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
0010ea   0012     RETURN    0x0            }//end USBErrorHandler                                                           E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                           /******************************************************************************  E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            * Function:        void USBProtocolResetHandler(void)                           E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            * PreCondition:    A USB bus reset is received from the host.                   E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            * Input:           None                                                         E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            * Output:          None                                                         E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            * Side Effects:    Currently, this routine flushes any pending USB              E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                  transactions. It empties out the USTAT FIFO. This action     E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                  might not be desirable in some applications.                 E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            * Overview:        Once a USB bus reset is received from the host, this         E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                  routine should be called. It resets the device address to    E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                  zero, disables all non-EP0 endpoints, initializes EP0 to     E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                  be ready for default communication, clears all USB           E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                  interrupt flags, unmasks applicable USB interrupts, and      E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                  reinitializes internal state-machine variables.              E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            * Note:            None                                                         E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                            *****************************************************************************/  E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                           void USBProtocolResetHandler(void)                                               E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                           {                                                                                E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
0010ec   6a6a     CLRF      0x6a,0x0           UEIR = 0;                       // Clear all USB error flags                 E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
0010ee   6a68     CLRF      0x68,0x0           UIR = 0;                        // Clears all USB interrupts                 E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
0010f0   0e9f     MOVLW     0x9f               UEIE = 0b10011111;              // Unmask all USB error interrupts           E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
0010f2   6e6b     MOVWF     0x6b,0x0                                                                                        
0010f4   0e7b     MOVLW     0x7b               UIE = 0b01111011;               // Enable all interrupts except ACTVIE       E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
0010f6   6e69     MOVWF     0x69,0x0                                                                                        
                                                                                                                            E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
0010f8   6a6e     CLRF      0x6e,0x0           UADDR = 0x00;                   // Reset to default address                  E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
0010fa   0e0f     MOVLW     0xf                mDisableEP1to15();              // Reset all non-EP0 UEPn registers          E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
0010fc   6ee6     MOVWF     0xe6,0x0                                                                                        
0010fe   0e71     MOVLW     0x71                                                                                            
001100   6ee6     MOVWF     0xe6,0x0                                                                                        
001102   0e0f     MOVLW     0xf                                                                                             
001104   6ee6     MOVWF     0xe6,0x0                                                                                        
001106   d814     RCALL     0x1130                                                                                          
001108   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00110a   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00110c   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00110e   0e16     MOVLW     0x16               UEP0 = EP_CTRL|HSHK_EN;         // Init EP0 as a Ctrl EP, see usbdrv.h       E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
001110   6e70     MOVWF     0x70,0x0                                                                                        
                                                                                                                            E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
001112   a668     BTFSS     0x68,0x3,0x0       while(UIRbits.TRNIF == 1)       // Flush any pending transactions            E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
001114   d002     BRA       0x111a                                                                                          
001118   d7fc     BRA       0x1112                                                                                          
001116   9668     BCF       0x68,0x3,0x0           UIRbits.TRNIF = 0;                                                       E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
00111a   986d     BCF       0x6d,0x4,0x0       UCONbits.PKTDIS = 0;            // Make sure packet processing is enabled    E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
00111c   ec18     CALL      0xe30,0x0          USBPrepareForNextSetupTrf();    // Declared in usbctrltrf.c                  E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
00111e   f007                                                                                                               
                                                                                                                            E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
001120   0100     MOVLB     0x0                usb_stat.RemoteWakeup = 0;      // Default status flag to disable            E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
001122   91fd     BCF       0xfd,0x0,0x1                                                                                    
001124   0100     MOVLB     0x0                usb_active_cfg = 0;             // Clear active configuration                E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
001126   6bfe     CLRF      0xfe,0x1                                                                                        
001128   0100     MOVLB     0x0                usb_device_state = DEFAULT_STATE;                                            E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
00112a   0e03     MOVLW     0x3                                                                                             
00112c   6ffc     MOVWF     0xfc,0x1                                                                                        
00112e   0012     RETURN    0x0            }//end USBProtocolResetHandler                                                   E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                           /* Auxiliary Function */                                                         E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
001130   cfd9     MOVFF     0xfd9,0xfe6    void ClearArray(byte* startAdr,byte count)                                       E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
001132   ffe6                                                                                                               
001134   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
001136   ffd9                                                                                                               
                                           {                                                                                E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
001138   0efd     MOVLW     0xfd               *startAdr;                                                                   E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
00113a   cfdb     MOVFF     0xfdb,0xfe9                                                                                     
00113c   ffe9                                                                                                               
00113e   0efe     MOVLW     0xfe                                                                                            
001140   cfdb     MOVFF     0xfdb,0xfea                                                                                     
001142   ffea                                                                                                               
001144   0efc     MOVLW     0xfc               while(count)                                                                 E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
001146   50db     MOVF      0xdb,0x0,0x0                                                                                    
001148   e004     BZ        0x1152                                                                                          
001150   d7f9     BRA       0x1144                                                                                          
                                               {                                                                            E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                                   _asm                                                                     E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
00114a   6aee     CLRF      0xee,0x0               clrf POSTINC0,0                                                          E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                                   _endasm                                                                  E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
00114c   0efc     MOVLW     0xfc                   count--;                                                                 E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
00114e   06db     DECF      0xdb,0x1,0x0                                                                                    
                                               }//end while                                                                 E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
001152   52e5     MOVF      0xe5,0x1,0x0   }//end ClearArray                                                                E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
001154   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
001156   ffd9                                                                                                               
001158   0012     RETURN    0x0                                                                                             
                                                                                                                            E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                           /** EOF usbdrv.c *************************************************************/  E:\usb20\FCounter20\system\usb\usbdrv\usbdrv.c
                                           /*********************************************************************           E:\usb20\FCounter20\autofiles\usbdsc.c
                                            *                                                                               E:\usb20\FCounter20\autofiles\usbdsc.c
                                            *                Microchip USB C18 Firmware Version 1.0                         E:\usb20\FCounter20\autofiles\usbdsc.c
                                            *                                                                               E:\usb20\FCounter20\autofiles\usbdsc.c
                                            *********************************************************************           E:\usb20\FCounter20\autofiles\usbdsc.c
                                            * FileName:        usbdsc.c                                                     E:\usb20\FCounter20\autofiles\usbdsc.c
                                            * Dependencies:    See INCLUDES section below                                   E:\usb20\FCounter20\autofiles\usbdsc.c
                                            * Processor:       PIC18                                                        E:\usb20\FCounter20\autofiles\usbdsc.c
                                            * Compiler:        C18 2.30.01+                                                 E:\usb20\FCounter20\autofiles\usbdsc.c
                                            * Company:         Microchip Technology, Inc.                                   E:\usb20\FCounter20\autofiles\usbdsc.c
                                            *                                                                               E:\usb20\FCounter20\autofiles\usbdsc.c
                                            * Software License Agreement                                                    E:\usb20\FCounter20\autofiles\usbdsc.c
                                            *                                                                               E:\usb20\FCounter20\autofiles\usbdsc.c
                                            * The software supplied herewith by Microchip Technology Incorporated           E:\usb20\FCounter20\autofiles\usbdsc.c
                                            * (the 鼎ompany・ for its PICmicroｮ Microcontroller is intended and             E:\usb20\FCounter20\autofiles\usbdsc.c
                                            * supplied to you, the Company痴 customer, for use solely and                   E:\usb20\FCounter20\autofiles\usbdsc.c
                                            * exclusively on Microchip PICmicro Microcontroller products. The               E:\usb20\FCounter20\autofiles\usbdsc.c
                                            * software is owned by the Company and/or its supplier, and is                  E:\usb20\FCounter20\autofiles\usbdsc.c
                                            * protected under applicable copyright laws. All rights are reserved.           E:\usb20\FCounter20\autofiles\usbdsc.c
                                            * Any use in violation of the foregoing restrictions may subject the            E:\usb20\FCounter20\autofiles\usbdsc.c
                                            * user to criminal sanctions under applicable laws, as well as to               E:\usb20\FCounter20\autofiles\usbdsc.c
                                            * civil liability for the breach of the terms and conditions of this            E:\usb20\FCounter20\autofiles\usbdsc.c
                                            * license.                                                                      E:\usb20\FCounter20\autofiles\usbdsc.c
                                            *                                                                               E:\usb20\FCounter20\autofiles\usbdsc.c
                                            * THIS SOFTWARE IS PROVIDED IN AN 鄭S IS・CONDITION. NO WARRANTIES,             E:\usb20\FCounter20\autofiles\usbdsc.c
                                            * WHETHER EXPRESS, IMPLIED OR STATUTORY, INCLUDING, BUT NOT LIMITED             E:\usb20\FCounter20\autofiles\usbdsc.c
                                            * TO, IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A                   E:\usb20\FCounter20\autofiles\usbdsc.c
                                            * PARTICULAR PURPOSE APPLY TO THIS SOFTWARE. THE COMPANY SHALL NOT,             E:\usb20\FCounter20\autofiles\usbdsc.c
                                            * IN ANY CIRCUMSTANCES, BE LIABLE FOR SPECIAL, INCIDENTAL OR                    E:\usb20\FCounter20\autofiles\usbdsc.c
                                            * CONSEQUENTIAL DAMAGES, FOR ANY REASON WHATSOEVER.                             E:\usb20\FCounter20\autofiles\usbdsc.c
                                            *                                                                               E:\usb20\FCounter20\autofiles\usbdsc.c
                                            ********************************************************************/           E:\usb20\FCounter20\autofiles\usbdsc.c
                                                                                                                            E:\usb20\FCounter20\autofiles\usbdsc.c
                                           /*********************************************************************           E:\usb20\FCounter20\autofiles\usbdsc.c
                                            * -usbdsc.c-                                                                    E:\usb20\FCounter20\autofiles\usbdsc.c
                                            * This file contains the USB descriptor information. It is used                 E:\usb20\FCounter20\autofiles\usbdsc.c
                                            * in conjunction with the usbdsc.h file. When a descriptor is added             E:\usb20\FCounter20\autofiles\usbdsc.c
                                            * or removed from the main configuration descriptor, i.e. CFG01,                E:\usb20\FCounter20\autofiles\usbdsc.c
                                            * the user must also change the descriptor structure defined in                 E:\usb20\FCounter20\autofiles\usbdsc.c
                                            * the usbdsc.h file. The structure is used to calculate the                     E:\usb20\FCounter20\autofiles\usbdsc.c
                                            * descriptor size, i.e. sizeof(CFG01).                                          E:\usb20\FCounter20\autofiles\usbdsc.c
                                            *                                                                               E:\usb20\FCounter20\autofiles\usbdsc.c
                                            * A typical configuration descriptor consists of:                               E:\usb20\FCounter20\autofiles\usbdsc.c
                                            * At least one configuration descriptor (USB_CFG_DSC)                           E:\usb20\FCounter20\autofiles\usbdsc.c
                                            * One or more interface descriptors (USB_INTF_DSC)                              E:\usb20\FCounter20\autofiles\usbdsc.c
                                            * One or more endpoint descriptors (USB_EP_DSC)                                 E:\usb20\FCounter20\autofiles\usbdsc.c
                                            *                                                                               E:\usb20\FCounter20\autofiles\usbdsc.c
                                            * Naming Convention:                                                            E:\usb20\FCounter20\autofiles\usbdsc.c
                                            * To resolve ambiguity, the naming convention are as followed:                  E:\usb20\FCounter20\autofiles\usbdsc.c
                                            * - USB_CFG_DSC type should be named cdxx, where xx is the                      E:\usb20\FCounter20\autofiles\usbdsc.c
                                            *   configuration number. This number should match the actual                   E:\usb20\FCounter20\autofiles\usbdsc.c
                                            *   index value of this configuration.                                          E:\usb20\FCounter20\autofiles\usbdsc.c
                                            * - USB_INTF_DSC type should be named i<yy>a<zz>, where yy is the               E:\usb20\FCounter20\autofiles\usbdsc.c
                                            *   interface number and zz is the alternate interface number.                  E:\usb20\FCounter20\autofiles\usbdsc.c
                                            * - USB_EP_DSC type should be named ep<##><d>_i<yy>a<zz>, where                 E:\usb20\FCounter20\autofiles\usbdsc.c
                                            *   ## is the endpoint number and d is the direction of transfer.               E:\usb20\FCounter20\autofiles\usbdsc.c
                                            *   The interface name should also be listed as a suffix to identify            E:\usb20\FCounter20\autofiles\usbdsc.c
                                            *   which interface does the endpoint belong to.                                E:\usb20\FCounter20\autofiles\usbdsc.c
                                            *                                                                               E:\usb20\FCounter20\autofiles\usbdsc.c
                                            * Example:                                                                      E:\usb20\FCounter20\autofiles\usbdsc.c
                                            * If a device has one configuration, two interfaces; interface 0                E:\usb20\FCounter20\autofiles\usbdsc.c
                                            * has two endpoints (in and out), and interface 1 has one endpoint(in).         E:\usb20\FCounter20\autofiles\usbdsc.c
                                            * Then the CFG01 structure in the usbdsc.h should be:                           E:\usb20\FCounter20\autofiles\usbdsc.c
                                            *                                                                               E:\usb20\FCounter20\autofiles\usbdsc.c
                                            * #define CFG01 rom struct                            \                         E:\usb20\FCounter20\autofiles\usbdsc.c
                                            * {   USB_CFG_DSC             cd01;                   \                         E:\usb20\FCounter20\autofiles\usbdsc.c
                                            *     USB_INTF_DSC            i00a00;                 \                         E:\usb20\FCounter20\autofiles\usbdsc.c
                                            *     USB_EP_DSC              ep01o_i00a00;           \                         E:\usb20\FCounter20\autofiles\usbdsc.c
                                            *     USB_EP_DSC              ep01i_i00a00;           \                         E:\usb20\FCounter20\autofiles\usbdsc.c
                                            *     USB_INTF_DSC            i01a00;                 \                         E:\usb20\FCounter20\autofiles\usbdsc.c
                                            *     USB_EP_DSC              ep02i_i01a00;           \                         E:\usb20\FCounter20\autofiles\usbdsc.c
                                            * } cfg01                                                                       E:\usb20\FCounter20\autofiles\usbdsc.c
                                            *                                                                               E:\usb20\FCounter20\autofiles\usbdsc.c
                                            * Note the hierarchy of the descriptors above, it follows the USB               E:\usb20\FCounter20\autofiles\usbdsc.c
                                            * specification requirement. All endpoints belonging to an interface            E:\usb20\FCounter20\autofiles\usbdsc.c
                                            * should be listed immediately after that interface.                            E:\usb20\FCounter20\autofiles\usbdsc.c
                                            *                                                                               E:\usb20\FCounter20\autofiles\usbdsc.c
                                            * -------------------------------------------------------------------           E:\usb20\FCounter20\autofiles\usbdsc.c
                                            * Filling in the descriptor values in the usbdsc.c file:                        E:\usb20\FCounter20\autofiles\usbdsc.c
                                            * -------------------------------------------------------------------           E:\usb20\FCounter20\autofiles\usbdsc.c
                                            * Most items should be self-explanatory, however, a few will be                 E:\usb20\FCounter20\autofiles\usbdsc.c
                                            * explained for clarification.                                                  E:\usb20\FCounter20\autofiles\usbdsc.c
                                            *                                                                               E:\usb20\FCounter20\autofiles\usbdsc.c
                                            * [Configuration Descriptor(USB_CFG_DSC)]                                       E:\usb20\FCounter20\autofiles\usbdsc.c
                                            * The configuration attribute must always have the _DEFAULT                     E:\usb20\FCounter20\autofiles\usbdsc.c
                                            * definition at the minimum. Additional options can be ORed                     E:\usb20\FCounter20\autofiles\usbdsc.c
                                            * to the _DEFAULT attribute. Available options are _SELF and _RWU.              E:\usb20\FCounter20\autofiles\usbdsc.c
                                            * These definitions are defined in the usbdefs_std_dsc.h file. The              E:\usb20\FCounter20\autofiles\usbdsc.c
                                            * _SELF tells the USB host that this device is self-powered. The                E:\usb20\FCounter20\autofiles\usbdsc.c
                                            * _RWU tells the USB host that this device supports Remote Wakeup.              E:\usb20\FCounter20\autofiles\usbdsc.c
                                            *                                                                               E:\usb20\FCounter20\autofiles\usbdsc.c
                                            * [Endpoint Descriptor(USB_EP_DSC)]                                             E:\usb20\FCounter20\autofiles\usbdsc.c
                                            * Assume the following example:                                                 E:\usb20\FCounter20\autofiles\usbdsc.c
                                            * sizeof(USB_EP_DSC),DSC_EP,_EP01_OUT,_BULK,64,0x00                             E:\usb20\FCounter20\autofiles\usbdsc.c
                                            *                                                                               E:\usb20\FCounter20\autofiles\usbdsc.c
                                            * The first two parameters are self-explanatory. They specify the               E:\usb20\FCounter20\autofiles\usbdsc.c
                                            * length of this endpoint descriptor (7) and the descriptor type.               E:\usb20\FCounter20\autofiles\usbdsc.c
                                            * The next parameter identifies the endpoint, the definitions are               E:\usb20\FCounter20\autofiles\usbdsc.c
                                            * defined in usbdefs_std_dsc.h and has the following naming                     E:\usb20\FCounter20\autofiles\usbdsc.c
                                            * convention:                                                                   E:\usb20\FCounter20\autofiles\usbdsc.c
                                            * _EP<##>_<dir>                                                                 E:\usb20\FCounter20\autofiles\usbdsc.c
                                            * where ## is the endpoint number and dir is the direction of                   E:\usb20\FCounter20\autofiles\usbdsc.c
                                            * transfer. The dir has the value of either 'OUT' or 'IN'.                      E:\usb20\FCounter20\autofiles\usbdsc.c
                                            * The next parameter identifies the type of the endpoint. Available             E:\usb20\FCounter20\autofiles\usbdsc.c
                                            * options are _BULK, _INT, _ISO, and _CTRL. The _CTRL is not                    E:\usb20\FCounter20\autofiles\usbdsc.c
                                            * typically used because the default control transfer endpoint is               E:\usb20\FCounter20\autofiles\usbdsc.c
                                            * not defined in the USB descriptors. When _ISO option is used,                 E:\usb20\FCounter20\autofiles\usbdsc.c
                                            * addition options can be ORed to _ISO. Example:                                E:\usb20\FCounter20\autofiles\usbdsc.c
                                            * _ISO|_AD|_FE                                                                  E:\usb20\FCounter20\autofiles\usbdsc.c
                                            * This describes the endpoint as an isochronous pipe with adaptive              E:\usb20\FCounter20\autofiles\usbdsc.c
                                            * and feedback attributes. See usbdefs_std_dsc.h and the USB                    E:\usb20\FCounter20\autofiles\usbdsc.c
                                            * specification for details. The next parameter defines the size of             E:\usb20\FCounter20\autofiles\usbdsc.c
                                            * the endpoint. The last parameter in the polling interval.                     E:\usb20\FCounter20\autofiles\usbdsc.c
                                            *                                                                               E:\usb20\FCounter20\autofiles\usbdsc.c
                                            * -------------------------------------------------------------------           E:\usb20\FCounter20\autofiles\usbdsc.c
                                            * Adding a USB String                                                           E:\usb20\FCounter20\autofiles\usbdsc.c
                                            * -------------------------------------------------------------------           E:\usb20\FCounter20\autofiles\usbdsc.c
                                            * A string descriptor array should have the following format:                   E:\usb20\FCounter20\autofiles\usbdsc.c
                                            *                                                                               E:\usb20\FCounter20\autofiles\usbdsc.c
                                            * rom struct{byte bLength;byte bDscType;word string[size];}sdxxx={              E:\usb20\FCounter20\autofiles\usbdsc.c
                                            * sizeof(sdxxx),DSC_STR,<text>};                                                E:\usb20\FCounter20\autofiles\usbdsc.c
                                            *                                                                               E:\usb20\FCounter20\autofiles\usbdsc.c
                                            * The above structure provides a means for the C compiler to                    E:\usb20\FCounter20\autofiles\usbdsc.c
                                            * calculate the length of string descriptor sdxxx, where xxx is the             E:\usb20\FCounter20\autofiles\usbdsc.c
                                            * index number. The first two bytes of the descriptor are descriptor            E:\usb20\FCounter20\autofiles\usbdsc.c
                                            * length and type. The rest <text> are string texts which must be               E:\usb20\FCounter20\autofiles\usbdsc.c
                                            * in the unicode format. The unicode format is achieved by declaring            E:\usb20\FCounter20\autofiles\usbdsc.c
                                            * each character as a word type. The whole text string is declared              E:\usb20\FCounter20\autofiles\usbdsc.c
                                            * as a word array with the number of characters equals to <size>.               E:\usb20\FCounter20\autofiles\usbdsc.c
                                            * <size> has to be manually counted and entered into the array                  E:\usb20\FCounter20\autofiles\usbdsc.c
                                            * declaration. Let's study this through an example:                             E:\usb20\FCounter20\autofiles\usbdsc.c
                                            * if the string is "USB" , then the string descriptor should be:                E:\usb20\FCounter20\autofiles\usbdsc.c
                                            * (Using index 02)                                                              E:\usb20\FCounter20\autofiles\usbdsc.c
                                            * rom struct{byte bLength;byte bDscType;word string[3];}sd002={                 E:\usb20\FCounter20\autofiles\usbdsc.c
                                            * sizeof(sd002),DSC_STR,'U','S','B'};                                           E:\usb20\FCounter20\autofiles\usbdsc.c
                                            *                                                                               E:\usb20\FCounter20\autofiles\usbdsc.c
                                            * A USB project may have multiple strings and the firmware supports             E:\usb20\FCounter20\autofiles\usbdsc.c
                                            * the management of multiple strings through a look-up table.                   E:\usb20\FCounter20\autofiles\usbdsc.c
                                            * The look-up table is defined as:                                              E:\usb20\FCounter20\autofiles\usbdsc.c
                                            * rom const unsigned char *rom USB_SD_Ptr[]={&sd000,&sd001,&sd002};             E:\usb20\FCounter20\autofiles\usbdsc.c
                                            *                                                                               E:\usb20\FCounter20\autofiles\usbdsc.c
                                            * The above declaration has 3 strings, sd000, sd001, and sd002.                 E:\usb20\FCounter20\autofiles\usbdsc.c
                                            * Strings can be removed or added. sd000 is a specialized string                E:\usb20\FCounter20\autofiles\usbdsc.c
                                            * descriptor. It defines the language code, usually this is                     E:\usb20\FCounter20\autofiles\usbdsc.c
                                            * US English (0x0409). The index of the string must match the index             E:\usb20\FCounter20\autofiles\usbdsc.c
                                            * position of the USB_SD_Ptr array, &sd000 must be in position                  E:\usb20\FCounter20\autofiles\usbdsc.c
                                            * USB_SD_Ptr[0], &sd001 must be in position USB_SD_Ptr[1] and so on.            E:\usb20\FCounter20\autofiles\usbdsc.c
                                            * The look-up table USB_SD_Ptr is used by the get string handler                E:\usb20\FCounter20\autofiles\usbdsc.c
                                            * function in usb9.c.                                                           E:\usb20\FCounter20\autofiles\usbdsc.c
                                            *                                                                               E:\usb20\FCounter20\autofiles\usbdsc.c
                                            * -------------------------------------------------------------------           E:\usb20\FCounter20\autofiles\usbdsc.c
                                            *                                                                               E:\usb20\FCounter20\autofiles\usbdsc.c
                                            * The look-up table scheme also applies to the configuration                    E:\usb20\FCounter20\autofiles\usbdsc.c
                                            * descriptor. A USB device may have multiple configuration                      E:\usb20\FCounter20\autofiles\usbdsc.c
                                            * descriptors, i.e. CFG01, CFG02, etc. To add a configuration                   E:\usb20\FCounter20\autofiles\usbdsc.c
                                            * descriptor, user must implement a structure similar to CFG01.                 E:\usb20\FCounter20\autofiles\usbdsc.c
                                            * The next step is to add the configuration descriptor name, i.e.               E:\usb20\FCounter20\autofiles\usbdsc.c
                                            * cfg01, cfg02,.., to the look-up table USB_CD_Ptr. USB_CD_Ptr[0]               E:\usb20\FCounter20\autofiles\usbdsc.c
                                            * is a dummy place holder since configuration 0 is the un-configured            E:\usb20\FCounter20\autofiles\usbdsc.c
                                            * state according to the definition in the USB specification.                   E:\usb20\FCounter20\autofiles\usbdsc.c
                                            *                                                                               E:\usb20\FCounter20\autofiles\usbdsc.c
                                            ********************************************************************/           E:\usb20\FCounter20\autofiles\usbdsc.c
                                                                                                                            E:\usb20\FCounter20\autofiles\usbdsc.c
                                           /*********************************************************************           E:\usb20\FCounter20\autofiles\usbdsc.c
                                            * Descriptor specific type definitions are defined in:                          E:\usb20\FCounter20\autofiles\usbdsc.c
                                            * system\usb\usbdefs\usbdefs_std_dsc.h                                          E:\usb20\FCounter20\autofiles\usbdsc.c
                                            *                                                                               E:\usb20\FCounter20\autofiles\usbdsc.c
                                            * Configuration information is defined in:                                      E:\usb20\FCounter20\autofiles\usbdsc.c
                                            * autofiles\usbcfg.h                                                            E:\usb20\FCounter20\autofiles\usbdsc.c
                                            ********************************************************************/           E:\usb20\FCounter20\autofiles\usbdsc.c
                                                                                                                            E:\usb20\FCounter20\autofiles\usbdsc.c
                                           /** I N C L U D E S *************************************************/           E:\usb20\FCounter20\autofiles\usbdsc.c
                                           #include "system\typedefs.h"                                                     E:\usb20\FCounter20\autofiles\usbdsc.c
                                           #include "system\usb\usb.h"                                                      E:\usb20\FCounter20\autofiles\usbdsc.c
                                                                                                                            E:\usb20\FCounter20\autofiles\usbdsc.c
                                           /** C O N S T A N T S ************************************************/          E:\usb20\FCounter20\autofiles\usbdsc.c
                                           #pragma romdata                                                                  E:\usb20\FCounter20\autofiles\usbdsc.c
                                                                                                                            E:\usb20\FCounter20\autofiles\usbdsc.c
                                           /* Device Descriptor */                                                          E:\usb20\FCounter20\autofiles\usbdsc.c
                                           rom USB_DEV_DSC device_dsc=                                                      E:\usb20\FCounter20\autofiles\usbdsc.c
                                           {                                                                                E:\usb20\FCounter20\autofiles\usbdsc.c
                                               sizeof(USB_DEV_DSC),    // Size of this descriptor in bytes                  E:\usb20\FCounter20\autofiles\usbdsc.c
                                               DSC_DEV,                // DEVICE descriptor type                            E:\usb20\FCounter20\autofiles\usbdsc.c
                                               0x0200,                 // USB Spec Release Number in BCD format             E:\usb20\FCounter20\autofiles\usbdsc.c
                                               CDC_DEVICE,             // Class Code                                        E:\usb20\FCounter20\autofiles\usbdsc.c
                                               0x00,                   // Subclass code                                     E:\usb20\FCounter20\autofiles\usbdsc.c
                                               0x00,                   // Protocol code                                     E:\usb20\FCounter20\autofiles\usbdsc.c
                                               EP0_BUFF_SIZE,          // Max packet size for EP0, see usbcfg.h             E:\usb20\FCounter20\autofiles\usbdsc.c
                                               0x09B9,                 // Vendor ID                                         E:\usb20\FCounter20\autofiles\usbdsc.c
                                               0x0049,                 // Product ID: CDC RS-232 Emulation Demo             E:\usb20\FCounter20\autofiles\usbdsc.c
                                               0x0000,                 // Device release number in BCD format               E:\usb20\FCounter20\autofiles\usbdsc.c
                                               0x01,                   // Manufacturer string index                         E:\usb20\FCounter20\autofiles\usbdsc.c
                                               0x02,                   // Product string index                              E:\usb20\FCounter20\autofiles\usbdsc.c
                                               0x00,                   // Device serial number string index                 E:\usb20\FCounter20\autofiles\usbdsc.c
                                               0x01                    // Number of possible configurations                 E:\usb20\FCounter20\autofiles\usbdsc.c
                                           };                                                                               E:\usb20\FCounter20\autofiles\usbdsc.c
                                                                                                                            E:\usb20\FCounter20\autofiles\usbdsc.c
                                           /* Configuration 1 Descriptor */                                                 E:\usb20\FCounter20\autofiles\usbdsc.c
                                           CFG01=                                                                           E:\usb20\FCounter20\autofiles\usbdsc.c
                                           {                                                                                E:\usb20\FCounter20\autofiles\usbdsc.c
                                               /* Configuration Descriptor */                                               E:\usb20\FCounter20\autofiles\usbdsc.c
                                               sizeof(USB_CFG_DSC),    // Size of this descriptor in bytes                  E:\usb20\FCounter20\autofiles\usbdsc.c
                                               DSC_CFG,                // CONFIGURATION descriptor type                     E:\usb20\FCounter20\autofiles\usbdsc.c
                                               sizeof(cfg01),          // Total length of data for this cfg                 E:\usb20\FCounter20\autofiles\usbdsc.c
                                               2,                      // Number of interfaces in this cfg                  E:\usb20\FCounter20\autofiles\usbdsc.c
                                               1,                      // Index value of this configuration                 E:\usb20\FCounter20\autofiles\usbdsc.c
                                               0,                      // Configuration string index                        E:\usb20\FCounter20\autofiles\usbdsc.c
                                               _DEFAULT,               // Attributes, see usbdefs_std_dsc.h                 E:\usb20\FCounter20\autofiles\usbdsc.c
                                               50,                     // Max power consumption (2X mA)                     E:\usb20\FCounter20\autofiles\usbdsc.c
                                                                                                                            E:\usb20\FCounter20\autofiles\usbdsc.c
                                               /* Interface Descriptor */                                                   E:\usb20\FCounter20\autofiles\usbdsc.c
                                               sizeof(USB_INTF_DSC),   // Size of this descriptor in bytes                  E:\usb20\FCounter20\autofiles\usbdsc.c
                                               DSC_INTF,               // INTERFACE descriptor type                         E:\usb20\FCounter20\autofiles\usbdsc.c
                                               0,                      // Interface Number                                  E:\usb20\FCounter20\autofiles\usbdsc.c
                                               0,                      // Alternate Setting Number                          E:\usb20\FCounter20\autofiles\usbdsc.c
                                               1,                      // Number of endpoints in this intf                  E:\usb20\FCounter20\autofiles\usbdsc.c
                                               COMM_INTF,              // Class code                                        E:\usb20\FCounter20\autofiles\usbdsc.c
                                               ABSTRACT_CONTROL_MODEL, // Subclass code                                     E:\usb20\FCounter20\autofiles\usbdsc.c
                                               V25TER,                 // Protocol code                                     E:\usb20\FCounter20\autofiles\usbdsc.c
                                               0,                      // Interface string index                            E:\usb20\FCounter20\autofiles\usbdsc.c
                                                                                                                            E:\usb20\FCounter20\autofiles\usbdsc.c
                                               /* CDC Class-Specific Descriptors */                                         E:\usb20\FCounter20\autofiles\usbdsc.c
                                               sizeof(USB_CDC_HEADER_FN_DSC),CS_INTERFACE,DSC_FN_HEADER,0x0110,             E:\usb20\FCounter20\autofiles\usbdsc.c
                                               sizeof(USB_CDC_ACM_FN_DSC),CS_INTERFACE,DSC_FN_ACM,0x02,                     E:\usb20\FCounter20\autofiles\usbdsc.c
                                               sizeof(USB_CDC_UNION_FN_DSC),CS_INTERFACE,DSC_FN_UNION,CDC_COMM_INTF_ID,CDC_DATA_INTF_ID, E:\usb20\FCounter20\autofiles\usbdsc.c
                                               sizeof(USB_CDC_CALL_MGT_FN_DSC),CS_INTERFACE,DSC_FN_CALL_MGT,0x00,CDC_DATA_INTF_ID, E:\usb20\FCounter20\autofiles\usbdsc.c
                                                                                                                            E:\usb20\FCounter20\autofiles\usbdsc.c
                                               /* Endpoint Descriptor */                                                    E:\usb20\FCounter20\autofiles\usbdsc.c
                                               sizeof(USB_EP_DSC),DSC_EP,_EP02_IN,_INT,CDC_INT_EP_SIZE,0x02,                E:\usb20\FCounter20\autofiles\usbdsc.c
                                                                                                                            E:\usb20\FCounter20\autofiles\usbdsc.c
                                               /* Interface Descriptor */                                                   E:\usb20\FCounter20\autofiles\usbdsc.c
                                               sizeof(USB_INTF_DSC),   // Size of this descriptor in bytes                  E:\usb20\FCounter20\autofiles\usbdsc.c
                                               DSC_INTF,               // INTERFACE descriptor type                         E:\usb20\FCounter20\autofiles\usbdsc.c
                                               1,                      // Interface Number                                  E:\usb20\FCounter20\autofiles\usbdsc.c
                                               0,                      // Alternate Setting Number                          E:\usb20\FCounter20\autofiles\usbdsc.c
                                               2,                      // Number of endpoints in this intf                  E:\usb20\FCounter20\autofiles\usbdsc.c
                                               DATA_INTF,              // Class code                                        E:\usb20\FCounter20\autofiles\usbdsc.c
                                               0,                      // Subclass code                                     E:\usb20\FCounter20\autofiles\usbdsc.c
                                               NO_PROTOCOL,            // Protocol code                                     E:\usb20\FCounter20\autofiles\usbdsc.c
                                               0,                      // Interface string index                            E:\usb20\FCounter20\autofiles\usbdsc.c
                                                                                                                            E:\usb20\FCounter20\autofiles\usbdsc.c
                                               /* Endpoint Descriptors */                                                   E:\usb20\FCounter20\autofiles\usbdsc.c
                                               sizeof(USB_EP_DSC),DSC_EP,_EP03_OUT,_BULK,CDC_BULK_OUT_EP_SIZE,0x00,         E:\usb20\FCounter20\autofiles\usbdsc.c
                                               sizeof(USB_EP_DSC),DSC_EP,_EP03_IN,_BULK,CDC_BULK_IN_EP_SIZE,0x00            E:\usb20\FCounter20\autofiles\usbdsc.c
                                           };                                                                               E:\usb20\FCounter20\autofiles\usbdsc.c
                                                                                                                            E:\usb20\FCounter20\autofiles\usbdsc.c
                                           rom struct{byte bLength;byte bDscType;word string[1];}sd000={                    E:\usb20\FCounter20\autofiles\usbdsc.c
                                           sizeof(sd000),DSC_STR,0x0409};                                                   E:\usb20\FCounter20\autofiles\usbdsc.c
                                                                                                                            E:\usb20\FCounter20\autofiles\usbdsc.c
                                           rom struct{byte bLength;byte bDscType;word string[20];}sd001={                   E:\usb20\FCounter20\autofiles\usbdsc.c
                                           sizeof(sd001),DSC_STR,                                                           E:\usb20\FCounter20\autofiles\usbdsc.c
                                           'M','i','c','r','o','c','h','i','p',' ',                                         E:\usb20\FCounter20\autofiles\usbdsc.c
                                           'D','e','s','i','g','n',' ','L','a','b'};                                        E:\usb20\FCounter20\autofiles\usbdsc.c
                                                                                                                            E:\usb20\FCounter20\autofiles\usbdsc.c
                                           rom struct{byte bLength;byte bDscType;word string[17];}sd002={                   E:\usb20\FCounter20\autofiles\usbdsc.c
                                           sizeof(sd002),DSC_STR,                                                           E:\usb20\FCounter20\autofiles\usbdsc.c
                                           'F','r','e','q','u','e','n','c','y',' ',                                         E:\usb20\FCounter20\autofiles\usbdsc.c
                                           'C','o','u','n','t','e','r'};                                                    E:\usb20\FCounter20\autofiles\usbdsc.c
                                                                                                                            E:\usb20\FCounter20\autofiles\usbdsc.c
                                           rom const unsigned char *rom USB_CD_Ptr[]={&cfg01,&cfg01};                       E:\usb20\FCounter20\autofiles\usbdsc.c
                                           rom const unsigned char *rom USB_SD_Ptr[]={&sd000,&sd001,&sd002};                E:\usb20\FCounter20\autofiles\usbdsc.c
                                                                                                                            E:\usb20\FCounter20\autofiles\usbdsc.c
                                           rom pFunc ClassReqHandler[1]=                                                    E:\usb20\FCounter20\autofiles\usbdsc.c
                                           {                                                                                E:\usb20\FCounter20\autofiles\usbdsc.c
                                               &USBCheckCDCRequest                                                          E:\usb20\FCounter20\autofiles\usbdsc.c
                                           };                                                                               E:\usb20\FCounter20\autofiles\usbdsc.c
                                                                                                                            E:\usb20\FCounter20\autofiles\usbdsc.c
                                           #pragma code                                                                     E:\usb20\FCounter20\autofiles\usbdsc.c
                                                                                                                            E:\usb20\FCounter20\autofiles\usbdsc.c
                                           /** EOF usbdsc.c ****************************************************/           E:\usb20\FCounter20\autofiles\usbdsc.c
