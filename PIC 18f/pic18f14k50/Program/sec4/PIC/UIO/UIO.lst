MP2COD 4.00, COFF to COD File Converter
Copyright (c) 2005 Microchip Technology Inc.
Listing File Generated: Sun Nov 06 12:05:50 2005


Address  Value    Disassembly              Source                                                                           File
-------  -------  -----------------------  -------------------------------------------------------------------------------  -----
                                           /*********************************************************************           E:\usb20\UIO\main.c
                                           *                                                                                E:\usb20\UIO\main.c
                                           *　USB接続 汎用Ｉ／Ｏプログラム                                                  E:\usb20\UIO\main.c
                                           *	USBフレ-ムワーク修正情報                                                       E:\usb20\UIO\main.c
                                           *　　コンフィギュレーションの設定変更                                            E:\usb20\UIO\main.c
                                           *    CDCクラスベース                                                             E:\usb20\UIO\main.c
                                           *　　main.c　の変更　初期化削除　IO設定変更                                      E:\usb20\UIO\main.c
                                           *　　io_cfg.hの変更　LED削除　IOモニタ削除                                       E:\usb20\UIO\main.c
                                           *　　user.cの変更　　実行内容削除                                                E:\usb20\UIO\main.c
                                           *　　usbcfg.hの変更　IOモニタ削除                                                E:\usb20\UIO\main.c
                                           *                                                                                E:\usb20\UIO\main.c
                                           *********************************************************************            E:\usb20\UIO\main.c
                                                                                                                            E:\usb20\UIO\main.c
                                           /** I N C L U D E S ************************************************/            E:\usb20\UIO\main.c
                                           #include <p18cxxx.h>                                                             E:\usb20\UIO\main.c
                                           #include "system\typedefs.h"                 // Required                         E:\usb20\UIO\main.c
                                           #include "system\usb\usb.h"                  // Required                         E:\usb20\UIO\main.c
                                           #include "io_cfg.h"                          // Required                         E:\usb20\UIO\main.c
                                                                                                                            E:\usb20\UIO\main.c
                                           #include "system\usb\usb_compile_time_validation.h"                              E:\usb20\UIO\main.c
                                           #include	"delays.h"                                                              E:\usb20\UIO\main.c
                                           #include "lcd_lib.h"                                                             E:\usb20\UIO\main.c
                                                                                                                            E:\usb20\UIO\main.c
                                           /*** Configuration *******/                                                      E:\usb20\UIO\main.c
                                           #pragma config FOSC = HSPLL_HS                                                   E:\usb20\UIO\main.c
                                           #pragma config WDT = OFF                                                         E:\usb20\UIO\main.c
                                           #pragma config PLLDIV = 5                                                        E:\usb20\UIO\main.c
                                           #pragma config CPUDIV = OSC1_PLL2                                                E:\usb20\UIO\main.c
                                           #pragma config USBDIV = 2                                                        E:\usb20\UIO\main.c
                                           #pragma config PWRT = ON                                                         E:\usb20\UIO\main.c
                                           #pragma config BOR = ON                                                          E:\usb20\UIO\main.c
                                           #pragma config BORV = 43                                                         E:\usb20\UIO\main.c
                                           #pragma config LVP = OFF                                                         E:\usb20\UIO\main.c
                                           #pragma config VREGEN = ON                                                       E:\usb20\UIO\main.c
                                           #pragma config MCLRE = ON                                                        E:\usb20\UIO\main.c
                                           #pragma config PBADEN = OFF                                                      E:\usb20\UIO\main.c
                                                                                                                            E:\usb20\UIO\main.c
                                           /** V A R I A B L E S **********************************************/            E:\usb20\UIO\main.c
                                           #pragma udata                                                                    E:\usb20\UIO\main.c
                                           char input_buffer[64];						// USB入力バッファ                                   E:\usb20\UIO\main.c
                                           char output_buffer[64];						// USB出力バッファ                                  E:\usb20\UIO\main.c
                                           unsigned int  Pot0;							// 計測データ                                          E:\usb20\UIO\main.c
                                           unsigned int Counter;                                                            E:\usb20\UIO\main.c
                                           unsigned int cmnd;                                                               E:\usb20\UIO\main.c
                                           char MsgPot[] =  "Pot =         ";			// 液晶表示用バッファ                       E:\usb20\UIO\main.c
                                           char MsgStart[] = "Start!";					// 初期メッセージ                                E:\usb20\UIO\main.c
                                           char MsgHello[] = "Welcome         ";                                            E:\usb20\UIO\main.c
                                           char MsgState[] = "  ";						// LED状態                                          E:\usb20\UIO\main.c
                                           // アナログデータ送信バッファ（８チャネル分×４文字）                            E:\usb20\UIO\main.c
                                           char MsgAnalog[] = "                                    ";                       E:\usb20\UIO\main.c
                                                                                                                            E:\usb20\UIO\main.c
                                           /** P R I V A T E  P R O T O T Y P E S ******************************/           E:\usb20\UIO\main.c
                                           void ltostring(char digit, unsigned long data, byte *buffer);                    E:\usb20\UIO\main.c
                                           unsigned int AD_input(char chanl);                                               E:\usb20\UIO\main.c
                                           unsigned int toHEX(char *str);                                                   E:\usb20\UIO\main.c
                                                                                                                            E:\usb20\UIO\main.c
                                           #pragma code                                                                     E:\usb20\UIO\main.c
                                           /*********************************************************************           E:\usb20\UIO\main.c
                                            * Function:        void main(void)                                              E:\usb20\UIO\main.c
                                            ********************************************************************/           E:\usb20\UIO\main.c
000038   cfd9     MOVFF     0xfd9,0xfe6    void main(void)                                                                  E:\usb20\UIO\main.c
00003a   ffe6                                                                                                               
00003c   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
00003e   ffd9                                                                                                               
000040   0e02     MOVLW     0x2                                                                                             
000042   26e1     ADDWF     0xe1,0x1,0x0                                                                                    
                                           {                                                                                E:\usb20\UIO\main.c
                                           	int i;                                                                          E:\usb20\UIO\main.c
                                           	                                                                                E:\usb20\UIO\main.c
000044   0e07     MOVLW     0x7            	ADCON1 = 0x07;                 		// RA,RE全アナログに設定                       E:\usb20\UIO\main.c
000046   6ec1     MOVWF     0xc1,0x0                                                                                        
000048   0ebb     MOVLW     0xbb           	ADCON2 = 0xBB;					// Right,Tad＝Tcy/16                                         E:\usb20\UIO\main.c
00004a   6ec0     MOVWF     0xc0,0x0                                                                                        
00004c   0e1d     MOVLW     0x1d           	ADCON0 = 0x1D;					// AD On	                                                    E:\usb20\UIO\main.c
00004e   6ec2     MOVWF     0xc2,0x0                                                                                        
000050   0e07     MOVLW     0x7            	CMCON = 0x07;						// コンパレータオフ                                          E:\usb20\UIO\main.c
000052   6eb4     MOVWF     0xb4,0x0                                                                                        
000054   6889     SETF      0x89,0x0        	LATA = 0xFF;						// 初期出力                                                  E:\usb20\UIO\main.c
000056   6a8a     CLRF      0x8a,0x0          	LATB = 0;							// 液晶表示ポートリセット                                    E:\usb20\UIO\main.c
000058   6e8b     MOVWF     0x8b,0x0         	LATC = 0x07;						// LED Off                                                  E:\usb20\UIO\main.c
00005a   6a8c     CLRF      0x8c,0x0         	LATD = 0;                                                                     E:\usb20\UIO\main.c
00005c   6892     SETF      0x92,0x0        	TRISA = 0xFF;						// アナログ入力                                             E:\usb20\UIO\main.c
00005e   6a93     CLRF      0x93,0x0       	TRISB = 0x00;						// 液晶表示                                                  E:\usb20\UIO\main.c
000060   0eb8     MOVLW     0xb8            	TRISC = 0xB8;						// LED, USART                                               E:\usb20\UIO\main.c
000062   6e94     MOVWF     0x94,0x0                                                                                        
000064   0ef0     MOVLW     0xf0            	TRISD = 0xF0;						// Universal I/O                                            E:\usb20\UIO\main.c
000066   6e95     MOVWF     0x95,0x0                                                                                        
000068   6896     SETF      0x96,0x0        	TRISE = 0xFF;                                                                  E:\usb20\UIO\main.c
                                           	/// USB初期化                                                                   E:\usb20\UIO\main.c
00006a   0e14     MOVLW     0x14           	mInitializeUSBDriver();         	// See usbdrv.h                                E:\usb20\UIO\main.c
00006c   6e6f     MOVWF     0x6f,0x0                                                                                        
00006e   0100     MOVLB     0x0                                                                                             
000070   6bf8     CLRF      0xf8,0x1                                                                                        
000072   0100     MOVLB     0x0                                                                                             
000074   6bf9     CLRF      0xf9,0x1                                                                                        
000076   0100     MOVLB     0x0                                                                                             
000078   6bfa     CLRF      0xfa,0x1                                                                                        
                                           	/// 液晶表示器初期化                                                            E:\usb20\UIO\main.c
00007a   0100     MOVLB     0x0            	Counter = 0;                                                                    E:\usb20\UIO\main.c
00007c   6be2     CLRF      0xe2,0x1                                                                                        
00007e   6be3     CLRF      0xe3,0x1                                                                                        
000080   ec92     CALL      0x1124,0x0     	lcd_init();						// LCD初期化                                                   E:\usb20\UIO\main.c
000082   f008                                                                                                               
000084   0e0f     MOVLW     0xf            	lcd_str(MsgStart);				// 初期メッセージ表示                                     E:\usb20\UIO\main.c
000086   6ee6     MOVWF     0xe6,0x0                                                                                        
000088   0e01     MOVLW     0x1                                                                                             
00008a   6ee6     MOVWF     0xe6,0x0                                                                                        
00008c   ec72     CALL      0x10e4,0x0                                                                                      
00008e   f008                                                                                                               
000090   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000092   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                                                                                                            E:\usb20\UIO\main.c
                                               /// メインループ                                                             E:\usb20\UIO\main.c
000348   d6a5     BRA       0x94               while(1)                                                                     E:\usb20\UIO\main.c
                                               {                                                                            E:\usb20\UIO\main.c
000094   ecdc     CALL      0x11b8,0x0         		USBCheckBusStatus();        							// USB接続チェック                      E:\usb20\UIO\main.c
000096   f008                                                                                                               
000098   be6f     BTFSC     0x6f,0x7,0x0       		if(UCFGbits.UTEYE!=1)									// アイパターンモードオフか                  E:\usb20\UIO\main.c
00009a   d002     BRA       0xa0                                                                                            
00009c   ecfb     CALL      0x11f6,0x0             		USBDriverService();								// USBイベントポーリング                    E:\usb20\UIO\main.c
00009e   f008                                                                                                               
0000a0   ec92     CALL      0x924,0x0      		CDCTxService();										// クラス送受信実行                                   E:\usb20\UIO\main.c
0000a2   f004                                                                                                               
                                            		/// 送受信データの処理実行                                                    E:\usb20\UIO\main.c
0000a4   0e06     MOVLW     0x6            		if((usb_device_state >= CONFIGURED_STATE)&&(UCONbits.SUSPND==0))               E:\usb20\UIO\main.c
0000a6   0100     MOVLB     0x0                                                                                             
0000a8   5df8     SUBWF     0xf8,0x0,0x1                                                                                    
0000aa   e201     BC        0xae                                                                                            
0000ac   d14d     BRA       0x348                                                                                           
0000ae   506d     MOVF      0x6d,0x0,0x0                                                                                    
0000b0   0b02     ANDLW     0x2                                                                                             
0000b2   e001     BZ        0xb6                                                                                            
0000b4   d149     BRA       0x348                                                                                           
                                           		{                                                                              E:\usb20\UIO\main.c
0000b6   0e40     MOVLW     0x40               			if(getsUSBUSART(input_buffer,64))					// データ受信ポール                 E:\usb20\UIO\main.c
0000b8   6ee6     MOVWF     0xe6,0x0                                                                                        
0000ba   0e60     MOVLW     0x60                                                                                            
0000bc   6ee6     MOVWF     0xe6,0x0                                                                                        
0000be   0e00     MOVLW     0x0                                                                                             
0000c0   6ee6     MOVWF     0xe6,0x0                                                                                        
0000c2   ecd7     CALL      0x7ae,0x0                                                                                       
0000c4   f003                                                                                                               
0000c6   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0000c8   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0000ca   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0000cc   0900     IORLW     0x0                                                                                             
0000ce   e101     BNZ       0xd2                                                                                            
0000d0   d13b     BRA       0x348                                                                                           
                                               			{                                                                         E:\usb20\UIO\main.c
0000d2   708b     BTG       0x8b,0x0,0x0               		LATCbits.LATC0 = !LATCbits.LATC0;				// LED0反転                   E:\usb20\UIO\main.c
0000d4   0100     MOVLB     0x0            	    			switch(input_buffer[0])						// 最初の１文字チェック                     E:\usb20\UIO\main.c
0000d6   5160     MOVF      0x60,0x0,0x1                                                                                    
0000d8   0a38     XORLW     0x38                                                                                            
0000da   e101     BNZ       0xde                                                                                            
0000dc   d108     BRA       0x2ee                                                                                           
0000de   0a0f     XORLW     0xf                                                                                             
0000e0   e101     BNZ       0xe4                                                                                            
0000e2   d0af     BRA       0x242                                                                                           
0000e4   0a01     XORLW     0x1                                                                                             
0000e6   e101     BNZ       0xea                                                                                            
0000e8   d098     BRA       0x21a                                                                                           
0000ea   0a03     XORLW     0x3                                                                                             
0000ec   e064     BZ        0x1b6                                                                                           
0000ee   0a01     XORLW     0x1                                                                                             
0000f0   e05c     BZ        0x1aa                                                                                           
0000f2   0a07     XORLW     0x7                                                                                             
0000f4   e041     BZ        0x178                                                                                           
0000f6   0a01     XORLW     0x1                                                                                             
0000f8   e028     BZ        0x14a                                                                                           
0000fa   0a03     XORLW     0x3                                                                                             
0000fc   e00f     BZ        0x11c                                                                                           
0000fe   0a01     XORLW     0x1                                                                                             
000100   e001     BZ        0x104                                                                                           
                                           	    			{                                                                        E:\usb20\UIO\main.c
                                           		    			case '0':								// OKメッセージ返送                                    E:\usb20\UIO\main.c
000104   0101     MOVLB     0x1                    					if(mUSBUSARTIsTxTrfReady())                                         E:\usb20\UIO\main.c
000106   5150     MOVF      0x50,0x0,0x1                                                                                    
000108   e108     BNZ       0x11a                                                                                           
00010a   0e7e     MOVLW     0x7e                      			 		putrsUSBUSART("OK");                                            E:\usb20\UIO\main.c
00010c   6ee6     MOVWF     0xe6,0x0                                                                                        
00010e   0e15     MOVLW     0x15                                                                                            
000110   6ee6     MOVWF     0xe6,0x0                                                                                        
000112   ec54     CALL      0x8a8,0x0                                                                                       
000114   f004                                                                                                               
000116   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000118   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00011a   d116     BRA       0x348                     			 	break;		    				                                                 E:\usb20\UIO\main.c
                                           		    			case '1':								//                                                     E:\usb20\UIO\main.c
00011c   728b     BTG       0x8b,0x1,0x0               				LATCbits.LATC1 = !LATCbits.LATC1;		// LED1反転                   E:\usb20\UIO\main.c
00011e   a28b     BTFSS     0x8b,0x1,0x0               				if(LATCbits.LATC1 == 1)                                          E:\usb20\UIO\main.c
000120   d004     BRA       0x12a                                                                                           
000122   0101     MOVLB     0x1                        					MsgState[0] = '1';				// 現在状態返送                           E:\usb20\UIO\main.c
000124   0e31     MOVLW     0x31                                                                                            
000126   6f27     MOVWF     0x27,0x1                                                                                        
000128   d003     BRA       0x130                      				else                                                             E:\usb20\UIO\main.c
00012a   0101     MOVLB     0x1                        					MsgState[0] = '0';                                              E:\usb20\UIO\main.c
00012c   0e30     MOVLW     0x30                                                                                            
00012e   6f27     MOVWF     0x27,0x1                                                                                        
000130   0101     MOVLB     0x1                        				mUSBUSARTTxRam((byte*)MsgState, 1);                              E:\usb20\UIO\main.c
000132   0e27     MOVLW     0x27                                                                                            
000134   6f51     MOVWF     0x51,0x1                                                                                        
000136   0e01     MOVLW     0x1                                                                                             
000138   6f52     MOVWF     0x52,0x1                                                                                        
00013a   0101     MOVLB     0x1                                                                                             
00013c   0e01     MOVLW     0x1                                                                                             
00013e   6f55     MOVWF     0x55,0x1                                                                                        
000140   0101     MOVLB     0x1                                                                                             
000142   6b56     CLRF      0x56,0x1                                                                                        
000144   0101     MOVLB     0x1                                                                                             
000146   6f50     MOVWF     0x50,0x1                                                                                        
000148   d0ff     BRA       0x348          		    				break;                                                                 E:\usb20\UIO\main.c
                                           		    			case '2':                                                               E:\usb20\UIO\main.c
00014a   748b     BTG       0x8b,0x2,0x0               				LATCbits.LATC2 = !LATCbits.LATC2;		// LED2反転                   E:\usb20\UIO\main.c
00014c   a48b     BTFSS     0x8b,0x2,0x0                				if(LATCbits.LATC2 == 1)                                         E:\usb20\UIO\main.c
00014e   d004     BRA       0x158                                                                                           
000150   0101     MOVLB     0x1                        					MsgState[0] = '1';				// 現在状態返送                           E:\usb20\UIO\main.c
000152   0e31     MOVLW     0x31                                                                                            
000154   6f27     MOVWF     0x27,0x1                                                                                        
000156   d003     BRA       0x15e                      				else                                                             E:\usb20\UIO\main.c
000158   0101     MOVLB     0x1                        					MsgState[0] = '0';                                              E:\usb20\UIO\main.c
00015a   0e30     MOVLW     0x30                                                                                            
00015c   6f27     MOVWF     0x27,0x1                                                                                        
00015e   0101     MOVLB     0x1                        				mUSBUSARTTxRam((byte*)MsgState, 1);                              E:\usb20\UIO\main.c
000160   0e27     MOVLW     0x27                                                                                            
000162   6f51     MOVWF     0x51,0x1                                                                                        
000164   0e01     MOVLW     0x1                                                                                             
000166   6f52     MOVWF     0x52,0x1                                                                                        
000168   0101     MOVLB     0x1                                                                                             
00016a   0e01     MOVLW     0x1                                                                                             
00016c   6f55     MOVWF     0x55,0x1                                                                                        
00016e   0101     MOVLB     0x1                                                                                             
000170   6b56     CLRF      0x56,0x1                                                                                        
000172   0101     MOVLB     0x1                                                                                             
000174   6f50     MOVWF     0x50,0x1                                                                                        
000176   d0e8     BRA       0x348          		    				break;                                                                 E:\usb20\UIO\main.c
                                           		    			case '3':                                                               E:\usb20\UIO\main.c
000178   0e61     MOVLW     0x61           		    				cmnd = toHEX(&input_buffer[1]);                                        E:\usb20\UIO\main.c
00017a   6ee6     MOVWF     0xe6,0x0                                                                                        
00017c   0e00     MOVLW     0x0                                                                                             
00017e   6ee6     MOVWF     0xe6,0x0                                                                                        
000180   d8f0     RCALL     0x362                                                                                           
000182   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000184   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000186   cff3     MOVFF     0xff3,0xe4                                                                                      
000188   f0e4                                                                                                               
00018a   cff4     MOVFF     0xff4,0xe5                                                                                      
00018c   f0e5                                                                                                               
00018e   c0e4     MOVFF     0xe4,0xfe6     		    				lcd_cmd(cmnd);						// 液晶メッセージ表示                              E:\usb20\UIO\main.c
000190   ffe6                                                                                                               
000192   ec45     CALL      0x108a,0x0                                                                                      
000194   f008                                                                                                               
000196   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000198   0e63     MOVLW     0x63           		    				lcd_str((char *)(&input_buffer[3]));                                   E:\usb20\UIO\main.c
00019a   6ee6     MOVWF     0xe6,0x0                                                                                        
00019c   0e00     MOVLW     0x0                                                                                             
00019e   6ee6     MOVWF     0xe6,0x0                                                                                        
0001a0   ec72     CALL      0x10e4,0x0                                                                                      
0001a2   f008                                                                                                               
0001a4   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0001a6   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0001a8   d0cf     BRA       0x348          		    				break;		    			                                                        E:\usb20\UIO\main.c
                                           		    			case '4':                                                               E:\usb20\UIO\main.c
0001aa   ec6d     CALL      0x10da,0x0     		    				lcd_clear();							// 液晶消去                                         E:\usb20\UIO\main.c
0001ac   f008                                                                                                               
0001ae   0100     MOVLB     0x0            		    				Counter = 0;                                                           E:\usb20\UIO\main.c
0001b0   6be2     CLRF      0xe2,0x1                                                                                        
0001b2   6be3     CLRF      0xe3,0x1                                                                                        
0001b4   d0c9     BRA       0x348          		    				break;                                                                 E:\usb20\UIO\main.c
                                           		    			case '5':                                                               E:\usb20\UIO\main.c
0001b6   0e07     MOVLW     0x7            	    					Pot0 = AD_input(7);                                                    E:\usb20\UIO\main.c
0001b8   6ee6     MOVWF     0xe6,0x0                                                                                        
0001ba   d9ba     RCALL     0x530                                                                                           
0001bc   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0001be   cff3     MOVFF     0xff3,0xe0                                                                                      
0001c0   f0e0                                                                                                               
0001c2   cff4     MOVFF     0xff4,0xe1                                                                                      
0001c4   f0e1                                                                                                               
0001c6   0e06     MOVLW     0x6            	    					ltostring(4, Pot0, MsgPot+6);			// 可変抵抗の値送信                    E:\usb20\UIO\main.c
0001c8   6ee6     MOVWF     0xe6,0x0                                                                                        
0001ca   0e01     MOVLW     0x1                                                                                             
0001cc   6ee6     MOVWF     0xe6,0x0                                                                                        
0001ce   c0e0     MOVFF     0xe0,0x14                                                                                       
0001d0   f014                                                                                                               
0001d2   c0e1     MOVFF     0xe1,0x15                                                                                       
0001d4   f015                                                                                                               
0001d6   6a16     CLRF      0x16,0x0                                                                                        
0001d8   6a17     CLRF      0x17,0x0                                                                                        
0001da   c014     MOVFF     0x14,0xfe6                                                                                      
0001dc   ffe6                                                                                                               
0001de   c015     MOVFF     0x15,0xfe6                                                                                      
0001e0   ffe6                                                                                                               
0001e2   c016     MOVFF     0x16,0xfe6                                                                                      
0001e4   ffe6                                                                                                               
0001e6   c017     MOVFF     0x17,0xfe6                                                                                      
0001e8   ffe6                                                                                                               
0001ea   0e04     MOVLW     0x4                                                                                             
0001ec   6ee6     MOVWF     0xe6,0x0                                                                                        
0001ee   d9d4     RCALL     0x598                                                                                           
0001f0   6ef5     MOVWF     0xf5,0x0                                                                                        
0001f2   0e07     MOVLW     0x7                                                                                             
0001f4   5ee1     SUBWF     0xe1,0x1,0x0                                                                                    
0001f6   50f5     MOVF      0xf5,0x0,0x0                                                                                    
0001f8   0101     MOVLB     0x1                    					if(mUSBUSARTIsTxTrfReady())                                         E:\usb20\UIO\main.c
0001fa   5150     MOVF      0x50,0x0,0x1                                                                                    
0001fc   e10d     BNZ       0x218                                                                                           
0001fe   0101     MOVLB     0x1                       			 		mUSBUSARTTxRam((byte*)MsgPot, 10);                              E:\usb20\UIO\main.c
000200   0e00     MOVLW     0x0                                                                                             
000202   6f51     MOVWF     0x51,0x1                                                                                        
000204   0e01     MOVLW     0x1                                                                                             
000206   6f52     MOVWF     0x52,0x1                                                                                        
000208   0101     MOVLB     0x1                                                                                             
00020a   0e0a     MOVLW     0xa                                                                                             
00020c   6f55     MOVWF     0x55,0x1                                                                                        
00020e   0101     MOVLB     0x1                                                                                             
000210   6b56     CLRF      0x56,0x1                                                                                        
000212   0101     MOVLB     0x1                                                                                             
000214   0e01     MOVLW     0x1                                                                                             
000216   6f50     MOVWF     0x50,0x1                                                                                        
000218   d097     BRA       0x348          		    				break;                                                                 E:\usb20\UIO\main.c
                                           		    			case '6':                                                               E:\usb20\UIO\main.c
00021a   c061     MOVFF     0x61,0xf8c     		    				LATD = input_buffer[1];				// PORTDの制御                              E:\usb20\UIO\main.c
00021c   ff8c                                                                                                               
00021e   cf83     MOVFF     0xf83,0x127    		    				MsgState[0] = PORTD;                                                   E:\usb20\UIO\main.c
000220   f127                                                                                                               
000222   0101     MOVLB     0x1                    					if(mUSBUSARTIsTxTrfReady())	                                        E:\usb20\UIO\main.c
000224   5150     MOVF      0x50,0x0,0x1                                                                                    
000226   e10c     BNZ       0x240                                                                                           
000228   0101     MOVLB     0x1                       			 		mUSBUSARTTxRam((byte*)MsgState, 1);                             E:\usb20\UIO\main.c
00022a   0e27     MOVLW     0x27                                                                                            
00022c   6f51     MOVWF     0x51,0x1                                                                                        
00022e   0e01     MOVLW     0x1                                                                                             
000230   6f52     MOVWF     0x52,0x1                                                                                        
000232   0101     MOVLB     0x1                                                                                             
000234   0e01     MOVLW     0x1                                                                                             
000236   6f55     MOVWF     0x55,0x1                                                                                        
000238   0101     MOVLB     0x1                                                                                             
00023a   6b56     CLRF      0x56,0x1                                                                                        
00023c   0101     MOVLB     0x1                                                                                             
00023e   6f50     MOVWF     0x50,0x1                                                                                        
000240   d083     BRA       0x348          		    				break;                                                                 E:\usb20\UIO\main.c
                                           		    			case '7':                                                               E:\usb20\UIO\main.c
000242   6ade     CLRF      0xde,0x0                				for(i=0; i<8; i++)					// 8チャネル分計測                           E:\usb20\UIO\main.c
000244   6add     CLRF      0xdd,0x0                                                                                        
000246   cfde     MOVFF     0xfde,0x14                                                                                      
000248   f014                                                                                                               
00024a   cfdd     MOVFF     0xfdd,0x15                                                                                      
00024c   f015                                                                                                               
00024e   90d8     BCF       0xd8,0x0,0x0                                                                                    
000250   5015     MOVF      0x15,0x0,0x0                                                                                    
000252   e604     BN        0x25c                                                                                           
000254   0e08     MOVLW     0x8                                                                                             
000256   5c14     SUBWF     0x14,0x0,0x0                                                                                    
000258   0e00     MOVLW     0x0                                                                                             
00025a   5815     SUBWFB    0x15,0x0,0x0                                                                                    
00025c   e237     BC        0x2cc                                                                                           
0002c2   2adf     INCF      0xdf,0x1,0x0                                                                                    
0002c4   0e01     MOVLW     0x1                                                                                             
0002c6   e301     BNC       0x2ca                                                                                           
0002c8   2adb     INCF      0xdb,0x1,0x0                                                                                    
0002ca   d7bd     BRA       0x246                                                                                           
                                           	         			{                                                                   E:\usb20\UIO\main.c
00025e   cfdf     MOVFF     0xfdf,0xfe6    			    				Pot0 = AD_input(i);                                                   E:\usb20\UIO\main.c
000260   ffe6                                                                                                               
000262   d966     RCALL     0x530                                                                                           
000264   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000266   cff3     MOVFF     0xff3,0xe0                                                                                      
000268   f0e0                                                                                                               
00026a   cff4     MOVFF     0xff4,0xe1                                                                                      
00026c   f0e1                                                                                                               
00026e   0e04     MOVLW     0x4            		    					ltostring(4, Pot0, MsgAnalog+4*i);	// 可変抵抗の値編集                E:\usb20\UIO\main.c
000270   6e06     MOVWF     0x6,0x0                                                                                         
000272   6a07     CLRF      0x7,0x0                                                                                         
000274   cfde     MOVFF     0xfde,0xb                                                                                       
000276   f00b                                                                                                               
000278   cfdd     MOVFF     0xfdd,0xc                                                                                       
00027a   f00c                                                                                                               
00027c   ec40     CALL      0x1480,0x0                                                                                      
00027e   f00a                                                                                                               
000280   c004     MOVFF     0x4,0x14                                                                                        
000282   f014                                                                                                               
000284   c005     MOVFF     0x5,0x15                                                                                        
000286   f015                                                                                                               
000288   0e2a     MOVLW     0x2a                                                                                            
00028a   2614     ADDWF     0x14,0x1,0x0                                                                                    
00028c   0e01     MOVLW     0x1                                                                                             
00028e   2215     ADDWFC    0x15,0x1,0x0                                                                                    
000290   c014     MOVFF     0x14,0xfe6                                                                                      
000292   ffe6                                                                                                               
000294   c015     MOVFF     0x15,0xfe6                                                                                      
000296   ffe6                                                                                                               
000298   c0e0     MOVFF     0xe0,0x16                                                                                       
00029a   f016                                                                                                               
00029c   c0e1     MOVFF     0xe1,0x17                                                                                       
00029e   f017                                                                                                               
0002a0   6a18     CLRF      0x18,0x0                                                                                        
0002a2   6a19     CLRF      0x19,0x0                                                                                        
0002a4   c016     MOVFF     0x16,0xfe6                                                                                      
0002a6   ffe6                                                                                                               
0002a8   c017     MOVFF     0x17,0xfe6                                                                                      
0002aa   ffe6                                                                                                               
0002ac   c018     MOVFF     0x18,0xfe6                                                                                      
0002ae   ffe6                                                                                                               
0002b0   c019     MOVFF     0x19,0xfe6                                                                                      
0002b2   ffe6                                                                                                               
0002b4   0e04     MOVLW     0x4                                                                                             
0002b6   6ee6     MOVWF     0xe6,0x0                                                                                        
0002b8   d96f     RCALL     0x598                                                                                           
0002ba   6ef5     MOVWF     0xf5,0x0                                                                                        
0002bc   0e07     MOVLW     0x7                                                                                             
0002be   5ee1     SUBWF     0xe1,0x1,0x0                                                                                    
0002c0   50f5     MOVF      0xf5,0x0,0x0                                                                                    
                                                      			 	}                                                                E:\usb20\UIO\main.c
0002cc   0101     MOVLB     0x1                    					if(mUSBUSARTIsTxTrfReady())                                         E:\usb20\UIO\main.c
0002ce   5150     MOVF      0x50,0x0,0x1                                                                                    
0002d0   e10d     BNZ       0x2ec                                                                                           
0002d2   0101     MOVLB     0x1                       			 		mUSBUSARTTxRam((byte*)MsgAnalog, 32);                           E:\usb20\UIO\main.c
0002d4   0e2a     MOVLW     0x2a                                                                                            
0002d6   6f51     MOVWF     0x51,0x1                                                                                        
0002d8   0e01     MOVLW     0x1                                                                                             
0002da   6f52     MOVWF     0x52,0x1                                                                                        
0002dc   0101     MOVLB     0x1                                                                                             
0002de   0e20     MOVLW     0x20                                                                                            
0002e0   6f55     MOVWF     0x55,0x1                                                                                        
0002e2   0101     MOVLB     0x1                                                                                             
0002e4   6b56     CLRF      0x56,0x1                                                                                        
0002e6   0101     MOVLB     0x1                                                                                             
0002e8   0e01     MOVLW     0x1                                                                                             
0002ea   6f50     MOVWF     0x50,0x1                                                                                        
0002ec   d02d     BRA       0x348          		    				break;                                                                 E:\usb20\UIO\main.c
                                           		    			case '8':								// メッセージ返送                                      E:\usb20\UIO\main.c
0002ee   2be2     INCF      0xe2,0x1,0x1           					Counter++;                                                          E:\usb20\UIO\main.c
0002f0   0e00     MOVLW     0x0                                                                                             
0002f2   23e3     ADDWFC    0xe3,0x1,0x1                                                                                    
0002f4   0e1e     MOVLW     0x1e                   					ltostring(6, Counter, MsgHello+8);                                  E:\usb20\UIO\main.c
0002f6   6ee6     MOVWF     0xe6,0x0                                                                                        
0002f8   0e01     MOVLW     0x1                                                                                             
0002fa   6ee6     MOVWF     0xe6,0x0                                                                                        
0002fc   c0e2     MOVFF     0xe2,0x14                                                                                       
0002fe   f014                                                                                                               
000300   c0e3     MOVFF     0xe3,0x15                                                                                       
000302   f015                                                                                                               
000304   6a16     CLRF      0x16,0x0                                                                                        
000306   6a17     CLRF      0x17,0x0                                                                                        
000308   c014     MOVFF     0x14,0xfe6                                                                                      
00030a   ffe6                                                                                                               
00030c   c015     MOVFF     0x15,0xfe6                                                                                      
00030e   ffe6                                                                                                               
000310   c016     MOVFF     0x16,0xfe6                                                                                      
000312   ffe6                                                                                                               
000314   c017     MOVFF     0x17,0xfe6                                                                                      
000316   ffe6                                                                                                               
000318   0e06     MOVLW     0x6                                                                                             
00031a   6ee6     MOVWF     0xe6,0x0                                                                                        
00031c   d93d     RCALL     0x598                                                                                           
00031e   6ef5     MOVWF     0xf5,0x0                                                                                        
000320   0e07     MOVLW     0x7                                                                                             
000322   5ee1     SUBWF     0xe1,0x1,0x0                                                                                    
000324   50f5     MOVF      0xf5,0x0,0x0                                                                                    
000326   0101     MOVLB     0x1                    					if(mUSBUSARTIsTxTrfReady())	                                        E:\usb20\UIO\main.c
000328   5150     MOVF      0x50,0x0,0x1                                                                                    
00032a   e10d     BNZ       0x346                                                                                           
00032c   0101     MOVLB     0x1                       			 		mUSBUSARTTxRam((byte*)MsgHello, 14);                            E:\usb20\UIO\main.c
00032e   0e16     MOVLW     0x16                                                                                            
000330   6f51     MOVWF     0x51,0x1                                                                                        
000332   0e01     MOVLW     0x1                                                                                             
000334   6f52     MOVWF     0x52,0x1                                                                                        
000336   0101     MOVLB     0x1                                                                                             
000338   0e0e     MOVLW     0xe                                                                                             
00033a   6f55     MOVWF     0x55,0x1                                                                                        
00033c   0101     MOVLB     0x1                                                                                             
00033e   6b56     CLRF      0x56,0x1                                                                                        
000340   0101     MOVLB     0x1                                                                                             
000342   0e01     MOVLW     0x1                                                                                             
000344   6f50     MOVWF     0x50,0x1                                                                                        
000346   d000     BRA       0x348          		    				break;                                                                 E:\usb20\UIO\main.c
000102   d122     BRA       0x348          		    			default: break;                                                         E:\usb20\UIO\main.c
                                           		    		}                                                                        E:\usb20\UIO\main.c
                                               			}                                                                         E:\usb20\UIO\main.c
                                               		}                                                                          E:\usb20\UIO\main.c
                                                }                                                                           E:\usb20\UIO\main.c
00034a   6ef5     MOVWF     0xf5,0x0       }                                                                                E:\usb20\UIO\main.c
00034c   0e02     MOVLW     0x2                                                                                             
00034e   5ce1     SUBWF     0xe1,0x0,0x0                                                                                    
000350   e202     BC        0x356                                                                                           
000352   6ae1     CLRF      0xe1,0x0                                                                                        
000354   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000356   6ee1     MOVWF     0xe1,0x0                                                                                        
000358   50f5     MOVF      0xf5,0x0,0x0                                                                                    
00035a   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00035c   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
00035e   ffd9                                                                                                               
000360   0012     RETURN    0x0                                                                                             
                                                                                                                            E:\usb20\UIO\main.c
                                           /////// ２文字を16進数１桁に変換                                                 E:\usb20\UIO\main.c
000362   cfd9     MOVFF     0xfd9,0xfe6    unsigned int toHEX(char* str)                                                    E:\usb20\UIO\main.c
000364   ffe6                                                                                                               
000366   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
000368   ffd9                                                                                                               
00036a   0e02     MOVLW     0x2                                                                                             
00036c   26e1     ADDWF     0xe1,0x1,0x0                                                                                    
                                           {                                                                                E:\usb20\UIO\main.c
                                           	int data;                                                                       E:\usb20\UIO\main.c
                                                                                                                            E:\usb20\UIO\main.c
00036e   6ade     CLRF      0xde,0x0       	data = 0;                                                                       E:\usb20\UIO\main.c
000370   6add     CLRF      0xdd,0x0                                                                                        
000372   0efd     MOVLW     0xfd           	if((*str >= '0') && (*str <= '9'))                                              E:\usb20\UIO\main.c
000374   cfdb     MOVFF     0xfdb,0xfe9                                                                                     
000376   ffe9                                                                                                               
000378   0efe     MOVLW     0xfe                                                                                            
00037a   cfdb     MOVFF     0xfdb,0xfea                                                                                     
00037c   ffea                                                                                                               
00037e   cfef     MOVFF     0xfef,0x14                                                                                      
000380   f014                                                                                                               
000382   0e30     MOVLW     0x30                                                                                            
000384   5c14     SUBWF     0x14,0x0,0x0                                                                                    
000386   e316     BNC       0x3b4                                                                                           
000388   0efd     MOVLW     0xfd                                                                                            
00038a   cfdb     MOVFF     0xfdb,0xfe9                                                                                     
00038c   ffe9                                                                                                               
00038e   0efe     MOVLW     0xfe                                                                                            
000390   cfdb     MOVFF     0xfdb,0xfea                                                                                     
000392   ffea                                                                                                               
000394   50ef     MOVF      0xef,0x0,0x0                                                                                    
000396   0839     SUBLW     0x39                                                                                            
000398   e30d     BNC       0x3b4                                                                                           
00039a   0efd     MOVLW     0xfd           		data = (int)(16 * (*str - '0'));                                               E:\usb20\UIO\main.c
00039c   cfdb     MOVFF     0xfdb,0xfe9                                                                                     
00039e   ffe9                                                                                                               
0003a0   0efe     MOVLW     0xfe                                                                                            
0003a2   cfdb     MOVFF     0xfdb,0xfea                                                                                     
0003a4   ffea                                                                                                               
0003a6   50ef     MOVF      0xef,0x0,0x0                                                                                    
0003a8   0fd0     ADDLW     0xd0                                                                                            
0003aa   0d10     MULLW     0x10                                                                                            
0003ac   50f3     MOVF      0xf3,0x0,0x0                                                                                    
0003ae   6ede     MOVWF     0xde,0x0                                                                                        
0003b0   6add     CLRF      0xdd,0x0                                                                                        
0003b2   d043     BRA       0x43a          	else                                                                            E:\usb20\UIO\main.c
                                           	{                                                                               E:\usb20\UIO\main.c
0003b4   0efd     MOVLW     0xfd           		if((*str >= 'A') && (*str <= 'F'))                                             E:\usb20\UIO\main.c
0003b6   cfdb     MOVFF     0xfdb,0xfe9                                                                                     
0003b8   ffe9                                                                                                               
0003ba   0efe     MOVLW     0xfe                                                                                            
0003bc   cfdb     MOVFF     0xfdb,0xfea                                                                                     
0003be   ffea                                                                                                               
0003c0   cfef     MOVFF     0xfef,0x14                                                                                      
0003c2   f014                                                                                                               
0003c4   0e41     MOVLW     0x41                                                                                            
0003c6   5c14     SUBWF     0x14,0x0,0x0                                                                                    
0003c8   e317     BNC       0x3f8                                                                                           
0003ca   0efd     MOVLW     0xfd                                                                                            
0003cc   cfdb     MOVFF     0xfdb,0xfe9                                                                                     
0003ce   ffe9                                                                                                               
0003d0   0efe     MOVLW     0xfe                                                                                            
0003d2   cfdb     MOVFF     0xfdb,0xfea                                                                                     
0003d4   ffea                                                                                                               
0003d6   50ef     MOVF      0xef,0x0,0x0                                                                                    
0003d8   0846     SUBLW     0x46                                                                                            
0003da   e30e     BNC       0x3f8                                                                                           
0003dc   0efd     MOVLW     0xfd           			data = (int)(16 * (*str - 'A' + 10));                                         E:\usb20\UIO\main.c
0003de   cfdb     MOVFF     0xfdb,0xfe9                                                                                     
0003e0   ffe9                                                                                                               
0003e2   0efe     MOVLW     0xfe                                                                                            
0003e4   cfdb     MOVFF     0xfdb,0xfea                                                                                     
0003e6   ffea                                                                                                               
0003e8   50ef     MOVF      0xef,0x0,0x0                                                                                    
0003ea   0fbf     ADDLW     0xbf                                                                                            
0003ec   0f0a     ADDLW     0xa                                                                                             
0003ee   0d10     MULLW     0x10                                                                                            
0003f0   50f3     MOVF      0xf3,0x0,0x0                                                                                    
0003f2   6ede     MOVWF     0xde,0x0                                                                                        
0003f4   6add     CLRF      0xdd,0x0                                                                                        
0003f6   d021     BRA       0x43a          		else                                                                           E:\usb20\UIO\main.c
                                           		{                                                                              E:\usb20\UIO\main.c
0003f8   0efd     MOVLW     0xfd           			if((*str >= 'a') && (*str <= 'f'))                                            E:\usb20\UIO\main.c
0003fa   cfdb     MOVFF     0xfdb,0xfe9                                                                                     
0003fc   ffe9                                                                                                               
0003fe   0efe     MOVLW     0xfe                                                                                            
000400   cfdb     MOVFF     0xfdb,0xfea                                                                                     
000402   ffea                                                                                                               
000404   cfef     MOVFF     0xfef,0x14                                                                                      
000406   f014                                                                                                               
000408   0e61     MOVLW     0x61                                                                                            
00040a   5c14     SUBWF     0x14,0x0,0x0                                                                                    
00040c   e316     BNC       0x43a                                                                                           
00040e   0efd     MOVLW     0xfd                                                                                            
000410   cfdb     MOVFF     0xfdb,0xfe9                                                                                     
000412   ffe9                                                                                                               
000414   0efe     MOVLW     0xfe                                                                                            
000416   cfdb     MOVFF     0xfdb,0xfea                                                                                     
000418   ffea                                                                                                               
00041a   50ef     MOVF      0xef,0x0,0x0                                                                                    
00041c   0866     SUBLW     0x66                                                                                            
00041e   e30d     BNC       0x43a                                                                                           
000420   0efd     MOVLW     0xfd           				data = (int)(16 * (*str - 'a' + 10));                                        E:\usb20\UIO\main.c
000422   cfdb     MOVFF     0xfdb,0xfe9                                                                                     
000424   ffe9                                                                                                               
000426   0efe     MOVLW     0xfe                                                                                            
000428   cfdb     MOVFF     0xfdb,0xfea                                                                                     
00042a   ffea                                                                                                               
00042c   50ef     MOVF      0xef,0x0,0x0                                                                                    
00042e   0f9f     ADDLW     0x9f                                                                                            
000430   0f0a     ADDLW     0xa                                                                                             
000432   0d10     MULLW     0x10                                                                                            
000434   50f3     MOVF      0xf3,0x0,0x0                                                                                    
000436   6ede     MOVWF     0xde,0x0                                                                                        
000438   6add     CLRF      0xdd,0x0                                                                                        
                                           		}                                                                              E:\usb20\UIO\main.c
                                           	}                                                                               E:\usb20\UIO\main.c
00043a   0efd     MOVLW     0xfd           	str++;                                                                          E:\usb20\UIO\main.c
00043c   2adb     INCF      0xdb,0x1,0x0                                                                                    
00043e   0efe     MOVLW     0xfe                                                                                            
000440   e301     BNC       0x444                                                                                           
000442   2adb     INCF      0xdb,0x1,0x0                                                                                    
000444   0efd     MOVLW     0xfd           	if((*str >= '0') && (*str <= '9'))                                              E:\usb20\UIO\main.c
000446   cfdb     MOVFF     0xfdb,0xfe9                                                                                     
000448   ffe9                                                                                                               
00044a   0efe     MOVLW     0xfe                                                                                            
00044c   cfdb     MOVFF     0xfdb,0xfea                                                                                     
00044e   ffea                                                                                                               
000450   cfef     MOVFF     0xfef,0x14                                                                                      
000452   f014                                                                                                               
000454   0e30     MOVLW     0x30                                                                                            
000456   5c14     SUBWF     0x14,0x0,0x0                                                                                    
000458   e315     BNC       0x484                                                                                           
00045a   0efd     MOVLW     0xfd                                                                                            
00045c   cfdb     MOVFF     0xfdb,0xfe9                                                                                     
00045e   ffe9                                                                                                               
000460   0efe     MOVLW     0xfe                                                                                            
000462   cfdb     MOVFF     0xfdb,0xfea                                                                                     
000464   ffea                                                                                                               
000466   50ef     MOVF      0xef,0x0,0x0                                                                                    
000468   0839     SUBLW     0x39                                                                                            
00046a   e30c     BNC       0x484                                                                                           
00046c   0efd     MOVLW     0xfd           		data += (int) (*str - '0');                                                    E:\usb20\UIO\main.c
00046e   cfdb     MOVFF     0xfdb,0xfe9                                                                                     
000470   ffe9                                                                                                               
000472   0efe     MOVLW     0xfe                                                                                            
000474   cfdb     MOVFF     0xfdb,0xfea                                                                                     
000476   ffea                                                                                                               
000478   50ef     MOVF      0xef,0x0,0x0                                                                                    
00047a   0fd0     ADDLW     0xd0                                                                                            
00047c   26de     ADDWF     0xde,0x1,0x0                                                                                    
00047e   0e00     MOVLW     0x0                                                                                             
000480   22dd     ADDWFC    0xdd,0x1,0x0                                                                                    
000482   d041     BRA       0x506          	else                                                                            E:\usb20\UIO\main.c
                                           	{                                                                               E:\usb20\UIO\main.c
000484   0efd     MOVLW     0xfd           		if((*str >= 'A') && (*str <= 'F'))                                             E:\usb20\UIO\main.c
000486   cfdb     MOVFF     0xfdb,0xfe9                                                                                     
000488   ffe9                                                                                                               
00048a   0efe     MOVLW     0xfe                                                                                            
00048c   cfdb     MOVFF     0xfdb,0xfea                                                                                     
00048e   ffea                                                                                                               
000490   cfef     MOVFF     0xfef,0x14                                                                                      
000492   f014                                                                                                               
000494   0e41     MOVLW     0x41                                                                                            
000496   5c14     SUBWF     0x14,0x0,0x0                                                                                    
000498   e316     BNC       0x4c6                                                                                           
00049a   0efd     MOVLW     0xfd                                                                                            
00049c   cfdb     MOVFF     0xfdb,0xfe9                                                                                     
00049e   ffe9                                                                                                               
0004a0   0efe     MOVLW     0xfe                                                                                            
0004a2   cfdb     MOVFF     0xfdb,0xfea                                                                                     
0004a4   ffea                                                                                                               
0004a6   50ef     MOVF      0xef,0x0,0x0                                                                                    
0004a8   0846     SUBLW     0x46                                                                                            
0004aa   e30d     BNC       0x4c6                                                                                           
0004ac   0efd     MOVLW     0xfd           			data += (int)(*str - 'A' + 10);                                               E:\usb20\UIO\main.c
0004ae   cfdb     MOVFF     0xfdb,0xfe9                                                                                     
0004b0   ffe9                                                                                                               
0004b2   0efe     MOVLW     0xfe                                                                                            
0004b4   cfdb     MOVFF     0xfdb,0xfea                                                                                     
0004b6   ffea                                                                                                               
0004b8   50ef     MOVF      0xef,0x0,0x0                                                                                    
0004ba   0fbf     ADDLW     0xbf                                                                                            
0004bc   0f0a     ADDLW     0xa                                                                                             
0004be   26de     ADDWF     0xde,0x1,0x0                                                                                    
0004c0   0e00     MOVLW     0x0                                                                                             
0004c2   22dd     ADDWFC    0xdd,0x1,0x0                                                                                    
0004c4   d020     BRA       0x506          		else                                                                           E:\usb20\UIO\main.c
                                           		{                                                                              E:\usb20\UIO\main.c
0004c6   0efd     MOVLW     0xfd           			if((*str >= 'a') && (*str <= 'f'))                                            E:\usb20\UIO\main.c
0004c8   cfdb     MOVFF     0xfdb,0xfe9                                                                                     
0004ca   ffe9                                                                                                               
0004cc   0efe     MOVLW     0xfe                                                                                            
0004ce   cfdb     MOVFF     0xfdb,0xfea                                                                                     
0004d0   ffea                                                                                                               
0004d2   cfef     MOVFF     0xfef,0x14                                                                                      
0004d4   f014                                                                                                               
0004d6   0e61     MOVLW     0x61                                                                                            
0004d8   5c14     SUBWF     0x14,0x0,0x0                                                                                    
0004da   e315     BNC       0x506                                                                                           
0004dc   0efd     MOVLW     0xfd                                                                                            
0004de   cfdb     MOVFF     0xfdb,0xfe9                                                                                     
0004e0   ffe9                                                                                                               
0004e2   0efe     MOVLW     0xfe                                                                                            
0004e4   cfdb     MOVFF     0xfdb,0xfea                                                                                     
0004e6   ffea                                                                                                               
0004e8   50ef     MOVF      0xef,0x0,0x0                                                                                    
0004ea   0866     SUBLW     0x66                                                                                            
0004ec   e30c     BNC       0x506                                                                                           
0004ee   0efd     MOVLW     0xfd           				data += (int)(*str - 'a' + 10);                                              E:\usb20\UIO\main.c
0004f0   cfdb     MOVFF     0xfdb,0xfe9                                                                                     
0004f2   ffe9                                                                                                               
0004f4   0efe     MOVLW     0xfe                                                                                            
0004f6   cfdb     MOVFF     0xfdb,0xfea                                                                                     
0004f8   ffea                                                                                                               
0004fa   50ef     MOVF      0xef,0x0,0x0                                                                                    
0004fc   0f9f     ADDLW     0x9f                                                                                            
0004fe   0f0a     ADDLW     0xa                                                                                             
000500   26de     ADDWF     0xde,0x1,0x0                                                                                    
000502   0e00     MOVLW     0x0                                                                                             
000504   22dd     ADDWFC    0xdd,0x1,0x0                                                                                    
                                           		}                                                                              E:\usb20\UIO\main.c
                                           	}	                                                                              E:\usb20\UIO\main.c
000506   cfde     MOVFF     0xfde,0x14     	return(data);                                                                   E:\usb20\UIO\main.c
000508   f014                                                                                                               
00050a   cfdd     MOVFF     0xfdd,0x15                                                                                      
00050c   f015                                                                                                               
00050e   c014     MOVFF     0x14,0xff3                                                                                      
000510   fff3                                                                                                               
000512   c015     MOVFF     0x15,0xff4                                                                                      
000514   fff4                                                                                                               
000516   6ef5     MOVWF     0xf5,0x0       }                                                                                E:\usb20\UIO\main.c
000518   0e02     MOVLW     0x2                                                                                             
00051a   5ce1     SUBWF     0xe1,0x0,0x0                                                                                    
00051c   e203     BC        0x524                                                                                           
00051e   d000     BRA       0x520                                                                                           
000520   6ae1     CLRF      0xe1,0x0                                                                                        
000522   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000524   6ee1     MOVWF     0xe1,0x0                                                                                        
000526   50f5     MOVF      0xf5,0x0,0x0                                                                                    
000528   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00052a   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
00052c   ffd9                                                                                                               
00052e   0012     RETURN    0x0                                                                                             
                                                                                                                            E:\usb20\UIO\main.c
                                           //////// A/D変換読み込み関数                                                     E:\usb20\UIO\main.c
000530   cfd9     MOVFF     0xfd9,0xfe6    unsigned int AD_input(char chanl)                                                E:\usb20\UIO\main.c
000532   ffe6                                                                                                               
000534   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
000536   ffd9                                                                                                               
000538   0e02     MOVLW     0x2                                                                                             
00053a   26e1     ADDWF     0xe1,0x1,0x0                                                                                    
                                           {                                                                                E:\usb20\UIO\main.c
                                               	unsigned int adData;        		// 10ビットモード                             E:\usb20\UIO\main.c
                                               	                                                                            E:\usb20\UIO\main.c
00053c   0efe     MOVLW     0xfe           	ADCON0 = 0x01 + (chanl * 4);                                                    E:\usb20\UIO\main.c
00053e   50db     MOVF      0xdb,0x0,0x0                                                                                    
000540   0d04     MULLW     0x4                                                                                             
000542   28f3     INCF      0xf3,0x0,0x0                                                                                    
000544   6ec2     MOVWF     0xc2,0x0                                                                                        
000546   82c2     BSF       0xc2,0x1,0x0       	ADCON0bits.GO = 1;              	// Start AD conversion                     E:\usb20\UIO\main.c
000548   b2c2     BTFSC     0xc2,0x1,0x0       	while(ADCON0bits.NOT_DONE);     	// Wait for conversion                     E:\usb20\UIO\main.c
00054a   d7fe     BRA       0x548                                                                                           
00054c   50c4     MOVF      0xc4,0x0,0x0    	adData = ADRESH * 256 + ADRESL;                                                E:\usb20\UIO\main.c
00054e   6e16     MOVWF     0x16,0x0                                                                                        
000550   6a17     CLRF      0x17,0x0                                                                                        
000552   c016     MOVFF     0x16,0x17                                                                                       
000554   f017                                                                                                               
000556   6a16     CLRF      0x16,0x0                                                                                        
000558   50c3     MOVF      0xc3,0x0,0x0                                                                                    
00055a   0100     MOVLB     0x0                                                                                             
00055c   2416     ADDWF     0x16,0x0,0x0                                                                                    
00055e   6e14     MOVWF     0x14,0x0                                                                                        
000560   0e00     MOVLW     0x0                                                                                             
000562   2017     ADDWFC    0x17,0x0,0x0                                                                                    
000564   6e15     MOVWF     0x15,0x0                                                                                        
000566   c014     MOVFF     0x14,0xfde                                                                                      
000568   ffde                                                                                                               
00056a   c015     MOVFF     0x15,0xfdd                                                                                      
00056c   ffdd                                                                                                               
00056e   cfde     MOVFF     0xfde,0x14     	return(adData);                    	// データ返し                               E:\usb20\UIO\main.c
000570   f014                                                                                                               
000572   cfdd     MOVFF     0xfdd,0x15                                                                                      
000574   f015                                                                                                               
000576   c014     MOVFF     0x14,0xff3                                                                                      
000578   fff3                                                                                                               
00057a   c015     MOVFF     0x15,0xff4                                                                                      
00057c   fff4                                                                                                               
00057e   6ef5     MOVWF     0xf5,0x0       }                                                                                E:\usb20\UIO\main.c
000580   0e02     MOVLW     0x2                                                                                             
000582   5ce1     SUBWF     0xe1,0x0,0x0                                                                                    
000584   e203     BC        0x58c                                                                                           
000586   d000     BRA       0x588                                                                                           
000588   6ae1     CLRF      0xe1,0x0                                                                                        
00058a   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00058c   6ee1     MOVWF     0xe1,0x0                                                                                        
00058e   50f5     MOVF      0xf5,0x0,0x0                                                                                    
000590   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000592   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
000594   ffd9                                                                                                               
000596   0012     RETURN    0x0                                                                                             
                                                                                                                            E:\usb20\UIO\main.c
                                           ///// 数値から文字列に変換                                                       E:\usb20\UIO\main.c
000598   cfd9     MOVFF     0xfd9,0xfe6    void ltostring(char digit, unsigned long data, byte *buffer)                     E:\usb20\UIO\main.c
00059a   ffe6                                                                                                               
00059c   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
00059e   ffd9                                                                                                               
0005a0   52e6     MOVF      0xe6,0x1,0x0                                                                                    
                                           {                                                                                E:\usb20\UIO\main.c
                                           	char i;                                                                         E:\usb20\UIO\main.c
0005a2   0efe     MOVLW     0xfe           	buffer += digit;					// 文字列の最後                                            E:\usb20\UIO\main.c
0005a4   cfdb     MOVFF     0xfdb,0x14                                                                                      
0005a6   f014                                                                                                               
0005a8   6a15     CLRF      0x15,0x0                                                                                        
0005aa   be14     BTFSC     0x14,0x7,0x0                                                                                    
0005ac   6815     SETF      0x15,0x0                                                                                        
0005ae   50d9     MOVF      0xd9,0x0,0x0                                                                                    
0005b0   0ff8     ADDLW     0xf8                                                                                            
0005b2   6ee9     MOVWF     0xe9,0x0                                                                                        
0005b4   0eff     MOVLW     0xff                                                                                            
0005b6   20da     ADDWFC    0xda,0x0,0x0                                                                                    
0005b8   6eea     MOVWF     0xea,0x0                                                                                        
0005ba   5014     MOVF      0x14,0x0,0x0                                                                                    
0005bc   26ee     ADDWF     0xee,0x1,0x0                                                                                    
0005be   5015     MOVF      0x15,0x0,0x0                                                                                    
0005c0   22ed     ADDWFC    0xed,0x1,0x0                                                                                    
0005c2   0efe     MOVLW     0xfe           	for(i=digit; i>0; i--) {			// 最下位桁から上位へ                                E:\usb20\UIO\main.c
0005c4   50db     MOVF      0xdb,0x0,0x0                                                                                    
0005c6   6edf     MOVWF     0xdf,0x0                                                                                        
0005c8   cfdf     MOVFF     0xfdf,0x14                                                                                      
0005ca   f014                                                                                                               
0005cc   0e00     MOVLW     0x0                                                                                             
0005ce   6ee7     MOVWF     0xe7,0x0                                                                                        
0005d0   1814     XORWF     0x14,0x0,0x0                                                                                    
0005d2   aee8     BTFSS     0xe8,0x7,0x0                                                                                    
0005d4   d002     BRA       0x5da                                                                                           
0005d6   3414     RLCF      0x14,0x0,0x0                                                                                    
0005d8   d003     BRA       0x5e0                                                                                           
0005da   50e7     MOVF      0xe7,0x0,0x0                                                                                    
0005dc   80d8     BSF       0xd8,0x0,0x0                                                                                    
0005de   5414     SUBFWB    0x14,0x0,0x0                                                                                    
0005e0   e257     BC        0x690                                                                                           
00068c   06df     DECF      0xdf,0x1,0x0                                                                                    
00068e   d79c     BRA       0x5c8                                                                                           
0005e2   0ef8     MOVLW     0xf8           		buffer--;						// ポインター１                                                 E:\usb20\UIO\main.c
0005e4   06db     DECF      0xdb,0x1,0x0                                                                                    
0005e6   0ef9     MOVLW     0xf9                                                                                            
0005e8   e201     BC        0x5ec                                                                                           
0005ea   06db     DECF      0xdb,0x1,0x0                                                                                    
0005ec   0efa     MOVLW     0xfa           		*buffer = (data % 10) + '0';	// その桁数値を文字にして格納                     E:\usb20\UIO\main.c
0005ee   cfdb     MOVFF     0xfdb,0x14                                                                                      
0005f0   f014                                                                                                               
0005f2   0efb     MOVLW     0xfb                                                                                            
0005f4   cfdb     MOVFF     0xfdb,0x15                                                                                      
0005f6   f015                                                                                                               
0005f8   0efc     MOVLW     0xfc                                                                                            
0005fa   cfdb     MOVFF     0xfdb,0x16                                                                                      
0005fc   f016                                                                                                               
0005fe   0efd     MOVLW     0xfd                                                                                            
000600   cfdb     MOVFF     0xfdb,0x17                                                                                      
000602   f017                                                                                                               
000604   0e0a     MOVLW     0xa                                                                                             
000606   6e09     MOVWF     0x9,0x0                                                                                         
000608   6a0a     CLRF      0xa,0x0                                                                                         
00060a   6a0b     CLRF      0xb,0x0                                                                                         
00060c   6a0c     CLRF      0xc,0x0                                                                                         
00060e   c014     MOVFF     0x14,0x4                                                                                        
000610   f004                                                                                                               
000612   c015     MOVFF     0x15,0x5                                                                                        
000614   f005                                                                                                               
000616   c016     MOVFF     0x16,0x6                                                                                        
000618   f006                                                                                                               
00061a   c017     MOVFF     0x17,0x7                                                                                        
00061c   f007                                                                                                               
00061e   ec6d     CALL      0x14da,0x0                                                                                      
000620   f00a                                                                                                               
000622   c000     MOVFF     0x0,0x14                                                                                        
000624   f014                                                                                                               
000626   c001     MOVFF     0x1,0x15                                                                                        
000628   f015                                                                                                               
00062a   c002     MOVFF     0x2,0x16                                                                                        
00062c   f016                                                                                                               
00062e   c003     MOVFF     0x3,0x17                                                                                        
000630   f017                                                                                                               
000632   0e30     MOVLW     0x30                                                                                            
000634   2614     ADDWF     0x14,0x1,0x0                                                                                    
000636   0e00     MOVLW     0x0                                                                                             
000638   2215     ADDWFC    0x15,0x1,0x0                                                                                    
00063a   2216     ADDWFC    0x16,0x1,0x0                                                                                    
00063c   2217     ADDWFC    0x17,0x1,0x0                                                                                    
00063e   0ef8     MOVLW     0xf8                                                                                            
000640   cfdb     MOVFF     0xfdb,0xfe9                                                                                     
000642   ffe9                                                                                                               
000644   0ef9     MOVLW     0xf9                                                                                            
000646   cfdb     MOVFF     0xfdb,0xfea                                                                                     
000648   ffea                                                                                                               
00064a   c014     MOVFF     0x14,0xfef                                                                                      
00064c   ffef                                                                                                               
00064e   0efa     MOVLW     0xfa           		data = data / 10;				// 桁-1                                                   E:\usb20\UIO\main.c
000650   cfdb     MOVFF     0xfdb,0x4                                                                                       
000652   f004                                                                                                               
000654   0efb     MOVLW     0xfb                                                                                            
000656   cfdb     MOVFF     0xfdb,0x5                                                                                       
000658   f005                                                                                                               
00065a   0efc     MOVLW     0xfc                                                                                            
00065c   cfdb     MOVFF     0xfdb,0x6                                                                                       
00065e   f006                                                                                                               
000660   0efd     MOVLW     0xfd                                                                                            
000662   cfdb     MOVFF     0xfdb,0x7                                                                                       
000664   f007                                                                                                               
000666   0e0a     MOVLW     0xa                                                                                             
000668   6e09     MOVWF     0x9,0x0                                                                                         
00066a   6a0a     CLRF      0xa,0x0                                                                                         
00066c   6a0b     CLRF      0xb,0x0                                                                                         
00066e   6a0c     CLRF      0xc,0x0                                                                                         
000670   ec6d     CALL      0x14da,0x0                                                                                      
000672   f00a                                                                                                               
000674   0efa     MOVLW     0xfa                                                                                            
000676   c004     MOVFF     0x4,0xfdb                                                                                       
000678   ffdb                                                                                                               
00067a   0efb     MOVLW     0xfb                                                                                            
00067c   c005     MOVFF     0x5,0xfdb                                                                                       
00067e   ffdb                                                                                                               
000680   0efc     MOVLW     0xfc                                                                                            
000682   c006     MOVFF     0x6,0xfdb                                                                                       
000684   ffdb                                                                                                               
000686   0efd     MOVLW     0xfd                                                                                            
000688   c007     MOVFF     0x7,0xfdb                                                                                       
00068a   ffdb                                                                                                               
                                           	}                                                                               E:\usb20\UIO\main.c
000690   52e5     MOVF      0xe5,0x1,0x0   }                                                                                E:\usb20\UIO\main.c
000692   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000694   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
000696   ffd9                                                                                                               
000698   0012     RETURN    0x0                                                                                             
                                                                                                                            E:\usb20\UIO\main.c
                                           ///////////////////////////////////////////////                                  E:\usb20\UIO\lcd_lib.c
                                           //  液晶表示器制御ライブラリ　for PIC18Fxxxx                                     E:\usb20\UIO\lcd_lib.c
                                           //  内蔵関数は以下                                                               E:\usb20\UIO\lcd_lib.c
                                           //    lcd_init()    ----- 初期化                                                 E:\usb20\UIO\lcd_lib.c
                                           //    lcd_cmd(cmd)  ----- コマンド出力                                           E:\usb20\UIO\lcd_lib.c
                                           //    lcd_data(chr) ----- １文字表示出力                                         E:\usb20\UIO\lcd_lib.c
                                           //    lcd_clear()   ----- 全消去                                                 E:\usb20\UIO\lcd_lib.c
                                           //////////////////////////////////////////////                                   E:\usb20\UIO\lcd_lib.c
                                           #include <p18cxxx.h>                                                             E:\usb20\UIO\lcd_lib.c
                                           #include "io_cfg.h"                                                              E:\usb20\UIO\lcd_lib.c
                                           #include	"delays.h"                                                              E:\usb20\UIO\lcd_lib.c
                                           #include "lcd_lib.h"                                                             E:\usb20\UIO\lcd_lib.c
                                                                                                                            E:\usb20\UIO\lcd_lib.c
                                           //////// データ出力サブ関数                                                      E:\usb20\UIO\lcd_lib.c
00101e   cfd9     MOVFF     0xfd9,0xfe6    void lcd_out(char code, char flag)                                               E:\usb20\UIO\lcd_lib.c
001020   ffe6                                                                                                               
001022   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
001024   ffd9                                                                                                               
                                           {                                                                                E:\usb20\UIO\lcd_lib.c
001026   0efe     MOVLW     0xfe           	lcd_port = code & 0xF0;                                                         E:\usb20\UIO\lcd_lib.c
001028   50db     MOVF      0xdb,0x0,0x0                                                                                    
00102a   0bf0     ANDLW     0xf0                                                                                            
00102c   6e8a     MOVWF     0x8a,0x0                                                                                        
00102e   0efd     MOVLW     0xfd           	if (flag == 0)                                                                  E:\usb20\UIO\lcd_lib.c
001030   50db     MOVF      0xdb,0x0,0x0                                                                                    
001032   e102     BNZ       0x1038                                                                                          
001034   848a     BSF       0x8a,0x2,0x0   		lcd_rs = 1;			//表示データの場合                                               E:\usb20\UIO\lcd_lib.c
001036   d001     BRA       0x103a         	else                                                                            E:\usb20\UIO\lcd_lib.c
001038   948a     BCF       0x8a,0x2,0x0   		lcd_rs = 0;			//コマンドデータの場合                                           E:\usb20\UIO\lcd_lib.c
00103a   0000     NOP                      	Delay1TCY();				//NOP		                                                         E:\usb20\UIO\lcd_lib.c
00103c   868a     BSF       0x8a,0x3,0x0   	lcd_stb = 1;				//strobe out                                                    E:\usb20\UIO\lcd_lib.c
00103e   0e01     MOVLW     0x1            	Delay10TCYx(1);			//10NOP                                                       E:\usb20\UIO\lcd_lib.c
001040   6ee6     MOVWF     0xe6,0x0                                                                                        
001042   ecb4     CALL      0x1568,0x0                                                                                      
001044   f00a                                                                                                               
001046   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001048   968a     BCF       0x8a,0x3,0x0   	lcd_stb = 0;				//reset strobe                                                  E:\usb20\UIO\lcd_lib.c
00104a   52e5     MOVF      0xe5,0x1,0x0   }                                                                                E:\usb20\UIO\lcd_lib.c
00104c   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
00104e   ffd9                                                                                                               
001050   0012     RETURN    0x0                                                                                             
                                           //////// １文字表示関数                                                          E:\usb20\UIO\lcd_lib.c
001052   cfd9     MOVFF     0xfd9,0xfe6    void lcd_data(char asci)                                                         E:\usb20\UIO\lcd_lib.c
001054   ffe6                                                                                                               
001056   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
001058   ffd9                                                                                                               
                                           {                                                                                E:\usb20\UIO\lcd_lib.c
00105a   6ae6     CLRF      0xe6,0x0       	lcd_out(asci, 0);			//上位４ビット出力                                          E:\usb20\UIO\lcd_lib.c
00105c   0efe     MOVLW     0xfe                                                                                            
00105e   cfdb     MOVFF     0xfdb,0xfe6                                                                                     
001060   ffe6                                                                                                               
001062   dfdd     RCALL     0x101e                                                                                          
001064   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001066   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001068   6ae6     CLRF      0xe6,0x0       	lcd_out(asci<<4, 0);		//下位４ビット出力                                        E:\usb20\UIO\lcd_lib.c
00106a   0efe     MOVLW     0xfe                                                                                            
00106c   38db     SWAPF     0xdb,0x0,0x0                                                                                    
00106e   0bf0     ANDLW     0xf0                                                                                            
001070   6ee6     MOVWF     0xe6,0x0                                                                                        
001072   dfd5     RCALL     0x101e                                                                                          
001074   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001076   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001078   0e32     MOVLW     0x32           	Delay10TCYx(50);			//50μsec待ち                                                E:\usb20\UIO\lcd_lib.c
00107a   6ee6     MOVWF     0xe6,0x0                                                                                        
00107c   ecb4     CALL      0x1568,0x0                                                                                      
00107e   f00a                                                                                                               
001080   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001082   52e5     MOVF      0xe5,0x1,0x0   }                                                                                E:\usb20\UIO\lcd_lib.c
001084   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
001086   ffd9                                                                                                               
001088   0012     RETURN    0x0                                                                                             
                                           /////// コマンド出力関数                                                         E:\usb20\UIO\lcd_lib.c
00108a   cfd9     MOVFF     0xfd9,0xfe6    void lcd_cmd(char cmd)                                                           E:\usb20\UIO\lcd_lib.c
00108c   ffe6                                                                                                               
00108e   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
001090   ffd9                                                                                                               
                                           {                                                                                E:\usb20\UIO\lcd_lib.c
001092   0e01     MOVLW     0x1            	lcd_out(cmd, 1);			//上位４ビット出力                                           E:\usb20\UIO\lcd_lib.c
001094   6ee6     MOVWF     0xe6,0x0                                                                                        
001096   0efe     MOVLW     0xfe                                                                                            
001098   cfdb     MOVFF     0xfdb,0xfe6                                                                                     
00109a   ffe6                                                                                                               
00109c   dfc0     RCALL     0x101e                                                                                          
00109e   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0010a0   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0010a2   0e01     MOVLW     0x1            	lcd_out(cmd<<4, 1);		//下位４ビット出力                                         E:\usb20\UIO\lcd_lib.c
0010a4   6ee6     MOVWF     0xe6,0x0                                                                                        
0010a6   0efe     MOVLW     0xfe                                                                                            
0010a8   38db     SWAPF     0xdb,0x0,0x0                                                                                    
0010aa   0bf0     ANDLW     0xf0                                                                                            
0010ac   6ee6     MOVWF     0xe6,0x0                                                                                        
0010ae   dfb7     RCALL     0x101e                                                                                          
0010b0   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0010b2   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0010b4   0efe     MOVLW     0xfe           	if((cmd & 0x03) != 0)                                                           E:\usb20\UIO\lcd_lib.c
0010b6   50db     MOVF      0xdb,0x0,0x0                                                                                    
0010b8   0b03     ANDLW     0x3                                                                                             
0010ba   e006     BZ        0x10c8                                                                                          
0010bc   0e02     MOVLW     0x2            		Delay10KTCYx(2);		//2msec待ち                                                  E:\usb20\UIO\lcd_lib.c
0010be   6ee6     MOVWF     0xe6,0x0                                                                                        
0010c0   ec91     CALL      0x1522,0x0                                                                                      
0010c2   f00a                                                                                                               
0010c4   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0010c6   d005     BRA       0x10d2         	else                                                                            E:\usb20\UIO\lcd_lib.c
0010c8   0e32     MOVLW     0x32           		Delay10TCYx(50);		//50usec待ち                                                 E:\usb20\UIO\lcd_lib.c
0010ca   6ee6     MOVWF     0xe6,0x0                                                                                        
0010cc   ecb4     CALL      0x1568,0x0                                                                                      
0010ce   f00a                                                                                                               
0010d0   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0010d2   52e5     MOVF      0xe5,0x1,0x0   }                                                                                E:\usb20\UIO\lcd_lib.c
0010d4   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
0010d6   ffd9                                                                                                               
0010d8   0012     RETURN    0x0                                                                                             
                                           /////// 全消去関数                                                               E:\usb20\UIO\lcd_lib.c
                                           void lcd_clear(void)                                                             E:\usb20\UIO\lcd_lib.c
                                           {                                                                                E:\usb20\UIO\lcd_lib.c
0010da   0e01     MOVLW     0x1            	lcd_cmd(0x01);			//初期化コマンド出力                                           E:\usb20\UIO\lcd_lib.c
0010dc   6ee6     MOVWF     0xe6,0x0                                                                                        
0010de   dfd5     RCALL     0x108a                                                                                          
0010e0   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0010e2   0012     RETURN    0x0            }                                                                                E:\usb20\UIO\lcd_lib.c
                                                                                                                            E:\usb20\UIO\lcd_lib.c
                                           /////// 文字列出力関数                                                           E:\usb20\UIO\lcd_lib.c
0010e4   cfd9     MOVFF     0xfd9,0xfe6    void lcd_str(char *str)                                                          E:\usb20\UIO\lcd_lib.c
0010e6   ffe6                                                                                                               
0010e8   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
0010ea   ffd9                                                                                                               
                                           {                                                                                E:\usb20\UIO\lcd_lib.c
0010ec   0efd     MOVLW     0xfd           	while(*str != 0x00)			//文字列の終わり判定                                      E:\usb20\UIO\lcd_lib.c
0010ee   cfdb     MOVFF     0xfdb,0xfe9                                                                                     
0010f0   ffe9                                                                                                               
0010f2   0efe     MOVLW     0xfe                                                                                            
0010f4   cfdb     MOVFF     0xfdb,0xfea                                                                                     
0010f6   ffea                                                                                                               
0010f8   50ef     MOVF      0xef,0x0,0x0                                                                                    
0010fa   e010     BZ        0x111c                                                                                          
00111a   d7e8     BRA       0x10ec                                                                                          
                                           	{                                                                               E:\usb20\UIO\lcd_lib.c
0010fc   0efd     MOVLW     0xfd           		lcd_data(*str);			//文字列１文字出力                                           E:\usb20\UIO\lcd_lib.c
0010fe   cfdb     MOVFF     0xfdb,0xfe9                                                                                     
001100   ffe9                                                                                                               
001102   0efe     MOVLW     0xfe                                                                                            
001104   cfdb     MOVFF     0xfdb,0xfea                                                                                     
001106   ffea                                                                                                               
001108   50ef     MOVF      0xef,0x0,0x0                                                                                    
00110a   6ee6     MOVWF     0xe6,0x0                                                                                        
00110c   dfa2     RCALL     0x1052                                                                                          
00110e   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001110   0efd     MOVLW     0xfd           		str++;					//ポインタ＋１                                                      E:\usb20\UIO\lcd_lib.c
001112   2adb     INCF      0xdb,0x1,0x0                                                                                    
001114   0efe     MOVLW     0xfe                                                                                            
001116   e301     BNC       0x111a                                                                                          
001118   2adb     INCF      0xdb,0x1,0x0                                                                                    
                                           	}                                                                               E:\usb20\UIO\lcd_lib.c
00111c   52e5     MOVF      0xe5,0x1,0x0   }                                                                                E:\usb20\UIO\lcd_lib.c
00111e   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
001120   ffd9                                                                                                               
001122   0012     RETURN    0x0                                                                                             
                                                                                                                            E:\usb20\UIO\lcd_lib.c
                                           /////// 初期化関数                                                               E:\usb20\UIO\lcd_lib.c
                                           void lcd_init(void)                                                              E:\usb20\UIO\lcd_lib.c
                                           {                                                                                E:\usb20\UIO\lcd_lib.c
001124   0e14     MOVLW     0x14           	Delay10KTCYx(20);                                                               E:\usb20\UIO\lcd_lib.c
001126   6ee6     MOVWF     0xe6,0x0                                                                                        
001128   ec91     CALL      0x1522,0x0                                                                                      
00112a   f00a                                                                                                               
00112c   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00112e   0e01     MOVLW     0x1            	lcd_out(0x30, 1);			//8bit mode set                                             E:\usb20\UIO\lcd_lib.c
001130   6ee6     MOVWF     0xe6,0x0                                                                                        
001132   0e30     MOVLW     0x30                                                                                            
001134   6ee6     MOVWF     0xe6,0x0                                                                                        
001136   df73     RCALL     0x101e                                                                                          
001138   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00113a   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00113c   0e05     MOVLW     0x5            	Delay10KTCYx(5);                                                                E:\usb20\UIO\lcd_lib.c
00113e   6ee6     MOVWF     0xe6,0x0                                                                                        
001140   ec91     CALL      0x1522,0x0                                                                                      
001142   f00a                                                                                                               
001144   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001146   0e01     MOVLW     0x1            	lcd_out(0x30, 1);			//8bit mode set                                             E:\usb20\UIO\lcd_lib.c
001148   6ee6     MOVWF     0xe6,0x0                                                                                        
00114a   0e30     MOVLW     0x30                                                                                            
00114c   6ee6     MOVWF     0xe6,0x0                                                                                        
00114e   df67     RCALL     0x101e                                                                                          
001150   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001152   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001154   0e01     MOVLW     0x1            	Delay10KTCYx(1);                                                                E:\usb20\UIO\lcd_lib.c
001156   6ee6     MOVWF     0xe6,0x0                                                                                        
001158   ec91     CALL      0x1522,0x0                                                                                      
00115a   f00a                                                                                                               
00115c   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00115e   0e01     MOVLW     0x1            	lcd_out(0x30, 1);			//8bit mode set                                             E:\usb20\UIO\lcd_lib.c
001160   6ee6     MOVWF     0xe6,0x0                                                                                        
001162   0e30     MOVLW     0x30                                                                                            
001164   6ee6     MOVWF     0xe6,0x0                                                                                        
001166   df5b     RCALL     0x101e                                                                                          
001168   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00116a   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00116c   0e01     MOVLW     0x1            	Delay10KTCYx(1);                                                                E:\usb20\UIO\lcd_lib.c
00116e   6ee6     MOVWF     0xe6,0x0                                                                                        
001170   ec91     CALL      0x1522,0x0                                                                                      
001172   f00a                                                                                                               
001174   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001176   0e01     MOVLW     0x1            	lcd_out(0x20, 1);			//4bit mode set                                             E:\usb20\UIO\lcd_lib.c
001178   6ee6     MOVWF     0xe6,0x0                                                                                        
00117a   0e20     MOVLW     0x20                                                                                            
00117c   6ee6     MOVWF     0xe6,0x0                                                                                        
00117e   df4f     RCALL     0x101e                                                                                          
001180   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001182   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001184   0e01     MOVLW     0x1            	Delay10KTCYx(1);                                                                E:\usb20\UIO\lcd_lib.c
001186   6ee6     MOVWF     0xe6,0x0                                                                                        
001188   ec91     CALL      0x1522,0x0                                                                                      
00118a   f00a                                                                                                               
00118c   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00118e   0e2e     MOVLW     0x2e           	lcd_cmd(0x2E);			//DL=0 4bit mode                                               E:\usb20\UIO\lcd_lib.c
001190   6ee6     MOVWF     0xe6,0x0                                                                                        
001192   df7b     RCALL     0x108a                                                                                          
001194   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001196   0e08     MOVLW     0x8            	lcd_cmd(0x08);			//display off C=D=B=0                                          E:\usb20\UIO\lcd_lib.c
001198   6ee6     MOVWF     0xe6,0x0                                                                                        
00119a   df77     RCALL     0x108a                                                                                          
00119c   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00119e   0e0d     MOVLW     0xd            	lcd_cmd(0x0D);			//display on C=D=1 B=0                                         E:\usb20\UIO\lcd_lib.c
0011a0   6ee6     MOVWF     0xe6,0x0                                                                                        
0011a2   df73     RCALL     0x108a                                                                                          
0011a4   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0011a6   0e06     MOVLW     0x6            	lcd_cmd(0x06);			//entry I/D=1 S=0                                              E:\usb20\UIO\lcd_lib.c
0011a8   6ee6     MOVWF     0xe6,0x0                                                                                        
0011aa   df6f     RCALL     0x108a                                                                                          
0011ac   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0011ae   0e01     MOVLW     0x1            	lcd_cmd(0x01);			//all clear                                                    E:\usb20\UIO\lcd_lib.c
0011b0   6ee6     MOVWF     0xe6,0x0                                                                                        
0011b2   df6b     RCALL     0x108a                                                                                          
0011b4   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0011b6   0012     RETURN    0x0            }                                                                                E:\usb20\UIO\lcd_lib.c
                                           /*********************************************************************           E:\usb20\UIO\autofiles\usbdsc.c
                                            *                                                                               E:\usb20\UIO\autofiles\usbdsc.c
                                            *                Microchip USB C18 Firmware Version 1.0                         E:\usb20\UIO\autofiles\usbdsc.c
                                            *                                                                               E:\usb20\UIO\autofiles\usbdsc.c
                                            *********************************************************************           E:\usb20\UIO\autofiles\usbdsc.c
                                            * FileName:        usbdsc.c                                                     E:\usb20\UIO\autofiles\usbdsc.c
                                            * Dependencies:    See INCLUDES section below                                   E:\usb20\UIO\autofiles\usbdsc.c
                                            * Processor:       PIC18                                                        E:\usb20\UIO\autofiles\usbdsc.c
                                            * Compiler:        C18 2.30.01+                                                 E:\usb20\UIO\autofiles\usbdsc.c
                                            * Company:         Microchip Technology, Inc.                                   E:\usb20\UIO\autofiles\usbdsc.c
                                            *                                                                               E:\usb20\UIO\autofiles\usbdsc.c
                                            * Software License Agreement                                                    E:\usb20\UIO\autofiles\usbdsc.c
                                            *                                                                               E:\usb20\UIO\autofiles\usbdsc.c
                                            * The software supplied herewith by Microchip Technology Incorporated           E:\usb20\UIO\autofiles\usbdsc.c
                                            * (the 鼎ompany・ for its PICmicroｮ Microcontroller is intended and             E:\usb20\UIO\autofiles\usbdsc.c
                                            * supplied to you, the Company痴 customer, for use solely and                   E:\usb20\UIO\autofiles\usbdsc.c
                                            * exclusively on Microchip PICmicro Microcontroller products. The               E:\usb20\UIO\autofiles\usbdsc.c
                                            * software is owned by the Company and/or its supplier, and is                  E:\usb20\UIO\autofiles\usbdsc.c
                                            * protected under applicable copyright laws. All rights are reserved.           E:\usb20\UIO\autofiles\usbdsc.c
                                            * Any use in violation of the foregoing restrictions may subject the            E:\usb20\UIO\autofiles\usbdsc.c
                                            * user to criminal sanctions under applicable laws, as well as to               E:\usb20\UIO\autofiles\usbdsc.c
                                            * civil liability for the breach of the terms and conditions of this            E:\usb20\UIO\autofiles\usbdsc.c
                                            * license.                                                                      E:\usb20\UIO\autofiles\usbdsc.c
                                            *                                                                               E:\usb20\UIO\autofiles\usbdsc.c
                                            * THIS SOFTWARE IS PROVIDED IN AN 鄭S IS・CONDITION. NO WARRANTIES,             E:\usb20\UIO\autofiles\usbdsc.c
                                            * WHETHER EXPRESS, IMPLIED OR STATUTORY, INCLUDING, BUT NOT LIMITED             E:\usb20\UIO\autofiles\usbdsc.c
                                            * TO, IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A                   E:\usb20\UIO\autofiles\usbdsc.c
                                            * PARTICULAR PURPOSE APPLY TO THIS SOFTWARE. THE COMPANY SHALL NOT,             E:\usb20\UIO\autofiles\usbdsc.c
                                            * IN ANY CIRCUMSTANCES, BE LIABLE FOR SPECIAL, INCIDENTAL OR                    E:\usb20\UIO\autofiles\usbdsc.c
                                            * CONSEQUENTIAL DAMAGES, FOR ANY REASON WHATSOEVER.                             E:\usb20\UIO\autofiles\usbdsc.c
                                            *                                                                               E:\usb20\UIO\autofiles\usbdsc.c
                                            ********************************************************************/           E:\usb20\UIO\autofiles\usbdsc.c
                                                                                                                            E:\usb20\UIO\autofiles\usbdsc.c
                                           /*********************************************************************           E:\usb20\UIO\autofiles\usbdsc.c
                                            * -usbdsc.c-                                                                    E:\usb20\UIO\autofiles\usbdsc.c
                                            * This file contains the USB descriptor information. It is used                 E:\usb20\UIO\autofiles\usbdsc.c
                                            * in conjunction with the usbdsc.h file. When a descriptor is added             E:\usb20\UIO\autofiles\usbdsc.c
                                            * or removed from the main configuration descriptor, i.e. CFG01,                E:\usb20\UIO\autofiles\usbdsc.c
                                            * the user must also change the descriptor structure defined in                 E:\usb20\UIO\autofiles\usbdsc.c
                                            * the usbdsc.h file. The structure is used to calculate the                     E:\usb20\UIO\autofiles\usbdsc.c
                                            * descriptor size, i.e. sizeof(CFG01).                                          E:\usb20\UIO\autofiles\usbdsc.c
                                            *                                                                               E:\usb20\UIO\autofiles\usbdsc.c
                                            * A typical configuration descriptor consists of:                               E:\usb20\UIO\autofiles\usbdsc.c
                                            * At least one configuration descriptor (USB_CFG_DSC)                           E:\usb20\UIO\autofiles\usbdsc.c
                                            * One or more interface descriptors (USB_INTF_DSC)                              E:\usb20\UIO\autofiles\usbdsc.c
                                            * One or more endpoint descriptors (USB_EP_DSC)                                 E:\usb20\UIO\autofiles\usbdsc.c
                                            *                                                                               E:\usb20\UIO\autofiles\usbdsc.c
                                            * Naming Convention:                                                            E:\usb20\UIO\autofiles\usbdsc.c
                                            * To resolve ambiguity, the naming convention are as followed:                  E:\usb20\UIO\autofiles\usbdsc.c
                                            * - USB_CFG_DSC type should be named cdxx, where xx is the                      E:\usb20\UIO\autofiles\usbdsc.c
                                            *   configuration number. This number should match the actual                   E:\usb20\UIO\autofiles\usbdsc.c
                                            *   index value of this configuration.                                          E:\usb20\UIO\autofiles\usbdsc.c
                                            * - USB_INTF_DSC type should be named i<yy>a<zz>, where yy is the               E:\usb20\UIO\autofiles\usbdsc.c
                                            *   interface number and zz is the alternate interface number.                  E:\usb20\UIO\autofiles\usbdsc.c
                                            * - USB_EP_DSC type should be named ep<##><d>_i<yy>a<zz>, where                 E:\usb20\UIO\autofiles\usbdsc.c
                                            *   ## is the endpoint number and d is the direction of transfer.               E:\usb20\UIO\autofiles\usbdsc.c
                                            *   The interface name should also be listed as a suffix to identify            E:\usb20\UIO\autofiles\usbdsc.c
                                            *   which interface does the endpoint belong to.                                E:\usb20\UIO\autofiles\usbdsc.c
                                            *                                                                               E:\usb20\UIO\autofiles\usbdsc.c
                                            * Example:                                                                      E:\usb20\UIO\autofiles\usbdsc.c
                                            * If a device has one configuration, two interfaces; interface 0                E:\usb20\UIO\autofiles\usbdsc.c
                                            * has two endpoints (in and out), and interface 1 has one endpoint(in).         E:\usb20\UIO\autofiles\usbdsc.c
                                            * Then the CFG01 structure in the usbdsc.h should be:                           E:\usb20\UIO\autofiles\usbdsc.c
                                            *                                                                               E:\usb20\UIO\autofiles\usbdsc.c
                                            * #define CFG01 rom struct                            \                         E:\usb20\UIO\autofiles\usbdsc.c
                                            * {   USB_CFG_DSC             cd01;                   \                         E:\usb20\UIO\autofiles\usbdsc.c
                                            *     USB_INTF_DSC            i00a00;                 \                         E:\usb20\UIO\autofiles\usbdsc.c
                                            *     USB_EP_DSC              ep01o_i00a00;           \                         E:\usb20\UIO\autofiles\usbdsc.c
                                            *     USB_EP_DSC              ep01i_i00a00;           \                         E:\usb20\UIO\autofiles\usbdsc.c
                                            *     USB_INTF_DSC            i01a00;                 \                         E:\usb20\UIO\autofiles\usbdsc.c
                                            *     USB_EP_DSC              ep02i_i01a00;           \                         E:\usb20\UIO\autofiles\usbdsc.c
                                            * } cfg01                                                                       E:\usb20\UIO\autofiles\usbdsc.c
                                            *                                                                               E:\usb20\UIO\autofiles\usbdsc.c
                                            * Note the hierarchy of the descriptors above, it follows the USB               E:\usb20\UIO\autofiles\usbdsc.c
                                            * specification requirement. All endpoints belonging to an interface            E:\usb20\UIO\autofiles\usbdsc.c
                                            * should be listed immediately after that interface.                            E:\usb20\UIO\autofiles\usbdsc.c
                                            *                                                                               E:\usb20\UIO\autofiles\usbdsc.c
                                            * -------------------------------------------------------------------           E:\usb20\UIO\autofiles\usbdsc.c
                                            * Filling in the descriptor values in the usbdsc.c file:                        E:\usb20\UIO\autofiles\usbdsc.c
                                            * -------------------------------------------------------------------           E:\usb20\UIO\autofiles\usbdsc.c
                                            * Most items should be self-explanatory, however, a few will be                 E:\usb20\UIO\autofiles\usbdsc.c
                                            * explained for clarification.                                                  E:\usb20\UIO\autofiles\usbdsc.c
                                            *                                                                               E:\usb20\UIO\autofiles\usbdsc.c
                                            * [Configuration Descriptor(USB_CFG_DSC)]                                       E:\usb20\UIO\autofiles\usbdsc.c
                                            * The configuration attribute must always have the _DEFAULT                     E:\usb20\UIO\autofiles\usbdsc.c
                                            * definition at the minimum. Additional options can be ORed                     E:\usb20\UIO\autofiles\usbdsc.c
                                            * to the _DEFAULT attribute. Available options are _SELF and _RWU.              E:\usb20\UIO\autofiles\usbdsc.c
                                            * These definitions are defined in the usbdefs_std_dsc.h file. The              E:\usb20\UIO\autofiles\usbdsc.c
                                            * _SELF tells the USB host that this device is self-powered. The                E:\usb20\UIO\autofiles\usbdsc.c
                                            * _RWU tells the USB host that this device supports Remote Wakeup.              E:\usb20\UIO\autofiles\usbdsc.c
                                            *                                                                               E:\usb20\UIO\autofiles\usbdsc.c
                                            * [Endpoint Descriptor(USB_EP_DSC)]                                             E:\usb20\UIO\autofiles\usbdsc.c
                                            * Assume the following example:                                                 E:\usb20\UIO\autofiles\usbdsc.c
                                            * sizeof(USB_EP_DSC),DSC_EP,_EP01_OUT,_BULK,64,0x00                             E:\usb20\UIO\autofiles\usbdsc.c
                                            *                                                                               E:\usb20\UIO\autofiles\usbdsc.c
                                            * The first two parameters are self-explanatory. They specify the               E:\usb20\UIO\autofiles\usbdsc.c
                                            * length of this endpoint descriptor (7) and the descriptor type.               E:\usb20\UIO\autofiles\usbdsc.c
                                            * The next parameter identifies the endpoint, the definitions are               E:\usb20\UIO\autofiles\usbdsc.c
                                            * defined in usbdefs_std_dsc.h and has the following naming                     E:\usb20\UIO\autofiles\usbdsc.c
                                            * convention:                                                                   E:\usb20\UIO\autofiles\usbdsc.c
                                            * _EP<##>_<dir>                                                                 E:\usb20\UIO\autofiles\usbdsc.c
                                            * where ## is the endpoint number and dir is the direction of                   E:\usb20\UIO\autofiles\usbdsc.c
                                            * transfer. The dir has the value of either 'OUT' or 'IN'.                      E:\usb20\UIO\autofiles\usbdsc.c
                                            * The next parameter identifies the type of the endpoint. Available             E:\usb20\UIO\autofiles\usbdsc.c
                                            * options are _BULK, _INT, _ISO, and _CTRL. The _CTRL is not                    E:\usb20\UIO\autofiles\usbdsc.c
                                            * typically used because the default control transfer endpoint is               E:\usb20\UIO\autofiles\usbdsc.c
                                            * not defined in the USB descriptors. When _ISO option is used,                 E:\usb20\UIO\autofiles\usbdsc.c
                                            * addition options can be ORed to _ISO. Example:                                E:\usb20\UIO\autofiles\usbdsc.c
                                            * _ISO|_AD|_FE                                                                  E:\usb20\UIO\autofiles\usbdsc.c
                                            * This describes the endpoint as an isochronous pipe with adaptive              E:\usb20\UIO\autofiles\usbdsc.c
                                            * and feedback attributes. See usbdefs_std_dsc.h and the USB                    E:\usb20\UIO\autofiles\usbdsc.c
                                            * specification for details. The next parameter defines the size of             E:\usb20\UIO\autofiles\usbdsc.c
                                            * the endpoint. The last parameter in the polling interval.                     E:\usb20\UIO\autofiles\usbdsc.c
                                            *                                                                               E:\usb20\UIO\autofiles\usbdsc.c
                                            * -------------------------------------------------------------------           E:\usb20\UIO\autofiles\usbdsc.c
                                            * Adding a USB String                                                           E:\usb20\UIO\autofiles\usbdsc.c
                                            * -------------------------------------------------------------------           E:\usb20\UIO\autofiles\usbdsc.c
                                            * A string descriptor array should have the following format:                   E:\usb20\UIO\autofiles\usbdsc.c
                                            *                                                                               E:\usb20\UIO\autofiles\usbdsc.c
                                            * rom struct{byte bLength;byte bDscType;word string[size];}sdxxx={              E:\usb20\UIO\autofiles\usbdsc.c
                                            * sizeof(sdxxx),DSC_STR,<text>};                                                E:\usb20\UIO\autofiles\usbdsc.c
                                            *                                                                               E:\usb20\UIO\autofiles\usbdsc.c
                                            * The above structure provides a means for the C compiler to                    E:\usb20\UIO\autofiles\usbdsc.c
                                            * calculate the length of string descriptor sdxxx, where xxx is the             E:\usb20\UIO\autofiles\usbdsc.c
                                            * index number. The first two bytes of the descriptor are descriptor            E:\usb20\UIO\autofiles\usbdsc.c
                                            * length and type. The rest <text> are string texts which must be               E:\usb20\UIO\autofiles\usbdsc.c
                                            * in the unicode format. The unicode format is achieved by declaring            E:\usb20\UIO\autofiles\usbdsc.c
                                            * each character as a word type. The whole text string is declared              E:\usb20\UIO\autofiles\usbdsc.c
                                            * as a word array with the number of characters equals to <size>.               E:\usb20\UIO\autofiles\usbdsc.c
                                            * <size> has to be manually counted and entered into the array                  E:\usb20\UIO\autofiles\usbdsc.c
                                            * declaration. Let's study this through an example:                             E:\usb20\UIO\autofiles\usbdsc.c
                                            * if the string is "USB" , then the string descriptor should be:                E:\usb20\UIO\autofiles\usbdsc.c
                                            * (Using index 02)                                                              E:\usb20\UIO\autofiles\usbdsc.c
                                            * rom struct{byte bLength;byte bDscType;word string[3];}sd002={                 E:\usb20\UIO\autofiles\usbdsc.c
                                            * sizeof(sd002),DSC_STR,'U','S','B'};                                           E:\usb20\UIO\autofiles\usbdsc.c
                                            *                                                                               E:\usb20\UIO\autofiles\usbdsc.c
                                            * A USB project may have multiple strings and the firmware supports             E:\usb20\UIO\autofiles\usbdsc.c
                                            * the management of multiple strings through a look-up table.                   E:\usb20\UIO\autofiles\usbdsc.c
                                            * The look-up table is defined as:                                              E:\usb20\UIO\autofiles\usbdsc.c
                                            * rom const unsigned char *rom USB_SD_Ptr[]={&sd000,&sd001,&sd002};             E:\usb20\UIO\autofiles\usbdsc.c
                                            *                                                                               E:\usb20\UIO\autofiles\usbdsc.c
                                            * The above declaration has 3 strings, sd000, sd001, and sd002.                 E:\usb20\UIO\autofiles\usbdsc.c
                                            * Strings can be removed or added. sd000 is a specialized string                E:\usb20\UIO\autofiles\usbdsc.c
                                            * descriptor. It defines the language code, usually this is                     E:\usb20\UIO\autofiles\usbdsc.c
                                            * US English (0x0409). The index of the string must match the index             E:\usb20\UIO\autofiles\usbdsc.c
                                            * position of the USB_SD_Ptr array, &sd000 must be in position                  E:\usb20\UIO\autofiles\usbdsc.c
                                            * USB_SD_Ptr[0], &sd001 must be in position USB_SD_Ptr[1] and so on.            E:\usb20\UIO\autofiles\usbdsc.c
                                            * The look-up table USB_SD_Ptr is used by the get string handler                E:\usb20\UIO\autofiles\usbdsc.c
                                            * function in usb9.c.                                                           E:\usb20\UIO\autofiles\usbdsc.c
                                            *                                                                               E:\usb20\UIO\autofiles\usbdsc.c
                                            * -------------------------------------------------------------------           E:\usb20\UIO\autofiles\usbdsc.c
                                            *                                                                               E:\usb20\UIO\autofiles\usbdsc.c
                                            * The look-up table scheme also applies to the configuration                    E:\usb20\UIO\autofiles\usbdsc.c
                                            * descriptor. A USB device may have multiple configuration                      E:\usb20\UIO\autofiles\usbdsc.c
                                            * descriptors, i.e. CFG01, CFG02, etc. To add a configuration                   E:\usb20\UIO\autofiles\usbdsc.c
                                            * descriptor, user must implement a structure similar to CFG01.                 E:\usb20\UIO\autofiles\usbdsc.c
                                            * The next step is to add the configuration descriptor name, i.e.               E:\usb20\UIO\autofiles\usbdsc.c
                                            * cfg01, cfg02,.., to the look-up table USB_CD_Ptr. USB_CD_Ptr[0]               E:\usb20\UIO\autofiles\usbdsc.c
                                            * is a dummy place holder since configuration 0 is the un-configured            E:\usb20\UIO\autofiles\usbdsc.c
                                            * state according to the definition in the USB specification.                   E:\usb20\UIO\autofiles\usbdsc.c
                                            *                                                                               E:\usb20\UIO\autofiles\usbdsc.c
                                            ********************************************************************/           E:\usb20\UIO\autofiles\usbdsc.c
                                                                                                                            E:\usb20\UIO\autofiles\usbdsc.c
                                           /*********************************************************************           E:\usb20\UIO\autofiles\usbdsc.c
                                            * Descriptor specific type definitions are defined in:                          E:\usb20\UIO\autofiles\usbdsc.c
                                            * system\usb\usbdefs\usbdefs_std_dsc.h                                          E:\usb20\UIO\autofiles\usbdsc.c
                                            *                                                                               E:\usb20\UIO\autofiles\usbdsc.c
                                            * Configuration information is defined in:                                      E:\usb20\UIO\autofiles\usbdsc.c
                                            * autofiles\usbcfg.h                                                            E:\usb20\UIO\autofiles\usbdsc.c
                                            ********************************************************************/           E:\usb20\UIO\autofiles\usbdsc.c
                                                                                                                            E:\usb20\UIO\autofiles\usbdsc.c
                                           /** I N C L U D E S *************************************************/           E:\usb20\UIO\autofiles\usbdsc.c
                                           #include "system\typedefs.h"                                                     E:\usb20\UIO\autofiles\usbdsc.c
                                           #include "system\usb\usb.h"                                                      E:\usb20\UIO\autofiles\usbdsc.c
                                                                                                                            E:\usb20\UIO\autofiles\usbdsc.c
                                           /** C O N S T A N T S ************************************************/          E:\usb20\UIO\autofiles\usbdsc.c
                                           #pragma romdata                                                                  E:\usb20\UIO\autofiles\usbdsc.c
                                                                                                                            E:\usb20\UIO\autofiles\usbdsc.c
                                           /* Device Descriptor */                                                          E:\usb20\UIO\autofiles\usbdsc.c
                                           rom USB_DEV_DSC device_dsc=                                                      E:\usb20\UIO\autofiles\usbdsc.c
                                           {                                                                                E:\usb20\UIO\autofiles\usbdsc.c
                                               sizeof(USB_DEV_DSC),    // Size of this descriptor in bytes                  E:\usb20\UIO\autofiles\usbdsc.c
                                               DSC_DEV,                // DEVICE descriptor type                            E:\usb20\UIO\autofiles\usbdsc.c
                                               0x0200,                 // USB Spec Release Number in BCD format             E:\usb20\UIO\autofiles\usbdsc.c
                                               CDC_DEVICE,             // Class Code 0x02                                   E:\usb20\UIO\autofiles\usbdsc.c
                                               0x00,                   // Subclass code                                     E:\usb20\UIO\autofiles\usbdsc.c
                                               0x00,                   // Protocol code                                     E:\usb20\UIO\autofiles\usbdsc.c
                                               EP0_BUFF_SIZE,          // Max packet size for EP0, see usbcfg.h             E:\usb20\UIO\autofiles\usbdsc.c
                                               0x09B9,                 // Vendor ID                                         E:\usb20\UIO\autofiles\usbdsc.c
                                               0x0047,                 // Product ID: CDC RS-232 Emulation Demo             E:\usb20\UIO\autofiles\usbdsc.c
                                               0x0000,                 // Device release number in BCD format               E:\usb20\UIO\autofiles\usbdsc.c
                                               0x01,                   // Manufacturer string index                         E:\usb20\UIO\autofiles\usbdsc.c
                                               0x02,                   // Product string index                              E:\usb20\UIO\autofiles\usbdsc.c
                                               0x00,                   // Device serial number string index                 E:\usb20\UIO\autofiles\usbdsc.c
                                               0x01                    // Number of possible configurations                 E:\usb20\UIO\autofiles\usbdsc.c
                                           };                                                                               E:\usb20\UIO\autofiles\usbdsc.c
                                                                                                                            E:\usb20\UIO\autofiles\usbdsc.c
                                           /* Configuration 1 Descriptor */                                                 E:\usb20\UIO\autofiles\usbdsc.c
                                           CFG01=                                                                           E:\usb20\UIO\autofiles\usbdsc.c
                                           {                                                                                E:\usb20\UIO\autofiles\usbdsc.c
                                               /* Configuration Descriptor */                                               E:\usb20\UIO\autofiles\usbdsc.c
                                               sizeof(USB_CFG_DSC),    // Size of this descriptor in bytes                  E:\usb20\UIO\autofiles\usbdsc.c
                                               DSC_CFG,                // CONFIGURATION descriptor type                     E:\usb20\UIO\autofiles\usbdsc.c
                                               sizeof(cfg01),          // Total length of data for this cfg                 E:\usb20\UIO\autofiles\usbdsc.c
                                               2,                      // Number of interfaces in this cfg                  E:\usb20\UIO\autofiles\usbdsc.c
                                               1,                      // Index value of this configuration                 E:\usb20\UIO\autofiles\usbdsc.c
                                               0,                      // Configuration string index                        E:\usb20\UIO\autofiles\usbdsc.c
                                               _DEFAULT,               // Attributes, see usbdefs_std_dsc.h                 E:\usb20\UIO\autofiles\usbdsc.c
                                               50,                     // Max power consumption (2X mA)                     E:\usb20\UIO\autofiles\usbdsc.c
                                                                                                                            E:\usb20\UIO\autofiles\usbdsc.c
                                               /* Interface Descriptor */                                                   E:\usb20\UIO\autofiles\usbdsc.c
                                               sizeof(USB_INTF_DSC),   // Size of this descriptor in bytes                  E:\usb20\UIO\autofiles\usbdsc.c
                                               DSC_INTF,               // INTERFACE descriptor type                         E:\usb20\UIO\autofiles\usbdsc.c
                                               0,                      // Interface Number                                  E:\usb20\UIO\autofiles\usbdsc.c
                                               0,                      // Alternate Setting Number                          E:\usb20\UIO\autofiles\usbdsc.c
                                               1,                      // Number of endpoints in this intf                  E:\usb20\UIO\autofiles\usbdsc.c
                                               COMM_INTF,              // Class code                                        E:\usb20\UIO\autofiles\usbdsc.c
                                               ABSTRACT_CONTROL_MODEL, // Subclass code                                     E:\usb20\UIO\autofiles\usbdsc.c
                                               V25TER,                 // Protocol code                                     E:\usb20\UIO\autofiles\usbdsc.c
                                               0,                      // Interface string index                            E:\usb20\UIO\autofiles\usbdsc.c
                                                                                                                            E:\usb20\UIO\autofiles\usbdsc.c
                                               /* CDC Class-Specific Descriptors */                                         E:\usb20\UIO\autofiles\usbdsc.c
                                               sizeof(USB_CDC_HEADER_FN_DSC),CS_INTERFACE,DSC_FN_HEADER,0x0110,             E:\usb20\UIO\autofiles\usbdsc.c
                                               sizeof(USB_CDC_ACM_FN_DSC),CS_INTERFACE,DSC_FN_ACM,0x02,                     E:\usb20\UIO\autofiles\usbdsc.c
                                               sizeof(USB_CDC_UNION_FN_DSC),CS_INTERFACE,DSC_FN_UNION,CDC_COMM_INTF_ID,CDC_DATA_INTF_ID, E:\usb20\UIO\autofiles\usbdsc.c
                                               sizeof(USB_CDC_CALL_MGT_FN_DSC),CS_INTERFACE,DSC_FN_CALL_MGT,0x00,CDC_DATA_INTF_ID, E:\usb20\UIO\autofiles\usbdsc.c
                                                                                                                            E:\usb20\UIO\autofiles\usbdsc.c
                                               /* Endpoint Descriptor */                                                    E:\usb20\UIO\autofiles\usbdsc.c
                                               sizeof(USB_EP_DSC),DSC_EP,_EP02_IN,_INT,CDC_INT_EP_SIZE,0x02,                E:\usb20\UIO\autofiles\usbdsc.c
                                                                                                                            E:\usb20\UIO\autofiles\usbdsc.c
                                               /* Interface Descriptor */                                                   E:\usb20\UIO\autofiles\usbdsc.c
                                               sizeof(USB_INTF_DSC),   // Size of this descriptor in bytes                  E:\usb20\UIO\autofiles\usbdsc.c
                                               DSC_INTF,               // INTERFACE descriptor type                         E:\usb20\UIO\autofiles\usbdsc.c
                                               1,                      // Interface Number                                  E:\usb20\UIO\autofiles\usbdsc.c
                                               0,                      // Alternate Setting Number                          E:\usb20\UIO\autofiles\usbdsc.c
                                               2,                      // Number of endpoints in this intf                  E:\usb20\UIO\autofiles\usbdsc.c
                                               DATA_INTF,              // Class code                                        E:\usb20\UIO\autofiles\usbdsc.c
                                               0,                      // Subclass code                                     E:\usb20\UIO\autofiles\usbdsc.c
                                               NO_PROTOCOL,            // Protocol code                                     E:\usb20\UIO\autofiles\usbdsc.c
                                               0,                      // Interface string index                            E:\usb20\UIO\autofiles\usbdsc.c
                                                                                                                            E:\usb20\UIO\autofiles\usbdsc.c
                                               /* Endpoint Descriptors */                                                   E:\usb20\UIO\autofiles\usbdsc.c
                                               sizeof(USB_EP_DSC),DSC_EP,_EP03_OUT,_BULK,CDC_BULK_OUT_EP_SIZE,0x00,         E:\usb20\UIO\autofiles\usbdsc.c
                                               sizeof(USB_EP_DSC),DSC_EP,_EP03_IN,_BULK,CDC_BULK_IN_EP_SIZE,0x00            E:\usb20\UIO\autofiles\usbdsc.c
                                           };                                                                               E:\usb20\UIO\autofiles\usbdsc.c
                                                                                                                            E:\usb20\UIO\autofiles\usbdsc.c
                                           rom struct{byte bLength;byte bDscType;word string[1];}sd000={                    E:\usb20\UIO\autofiles\usbdsc.c
                                           sizeof(sd000),DSC_STR,0x0409};                                                   E:\usb20\UIO\autofiles\usbdsc.c
                                                                                                                            E:\usb20\UIO\autofiles\usbdsc.c
                                           rom struct{byte bLength;byte bDscType;word string[20];}sd001={                   E:\usb20\UIO\autofiles\usbdsc.c
                                           sizeof(sd001),DSC_STR,                                                           E:\usb20\UIO\autofiles\usbdsc.c
                                           'M','i','c','r','o','c','h','i','p',' ',                                         E:\usb20\UIO\autofiles\usbdsc.c
                                           'D','e','s','i','g','n',' ','L','a','b'};                                        E:\usb20\UIO\autofiles\usbdsc.c
                                                                                                                            E:\usb20\UIO\autofiles\usbdsc.c
                                           rom struct{byte bLength;byte bDscType;word string[18];}sd002={                   E:\usb20\UIO\autofiles\usbdsc.c
                                           sizeof(sd002),DSC_STR,                                                           E:\usb20\UIO\autofiles\usbdsc.c
                                           'U','n','i','v','e','r','s','a','l',' ',                                         E:\usb20\UIO\autofiles\usbdsc.c
                                           'I','/','O',' ','D','e','m','o'};                                                E:\usb20\UIO\autofiles\usbdsc.c
                                                                                                                            E:\usb20\UIO\autofiles\usbdsc.c
                                           rom const unsigned char *rom USB_CD_Ptr[]={&cfg01,&cfg01};                       E:\usb20\UIO\autofiles\usbdsc.c
                                           rom const unsigned char *rom USB_SD_Ptr[]={&sd000,&sd001,&sd002};                E:\usb20\UIO\autofiles\usbdsc.c
                                                                                                                            E:\usb20\UIO\autofiles\usbdsc.c
                                           rom pFunc ClassReqHandler[1]=                                                    E:\usb20\UIO\autofiles\usbdsc.c
                                           {                                                                                E:\usb20\UIO\autofiles\usbdsc.c
                                               &USBCheckCDCRequest                                                          E:\usb20\UIO\autofiles\usbdsc.c
                                           };                                                                               E:\usb20\UIO\autofiles\usbdsc.c
                                                                                                                            E:\usb20\UIO\autofiles\usbdsc.c
                                           #pragma code                                                                     E:\usb20\UIO\autofiles\usbdsc.c
                                                                                                                            E:\usb20\UIO\autofiles\usbdsc.c
                                           /** EOF usbdsc.c ****************************************************/           E:\usb20\UIO\autofiles\usbdsc.c
                                           /*********************************************************************           E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            *             Microchip USB C18 Firmware -  CDC Version 1.0                     E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            *********************************************************************           E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            * FileName:        cdc.c                                                        E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            * Dependencies:    See INCLUDES section below                                   E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            * Processor:       PIC18                                                        E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            * Compiler:        C18 2.30.01+                                                 E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            * Company:         Microchip Technology, Inc.                                   E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            * Software License Agreement                                                    E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            * The software supplied herewith by Microchip Technology Incorporated           E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            * (the 鼎ompany) for its PICmicroｮ Microcontroller is intended and             E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            * supplied to you, the Company痴 customer, for use solely and                   E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            * exclusively on Microchip PICmicro Microcontroller products. The               E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            * software is owned by the Company and/or its supplier, and is                  E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            * protected under applicable copyright laws. All rights are reserved.           E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            * Any use in violation of the foregoing restrictions may subject the            E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            * user to criminal sanctions under applicable laws, as well as to               E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            * civil liability for the breach of the terms and conditions of this            E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            * license.                                                                      E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            * THIS SOFTWARE IS PROVIDED IN AN 鄭S IS CONDITION. NO WARRANTIES,             E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            * WHETHER EXPRESS, IMPLIED OR STATUTORY, INCLUDING, BUT NOT LIMITED             E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            * TO, IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A                   E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            * PARTICULAR PURPOSE APPLY TO THIS SOFTWARE. THE COMPANY SHALL NOT,             E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            * IN ANY CIRCUMSTANCES, BE LIABLE FOR SPECIAL, INCIDENTAL OR                    E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            * CONSEQUENTIAL DAMAGES, FOR ANY REASON WHATSOEVER.                             E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            * Author               Date        Comment                                      E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            *~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~           E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            * Rawin Rojvanit       11/19/04    Original. RS-232 Emulation Subset            E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            ********************************************************************/           E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                                                                                            E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                           /** I N C L U D E S **********************************************************/  E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                           #include <p18cxxx.h>                                                             E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                           #include "system\typedefs.h"                                                     E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                           #include "system\usb\usb.h"                                                      E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                                                                                            E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                           #ifdef USB_USE_CDC                                                               E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                                                                                            E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                           /** V A R I A B L E S ********************************************************/  E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                           #pragma udata                                                                    E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                           byte cdc_rx_len;            // total rx length                                   E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                                                                                            E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                           byte cdc_trf_state;         // States are defined cdc.h                          E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                           POINTER pCDCSrc;            // Dedicated source pointer                          E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                           POINTER pCDCDst;            // Dedicated destination pointer                     E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                           byte cdc_tx_len;            // total tx length                                   E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                           byte cdc_mem_type;          // _ROM, _RAM                                        E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                                                                                            E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                           LINE_CODING line_coding;    // Buffer to store line coding information           E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                           CONTROL_SIGNAL_BITMAP control_signal_bitmap;                                     E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                                                                                            E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                           /*                                                                               E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            * SEND_ENCAPSULATED_COMMAND and GET_ENCAPSULATED_RESPONSE are required          E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            * requests according to the CDC specification.                                  E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            * However, it is not really being used here, therefore a dummy buffer is        E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            * used for conformance.                                                         E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            */                                                                              E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                           #define dummy_length    0x08                                                     E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                           byte dummy_encapsulated_cmd_response[dummy_length];                              E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                                                                                            E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                           /** P R I V A T E  P R O T O T Y P E S ***************************************/  E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                                                                                            E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                           /** D E C L A R A T I O N S **************************************************/  E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                           #pragma code                                                                     E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                                                                                            E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                           /** C L A S S  S P E C I F I C  R E Q ****************************************/  E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                           /******************************************************************************  E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            * Function:        void USBCheckCDCRequest(void)                                E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            * PreCondition:    None                                                         E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            * Input:           None                                                         E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            * Output:          None                                                         E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            * Side Effects:    None                                                         E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            * Overview:        This routine checks the setup data packet to see if it       E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            *                  knows how to handle it                                       E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            * Note:            None                                                         E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            *****************************************************************************/  E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                           void USBCheckCDCRequest(void)                                                    E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                           {                                                                                E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                               /*                                                                           E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                * If request recipient is not an interface then return                      E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                */                                                                          E:\usb20\UIO\system\usb\class\cdc\cdc.c
00069a   0104     MOVLB     0x4                if(SetupPkt.Recipient != RCPT_INTF) return;                                  E:\usb20\UIO\system\usb\class\cdc\cdc.c
00069c   5120     MOVF      0x20,0x0,0x1                                                                                    
00069e   0b1f     ANDLW     0x1f                                                                                            
0006a0   0801     SUBLW     0x1                                                                                             
0006a2   e001     BZ        0x6a6                                                                                           
0006a4   d05b     BRA       0x75c                                                                                           
                                                                                                                            E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                               /*                                                                           E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                * If request type is not class-specific then return                         E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                */                                                                          E:\usb20\UIO\system\usb\class\cdc\cdc.c
0006a6   5120     MOVF      0x20,0x0,0x1       if(SetupPkt.RequestType != CLASS) return;                                    E:\usb20\UIO\system\usb\class\cdc\cdc.c
0006a8   0b60     ANDLW     0x60                                                                                            
0006aa   42e8     RRNCF     0xe8,0x1,0x0                                                                                    
0006ac   42e8     RRNCF     0xe8,0x1,0x0                                                                                    
0006ae   42e8     RRNCF     0xe8,0x1,0x0                                                                                    
0006b0   42e8     RRNCF     0xe8,0x1,0x0                                                                                    
0006b2   42e8     RRNCF     0xe8,0x1,0x0                                                                                    
0006b4   0801     SUBLW     0x1                                                                                             
0006b6   e001     BZ        0x6ba                                                                                           
0006b8   d051     BRA       0x75c                                                                                           
                                                                                                                            E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                               /*                                                                           E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                * Interface ID must match interface numbers associated with                 E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                * CDC class, else return                                                    E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                */                                                                          E:\usb20\UIO\system\usb\class\cdc\cdc.c
0006ba   5124     MOVF      0x24,0x0,0x1       if((SetupPkt.bIntfID != CDC_COMM_INTF_ID)&&                                  E:\usb20\UIO\system\usb\class\cdc\cdc.c
0006bc   e003     BZ        0x6c4                 (SetupPkt.bIntfID != CDC_DATA_INTF_ID)) return;                           E:\usb20\UIO\system\usb\class\cdc\cdc.c
0006be   0524     DECF      0x24,0x0,0x1                                                                                    
0006c0   e001     BZ        0x6c4                                                                                           
0006c2   d04c     BRA       0x75c                                                                                           
                                                                                                                            E:\usb20\UIO\system\usb\class\cdc\cdc.c
0006c4   5121     MOVF      0x21,0x0,0x1       switch(SetupPkt.bRequest)                                                    E:\usb20\UIO\system\usb\class\cdc\cdc.c
0006c6   0a23     XORLW     0x23                                                                                            
0006c8   e048     BZ        0x75a                                                                                           
0006ca   0a01     XORLW     0x1                                                                                             
0006cc   e040     BZ        0x74e                                                                                           
0006ce   0a03     XORLW     0x3                                                                                             
0006d0   e030     BZ        0x732                                                                                           
0006d2   0a01     XORLW     0x1                                                                                             
0006d4   e025     BZ        0x720                                                                                           
0006d6   0a24     XORLW     0x24                                                                                            
0006d8   e022     BZ        0x71e                                                                                           
0006da   0a07     XORLW     0x7                                                                                             
0006dc   e01f     BZ        0x71c                                                                                           
0006de   0a01     XORLW     0x1                                                                                             
0006e0   e01c     BZ        0x71a                                                                                           
0006e2   0a03     XORLW     0x3                                                                                             
0006e4   e011     BZ        0x708                                                                                           
0006e6   0a01     XORLW     0x1                                                                                             
0006e8   e001     BZ        0x6ec                                                                                           
                                               {                                                                            E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                   case SEND_ENCAPSULATED_COMMAND:                                          E:\usb20\UIO\system\usb\class\cdc\cdc.c
0006ec   0100     MOVLB     0x0                        ctrl_trf_session_owner = MUID_CDC;                                   E:\usb20\UIO\system\usb\class\cdc\cdc.c
0006ee   0e03     MOVLW     0x3                                                                                             
0006f0   6ff1     MOVWF     0xf1,0x1                                                                                        
0006f2   0100     MOVLB     0x0                        pSrc.bRam = (byte*)&dummy_encapsulated_cmd_response;                 E:\usb20\UIO\system\usb\class\cdc\cdc.c
0006f4   0e62     MOVLW     0x62                                                                                            
0006f6   6ff2     MOVWF     0xf2,0x1                                                                                        
0006f8   0e01     MOVLW     0x1                                                                                             
0006fa   6ff3     MOVWF     0xf3,0x1                                                                                        
0006fc   0100     MOVLB     0x0                        usb_stat.ctrl_trf_mem = _RAM;                                        E:\usb20\UIO\system\usb\class\cdc\cdc.c
0006fe   93f9     BCF       0xf9,0x1,0x1                                                                                    
000700   0100     MOVLB     0x0                        LSB(wCount) = dummy_length;                                          E:\usb20\UIO\system\usb\class\cdc\cdc.c
000702   0e08     MOVLW     0x8                                                                                             
000704   6ff6     MOVWF     0xf6,0x1                                                                                        
000706   d02a     BRA       0x75c                      break;                                                               E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                   case GET_ENCAPSULATED_RESPONSE:                                          E:\usb20\UIO\system\usb\class\cdc\cdc.c
000708   0100     MOVLB     0x0                        ctrl_trf_session_owner = MUID_CDC;                                   E:\usb20\UIO\system\usb\class\cdc\cdc.c
00070a   0e03     MOVLW     0x3                                                                                             
00070c   6ff1     MOVWF     0xf1,0x1                                                                                        
                                                       // Populate dummy_encapsulated_cmd_response first.                   E:\usb20\UIO\system\usb\class\cdc\cdc.c
00070e   0100     MOVLB     0x0                        pDst.bRam = (byte*)&dummy_encapsulated_cmd_response;                 E:\usb20\UIO\system\usb\class\cdc\cdc.c
000710   0e62     MOVLW     0x62                                                                                            
000712   6ff4     MOVWF     0xf4,0x1                                                                                        
000714   0e01     MOVLW     0x1                                                                                             
000716   6ff5     MOVWF     0xf5,0x1                                                                                        
000718   d021     BRA       0x75c                      break;                                                               E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                   case SET_COMM_FEATURE:                  // Optional                      E:\usb20\UIO\system\usb\class\cdc\cdc.c
00071a   d020     BRA       0x75c                      break;                                                               E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                   case GET_COMM_FEATURE:                  // Optional                      E:\usb20\UIO\system\usb\class\cdc\cdc.c
00071c   d01f     BRA       0x75c                      break;                                                               E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                   case CLEAR_COMM_FEATURE:                // Optional                      E:\usb20\UIO\system\usb\class\cdc\cdc.c
00071e   d01e     BRA       0x75c                      break;                                                               E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                   case SET_LINE_CODING:                                                    E:\usb20\UIO\system\usb\class\cdc\cdc.c
000720   0100     MOVLB     0x0                        ctrl_trf_session_owner = MUID_CDC;                                   E:\usb20\UIO\system\usb\class\cdc\cdc.c
000722   0e03     MOVLW     0x3                                                                                             
000724   6ff1     MOVWF     0xf1,0x1                                                                                        
000726   0100     MOVLB     0x0                        pDst.bRam = (byte*)&line_coding;    // Set destination               E:\usb20\UIO\system\usb\class\cdc\cdc.c
000728   0e57     MOVLW     0x57                                                                                            
00072a   6ff4     MOVWF     0xf4,0x1                                                                                        
00072c   0e01     MOVLW     0x1                                                                                             
00072e   6ff5     MOVWF     0xf5,0x1                                                                                        
000730   d015     BRA       0x75c                      break;                                                               E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                   case GET_LINE_CODING:                                                    E:\usb20\UIO\system\usb\class\cdc\cdc.c
000732   0100     MOVLB     0x0                        ctrl_trf_session_owner = MUID_CDC;                                   E:\usb20\UIO\system\usb\class\cdc\cdc.c
000734   0e03     MOVLW     0x3                                                                                             
000736   6ff1     MOVWF     0xf1,0x1                                                                                        
000738   0100     MOVLB     0x0                        pSrc.bRam = (byte*)&line_coding;    // Set source                    E:\usb20\UIO\system\usb\class\cdc\cdc.c
00073a   0e57     MOVLW     0x57                                                                                            
00073c   6ff2     MOVWF     0xf2,0x1                                                                                        
00073e   0e01     MOVLW     0x1                                                                                             
000740   6ff3     MOVWF     0xf3,0x1                                                                                        
000742   0100     MOVLB     0x0                        usb_stat.ctrl_trf_mem = _RAM;       // Set memory type               E:\usb20\UIO\system\usb\class\cdc\cdc.c
000744   93f9     BCF       0xf9,0x1,0x1                                                                                    
000746   0100     MOVLB     0x0                        LSB(wCount) = LINE_CODING_LENGTH;   // Set data count                E:\usb20\UIO\system\usb\class\cdc\cdc.c
000748   0e07     MOVLW     0x7                                                                                             
00074a   6ff6     MOVWF     0xf6,0x1                                                                                        
00074c   d007     BRA       0x75c                      break;                                                               E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                   case SET_CONTROL_LINE_STATE:                                             E:\usb20\UIO\system\usb\class\cdc\cdc.c
00074e   0100     MOVLB     0x0                        ctrl_trf_session_owner = MUID_CDC;                                   E:\usb20\UIO\system\usb\class\cdc\cdc.c
000750   0e03     MOVLW     0x3                                                                                             
000752   6ff1     MOVWF     0xf1,0x1                                                                                        
000754   c422     MOVFF     0x422,0x15e                control_signal_bitmap._byte = LSB(SetupPkt.W_Value);                 E:\usb20\UIO\system\usb\class\cdc\cdc.c
000756   f15e                                                                                                               
000758   d001     BRA       0x75c                      break;                                                               E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                   case SEND_BREAK:                        // Optional                      E:\usb20\UIO\system\usb\class\cdc\cdc.c
00075a   d000     BRA       0x75c                      break;                                                               E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                   default:                                                                 E:\usb20\UIO\system\usb\class\cdc\cdc.c
0006ea   d038     BRA       0x75c                      break;                                                               E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                               }//end switch(SetupPkt.bRequest)                                             E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                                                                                            E:\usb20\UIO\system\usb\class\cdc\cdc.c
00075c   0012     RETURN    0x0            }//end USBCheckCDCRequest                                                        E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                                                                                            E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                           /** U S E R  A P I ***********************************************************/  E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                                                                                            E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                           /******************************************************************************  E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            * Function:        void CDCInitEP(void)                                         E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            * PreCondition:    None                                                         E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            * Input:           None                                                         E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            * Output:          None                                                         E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            * Side Effects:    None                                                         E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            * Overview:        CDCInitEP initializes CDC endpoints, buffer descriptors,     E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            *                  internal state-machine, and variables.                       E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            *                  It should be called after the USB host has sent out a        E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            *                  SET_CONFIGURATION request.                                   E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            *                  See USBStdSetCfgHandler() in usb9.c for examples.            E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            * Note:            None                                                         E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            *****************************************************************************/  E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                           void CDCInitEP(void)                                                             E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                           {                                                                                E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                               //Abstract line coding information                                           E:\usb20\UIO\system\usb\class\cdc\cdc.c
00075e   0101     MOVLB     0x1                line_coding.dwDTERate._dword = 115200;      // baud rate                     E:\usb20\UIO\system\usb\class\cdc\cdc.c
000760   6b57     CLRF      0x57,0x1                                                                                        
000762   0ec2     MOVLW     0xc2                                                                                            
000764   6f58     MOVWF     0x58,0x1                                                                                        
000766   0e01     MOVLW     0x1                                                                                             
000768   6f59     MOVWF     0x59,0x1                                                                                        
00076a   6b5a     CLRF      0x5a,0x1                                                                                        
00076c   6b5b     CLRF      0x5b,0x1           line_coding.bCharFormat = 0x00;             // 1 stop bit                    E:\usb20\UIO\system\usb\class\cdc\cdc.c
00076e   6b5c     CLRF      0x5c,0x1           line_coding.bParityType = 0x00;             // None                          E:\usb20\UIO\system\usb\class\cdc\cdc.c
000770   0e08     MOVLW     0x8                line_coding.bDataBits = 0x08;               // 5,6,7,8, or 16                E:\usb20\UIO\system\usb\class\cdc\cdc.c
000772   6f5d     MOVWF     0x5d,0x1                                                                                        
                                                                                                                            E:\usb20\UIO\system\usb\class\cdc\cdc.c
000774   6b50     CLRF      0x50,0x1           cdc_trf_state = CDC_TX_READY;                                                E:\usb20\UIO\system\usb\class\cdc\cdc.c
000776   6b4f     CLRF      0x4f,0x1           cdc_rx_len = 0;                                                              E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                                                                                            E:\usb20\UIO\system\usb\class\cdc\cdc.c
000778   0e1a     MOVLW     0x1a               CDC_COMM_UEP = EP_IN|HSHK_EN;               // Enable 1 Comm pipe            E:\usb20\UIO\system\usb\class\cdc\cdc.c
00077a   6e72     MOVWF     0x72,0x0                                                                                        
00077c   0e1e     MOVLW     0x1e               CDC_DATA_UEP = EP_OUT_IN|HSHK_EN;           // Enable 2 data pipes           E:\usb20\UIO\system\usb\class\cdc\cdc.c
00077e   6e73     MOVWF     0x73,0x0                                                                                        
                                                                                                                            E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                               /*                                                                           E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                * Do not have to init Cnt of IN pipes here.                                 E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                * Reason:  Number of bytes to send to the host                              E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                *          varies from one transaction to                                   E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                *          another. Cnt should equal the exact                              E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                *          number of bytes to transmit for                                  E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                *          a given IN transaction.                                          E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                *          This number of bytes will only                                   E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                *          be known right before the data is                                E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                *          sent.                                                            E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                */                                                                          E:\usb20\UIO\system\usb\class\cdc\cdc.c
000780   0104     MOVLB     0x4                CDC_INT_BD_IN.ADR = (byte*)&cdc_notice;     // Set buffer address            E:\usb20\UIO\system\usb\class\cdc\cdc.c
000782   0e00     MOVLW     0x0                                                                                             
000784   6f16     MOVWF     0x16,0x1                                                                                        
000786   0e05     MOVLW     0x5                                                                                             
000788   6f17     MOVWF     0x17,0x1                                                                                        
00078a   0e40     MOVLW     0x40               CDC_INT_BD_IN.Stat._byte = _UCPU|_DAT1;     // Set status                    E:\usb20\UIO\system\usb\class\cdc\cdc.c
00078c   6f14     MOVWF     0x14,0x1                                                                                        
                                                                                                                            E:\usb20\UIO\system\usb\class\cdc\cdc.c
00078e   0104     MOVLB     0x4                CDC_BULK_BD_OUT.Cnt = sizeof(cdc_data_rx);  // Set buffer size               E:\usb20\UIO\system\usb\class\cdc\cdc.c
000790   6f19     MOVWF     0x19,0x1                                                                                        
000792   0e08     MOVLW     0x8                CDC_BULK_BD_OUT.ADR = (byte*)&cdc_data_rx;  // Set buffer address            E:\usb20\UIO\system\usb\class\cdc\cdc.c
000794   6f1a     MOVWF     0x1a,0x1                                                                                        
000796   0e05     MOVLW     0x5                                                                                             
000798   6f1b     MOVWF     0x1b,0x1                                                                                        
00079a   0e88     MOVLW     0x88               CDC_BULK_BD_OUT.Stat._byte = _USIE|_DAT0|_DTSEN;// Set status                E:\usb20\UIO\system\usb\class\cdc\cdc.c
00079c   6f18     MOVWF     0x18,0x1                                                                                        
                                                                                                                            E:\usb20\UIO\system\usb\class\cdc\cdc.c
00079e   0104     MOVLB     0x4                CDC_BULK_BD_IN.ADR = (byte*)&cdc_data_tx;   // Set buffer size               E:\usb20\UIO\system\usb\class\cdc\cdc.c
0007a0   0e48     MOVLW     0x48                                                                                            
0007a2   6f1e     MOVWF     0x1e,0x1                                                                                        
0007a4   0e05     MOVLW     0x5                                                                                             
0007a6   6f1f     MOVWF     0x1f,0x1                                                                                        
0007a8   0e40     MOVLW     0x40               CDC_BULK_BD_IN.Stat._byte = _UCPU|_DAT1;    // Set buffer address            E:\usb20\UIO\system\usb\class\cdc\cdc.c
0007aa   6f1c     MOVWF     0x1c,0x1                                                                                        
                                                                                                                            E:\usb20\UIO\system\usb\class\cdc\cdc.c
0007ac   0012     RETURN    0x0            }//end CDCInitEP                                                                 E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                                                                                            E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                           /******************************************************************************  E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            * Function:        byte getsUSBUSART(char *buffer,                              E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            *                                    byte len)                                  E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            * PreCondition:    Value of input argument 'len' should be smaller than the     E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            *                  maximum endpoint size responsible for receiving bulk         E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            *                  data from USB host for CDC class.                            E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            *                  Input argument 'buffer' should point to a buffer area that   E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            *                  is bigger or equal to the size specified by 'len'.           E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            * Input:           buffer  : Pointer to where received bytes are to be stored   E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            *                  len     : The number of bytes expected.                      E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            * Output:          The number of bytes copied to buffer.                        E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            * Side Effects:    Publicly accessible variable cdc_rx_len is updated with      E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            *                  the number of bytes copied to buffer.                        E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            *                  Once getsUSBUSART is called, subsequent retrieval of         E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            *                  cdc_rx_len can be done by calling macro mCDCGetRxLength().   E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            * Overview:        getsUSBUSART copies a string of bytes received through       E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            *                  USB CDC Bulk OUT endpoint to a user's specified location.    E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            *                  It is a non-blocking function. It does not wait              E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            *                  for data if there is no data available. Instead it returns   E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            *                  '0' to notify the caller that there is no data available.    E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            * Note:            If the actual number of bytes received is larger than the    E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            *                  number of bytes expected (len), only the expected number     E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            *                  of bytes specified will be copied to buffer.                 E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            *                  If the actual number of bytes received is smaller than the   E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            *                  number of bytes expected (len), only the actual number       E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            *                  of bytes received will be copied to buffer.                  E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            *****************************************************************************/  E:\usb20\UIO\system\usb\class\cdc\cdc.c
0007ae   cfd9     MOVFF     0xfd9,0xfe6    byte getsUSBUSART(char *buffer, byte len)                                        E:\usb20\UIO\system\usb\class\cdc\cdc.c
0007b0   ffe6                                                                                                               
0007b2   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
0007b4   ffd9                                                                                                               
                                           {                                                                                E:\usb20\UIO\system\usb\class\cdc\cdc.c
0007b6   0101     MOVLB     0x1                cdc_rx_len = 0;                                                              E:\usb20\UIO\system\usb\class\cdc\cdc.c
0007b8   6b4f     CLRF      0x4f,0x1                                                                                        
                                                                                                                            E:\usb20\UIO\system\usb\class\cdc\cdc.c
0007ba   0104     MOVLB     0x4                if(!mCDCUsartRxIsBusy())                                                     E:\usb20\UIO\system\usb\class\cdc\cdc.c
0007bc   bf18     BTFSC     0x18,0x7,0x1                                                                                    
0007be   d030     BRA       0x820                                                                                           
                                               {                                                                            E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                   /*                                                                       E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                    * Adjust the expected number of bytes to equal                          E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                    * the actual number of bytes received.                                  E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                    */                                                                      E:\usb20\UIO\system\usb\class\cdc\cdc.c
0007c0   0efc     MOVLW     0xfc                   if(len > CDC_BULK_BD_OUT.Cnt)                                            E:\usb20\UIO\system\usb\class\cdc\cdc.c
0007c2   cfdb     MOVFF     0xfdb,0x14                                                                                      
0007c4   f014                                                                                                               
0007c6   5119     MOVF      0x19,0x0,0x1                                                                                    
0007c8   80d8     BSF       0xd8,0x0,0x0                                                                                    
0007ca   5414     SUBFWB    0x14,0x0,0x0                                                                                    
0007cc   e203     BC        0x7d4                                                                                           
0007ce   0efc     MOVLW     0xfc                       len = CDC_BULK_BD_OUT.Cnt;                                           E:\usb20\UIO\system\usb\class\cdc\cdc.c
0007d0   c419     MOVFF     0x419,0xfdb                                                                                     
0007d2   ffdb                                                                                                               
                                                                                                                            E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                   /*                                                                       E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                    * Copy data from dual-ram buffer to user's buffer                       E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                    */                                                                      E:\usb20\UIO\system\usb\class\cdc\cdc.c
0007d4   0101     MOVLB     0x1                    for(cdc_rx_len = 0; cdc_rx_len < len; cdc_rx_len++)                      E:\usb20\UIO\system\usb\class\cdc\cdc.c
0007d6   6b4f     CLRF      0x4f,0x1                                                                                        
0007d8   0efc     MOVLW     0xfc                                                                                            
0007da   50db     MOVF      0xdb,0x0,0x0                                                                                    
0007dc   5d4f     SUBWF     0x4f,0x0,0x1                                                                                    
0007de   e219     BC        0x812                                                                                           
00080e   2b4f     INCF      0x4f,0x1,0x1                                                                                    
000810   d7e3     BRA       0x7d8                                                                                           
0007e0   514f     MOVF      0x4f,0x0,0x1               buffer[cdc_rx_len] = cdc_data_rx[cdc_rx_len];                        E:\usb20\UIO\system\usb\class\cdc\cdc.c
0007e2   6aea     CLRF      0xea,0x0                                                                                        
0007e4   0f08     ADDLW     0x8                                                                                             
0007e6   6ee9     MOVWF     0xe9,0x0                                                                                        
0007e8   0e05     MOVLW     0x5                                                                                             
0007ea   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
0007ec   50ef     MOVF      0xef,0x0,0x0                                                                                    
0007ee   6ee6     MOVWF     0xe6,0x0                                                                                        
0007f0   514f     MOVF      0x4f,0x0,0x1                                                                                    
0007f2   6ee7     MOVWF     0xe7,0x0                                                                                        
0007f4   0efd     MOVLW     0xfd                                                                                            
0007f6   cfdb     MOVFF     0xfdb,0xfe9                                                                                     
0007f8   ffe9                                                                                                               
0007fa   0efe     MOVLW     0xfe                                                                                            
0007fc   cfdb     MOVFF     0xfdb,0xfea                                                                                     
0007fe   ffea                                                                                                               
000800   50e7     MOVF      0xe7,0x0,0x0                                                                                    
000802   26e9     ADDWF     0xe9,0x1,0x0                                                                                    
000804   0e00     MOVLW     0x0                                                                                             
000806   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
000808   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00080a   50e7     MOVF      0xe7,0x0,0x0                                                                                    
00080c   6eef     MOVWF     0xef,0x0                                                                                        
                                                                                                                            E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                   /*                                                                       E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                    * Prepare dual-ram buffer for next OUT transaction                      E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                    */                                                                      E:\usb20\UIO\system\usb\class\cdc\cdc.c
000812   0104     MOVLB     0x4                    CDC_BULK_BD_OUT.Cnt = sizeof(cdc_data_rx);                               E:\usb20\UIO\system\usb\class\cdc\cdc.c
000814   0e40     MOVLW     0x40                                                                                            
000816   6f19     MOVWF     0x19,0x1                                                                                        
000818   1718     ANDWF     0x18,0x1,0x1           mUSBBufferReady(CDC_BULK_BD_OUT);                                        E:\usb20\UIO\system\usb\class\cdc\cdc.c
00081a   7d18     BTG       0x18,0x6,0x1                                                                                    
00081c   0e88     MOVLW     0x88                                                                                            
00081e   1318     IORWF     0x18,0x1,0x1                                                                                    
                                               }//end if                                                                    E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                                                                                            E:\usb20\UIO\system\usb\class\cdc\cdc.c
000820   0101     MOVLB     0x1                return cdc_rx_len;                                                           E:\usb20\UIO\system\usb\class\cdc\cdc.c
000822   514f     MOVF      0x4f,0x0,0x1                                                                                    
000824   d000     BRA       0x826                                                                                           
                                                                                                                            E:\usb20\UIO\system\usb\class\cdc\cdc.c
000826   52e5     MOVF      0xe5,0x1,0x0   }//end getsUSBUSART                                                              E:\usb20\UIO\system\usb\class\cdc\cdc.c
000828   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
00082a   ffd9                                                                                                               
00082c   0012     RETURN    0x0                                                                                             
                                                                                                                            E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                           /******************************************************************************  E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            * Function:        void putsUSBUSART(char *data)                                E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            * PreCondition:    cdc_trf_state must be in the CDC_TX_READY state.             E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            *                  The string of characters pointed to by 'data' must equal     E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            *                  to or smaller than 255 bytes.                                E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            * Input:           data    : Pointer to a null-terminated string of data.       E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            *                            If a null character is not found, 255 bytes        E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            *                            of data will be transferred to the host.           E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            * Output:          None                                                         E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            * Side Effects:    None                                                         E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            * Overview:        putsUSBUSART writes a string of data to the USB including    E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            *                  the null character. Use this version, 'puts', to transfer    E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            *                  data located in data memory.                                 E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            * Note:            The transfer mechanism for device-to-host(put) is more       E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            *                  flexible than host-to-device(get). It can handle             E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            *                  a string of data larger than the maximum size of bulk IN     E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            *                  endpoint. A state machine is used to transfer a long         E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            *                  string of data over multiple USB transactions.               E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            *                  See CDCTxService() for more details.                         E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            *****************************************************************************/  E:\usb20\UIO\system\usb\class\cdc\cdc.c
00082e   cfd9     MOVFF     0xfd9,0xfe6    void putsUSBUSART(char *data)                                                    E:\usb20\UIO\system\usb\class\cdc\cdc.c
000830   ffe6                                                                                                               
000832   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
000834   ffd9                                                                                                               
000836   52e6     MOVF      0xe6,0x1,0x0                                                                                    
                                           {                                                                                E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                               byte len;                                                                    E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                                                                                            E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                               /*                                                                           E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                * User should have checked that cdc_trf_state is in CDC_TX_READY state      E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                * before calling this function.                                             E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                * As a safety precaution, this fuction checks the state one more time       E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                * to make sure it does not override any pending transactions.               E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                *                                                                           E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                * Currently it just quits the routine without reporting any errors back     E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                * to the user.                                                              E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                *                                                                           E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                * Bottomline: User MUST make sure that mUSBUSARTIsTxTrfReady()==1           E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                *             before calling this function!                                 E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                * Example:                                                                  E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                * if(mUSBUSARTIsTxTrfReady())                                               E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                *     putsUSBUSART(pData);                                                  E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                *                                                                           E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                * IMPORTANT: Never use the following blocking while loop to wait:           E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                * while(!mUSBUSARTIsTxTrfReady())                                           E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                *     putsUSBUSART(pData);                                                  E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                *                                                                           E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                * The whole firmware framework is written based on cooperative              E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                * multi-tasking and a blocking code is not acceptable.                      E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                * Use a state machine instead.                                              E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                */                                                                          E:\usb20\UIO\system\usb\class\cdc\cdc.c
000838   0101     MOVLB     0x1                if(cdc_trf_state != CDC_TX_READY) return;                                    E:\usb20\UIO\system\usb\class\cdc\cdc.c
00083a   5150     MOVF      0x50,0x0,0x1                                                                                    
00083c   e001     BZ        0x840                                                                                           
00083e   d02f     BRA       0x89e                                                                                           
                                                                                                                            E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                               /*                                                                           E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                * While loop counts the number of bytes to send including the               E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                * null character.                                                           E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                */                                                                          E:\usb20\UIO\system\usb\class\cdc\cdc.c
000840   6adf     CLRF      0xdf,0x0           len = 0;                                                                     E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                               do                                                                           E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                               {                                                                            E:\usb20\UIO\system\usb\class\cdc\cdc.c
000842   2adf     INCF      0xdf,0x1,0x0           len++;                                                                   E:\usb20\UIO\system\usb\class\cdc\cdc.c
000844   50df     MOVF      0xdf,0x0,0x0           if(len == 255) break;       // Break loop once max len is reached.       E:\usb20\UIO\system\usb\class\cdc\cdc.c
000846   6e14     MOVWF     0x14,0x0                                                                                        
000848   6a15     CLRF      0x15,0x0                                                                                        
00084a   0eff     MOVLW     0xff                                                                                            
00084c   1814     XORWF     0x14,0x0,0x0                                                                                    
00084e   e101     BNZ       0x852                                                                                           
000850   5015     MOVF      0x15,0x0,0x0                                                                                    
000852   e101     BNZ       0x856                                                                                           
000854   d00b     BRA       0x86c                                                                                           
000856   0efd     MOVLW     0xfd               }while(*data++);                                                             E:\usb20\UIO\system\usb\class\cdc\cdc.c
000858   cfdb     MOVFF     0xfdb,0xfe9                                                                                     
00085a   ffe9                                                                                                               
00085c   2adb     INCF      0xdb,0x1,0x0                                                                                    
00085e   0efe     MOVLW     0xfe                                                                                            
000860   cfdb     MOVFF     0xfdb,0xfea                                                                                     
000862   ffea                                                                                                               
000864   e301     BNC       0x868                                                                                           
000866   2adb     INCF      0xdb,0x1,0x0                                                                                    
000868   50ef     MOVF      0xef,0x0,0x0                                                                                    
00086a   e1eb     BNZ       0x842                                                                                           
                                                                                                                            E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                               /*                                                                           E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                * Re-adjust pointer to its initial location                                 E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                */                                                                          E:\usb20\UIO\system\usb\class\cdc\cdc.c
00086c   50df     MOVF      0xdf,0x0,0x0       data-=len;                                                                   E:\usb20\UIO\system\usb\class\cdc\cdc.c
00086e   6e14     MOVWF     0x14,0x0                                                                                        
000870   6a15     CLRF      0x15,0x0                                                                                        
000872   50d9     MOVF      0xd9,0x0,0x0                                                                                    
000874   0ffd     ADDLW     0xfd                                                                                            
000876   6ee9     MOVWF     0xe9,0x0                                                                                        
000878   0eff     MOVLW     0xff                                                                                            
00087a   20da     ADDWFC    0xda,0x0,0x0                                                                                    
00087c   6eea     MOVWF     0xea,0x0                                                                                        
00087e   5014     MOVF      0x14,0x0,0x0                                                                                    
000880   5eee     SUBWF     0xee,0x1,0x0                                                                                    
000882   5015     MOVF      0x15,0x0,0x0                                                                                    
000884   5aed     SUBWFB    0xed,0x1,0x0                                                                                    
                                                                                                                            E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                               /*                                                                           E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                * Second piece of information (length of data to send) is ready.            E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                * Call mUSBUSARTTxRam to setup the transfer.                                E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                * The actual transfer process will be handled by CDCTxService(),            E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                * which should be called once per Main Program loop.                        E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                */                                                                          E:\usb20\UIO\system\usb\class\cdc\cdc.c
000886   0efd     MOVLW     0xfd               mUSBUSARTTxRam((byte*)data,len);     // See cdc.h                            E:\usb20\UIO\system\usb\class\cdc\cdc.c
000888   cfdb     MOVFF     0xfdb,0x151                                                                                     
00088a   f151                                                                                                               
00088c   0efe     MOVLW     0xfe                                                                                            
00088e   cfdb     MOVFF     0xfdb,0x152                                                                                     
000890   f152                                                                                                               
000892   cfdf     MOVFF     0xfdf,0x155                                                                                     
000894   f155                                                                                                               
000896   0101     MOVLB     0x1                                                                                             
000898   6b56     CLRF      0x56,0x1                                                                                        
00089a   0e01     MOVLW     0x1                                                                                             
00089c   6f50     MOVWF     0x50,0x1                                                                                        
00089e   52e5     MOVF      0xe5,0x1,0x0   }//end putsUSBUSART                                                              E:\usb20\UIO\system\usb\class\cdc\cdc.c
0008a0   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0008a2   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
0008a4   ffd9                                                                                                               
0008a6   0012     RETURN    0x0                                                                                             
                                                                                                                            E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                           /******************************************************************************  E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            * Function:        void putrsUSBUSART(const rom char *data)                     E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            * PreCondition:    cdc_trf_state must be in the CDC_TX_READY state.             E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            *                  The string of characters pointed to by 'data' must equal     E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            *                  to or smaller than 255 bytes.                                E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            * Input:           data    : Pointer to a null-terminated string of data.       E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            *                            If a null character is not found, 255 bytes        E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            *                            of data will be transferred to the host.           E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            * Output:          None                                                         E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            * Side Effects:    None                                                         E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            * Overview:        putrsUSBUSART writes a string of data to the USB including   E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            *                  the null character. Use this version, 'putrs', to transfer   E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            *                  data literals and data located in program memory.            E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            * Note:            The transfer mechanism for device-to-host(put) is more       E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            *                  flexible than host-to-device(get). It can handle             E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            *                  a string of data larger than the maximum size of bulk IN     E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            *                  endpoint. A state machine is used to transfer a long         E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            *                  string of data over multiple USB transactions.               E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            *                  See CDCTxService() for more details.                         E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            *****************************************************************************/  E:\usb20\UIO\system\usb\class\cdc\cdc.c
0008a8   cfd9     MOVFF     0xfd9,0xfe6    void putrsUSBUSART(const rom char *data)                                         E:\usb20\UIO\system\usb\class\cdc\cdc.c
0008aa   ffe6                                                                                                               
0008ac   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
0008ae   ffd9                                                                                                               
0008b0   52e6     MOVF      0xe6,0x1,0x0                                                                                    
                                           {                                                                                E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                               byte len;                                                                    E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                                                                                            E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                               /*                                                                           E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                * User should have checked that cdc_trf_state is in CDC_TX_READY state      E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                * before calling this function.                                             E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                * As a safety precaution, this fuction checks the state one more time       E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                * to make sure it does not override any pending transactions.               E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                *                                                                           E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                * Currently it just quits the routine without reporting any errors back     E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                * to the user.                                                              E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                *                                                                           E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                * Bottomline: User MUST make sure that mUSBUSARTIsTxTrfReady()              E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                *             before calling this function!                                 E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                * Example:                                                                  E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                * if(mUSBUSARTIsTxTrfReady())                                               E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                *     putsUSBUSART(pData);                                                  E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                *                                                                           E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                * IMPORTANT: Never use the following blocking while loop to wait:           E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                * while(cdc_trf_state != CDC_TX_READY)                                      E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                *     putsUSBUSART(pData);                                                  E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                *                                                                           E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                * The whole firmware framework is written based on cooperative              E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                * multi-tasking and a blocking code is not acceptable.                      E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                * Use a state machine instead.                                              E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                */                                                                          E:\usb20\UIO\system\usb\class\cdc\cdc.c
0008b2   0101     MOVLB     0x1                if(cdc_trf_state != CDC_TX_READY) return;                                    E:\usb20\UIO\system\usb\class\cdc\cdc.c
0008b4   5150     MOVF      0x50,0x0,0x1                                                                                    
0008b6   e001     BZ        0x8ba                                                                                           
0008b8   d030     BRA       0x91a                                                                                           
                                                                                                                            E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                               /*                                                                           E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                * While loop counts the number of bytes to send including the               E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                * null character.                                                           E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                */                                                                          E:\usb20\UIO\system\usb\class\cdc\cdc.c
0008ba   6adf     CLRF      0xdf,0x0           len = 0;                                                                     E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                               do                                                                           E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                               {                                                                            E:\usb20\UIO\system\usb\class\cdc\cdc.c
0008bc   2adf     INCF      0xdf,0x1,0x0           len++;                                                                   E:\usb20\UIO\system\usb\class\cdc\cdc.c
0008be   50df     MOVF      0xdf,0x0,0x0           if(len == 255) break;       // Break loop once max len is reached.       E:\usb20\UIO\system\usb\class\cdc\cdc.c
0008c0   6e14     MOVWF     0x14,0x0                                                                                        
0008c2   6a15     CLRF      0x15,0x0                                                                                        
0008c4   0eff     MOVLW     0xff                                                                                            
0008c6   1814     XORWF     0x14,0x0,0x0                                                                                    
0008c8   e101     BNZ       0x8cc                                                                                           
0008ca   5015     MOVF      0x15,0x0,0x0                                                                                    
0008cc   e101     BNZ       0x8d0                                                                                           
0008ce   d00c     BRA       0x8e8                                                                                           
0008d0   0efd     MOVLW     0xfd               }while(*data++);                                                             E:\usb20\UIO\system\usb\class\cdc\cdc.c
0008d2   cfdb     MOVFF     0xfdb,0xff6                                                                                     
0008d4   fff6                                                                                                               
0008d6   2adb     INCF      0xdb,0x1,0x0                                                                                    
0008d8   0efe     MOVLW     0xfe                                                                                            
0008da   cfdb     MOVFF     0xfdb,0xff7                                                                                     
0008dc   fff7                                                                                                               
0008de   e301     BNC       0x8e2                                                                                           
0008e0   2adb     INCF      0xdb,0x1,0x0                                                                                    
0008e2   0008     TBLRD                                                                                                     
0008e4   50f5     MOVF      0xf5,0x0,0x0                                                                                    
0008e6   e1ea     BNZ       0x8bc                                                                                           
                                                                                                                            E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                               /*                                                                           E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                * Re-adjust pointer to its initial location                                 E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                */                                                                          E:\usb20\UIO\system\usb\class\cdc\cdc.c
0008e8   50df     MOVF      0xdf,0x0,0x0       data-=len;                                                                   E:\usb20\UIO\system\usb\class\cdc\cdc.c
0008ea   6e14     MOVWF     0x14,0x0                                                                                        
0008ec   6a15     CLRF      0x15,0x0                                                                                        
0008ee   50d9     MOVF      0xd9,0x0,0x0                                                                                    
0008f0   0ffd     ADDLW     0xfd                                                                                            
0008f2   6ee9     MOVWF     0xe9,0x0                                                                                        
0008f4   0eff     MOVLW     0xff                                                                                            
0008f6   20da     ADDWFC    0xda,0x0,0x0                                                                                    
0008f8   6eea     MOVWF     0xea,0x0                                                                                        
0008fa   5014     MOVF      0x14,0x0,0x0                                                                                    
0008fc   5eee     SUBWF     0xee,0x1,0x0                                                                                    
0008fe   5015     MOVF      0x15,0x0,0x0                                                                                    
000900   5aed     SUBWFB    0xed,0x1,0x0                                                                                    
                                                                                                                            E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                               /*                                                                           E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                * Second piece of information (length of data to send) is ready.            E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                * Call mUSBUSARTTxRom to setup the transfer.                                E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                * The actual transfer process will be handled by CDCTxService(),            E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                * which should be called once per Main Program loop.                        E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                */                                                                          E:\usb20\UIO\system\usb\class\cdc\cdc.c
000902   0efd     MOVLW     0xfd               mUSBUSARTTxRom((rom byte*)data,len); // See cdc.h                            E:\usb20\UIO\system\usb\class\cdc\cdc.c
000904   cfdb     MOVFF     0xfdb,0x151                                                                                     
000906   f151                                                                                                               
000908   0efe     MOVLW     0xfe                                                                                            
00090a   cfdb     MOVFF     0xfdb,0x152                                                                                     
00090c   f152                                                                                                               
00090e   cfdf     MOVFF     0xfdf,0x155                                                                                     
000910   f155                                                                                                               
000912   0101     MOVLB     0x1                                                                                             
000914   0e01     MOVLW     0x1                                                                                             
000916   6f56     MOVWF     0x56,0x1                                                                                        
000918   6f50     MOVWF     0x50,0x1                                                                                        
                                                                                                                            E:\usb20\UIO\system\usb\class\cdc\cdc.c
00091a   52e5     MOVF      0xe5,0x1,0x0   }//end putrsUSBUSART                                                             E:\usb20\UIO\system\usb\class\cdc\cdc.c
00091c   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00091e   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
000920   ffd9                                                                                                               
000922   0012     RETURN    0x0                                                                                             
                                                                                                                            E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                           /******************************************************************************  E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            * Function:        void CDCTxService(void)                                      E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            * PreCondition:    None                                                         E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            * Input:           None                                                         E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            * Output:          None                                                         E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            * Side Effects:    None                                                         E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            * Overview:        CDCTxService handles device-to-host transaction(s).          E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            *                  This function should be called once per Main Program loop.   E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            *                                                                               E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            * Note:            None                                                         E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                            *****************************************************************************/  E:\usb20\UIO\system\usb\class\cdc\cdc.c
000924   cfd9     MOVFF     0xfd9,0xfe6    void CDCTxService(void)                                                          E:\usb20\UIO\system\usb\class\cdc\cdc.c
000926   ffe6                                                                                                               
000928   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
00092a   ffd9                                                                                                               
00092c   52e6     MOVF      0xe6,0x1,0x0                                                                                    
                                           {                                                                                E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                               byte byte_to_send;                                                           E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                                                                                            E:\usb20\UIO\system\usb\class\cdc\cdc.c
00092e   0104     MOVLB     0x4                if(mCDCUsartTxIsBusy()) return;                                              E:\usb20\UIO\system\usb\class\cdc\cdc.c
000930   bf1c     BTFSC     0x1c,0x7,0x1                                                                                    
000932   d06b     BRA       0xa0a                                                                                           
                                               /*                                                                           E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                * Completing stage is necessary while [ mCDCUSartTxIsBusy()==1 ].           E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                * By having this stage, user can always check cdc_trf_state,                E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                * and not having to call mCDCUsartTxIsBusy() directly.                      E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                */                                                                          E:\usb20\UIO\system\usb\class\cdc\cdc.c
000934   0e03     MOVLW     0x3                if(cdc_trf_state == CDC_TX_COMPLETING)                                       E:\usb20\UIO\system\usb\class\cdc\cdc.c
000936   0101     MOVLB     0x1                                                                                             
000938   5d50     SUBWF     0x50,0x0,0x1                                                                                    
00093a   e101     BNZ       0x93e                                                                                           
00093c   6b50     CLRF      0x50,0x1               cdc_trf_state = CDC_TX_READY;                                            E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                                                                                            E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                               /*                                                                           E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                * If CDC_TX_READY state, nothing to do, just return.                        E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                */                                                                          E:\usb20\UIO\system\usb\class\cdc\cdc.c
00093e   5150     MOVF      0x50,0x0,0x1       if(cdc_trf_state == CDC_TX_READY) return;                                    E:\usb20\UIO\system\usb\class\cdc\cdc.c
000940   e101     BNZ       0x944                                                                                           
000942   d063     BRA       0xa0a                                                                                           
                                                                                                                            E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                               /*                                                                           E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                * If CDC_TX_BUSY_ZLP state, send zero length packet                         E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                */                                                                          E:\usb20\UIO\system\usb\class\cdc\cdc.c
000944   0e02     MOVLW     0x2                if(cdc_trf_state == CDC_TX_BUSY_ZLP)                                         E:\usb20\UIO\system\usb\class\cdc\cdc.c
000946   5d50     SUBWF     0x50,0x0,0x1                                                                                    
000948   e106     BNZ       0x956                                                                                           
                                               {                                                                            E:\usb20\UIO\system\usb\class\cdc\cdc.c
00094a   0104     MOVLB     0x4                    CDC_BULK_BD_IN.Cnt = 0;                                                  E:\usb20\UIO\system\usb\class\cdc\cdc.c
00094c   6b1d     CLRF      0x1d,0x1                                                                                        
00094e   0101     MOVLB     0x1                    cdc_trf_state = CDC_TX_COMPLETING;                                       E:\usb20\UIO\system\usb\class\cdc\cdc.c
000950   0e03     MOVLW     0x3                                                                                             
000952   6f50     MOVWF     0x50,0x1                                                                                        
                                               }                                                                            E:\usb20\UIO\system\usb\class\cdc\cdc.c
000954   d054     BRA       0x9fe              else if(cdc_trf_state == CDC_TX_BUSY)                                        E:\usb20\UIO\system\usb\class\cdc\cdc.c
000956   0550     DECF      0x50,0x0,0x1                                                                                    
000958   e152     BNZ       0x9fe                                                                                           
                                               {                                                                            E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                   /*                                                                       E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                    * First, have to figure out how many byte of data to send.              E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                    */                                                                      E:\usb20\UIO\system\usb\class\cdc\cdc.c
00095a   0e40     MOVLW     0x40               	if(cdc_tx_len > sizeof(cdc_data_tx))                                        E:\usb20\UIO\system\usb\class\cdc\cdc.c
00095c   6e14     MOVWF     0x14,0x0                                                                                        
00095e   6a15     CLRF      0x15,0x0                                                                                        
000960   5155     MOVF      0x55,0x0,0x1                                                                                    
000962   5c14     SUBWF     0x14,0x0,0x0                                                                                    
000964   0e00     MOVLW     0x0                                                                                             
000966   5815     SUBWFB    0x15,0x0,0x0                                                                                    
000968   e203     BC        0x970                                                                                           
00096a   0e40     MOVLW     0x40               	    byte_to_send = sizeof(cdc_data_tx);                                     E:\usb20\UIO\system\usb\class\cdc\cdc.c
00096c   6edf     MOVWF     0xdf,0x0                                                                                        
00096e   d002     BRA       0x974              	else                                                                        E:\usb20\UIO\system\usb\class\cdc\cdc.c
000970   c155     MOVFF     0x155,0xfdf        	    byte_to_send = cdc_tx_len;                                              E:\usb20\UIO\system\usb\class\cdc\cdc.c
000972   ffdf                                                                                                               
                                                                                                                            E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                   /*                                                                       E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                    * Next, load the number of bytes to send to Cnt in buffer descriptor    E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                    */                                                                      E:\usb20\UIO\system\usb\class\cdc\cdc.c
000974   cfdf     MOVFF     0xfdf,0x41d            CDC_BULK_BD_IN.Cnt = byte_to_send;                                       E:\usb20\UIO\system\usb\class\cdc\cdc.c
000976   f41d                                                                                                               
                                                                                                                            E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                   /*                                                                       E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                    * Subtract the number of bytes just about to be sent from the total.    E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                    */                                                                      E:\usb20\UIO\system\usb\class\cdc\cdc.c
000978   50df     MOVF      0xdf,0x0,0x0       	cdc_tx_len = cdc_tx_len - byte_to_send;                                     E:\usb20\UIO\system\usb\class\cdc\cdc.c
00097a   5d55     SUBWF     0x55,0x0,0x1                                                                                    
00097c   6f55     MOVWF     0x55,0x1                                                                                        
                                               	                                                                            E:\usb20\UIO\system\usb\class\cdc\cdc.c
00097e   0e48     MOVLW     0x48                   pCDCDst.bRam = (byte*)&cdc_data_tx; // Set destination pointer           E:\usb20\UIO\system\usb\class\cdc\cdc.c
000980   6f53     MOVWF     0x53,0x1                                                                                        
000982   0e05     MOVLW     0x5                                                                                             
000984   6f54     MOVWF     0x54,0x1                                                                                        
                                                                                                                            E:\usb20\UIO\system\usb\class\cdc\cdc.c
000986   0556     DECF      0x56,0x0,0x1           if(cdc_mem_type == _ROM)            // Determine type of memory source   E:\usb20\UIO\system\usb\class\cdc\cdc.c
000988   e115     BNZ       0x9b4                                                                                           
                                                   {                                                                        E:\usb20\UIO\system\usb\class\cdc\cdc.c
00098a   50df     MOVF      0xdf,0x0,0x0               while(byte_to_send)                                                  E:\usb20\UIO\system\usb\class\cdc\cdc.c
00098c   e012     BZ        0x9b2                                                                                           
0009b0   d7ec     BRA       0x98a                                                                                           
                                                       {                                                                    E:\usb20\UIO\system\usb\class\cdc\cdc.c
00098e   c151     MOVFF     0x151,0xff6                    *pCDCDst.bRam = *pCDCSrc.bRom;                                   E:\usb20\UIO\system\usb\class\cdc\cdc.c
000990   fff6                                                                                                               
000992   c152     MOVFF     0x152,0xff7                                                                                     
000994   fff7                                                                                                               
000996   0008     TBLRD                                                                                                     
000998   50f5     MOVF      0xf5,0x0,0x0                                                                                    
00099a   c153     MOVFF     0x153,0xfe9                                                                                     
00099c   ffe9                                                                                                               
00099e   c154     MOVFF     0x154,0xfea                                                                                     
0009a0   ffea                                                                                                               
0009a2   6eef     MOVWF     0xef,0x0                                                                                        
0009a4   2b53     INCF      0x53,0x1,0x1                   pCDCDst.bRam++;                                                  E:\usb20\UIO\system\usb\class\cdc\cdc.c
0009a6   0e00     MOVLW     0x0                                                                                             
0009a8   2354     ADDWFC    0x54,0x1,0x1                                                                                    
0009aa   2b51     INCF      0x51,0x1,0x1                   pCDCSrc.bRom++;                                                  E:\usb20\UIO\system\usb\class\cdc\cdc.c
0009ac   2352     ADDWFC    0x52,0x1,0x1                                                                                    
0009ae   06df     DECF      0xdf,0x1,0x0                   byte_to_send--;                                                  E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                       }//end while(byte_to_send)                                           E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                   }                                                                        E:\usb20\UIO\system\usb\class\cdc\cdc.c
0009b2   d013     BRA       0x9da                  else // _RAM                                                             E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                   {                                                                        E:\usb20\UIO\system\usb\class\cdc\cdc.c
0009b4   50df     MOVF      0xdf,0x0,0x0               while(byte_to_send)                                                  E:\usb20\UIO\system\usb\class\cdc\cdc.c
0009b6   e011     BZ        0x9da                                                                                           
0009d8   d7ed     BRA       0x9b4                                                                                           
                                                       {                                                                    E:\usb20\UIO\system\usb\class\cdc\cdc.c
0009b8   c151     MOVFF     0x151,0xfe9                    *pCDCDst.bRam = *pCDCSrc.bRam;                                   E:\usb20\UIO\system\usb\class\cdc\cdc.c
0009ba   ffe9                                                                                                               
0009bc   c152     MOVFF     0x152,0xfea                                                                                     
0009be   ffea                                                                                                               
0009c0   50ef     MOVF      0xef,0x0,0x0                                                                                    
0009c2   c153     MOVFF     0x153,0xfe9                                                                                     
0009c4   ffe9                                                                                                               
0009c6   c154     MOVFF     0x154,0xfea                                                                                     
0009c8   ffea                                                                                                               
0009ca   6eef     MOVWF     0xef,0x0                                                                                        
0009cc   2b53     INCF      0x53,0x1,0x1                   pCDCDst.bRam++;                                                  E:\usb20\UIO\system\usb\class\cdc\cdc.c
0009ce   0e00     MOVLW     0x0                                                                                             
0009d0   2354     ADDWFC    0x54,0x1,0x1                                                                                    
0009d2   2b51     INCF      0x51,0x1,0x1                   pCDCSrc.bRam++;                                                  E:\usb20\UIO\system\usb\class\cdc\cdc.c
0009d4   2352     ADDWFC    0x52,0x1,0x1                                                                                    
0009d6   06df     DECF      0xdf,0x1,0x0                   byte_to_send--;                                                  E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                       }//end while(byte_to_send._word)                                     E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                   }//end if(cdc_mem_type...)                                               E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                                                                                            E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                   /*                                                                       E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                    * Lastly, determine if a zero length packet state is necessary.         E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                    * See explanation in USB Specification 2.0: Section 5.8.3               E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                    */                                                                      E:\usb20\UIO\system\usb\class\cdc\cdc.c
0009da   5155     MOVF      0x55,0x0,0x1           if(cdc_tx_len == 0)                                                      E:\usb20\UIO\system\usb\class\cdc\cdc.c
0009dc   e110     BNZ       0x9fe                                                                                           
                                                   {                                                                        E:\usb20\UIO\system\usb\class\cdc\cdc.c
0009de   0104     MOVLB     0x4                        if(CDC_BULK_BD_IN.Cnt == sizeof(cdc_data_tx))                        E:\usb20\UIO\system\usb\class\cdc\cdc.c
0009e0   511d     MOVF      0x1d,0x0,0x1                                                                                    
0009e2   6e14     MOVWF     0x14,0x0                                                                                        
0009e4   6a15     CLRF      0x15,0x0                                                                                        
0009e6   0e40     MOVLW     0x40                                                                                            
0009e8   1814     XORWF     0x14,0x0,0x0                                                                                    
0009ea   e101     BNZ       0x9ee                                                                                           
0009ec   5015     MOVF      0x15,0x0,0x0                                                                                    
0009ee   e104     BNZ       0x9f8                                                                                           
0009f0   0101     MOVLB     0x1                            cdc_trf_state = CDC_TX_BUSY_ZLP;                                 E:\usb20\UIO\system\usb\class\cdc\cdc.c
0009f2   0e02     MOVLW     0x2                                                                                             
0009f4   6f50     MOVWF     0x50,0x1                                                                                        
0009f6   d003     BRA       0x9fe                      else                                                                 E:\usb20\UIO\system\usb\class\cdc\cdc.c
0009f8   0101     MOVLB     0x1                            cdc_trf_state = CDC_TX_COMPLETING;                               E:\usb20\UIO\system\usb\class\cdc\cdc.c
0009fa   0e03     MOVLW     0x3                                                                                             
0009fc   6f50     MOVWF     0x50,0x1                                                                                        
                                                   }//end if(cdc_tx_len...)                                                 E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                                                                                            E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                               }//end if(cdc_tx_sate == CDC_TX_BUSY)                                        E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                                                                                            E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                               /*                                                                           E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                * Both CDC_TX_BUSY and CDC_TX_BUSY_ZLP states use the following macro       E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                */                                                                          E:\usb20\UIO\system\usb\class\cdc\cdc.c
0009fe   0e40     MOVLW     0x40               mUSBBufferReady(CDC_BULK_BD_IN);                                             E:\usb20\UIO\system\usb\class\cdc\cdc.c
000a00   0104     MOVLB     0x4                                                                                             
000a02   171c     ANDWF     0x1c,0x1,0x1                                                                                    
000a04   7d1c     BTG       0x1c,0x6,0x1                                                                                    
000a06   0e88     MOVLW     0x88                                                                                            
000a08   131c     IORWF     0x1c,0x1,0x1                                                                                    
                                                                                                                            E:\usb20\UIO\system\usb\class\cdc\cdc.c
000a0a   52e5     MOVF      0xe5,0x1,0x0   }//end CDCTxService                                                              E:\usb20\UIO\system\usb\class\cdc\cdc.c
000a0c   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000a0e   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
000a10   ffd9                                                                                                               
000a12   0012     RETURN    0x0                                                                                             
                                                                                                                            E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                           #endif //USB_USE_CDC                                                             E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                                                                                                            E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                           /** EOF cdc.c ****************************************************************/  E:\usb20\UIO\system\usb\class\cdc\cdc.c
                                           /*********************************************************************           E:\usb20\UIO\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\UIO\system\usb\usb9\usb9.c
                                            *                Microchip USB C18 Firmware Version 1.0                         E:\usb20\UIO\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\UIO\system\usb\usb9\usb9.c
                                            *********************************************************************           E:\usb20\UIO\system\usb\usb9\usb9.c
                                            * FileName:        usb9.c                                                       E:\usb20\UIO\system\usb\usb9\usb9.c
                                            * Dependencies:    See INCLUDES section below                                   E:\usb20\UIO\system\usb\usb9\usb9.c
                                            * Processor:       PIC18                                                        E:\usb20\UIO\system\usb\usb9\usb9.c
                                            * Compiler:        C18 2.30.01+                                                 E:\usb20\UIO\system\usb\usb9\usb9.c
                                            * Company:         Microchip Technology, Inc.                                   E:\usb20\UIO\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\UIO\system\usb\usb9\usb9.c
                                            * Software License Agreement                                                    E:\usb20\UIO\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\UIO\system\usb\usb9\usb9.c
                                            * The software supplied herewith by Microchip Technology Incorporated           E:\usb20\UIO\system\usb\usb9\usb9.c
                                            * (the 鼎ompany・ for its PICmicroｮ Microcontroller is intended and             E:\usb20\UIO\system\usb\usb9\usb9.c
                                            * supplied to you, the Company痴 customer, for use solely and                   E:\usb20\UIO\system\usb\usb9\usb9.c
                                            * exclusively on Microchip PICmicro Microcontroller products. The               E:\usb20\UIO\system\usb\usb9\usb9.c
                                            * software is owned by the Company and/or its supplier, and is                  E:\usb20\UIO\system\usb\usb9\usb9.c
                                            * protected under applicable copyright laws. All rights are reserved.           E:\usb20\UIO\system\usb\usb9\usb9.c
                                            * Any use in violation of the foregoing restrictions may subject the            E:\usb20\UIO\system\usb\usb9\usb9.c
                                            * user to criminal sanctions under applicable laws, as well as to               E:\usb20\UIO\system\usb\usb9\usb9.c
                                            * civil liability for the breach of the terms and conditions of this            E:\usb20\UIO\system\usb\usb9\usb9.c
                                            * license.                                                                      E:\usb20\UIO\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\UIO\system\usb\usb9\usb9.c
                                            * THIS SOFTWARE IS PROVIDED IN AN 鄭S IS・CONDITION. NO WARRANTIES,             E:\usb20\UIO\system\usb\usb9\usb9.c
                                            * WHETHER EXPRESS, IMPLIED OR STATUTORY, INCLUDING, BUT NOT LIMITED             E:\usb20\UIO\system\usb\usb9\usb9.c
                                            * TO, IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A                   E:\usb20\UIO\system\usb\usb9\usb9.c
                                            * PARTICULAR PURPOSE APPLY TO THIS SOFTWARE. THE COMPANY SHALL NOT,             E:\usb20\UIO\system\usb\usb9\usb9.c
                                            * IN ANY CIRCUMSTANCES, BE LIABLE FOR SPECIAL, INCIDENTAL OR                    E:\usb20\UIO\system\usb\usb9\usb9.c
                                            * CONSEQUENTIAL DAMAGES, FOR ANY REASON WHATSOEVER.                             E:\usb20\UIO\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\UIO\system\usb\usb9\usb9.c
                                            * Author               Date        Comment                                      E:\usb20\UIO\system\usb\usb9\usb9.c
                                            *~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~           E:\usb20\UIO\system\usb\usb9\usb9.c
                                            * Rawin Rojvanit       11/19/04    Original.                                    E:\usb20\UIO\system\usb\usb9\usb9.c
                                            ********************************************************************/           E:\usb20\UIO\system\usb\usb9\usb9.c
                                                                                                                            E:\usb20\UIO\system\usb\usb9\usb9.c
                                           /** I N C L U D E S **********************************************************/  E:\usb20\UIO\system\usb\usb9\usb9.c
                                           #include <p18cxxx.h>                                                             E:\usb20\UIO\system\usb\usb9\usb9.c
                                           #include "system\typedefs.h"                                                     E:\usb20\UIO\system\usb\usb9\usb9.c
                                           #include "system\usb\usb.h"                                                      E:\usb20\UIO\system\usb\usb9\usb9.c
                                           #include "io_cfg.h"                     // Required for self_power status        E:\usb20\UIO\system\usb\usb9\usb9.c
                                                                                                                            E:\usb20\UIO\system\usb\usb9\usb9.c
                                           /** V A R I A B L E S ********************************************************/  E:\usb20\UIO\system\usb\usb9\usb9.c
                                           #pragma udata                                                                    E:\usb20\UIO\system\usb\usb9\usb9.c
                                                                                                                            E:\usb20\UIO\system\usb\usb9\usb9.c
                                           /** P R I V A T E  P R O T O T Y P E S ***************************************/  E:\usb20\UIO\system\usb\usb9\usb9.c
                                           void USBStdGetDscHandler(void);                                                  E:\usb20\UIO\system\usb\usb9\usb9.c
                                           void USBStdSetCfgHandler(void);                                                  E:\usb20\UIO\system\usb\usb9\usb9.c
                                           void USBStdGetStatusHandler(void);                                               E:\usb20\UIO\system\usb\usb9\usb9.c
                                           void USBStdFeatureReqHandler(void);                                              E:\usb20\UIO\system\usb\usb9\usb9.c
                                                                                                                            E:\usb20\UIO\system\usb\usb9\usb9.c
                                           /** D E C L A R A T I O N S **************************************************/  E:\usb20\UIO\system\usb\usb9\usb9.c
                                           #pragma code                                                                     E:\usb20\UIO\system\usb\usb9\usb9.c
                                           /******************************************************************************  E:\usb20\UIO\system\usb\usb9\usb9.c
                                            * Function:        void USBCheckStdRequest(void)                                E:\usb20\UIO\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\UIO\system\usb\usb9\usb9.c
                                            * PreCondition:    None                                                         E:\usb20\UIO\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\UIO\system\usb\usb9\usb9.c
                                            * Input:           None                                                         E:\usb20\UIO\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\UIO\system\usb\usb9\usb9.c
                                            * Output:          None                                                         E:\usb20\UIO\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\UIO\system\usb\usb9\usb9.c
                                            * Side Effects:    None                                                         E:\usb20\UIO\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\UIO\system\usb\usb9\usb9.c
                                            * Overview:        This routine checks the setup data packet to see if it       E:\usb20\UIO\system\usb\usb9\usb9.c
                                            *                  knows how to handle it                                       E:\usb20\UIO\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\UIO\system\usb\usb9\usb9.c
                                            * Note:            None                                                         E:\usb20\UIO\system\usb\usb9\usb9.c
                                            *****************************************************************************/  E:\usb20\UIO\system\usb\usb9\usb9.c
                                           void USBCheckStdRequest(void)                                                    E:\usb20\UIO\system\usb\usb9\usb9.c
                                           {                                                                                E:\usb20\UIO\system\usb\usb9\usb9.c
000a14   0104     MOVLB     0x4                if(SetupPkt.RequestType != STANDARD) return;                                 E:\usb20\UIO\system\usb\usb9\usb9.c
000a16   5120     MOVF      0x20,0x0,0x1                                                                                    
000a18   0b60     ANDLW     0x60                                                                                            
000a1a   42e8     RRNCF     0xe8,0x1,0x0                                                                                    
000a1c   42e8     RRNCF     0xe8,0x1,0x0                                                                                    
000a1e   42e8     RRNCF     0xe8,0x1,0x0                                                                                    
000a20   42e8     RRNCF     0xe8,0x1,0x0                                                                                    
000a22   42e8     RRNCF     0xe8,0x1,0x0                                                                                    
000a24   0900     IORLW     0x0                                                                                             
000a26   e001     BZ        0xa2a                                                                                           
000a28   d055     BRA       0xad4                                                                                           
                                                                                                                            E:\usb20\UIO\system\usb\usb9\usb9.c
000a2a   5121     MOVF      0x21,0x0,0x1       switch(SetupPkt.bRequest)                                                    E:\usb20\UIO\system\usb\usb9\usb9.c
000a2c   0a07     XORLW     0x7                                                                                             
000a2e   e051     BZ        0xad2                                                                                           
000a30   0a0b     XORLW     0xb                                                                                             
000a32   e04f     BZ        0xad2                                                                                           
000a34   0a07     XORLW     0x7                                                                                             
000a36   e040     BZ        0xab8                                                                                           
000a38   0a01     XORLW     0x1                                                                                             
000a3a   e02c     BZ        0xa94                                                                                           
000a3c   0a0b     XORLW     0xb                                                                                             
000a3e   e028     BZ        0xa90                                                                                           
000a40   0a02     XORLW     0x2                                                                                             
000a42   e026     BZ        0xa90                                                                                           
000a44   0a03     XORLW     0x3                                                                                             
000a46   e022     BZ        0xa8c                                                                                           
000a48   0a08     XORLW     0x8                                                                                             
000a4a   e012     BZ        0xa70                                                                                           
000a4c   0a01     XORLW     0x1                                                                                             
000a4e   e00e     BZ        0xa6c                                                                                           
000a50   0a0f     XORLW     0xf                                                                                             
000a52   e00a     BZ        0xa68                                                                                           
000a54   0a03     XORLW     0x3                                                                                             
000a56   e001     BZ        0xa5a                                                                                           
000a58   d03c     BRA       0xad2                                                                                           
                                               {                                                                            E:\usb20\UIO\system\usb\usb9\usb9.c
                                                   case SET_ADR:                                                            E:\usb20\UIO\system\usb\usb9\usb9.c
000a5a   0100     MOVLB     0x0                        ctrl_trf_session_owner = MUID_USB9;                                  E:\usb20\UIO\system\usb\usb9\usb9.c
000a5c   0e01     MOVLW     0x1                                                                                             
000a5e   6ff1     MOVWF     0xf1,0x1                                                                                        
000a60   0100     MOVLB     0x0                        usb_device_state = ADR_PENDING_STATE;       // Update state only     E:\usb20\UIO\system\usb\usb9\usb9.c
000a62   0e04     MOVLW     0x4                                                                                             
000a64   6ff8     MOVWF     0xf8,0x1                                                                                        
                                                       /* See USBCtrlTrfInHandler() in usbctrltrf.c for the next step */    E:\usb20\UIO\system\usb\usb9\usb9.c
000a66   d036     BRA       0xad4                      break;                                                               E:\usb20\UIO\system\usb\usb9\usb9.c
                                                   case GET_DSC:                                                            E:\usb20\UIO\system\usb\usb9\usb9.c
000a68   d836     RCALL     0xad6                      USBStdGetDscHandler();                                               E:\usb20\UIO\system\usb\usb9\usb9.c
000a6a   d034     BRA       0xad4                      break;                                                               E:\usb20\UIO\system\usb\usb9\usb9.c
                                                   case SET_CFG:                                                            E:\usb20\UIO\system\usb\usb9\usb9.c
000a6c   d890     RCALL     0xb8e                      USBStdSetCfgHandler();                                               E:\usb20\UIO\system\usb\usb9\usb9.c
000a6e   d032     BRA       0xad4                      break;                                                               E:\usb20\UIO\system\usb\usb9\usb9.c
                                                   case GET_CFG:                                                            E:\usb20\UIO\system\usb\usb9\usb9.c
000a70   0100     MOVLB     0x0                        ctrl_trf_session_owner = MUID_USB9;                                  E:\usb20\UIO\system\usb\usb9\usb9.c
000a72   0e01     MOVLW     0x1                                                                                             
000a74   6ff1     MOVWF     0xf1,0x1                                                                                        
000a76   0100     MOVLB     0x0                        pSrc.bRam = (byte*)&usb_active_cfg;         // Set Source            E:\usb20\UIO\system\usb\usb9\usb9.c
000a78   0efa     MOVLW     0xfa                                                                                            
000a7a   6ff2     MOVWF     0xf2,0x1                                                                                        
000a7c   0e00     MOVLW     0x0                                                                                             
000a7e   6ff3     MOVWF     0xf3,0x1                                                                                        
000a80   0100     MOVLB     0x0                        usb_stat.ctrl_trf_mem = _RAM;               // Set memory type       E:\usb20\UIO\system\usb\usb9\usb9.c
000a82   93f9     BCF       0xf9,0x1,0x1                                                                                    
000a84   0100     MOVLB     0x0                        LSB(wCount) = 1;                            // Set data count        E:\usb20\UIO\system\usb\usb9\usb9.c
000a86   0e01     MOVLW     0x1                                                                                             
000a88   6ff6     MOVWF     0xf6,0x1                                                                                        
000a8a   d024     BRA       0xad4                      break;                                                               E:\usb20\UIO\system\usb\usb9\usb9.c
                                                   case GET_STATUS:                                                         E:\usb20\UIO\system\usb\usb9\usb9.c
000a8c   d8a8     RCALL     0xbde                      USBStdGetStatusHandler();                                            E:\usb20\UIO\system\usb\usb9\usb9.c
000a8e   d022     BRA       0xad4                      break;                                                               E:\usb20\UIO\system\usb\usb9\usb9.c
                                                   case CLR_FEATURE:                                                        E:\usb20\UIO\system\usb\usb9\usb9.c
                                                   case SET_FEATURE:                                                        E:\usb20\UIO\system\usb\usb9\usb9.c
000a90   d8f4     RCALL     0xc7a                      USBStdFeatureReqHandler();                                           E:\usb20\UIO\system\usb\usb9\usb9.c
000a92   d020     BRA       0xad4                      break;                                                               E:\usb20\UIO\system\usb\usb9\usb9.c
                                                   case GET_INTF:                                                           E:\usb20\UIO\system\usb\usb9\usb9.c
000a94   0100     MOVLB     0x0                        ctrl_trf_session_owner = MUID_USB9;                                  E:\usb20\UIO\system\usb\usb9\usb9.c
000a96   0e01     MOVLW     0x1                                                                                             
000a98   6ff1     MOVWF     0xf1,0x1                                                                                        
000a9a   0104     MOVLB     0x4                        pSrc.bRam = (byte*)&usb_alt_intf+SetupPkt.bIntfID;  // Set source    E:\usb20\UIO\system\usb\usb9\usb9.c
000a9c   5124     MOVF      0x24,0x0,0x1                                                                                    
000a9e   0100     MOVLB     0x0                                                                                             
000aa0   6ff2     MOVWF     0xf2,0x1                                                                                        
000aa2   6bf3     CLRF      0xf3,0x1                                                                                        
000aa4   0efb     MOVLW     0xfb                                                                                            
000aa6   27f2     ADDWF     0xf2,0x1,0x1                                                                                    
000aa8   0e00     MOVLW     0x0                                                                                             
000aaa   23f3     ADDWFC    0xf3,0x1,0x1                                                                                    
000aac   0100     MOVLB     0x0                        usb_stat.ctrl_trf_mem = _RAM;               // Set memory type       E:\usb20\UIO\system\usb\usb9\usb9.c
000aae   93f9     BCF       0xf9,0x1,0x1                                                                                    
000ab0   0100     MOVLB     0x0                        LSB(wCount) = 1;                            // Set data count        E:\usb20\UIO\system\usb\usb9\usb9.c
000ab2   0e01     MOVLW     0x1                                                                                             
000ab4   6ff6     MOVWF     0xf6,0x1                                                                                        
000ab6   d00e     BRA       0xad4                      break;                                                               E:\usb20\UIO\system\usb\usb9\usb9.c
                                                   case SET_INTF:                                                           E:\usb20\UIO\system\usb\usb9\usb9.c
000ab8   0100     MOVLB     0x0                        ctrl_trf_session_owner = MUID_USB9;                                  E:\usb20\UIO\system\usb\usb9\usb9.c
000aba   0e01     MOVLW     0x1                                                                                             
000abc   6ff1     MOVWF     0xf1,0x1                                                                                        
000abe   0104     MOVLB     0x4                        usb_alt_intf[SetupPkt.bIntfID] = SetupPkt.bAltID;                    E:\usb20\UIO\system\usb\usb9\usb9.c
000ac0   5124     MOVF      0x24,0x0,0x1                                                                                    
000ac2   6aea     CLRF      0xea,0x0                                                                                        
000ac4   0ffb     ADDLW     0xfb                                                                                            
000ac6   6ee9     MOVWF     0xe9,0x0                                                                                        
000ac8   0e00     MOVLW     0x0                                                                                             
000aca   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
000acc   c422     MOVFF     0x422,0xfef                                                                                     
000ace   ffef                                                                                                               
000ad0   d001     BRA       0xad4                      break;                                                               E:\usb20\UIO\system\usb\usb9\usb9.c
                                                   case SET_DSC:                                                            E:\usb20\UIO\system\usb\usb9\usb9.c
                                                   case SYNCH_FRAME:                                                        E:\usb20\UIO\system\usb\usb9\usb9.c
                                                   default:                                                                 E:\usb20\UIO\system\usb\usb9\usb9.c
000ad2   d000     BRA       0xad4                      break;                                                               E:\usb20\UIO\system\usb\usb9\usb9.c
                                               }//end switch                                                                E:\usb20\UIO\system\usb\usb9\usb9.c
                                                                                                                            E:\usb20\UIO\system\usb\usb9\usb9.c
000ad4   0012     RETURN    0x0            }//end USBCheckStdRequest                                                        E:\usb20\UIO\system\usb\usb9\usb9.c
                                                                                                                            E:\usb20\UIO\system\usb\usb9\usb9.c
                                           /******************************************************************************  E:\usb20\UIO\system\usb\usb9\usb9.c
                                            * Function:        void USBStdGetDscHandler(void)                               E:\usb20\UIO\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\UIO\system\usb\usb9\usb9.c
                                            * PreCondition:    None                                                         E:\usb20\UIO\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\UIO\system\usb\usb9\usb9.c
                                            * Input:           None                                                         E:\usb20\UIO\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\UIO\system\usb\usb9\usb9.c
                                            * Output:          None                                                         E:\usb20\UIO\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\UIO\system\usb\usb9\usb9.c
                                            * Side Effects:    None                                                         E:\usb20\UIO\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\UIO\system\usb\usb9\usb9.c
                                            * Overview:        This routine handles the standard GET_DESCRIPTOR request.    E:\usb20\UIO\system\usb\usb9\usb9.c
                                            *                  It utilizes tables dynamically looks up descriptor size.     E:\usb20\UIO\system\usb\usb9\usb9.c
                                            *                  This routine should never have to be modified if the tables  E:\usb20\UIO\system\usb\usb9\usb9.c
                                            *                  in usbdsc.c are declared correctly.                          E:\usb20\UIO\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\UIO\system\usb\usb9\usb9.c
                                            * Note:            None                                                         E:\usb20\UIO\system\usb\usb9\usb9.c
                                            *****************************************************************************/  E:\usb20\UIO\system\usb\usb9\usb9.c
                                           void USBStdGetDscHandler(void)                                                   E:\usb20\UIO\system\usb\usb9\usb9.c
                                           {                                                                                E:\usb20\UIO\system\usb\usb9\usb9.c
000ad6   0e80     MOVLW     0x80               if(SetupPkt.bmRequestType == 0x80)                                           E:\usb20\UIO\system\usb\usb9\usb9.c
000ad8   0104     MOVLB     0x4                                                                                             
000ada   5d20     SUBWF     0x20,0x0,0x1                                                                                    
000adc   e157     BNZ       0xb8c                                                                                           
                                               {                                                                            E:\usb20\UIO\system\usb\usb9\usb9.c
000ade   5123     MOVF      0x23,0x0,0x1           switch(SetupPkt.bDscType)                                                E:\usb20\UIO\system\usb\usb9\usb9.c
000ae0   0a03     XORLW     0x3                                                                                             
000ae2   e034     BZ        0xb4c                                                                                           
000ae4   0a01     XORLW     0x1                                                                                             
000ae6   e010     BZ        0xb08                                                                                           
000ae8   0a03     XORLW     0x3                                                                                             
000aea   e001     BZ        0xaee                                                                                           
000aec   d04d     BRA       0xb88                                                                                           
                                                   {                                                                        E:\usb20\UIO\system\usb\usb9\usb9.c
                                                       case DSC_DEV:                                                        E:\usb20\UIO\system\usb\usb9\usb9.c
000aee   0100     MOVLB     0x0                            ctrl_trf_session_owner = MUID_USB9;                              E:\usb20\UIO\system\usb\usb9\usb9.c
000af0   0e01     MOVLW     0x1                                                                                             
000af2   6ff1     MOVWF     0xf1,0x1                                                                                        
000af4   0100     MOVLB     0x0                            pSrc.bRom = (rom byte*)&device_dsc;                              E:\usb20\UIO\system\usb\usb9\usb9.c
000af6   0e2c     MOVLW     0x2c                                                                                            
000af8   6ff2     MOVWF     0xf2,0x1                                                                                        
000afa   0e13     MOVLW     0x13                                                                                            
000afc   6ff3     MOVWF     0xf3,0x1                                                                                        
000afe   0e12     MOVLW     0x12                           wCount._word = sizeof(device_dsc);          // Set data count    E:\usb20\UIO\system\usb\usb9\usb9.c
000b00   0100     MOVLB     0x0                                                                                             
000b02   6ff6     MOVWF     0xf6,0x1                                                                                        
000b04   6bf7     CLRF      0xf7,0x1                                                                                        
000b06   d040     BRA       0xb88                          break;                                                           E:\usb20\UIO\system\usb\usb9\usb9.c
                                                       case DSC_CFG:                                                        E:\usb20\UIO\system\usb\usb9\usb9.c
000b08   0100     MOVLB     0x0                            ctrl_trf_session_owner = MUID_USB9;                              E:\usb20\UIO\system\usb\usb9\usb9.c
000b0a   0e01     MOVLW     0x1                                                                                             
000b0c   6ff1     MOVWF     0xf1,0x1                                                                                        
000b0e   0104     MOVLB     0x4                            pSrc.bRom = *(USB_CD_Ptr+SetupPkt.bDscIndex);                    E:\usb20\UIO\system\usb\usb9\usb9.c
000b10   5122     MOVF      0x22,0x0,0x1                                                                                    
000b12   6ef6     MOVWF     0xf6,0x0                                                                                        
000b14   6af7     CLRF      0xf7,0x0                                                                                        
000b16   90d8     BCF       0xd8,0x0,0x0                                                                                    
000b18   36f6     RLCF      0xf6,0x1,0x0                                                                                    
000b1a   36f7     RLCF      0xf7,0x1,0x0                                                                                    
000b1c   0ed5     MOVLW     0xd5                                                                                            
000b1e   26f6     ADDWF     0xf6,0x1,0x0                                                                                    
000b20   0e13     MOVLW     0x13                                                                                            
000b22   22f7     ADDWFC    0xf7,0x1,0x0                                                                                    
000b24   0009     TBLRDPOSTINC                                                                                              
000b26   cff5     MOVFF     0xff5,0xf2                                                                                      
000b28   f0f2                                                                                                               
000b2a   000a     TBLRDPOSTDEC                                                                                              
000b2c   cff5     MOVFF     0xff5,0xf3                                                                                      
000b2e   f0f3                                                                                                               
000b30   0e02     MOVLW     0x2                            wCount._word = *(pSrc.wRom+1);              // Set data count    E:\usb20\UIO\system\usb\usb9\usb9.c
000b32   0100     MOVLB     0x0                                                                                             
000b34   6af7     CLRF      0xf7,0x0                                                                                        
000b36   25f2     ADDWF     0xf2,0x0,0x1                                                                                    
000b38   6ef6     MOVWF     0xf6,0x0                                                                                        
000b3a   51f3     MOVF      0xf3,0x0,0x1                                                                                    
000b3c   22f7     ADDWFC    0xf7,0x1,0x0                                                                                    
000b3e   0009     TBLRDPOSTINC                                                                                              
000b40   cff5     MOVFF     0xff5,0xf6                                                                                      
000b42   f0f6                                                                                                               
000b44   000a     TBLRDPOSTDEC                                                                                              
000b46   cff5     MOVFF     0xff5,0xf7                                                                                      
000b48   f0f7                                                                                                               
000b4a   d01e     BRA       0xb88                          break;                                                           E:\usb20\UIO\system\usb\usb9\usb9.c
                                                       case DSC_STR:                                                        E:\usb20\UIO\system\usb\usb9\usb9.c
000b4c   0100     MOVLB     0x0                            ctrl_trf_session_owner = MUID_USB9;                              E:\usb20\UIO\system\usb\usb9\usb9.c
000b4e   0e01     MOVLW     0x1                                                                                             
000b50   6ff1     MOVWF     0xf1,0x1                                                                                        
000b52   0104     MOVLB     0x4                            pSrc.bRom = *(USB_SD_Ptr+SetupPkt.bDscIndex);                    E:\usb20\UIO\system\usb\usb9\usb9.c
000b54   5122     MOVF      0x22,0x0,0x1                                                                                    
000b56   6ef6     MOVWF     0xf6,0x0                                                                                        
000b58   6af7     CLRF      0xf7,0x0                                                                                        
000b5a   90d8     BCF       0xd8,0x0,0x0                                                                                    
000b5c   36f6     RLCF      0xf6,0x1,0x0                                                                                    
000b5e   36f7     RLCF      0xf7,0x1,0x0                                                                                    
000b60   0ed9     MOVLW     0xd9                                                                                            
000b62   26f6     ADDWF     0xf6,0x1,0x0                                                                                    
000b64   0e13     MOVLW     0x13                                                                                            
000b66   22f7     ADDWFC    0xf7,0x1,0x0                                                                                    
000b68   0009     TBLRDPOSTINC                                                                                              
000b6a   cff5     MOVFF     0xff5,0xf2                                                                                      
000b6c   f0f2                                                                                                               
000b6e   000a     TBLRDPOSTDEC                                                                                              
000b70   cff5     MOVFF     0xff5,0xf3                                                                                      
000b72   f0f3                                                                                                               
000b74   c0f2     MOVFF     0xf2,0xff6                     wCount._word = *pSrc.bRom;                  // Set data count    E:\usb20\UIO\system\usb\usb9\usb9.c
000b76   fff6                                                                                                               
000b78   c0f3     MOVFF     0xf3,0xff7                                                                                      
000b7a   fff7                                                                                                               
000b7c   0008     TBLRD                                                                                                     
000b7e   50f5     MOVF      0xf5,0x0,0x0                                                                                    
000b80   0100     MOVLB     0x0                                                                                             
000b82   6ff6     MOVWF     0xf6,0x1                                                                                        
000b84   6bf7     CLRF      0xf7,0x1                                                                                        
000b86   d000     BRA       0xb88                          break;                                                           E:\usb20\UIO\system\usb\usb9\usb9.c
                                                   }//end switch                                                            E:\usb20\UIO\system\usb\usb9\usb9.c
                                                                                                                            E:\usb20\UIO\system\usb\usb9\usb9.c
000b88   0100     MOVLB     0x0                    usb_stat.ctrl_trf_mem = _ROM;                       // Set memory type   E:\usb20\UIO\system\usb\usb9\usb9.c
000b8a   83f9     BSF       0xf9,0x1,0x1                                                                                    
                                               }//end if                                                                    E:\usb20\UIO\system\usb\usb9\usb9.c
000b8c   0012     RETURN    0x0            }//end USBStdGetDscHandler                                                       E:\usb20\UIO\system\usb\usb9\usb9.c
                                                                                                                            E:\usb20\UIO\system\usb\usb9\usb9.c
                                           /******************************************************************************  E:\usb20\UIO\system\usb\usb9\usb9.c
                                            * Function:        void USBStdSetCfgHandler(void)                               E:\usb20\UIO\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\UIO\system\usb\usb9\usb9.c
                                            * PreCondition:    None                                                         E:\usb20\UIO\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\UIO\system\usb\usb9\usb9.c
                                            * Input:           None                                                         E:\usb20\UIO\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\UIO\system\usb\usb9\usb9.c
                                            * Output:          None                                                         E:\usb20\UIO\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\UIO\system\usb\usb9\usb9.c
                                            * Side Effects:    None                                                         E:\usb20\UIO\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\UIO\system\usb\usb9\usb9.c
                                            * Overview:        This routine first disables all endpoints by clearing        E:\usb20\UIO\system\usb\usb9\usb9.c
                                            *                  UEP registers. It then configures (initializes) endpoints    E:\usb20\UIO\system\usb\usb9\usb9.c
                                            *                  specified in the modifiable section.                         E:\usb20\UIO\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\UIO\system\usb\usb9\usb9.c
                                            * Note:            None                                                         E:\usb20\UIO\system\usb\usb9\usb9.c
                                            *****************************************************************************/  E:\usb20\UIO\system\usb\usb9\usb9.c
                                           void USBStdSetCfgHandler(void)                                                   E:\usb20\UIO\system\usb\usb9\usb9.c
                                           {                                                                                E:\usb20\UIO\system\usb\usb9\usb9.c
000b8e   0100     MOVLB     0x0                ctrl_trf_session_owner = MUID_USB9;                                          E:\usb20\UIO\system\usb\usb9\usb9.c
000b90   0e01     MOVLW     0x1                                                                                             
000b92   6ff1     MOVWF     0xf1,0x1                                                                                        
000b94   0e0f     MOVLW     0xf                mDisableEP1to15();                          // See usbdrv.h                  E:\usb20\UIO\system\usb\usb9\usb9.c
000b96   6ee6     MOVWF     0xe6,0x0                                                                                        
000b98   0e71     MOVLW     0x71                                                                                            
000b9a   6ee6     MOVWF     0xe6,0x0                                                                                        
000b9c   0e0f     MOVLW     0xf                                                                                             
000b9e   6ee6     MOVWF     0xe6,0x0                                                                                        
000ba0   ec81     CALL      0x1302,0x0                                                                                      
000ba2   f009                                                                                                               
000ba4   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000ba6   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000ba8   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000baa   0e01     MOVLW     0x1                ClearArray((byte*)&usb_alt_intf,MAX_NUM_INT);                                E:\usb20\UIO\system\usb\usb9\usb9.c
000bac   6ee6     MOVWF     0xe6,0x0                                                                                        
000bae   0efb     MOVLW     0xfb                                                                                            
000bb0   6ee6     MOVWF     0xe6,0x0                                                                                        
000bb2   0e00     MOVLW     0x0                                                                                             
000bb4   6ee6     MOVWF     0xe6,0x0                                                                                        
000bb6   ec81     CALL      0x1302,0x0                                                                                      
000bb8   f009                                                                                                               
000bba   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000bbc   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000bbe   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000bc0   c422     MOVFF     0x422,0xfa         usb_active_cfg = SetupPkt.bCfgValue;                                         E:\usb20\UIO\system\usb\usb9\usb9.c
000bc2   f0fa                                                                                                               
000bc4   0104     MOVLB     0x4                if(SetupPkt.bCfgValue == 0)                                                  E:\usb20\UIO\system\usb\usb9\usb9.c
000bc6   5122     MOVF      0x22,0x0,0x1                                                                                    
000bc8   e104     BNZ       0xbd2                                                                                           
000bca   0100     MOVLB     0x0                    usb_device_state = ADDRESS_STATE;                                        E:\usb20\UIO\system\usb\usb9\usb9.c
000bcc   0e05     MOVLW     0x5                                                                                             
000bce   6ff8     MOVWF     0xf8,0x1                                                                                        
000bd0   d005     BRA       0xbdc              else                                                                         E:\usb20\UIO\system\usb\usb9\usb9.c
                                               {                                                                            E:\usb20\UIO\system\usb\usb9\usb9.c
000bd2   0100     MOVLB     0x0                    usb_device_state = CONFIGURED_STATE;                                     E:\usb20\UIO\system\usb\usb9\usb9.c
000bd4   0e06     MOVLW     0x6                                                                                             
000bd6   6ff8     MOVWF     0xf8,0x1                                                                                        
                                                                                                                            E:\usb20\UIO\system\usb\usb9\usb9.c
                                                   /* Modifiable Section */                                                 E:\usb20\UIO\system\usb\usb9\usb9.c
                                                                                                                            E:\usb20\UIO\system\usb\usb9\usb9.c
                                                   #if defined(USB_USE_CDC)                // See autofiles\usbcfg.h        E:\usb20\UIO\system\usb\usb9\usb9.c
000bd8   ecaf     CALL      0x75e,0x0              CDCInitEP();                                                             E:\usb20\UIO\system\usb\usb9\usb9.c
000bda   f003                                                                                                               
                                                   #endif                                                                   E:\usb20\UIO\system\usb\usb9\usb9.c
                                                                                                                            E:\usb20\UIO\system\usb\usb9\usb9.c
                                                   /* End modifiable section */                                             E:\usb20\UIO\system\usb\usb9\usb9.c
                                                                                                                            E:\usb20\UIO\system\usb\usb9\usb9.c
                                               }//end if(SetupPkt.bcfgValue == 0)                                           E:\usb20\UIO\system\usb\usb9\usb9.c
000bdc   0012     RETURN    0x0            }//end USBStdSetCfgHandler                                                       E:\usb20\UIO\system\usb\usb9\usb9.c
                                                                                                                            E:\usb20\UIO\system\usb\usb9\usb9.c
                                           /******************************************************************************  E:\usb20\UIO\system\usb\usb9\usb9.c
                                            * Function:        void USBStdGetStatusHandler(void)                            E:\usb20\UIO\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\UIO\system\usb\usb9\usb9.c
                                            * PreCondition:    None                                                         E:\usb20\UIO\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\UIO\system\usb\usb9\usb9.c
                                            * Input:           None                                                         E:\usb20\UIO\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\UIO\system\usb\usb9\usb9.c
                                            * Output:          None                                                         E:\usb20\UIO\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\UIO\system\usb\usb9\usb9.c
                                            * Side Effects:    None                                                         E:\usb20\UIO\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\UIO\system\usb\usb9\usb9.c
                                            * Overview:        This routine handles the standard GET_STATUS request         E:\usb20\UIO\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\UIO\system\usb\usb9\usb9.c
                                            * Note:            None                                                         E:\usb20\UIO\system\usb\usb9\usb9.c
                                            *****************************************************************************/  E:\usb20\UIO\system\usb\usb9\usb9.c
                                           void USBStdGetStatusHandler(void)                                                E:\usb20\UIO\system\usb\usb9\usb9.c
                                           {                                                                                E:\usb20\UIO\system\usb\usb9\usb9.c
000bde   0104     MOVLB     0x4                CtrlTrfData._byte0 = 0;                         // Initialize content        E:\usb20\UIO\system\usb\usb9\usb9.c
000be0   6b28     CLRF      0x28,0x1                                                                                        
000be2   6b29     CLRF      0x29,0x1           CtrlTrfData._byte1 = 0;                                                      E:\usb20\UIO\system\usb\usb9\usb9.c
                                                                                                                            E:\usb20\UIO\system\usb\usb9\usb9.c
000be4   0104     MOVLB     0x4                switch(SetupPkt.Recipient)                                                   E:\usb20\UIO\system\usb\usb9\usb9.c
000be6   5120     MOVF      0x20,0x0,0x1                                                                                    
000be8   0b1f     ANDLW     0x1f                                                                                            
000bea   0a02     XORLW     0x2                                                                                             
000bec   e014     BZ        0xc16                                                                                           
000bee   0a03     XORLW     0x3                                                                                             
000bf0   e00e     BZ        0xc0e                                                                                           
000bf2   0a01     XORLW     0x1                                                                                             
000bf4   e001     BZ        0xbf8                                                                                           
000bf6   d033     BRA       0xc5e                                                                                           
                                               {                                                                            E:\usb20\UIO\system\usb\usb9\usb9.c
                                                   case RCPT_DEV:                                                           E:\usb20\UIO\system\usb\usb9\usb9.c
000bf8   0100     MOVLB     0x0                        ctrl_trf_session_owner = MUID_USB9;                                  E:\usb20\UIO\system\usb\usb9\usb9.c
000bfa   0e01     MOVLW     0x1                                                                                             
000bfc   6ff1     MOVWF     0xf1,0x1                                                                                        
                                                       /*                                                                   E:\usb20\UIO\system\usb\usb9\usb9.c
                                                        * _byte0: bit0: Self-Powered Status [0] Bus-Powered [1] Self-Powered E:\usb20\UIO\system\usb\usb9\usb9.c
                                                        *         bit1: RemoteWakeup        [0] Disabled    [1] Enabled     E:\usb20\UIO\system\usb\usb9\usb9.c
                                                        */                                                                  E:\usb20\UIO\system\usb\usb9\usb9.c
                                                       if(self_power == 1)                     // self_power defined in io_cfg.h E:\usb20\UIO\system\usb\usb9\usb9.c
000bfe   0104     MOVLB     0x4                            CtrlTrfData._byte0|=0b000000001;    // Set bit0                  E:\usb20\UIO\system\usb\usb9\usb9.c
000c00   8128     BSF       0x28,0x0,0x1                                                                                    
                                                                                                                            E:\usb20\UIO\system\usb\usb9\usb9.c
000c02   0100     MOVLB     0x0                        if(usb_stat.RemoteWakeup == 1)          // usb_stat defined in usbmmap.c E:\usb20\UIO\system\usb\usb9\usb9.c
000c04   a1f9     BTFSS     0xf9,0x0,0x1                                                                                    
000c06   d002     BRA       0xc0c                                                                                           
000c08   0104     MOVLB     0x4                            CtrlTrfData._byte0|=0b00000010;     // Set bit1                  E:\usb20\UIO\system\usb\usb9\usb9.c
000c0a   8328     BSF       0x28,0x1,0x1                                                                                    
000c0c   d028     BRA       0xc5e                      break;                                                               E:\usb20\UIO\system\usb\usb9\usb9.c
                                                   case RCPT_INTF:                                                          E:\usb20\UIO\system\usb\usb9\usb9.c
000c0e   0100     MOVLB     0x0                        ctrl_trf_session_owner = MUID_USB9;     // No data to update         E:\usb20\UIO\system\usb\usb9\usb9.c
000c10   0e01     MOVLW     0x1                                                                                             
000c12   6ff1     MOVWF     0xf1,0x1                                                                                        
000c14   d024     BRA       0xc5e                      break;                                                               E:\usb20\UIO\system\usb\usb9\usb9.c
                                                   case RCPT_EP:                                                            E:\usb20\UIO\system\usb\usb9\usb9.c
000c16   0100     MOVLB     0x0                        ctrl_trf_session_owner = MUID_USB9;                                  E:\usb20\UIO\system\usb\usb9\usb9.c
000c18   0e01     MOVLW     0x1                                                                                             
000c1a   6ff1     MOVWF     0xf1,0x1                                                                                        
                                                       /*                                                                   E:\usb20\UIO\system\usb\usb9\usb9.c
                                                        * _byte0: bit0: Halt Status [0] Not Halted [1] Halted               E:\usb20\UIO\system\usb\usb9\usb9.c
                                                        */                                                                  E:\usb20\UIO\system\usb\usb9\usb9.c
000c1c   0104     MOVLB     0x4                        pDst.bRam = (byte*)&ep0Bo+(SetupPkt.EPNum*8)+(SetupPkt.EPDir*4);     E:\usb20\UIO\system\usb\usb9\usb9.c
000c1e   5124     MOVF      0x24,0x0,0x1                                                                                    
000c20   0b0f     ANDLW     0xf                                                                                             
000c22   0d08     MULLW     0x8                                                                                             
000c24   50f3     MOVF      0xf3,0x0,0x0                                                                                    
000c26   6a15     CLRF      0x15,0x0                                                                                        
000c28   0f00     ADDLW     0x0                                                                                             
000c2a   6e14     MOVWF     0x14,0x0                                                                                        
000c2c   0e04     MOVLW     0x4                                                                                             
000c2e   2215     ADDWFC    0x15,0x1,0x0                                                                                    
000c30   5124     MOVF      0x24,0x0,0x1                                                                                    
000c32   0b80     ANDLW     0x80                                                                                            
000c34   e001     BZ        0xc38                                                                                           
000c36   0e01     MOVLW     0x1                                                                                             
000c38   0d04     MULLW     0x4                                                                                             
000c3a   50f3     MOVF      0xf3,0x0,0x0                                                                                    
000c3c   0100     MOVLB     0x0                                                                                             
000c3e   2414     ADDWF     0x14,0x0,0x0                                                                                    
000c40   6ff4     MOVWF     0xf4,0x1                                                                                        
000c42   0e00     MOVLW     0x0                                                                                             
000c44   2015     ADDWFC    0x15,0x0,0x0                                                                                    
000c46   6ff5     MOVWF     0xf5,0x1                                                                                        
000c48   c0f4     MOVFF     0xf4,0xfe9                 if(*pDst.bRam & _BSTALL)    // Use _BSTALL as a bit mask             E:\usb20\UIO\system\usb\usb9\usb9.c
000c4a   ffe9                                                                                                               
000c4c   c0f5     MOVFF     0xf5,0xfea                                                                                      
000c4e   ffea                                                                                                               
000c50   50ef     MOVF      0xef,0x0,0x0                                                                                    
000c52   0b04     ANDLW     0x4                                                                                             
000c54   e003     BZ        0xc5c                                                                                           
000c56   0104     MOVLB     0x4                            CtrlTrfData._byte0=0x01;// Set bit0                              E:\usb20\UIO\system\usb\usb9\usb9.c
000c58   0e01     MOVLW     0x1                                                                                             
000c5a   6f28     MOVWF     0x28,0x1                                                                                        
000c5c   d000     BRA       0xc5e                      break;                                                               E:\usb20\UIO\system\usb\usb9\usb9.c
                                               }//end switch                                                                E:\usb20\UIO\system\usb\usb9\usb9.c
                                                                                                                            E:\usb20\UIO\system\usb\usb9\usb9.c
000c5e   0100     MOVLB     0x0                if(ctrl_trf_session_owner == MUID_USB9)                                      E:\usb20\UIO\system\usb\usb9\usb9.c
000c60   05f1     DECF      0xf1,0x0,0x1                                                                                    
000c62   e10a     BNZ       0xc78                                                                                           
                                               {                                                                            E:\usb20\UIO\system\usb\usb9\usb9.c
000c64   0100     MOVLB     0x0                    pSrc.bRam = (byte*)&CtrlTrfData;            // Set Source                E:\usb20\UIO\system\usb\usb9\usb9.c
000c66   0e28     MOVLW     0x28                                                                                            
000c68   6ff2     MOVWF     0xf2,0x1                                                                                        
000c6a   0e04     MOVLW     0x4                                                                                             
000c6c   6ff3     MOVWF     0xf3,0x1                                                                                        
000c6e   0100     MOVLB     0x0                    usb_stat.ctrl_trf_mem = _RAM;               // Set memory type           E:\usb20\UIO\system\usb\usb9\usb9.c
000c70   93f9     BCF       0xf9,0x1,0x1                                                                                    
000c72   0100     MOVLB     0x0                    LSB(wCount) = 2;                            // Set data count            E:\usb20\UIO\system\usb\usb9\usb9.c
000c74   0e02     MOVLW     0x2                                                                                             
000c76   6ff6     MOVWF     0xf6,0x1                                                                                        
                                               }//end if(...)                                                               E:\usb20\UIO\system\usb\usb9\usb9.c
000c78   0012     RETURN    0x0            }//end USBStdGetStatusHandler                                                    E:\usb20\UIO\system\usb\usb9\usb9.c
                                                                                                                            E:\usb20\UIO\system\usb\usb9\usb9.c
                                           /******************************************************************************  E:\usb20\UIO\system\usb\usb9\usb9.c
                                            * Function:        void USBStdFeatureReqHandler(void)                           E:\usb20\UIO\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\UIO\system\usb\usb9\usb9.c
                                            * PreCondition:    None                                                         E:\usb20\UIO\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\UIO\system\usb\usb9\usb9.c
                                            * Input:           None                                                         E:\usb20\UIO\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\UIO\system\usb\usb9\usb9.c
                                            * Output:          None                                                         E:\usb20\UIO\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\UIO\system\usb\usb9\usb9.c
                                            * Side Effects:    None                                                         E:\usb20\UIO\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\UIO\system\usb\usb9\usb9.c
                                            * Overview:        This routine handles the standard SET & CLEAR FEATURES       E:\usb20\UIO\system\usb\usb9\usb9.c
                                            *                  requests                                                     E:\usb20\UIO\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\UIO\system\usb\usb9\usb9.c
                                            * Note:            None                                                         E:\usb20\UIO\system\usb\usb9\usb9.c
                                            *****************************************************************************/  E:\usb20\UIO\system\usb\usb9\usb9.c
                                           void USBStdFeatureReqHandler(void)                                               E:\usb20\UIO\system\usb\usb9\usb9.c
                                           {                                                                                E:\usb20\UIO\system\usb\usb9\usb9.c
000c7a   0104     MOVLB     0x4                if((SetupPkt.bFeature == DEVICE_REMOTE_WAKEUP)&&                             E:\usb20\UIO\system\usb\usb9\usb9.c
000c7c   0522     DECF      0x22,0x0,0x1                                                                                    
000c7e   e110     BNZ       0xca0                 (SetupPkt.Recipient == RCPT_DEV))                                         E:\usb20\UIO\system\usb\usb9\usb9.c
000c80   5120     MOVF      0x20,0x0,0x1                                                                                    
000c82   0b1f     ANDLW     0x1f                                                                                            
000c84   0900     IORLW     0x0                                                                                             
000c86   e10c     BNZ       0xca0                                                                                           
                                               {                                                                            E:\usb20\UIO\system\usb\usb9\usb9.c
000c88   0100     MOVLB     0x0                    ctrl_trf_session_owner = MUID_USB9;                                      E:\usb20\UIO\system\usb\usb9\usb9.c
000c8a   0e01     MOVLW     0x1                                                                                             
000c8c   6ff1     MOVWF     0xf1,0x1                                                                                        
000c8e   0e03     MOVLW     0x3                    if(SetupPkt.bRequest == SET_FEATURE)                                     E:\usb20\UIO\system\usb\usb9\usb9.c
000c90   0104     MOVLB     0x4                                                                                             
000c92   5d21     SUBWF     0x21,0x0,0x1                                                                                    
000c94   e103     BNZ       0xc9c                                                                                           
000c96   0100     MOVLB     0x0                        usb_stat.RemoteWakeup = 1;                                           E:\usb20\UIO\system\usb\usb9\usb9.c
000c98   81f9     BSF       0xf9,0x0,0x1                                                                                    
000c9a   d002     BRA       0xca0                  else                                                                     E:\usb20\UIO\system\usb\usb9\usb9.c
000c9c   0100     MOVLB     0x0                        usb_stat.RemoteWakeup = 0;                                           E:\usb20\UIO\system\usb\usb9\usb9.c
000c9e   91f9     BCF       0xf9,0x0,0x1                                                                                    
                                               }//end if                                                                    E:\usb20\UIO\system\usb\usb9\usb9.c
                                                                                                                            E:\usb20\UIO\system\usb\usb9\usb9.c
000ca0   0104     MOVLB     0x4                if((SetupPkt.bFeature == ENDPOINT_HALT)&&                                    E:\usb20\UIO\system\usb\usb9\usb9.c
000ca2   5122     MOVF      0x22,0x0,0x1                                                                                    
000ca4   e13a     BNZ       0xd1a                 (SetupPkt.Recipient == RCPT_EP)&&                                         E:\usb20\UIO\system\usb\usb9\usb9.c
000ca6   5120     MOVF      0x20,0x0,0x1                                                                                    
000ca8   0b1f     ANDLW     0x1f                                                                                            
000caa   0802     SUBLW     0x2                                                                                             
000cac   e136     BNZ       0xd1a                                                                                           
000cae   5124     MOVF      0x24,0x0,0x1          (SetupPkt.EPNum != 0))                                                    E:\usb20\UIO\system\usb\usb9\usb9.c
000cb0   0b0f     ANDLW     0xf                                                                                             
000cb2   0900     IORLW     0x0                                                                                             
000cb4   e032     BZ        0xd1a                                                                                           
                                               {                                                                            E:\usb20\UIO\system\usb\usb9\usb9.c
000cb6   0100     MOVLB     0x0                    ctrl_trf_session_owner = MUID_USB9;                                      E:\usb20\UIO\system\usb\usb9\usb9.c
000cb8   0e01     MOVLW     0x1                                                                                             
000cba   6ff1     MOVWF     0xf1,0x1                                                                                        
                                                   /* Must do address calculation here */                                   E:\usb20\UIO\system\usb\usb9\usb9.c
000cbc   0104     MOVLB     0x4                    pDst.bRam = (byte*)&ep0Bo+(SetupPkt.EPNum*8)+(SetupPkt.EPDir*4);         E:\usb20\UIO\system\usb\usb9\usb9.c
000cbe   5124     MOVF      0x24,0x0,0x1                                                                                    
000cc0   0b0f     ANDLW     0xf                                                                                             
000cc2   0d08     MULLW     0x8                                                                                             
000cc4   50f3     MOVF      0xf3,0x0,0x0                                                                                    
000cc6   6a15     CLRF      0x15,0x0                                                                                        
000cc8   0f00     ADDLW     0x0                                                                                             
000cca   6e14     MOVWF     0x14,0x0                                                                                        
000ccc   0e04     MOVLW     0x4                                                                                             
000cce   2215     ADDWFC    0x15,0x1,0x0                                                                                    
000cd0   5124     MOVF      0x24,0x0,0x1                                                                                    
000cd2   0b80     ANDLW     0x80                                                                                            
000cd4   e001     BZ        0xcd8                                                                                           
000cd6   0e01     MOVLW     0x1                                                                                             
000cd8   0d04     MULLW     0x4                                                                                             
000cda   50f3     MOVF      0xf3,0x0,0x0                                                                                    
000cdc   0100     MOVLB     0x0                                                                                             
000cde   2414     ADDWF     0x14,0x0,0x0                                                                                    
000ce0   6ff4     MOVWF     0xf4,0x1                                                                                        
000ce2   0e00     MOVLW     0x0                                                                                             
000ce4   2015     ADDWFC    0x15,0x0,0x0                                                                                    
000ce6   6ff5     MOVWF     0xf5,0x1                                                                                        
                                                                                                                            E:\usb20\UIO\system\usb\usb9\usb9.c
000ce8   0e03     MOVLW     0x3                    if(SetupPkt.bRequest == SET_FEATURE)                                     E:\usb20\UIO\system\usb\usb9\usb9.c
000cea   0104     MOVLB     0x4                                                                                             
000cec   5d21     SUBWF     0x21,0x0,0x1                                                                                    
000cee   e107     BNZ       0xcfe                                                                                           
000cf0   0e84     MOVLW     0x84                       *pDst.bRam = _USIE|_BSTALL;                                          E:\usb20\UIO\system\usb\usb9\usb9.c
000cf2   c0f4     MOVFF     0xf4,0xfe9                                                                                      
000cf4   ffe9                                                                                                               
000cf6   c0f5     MOVFF     0xf5,0xfea                                                                                      
000cf8   ffea                                                                                                               
000cfa   6eef     MOVWF     0xef,0x0                                                                                        
000cfc   d00e     BRA       0xd1a                  else                                                                     E:\usb20\UIO\system\usb\usb9\usb9.c
                                                   {                                                                        E:\usb20\UIO\system\usb\usb9\usb9.c
000cfe   af24     BTFSS     0x24,0x7,0x1               if(SetupPkt.EPDir == 1) // IN                                        E:\usb20\UIO\system\usb\usb9\usb9.c
000d00   d006     BRA       0xd0e                                                                                           
000d02   c0f4     MOVFF     0xf4,0xfe9                     *pDst.bRam = _UCPU;                                              E:\usb20\UIO\system\usb\usb9\usb9.c
000d04   ffe9                                                                                                               
000d06   c0f5     MOVFF     0xf5,0xfea                                                                                      
000d08   ffea                                                                                                               
000d0a   6aef     CLRF      0xef,0x0                                                                                        
000d0c   d006     BRA       0xd1a                      else                                                                 E:\usb20\UIO\system\usb\usb9\usb9.c
000d0e   0e88     MOVLW     0x88                           *pDst.bRam = _USIE|_DAT0|_DTSEN;                                 E:\usb20\UIO\system\usb\usb9\usb9.c
000d10   c0f4     MOVFF     0xf4,0xfe9                                                                                      
000d12   ffe9                                                                                                               
000d14   c0f5     MOVFF     0xf5,0xfea                                                                                      
000d16   ffea                                                                                                               
000d18   6eef     MOVWF     0xef,0x0                                                                                        
                                                   }//end if                                                                E:\usb20\UIO\system\usb\usb9\usb9.c
                                               }//end if                                                                    E:\usb20\UIO\system\usb\usb9\usb9.c
000d1a   0012     RETURN    0x0            }//end USBStdFeatureReqHandler                                                   E:\usb20\UIO\system\usb\usb9\usb9.c
                                                                                                                            E:\usb20\UIO\system\usb\usb9\usb9.c
                                           /** EOF usb9.c ***************************************************************/  E:\usb20\UIO\system\usb\usb9\usb9.c
                                           /*********************************************************************           E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            *                Microchip USB C18 Firmware Version 1.0                         E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            *********************************************************************           E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            * FileName:        usbctrltrf.c                                                 E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            * Dependencies:    See INCLUDES section below                                   E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            * Processor:       PIC18                                                        E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            * Compiler:        C18 2.30.01+                                                 E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            * Company:         Microchip Technology, Inc.                                   E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            * Software License Agreement                                                    E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            * The software supplied herewith by Microchip Technology Incorporated           E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            * (the 鼎ompany) for its PICmicroｮ Microcontroller is intended and             E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            * supplied to you, the Company痴 customer, for use solely and                   E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            * exclusively on Microchip PICmicro Microcontroller products. The               E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            * software is owned by the Company and/or its supplier, and is                  E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            * protected under applicable copyright laws. All rights are reserved.           E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            * Any use in violation of the foregoing restrictions may subject the            E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            * user to criminal sanctions under applicable laws, as well as to               E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            * civil liability for the breach of the terms and conditions of this            E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            * license.                                                                      E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            * THIS SOFTWARE IS PROVIDED IN AN 鄭S IS CONDITION. NO WARRANTIES,             E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            * WHETHER EXPRESS, IMPLIED OR STATUTORY, INCLUDING, BUT NOT LIMITED             E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            * TO, IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A                   E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            * PARTICULAR PURPOSE APPLY TO THIS SOFTWARE. THE COMPANY SHALL NOT,             E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            * IN ANY CIRCUMSTANCES, BE LIABLE FOR SPECIAL, INCIDENTAL OR                    E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            * CONSEQUENTIAL DAMAGES, FOR ANY REASON WHATSOEVER.                             E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            * Author               Date        Comment                                      E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            *~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~           E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            * Rawin Rojvanit       11/19/04    Original.                                    E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            ********************************************************************/           E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                                                                                                            E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                           /** I N C L U D E S **********************************************************/  E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                           #include <p18cxxx.h>                                                             E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                           #include "system\typedefs.h"                                                     E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                           #include "system\usb\usb.h"                                                      E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                                                                                                            E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                           /** V A R I A B L E S ********************************************************/  E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                           #pragma udata                                                                    E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                           byte ctrl_trf_state;                // Control Transfer State                    E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                           byte ctrl_trf_session_owner;        // Current transfer session owner            E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                                                                                                            E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                           POINTER pSrc;                       // Data source pointer                       E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                           POINTER pDst;                       // Data destination pointer                  E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                           WORD wCount;                        // Data counter                              E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                                                                                                            E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                           /** P R I V A T E  P R O T O T Y P E S ***************************************/  E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                           void USBCtrlTrfSetupHandler(void);                                               E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                           void USBCtrlTrfOutHandler(void);                                                 E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                           void USBCtrlTrfInHandler(void);                                                  E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                                                                                                            E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                           /** D E C L A R A T I O N S **************************************************/  E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                           #pragma code                                                                     E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                           /******************************************************************************  E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            * Function:        void USBCtrlEPService(void)                                  E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            * PreCondition:    USTAT is loaded with a valid endpoint address.               E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            * Input:           None                                                         E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            * Output:          None                                                         E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            * Side Effects:    None                                                         E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            * Overview:        USBCtrlEPService checks for three transaction types that     E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  it knows how to service and services them:                   E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  1. EP0 SETUP                                                 E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  2. EP0 OUT                                                   E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  3. EP0 IN                                                    E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  It ignores all other types (i.e. EP1, EP2, etc.)             E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            * Note:            None                                                         E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            *****************************************************************************/  E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                           void USBCtrlEPService(void)                                                      E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                           {                                                                                E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
000d1c   506c     MOVF      0x6c,0x0,0x0       if(USTAT == EP00_OUT)                                                        E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
000d1e   e002     BZ        0xd24                                                                                           
000d20   0e00     MOVLW     0x0                                                                                             
000d22   d001     BRA       0xd26                                                                                           
000d24   0e01     MOVLW     0x1                                                                                             
000d26   0900     IORLW     0x0                                                                                             
000d28   e00b     BZ        0xd40                                                                                           
                                               {                                                                            E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
000d2a   0104     MOVLB     0x4                    if(ep0Bo.Stat.PID == SETUP_TOKEN)           // EP0 SETUP                 E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
000d2c   5100     MOVF      0x0,0x0,0x1                                                                                     
000d2e   0b3c     ANDLW     0x3c                                                                                            
000d30   42e8     RRNCF     0xe8,0x1,0x0                                                                                    
000d32   42e8     RRNCF     0xe8,0x1,0x0                                                                                    
000d34   080d     SUBLW     0xd                                                                                             
000d36   e102     BNZ       0xd3c                                                                                           
000d38   d80c     RCALL     0xd52                      USBCtrlTrfSetupHandler();                                            E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
000d3a   d001     BRA       0xd3e                  else                                        // EP0 OUT                   E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
000d3c   d840     RCALL     0xdbe                      USBCtrlTrfOutHandler();                                              E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                               }                                                                            E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
000d3e   d008     BRA       0xd50              else if(USTAT == EP00_IN)                       // EP0 IN                    E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
000d40   506c     MOVF      0x6c,0x0,0x0                                                                                    
000d42   e002     BZ        0xd48                                                                                           
000d44   0e00     MOVLW     0x0                                                                                             
000d46   d001     BRA       0xd4a                                                                                           
000d48   0e01     MOVLW     0x1                                                                                             
000d4a   0904     IORLW     0x4                                                                                             
000d4c   e001     BZ        0xd50                                                                                           
000d4e   d847     RCALL     0xdde                  USBCtrlTrfInHandler();                                                   E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                                                                                                            E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
000d50   0012     RETURN    0x0            }//end USBCtrlEPService                                                          E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                                                                                                            E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                           /******************************************************************************  E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            * Function:        void USBCtrlTrfSetupHandler(void)                            E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            * PreCondition:    SetupPkt buffer is loaded with valid USB Setup Data          E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            * Input:           None                                                         E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            * Output:          None                                                         E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            * Side Effects:    None                                                         E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            * Overview:        This routine is a task dispatcher and has 3 stages.          E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  1. It initializes the control transfer state machine.        E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  2. It calls on each of the module that may know how to       E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            *                     service the Setup Request from the host.                  E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            *                     Module Example: USB9, HID, CDC, MSD, ...                  E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            *                     As new classes are added, ClassReqHandler table in        E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            *                     usbdsc.c should be updated to call all available          E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            *                     class handlers.                                           E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  3. Once each of the modules has had a chance to check if     E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            *                     it is responsible for servicing the request, stage 3      E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            *                     then checks direction of the transfer to determine how    E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            *                     to prepare EP0 for the control transfer.                  E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            *                     Refer to USBCtrlEPServiceComplete() for more details.     E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            * Note:            Microchip USB Firmware has three different states for        E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  the control transfer state machine:                          E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  1. WAIT_SETUP                                                E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  2. CTRL_TRF_TX                                               E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  3. CTRL_TRF_RX                                               E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  Refer to firmware manual to find out how one state           E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  is transitioned to another.                                  E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  A Control Transfer is composed of many USB transactions.     E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  When transferring data over multiple transactions,           E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  it is important to keep track of data source, data           E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  destination, and data count. These three parameters are      E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  stored in pSrc,pDst, and wCount. A flag is used to           E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  note if the data source is from ROM or RAM.                  E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            *****************************************************************************/  E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
000d52   cfd9     MOVFF     0xfd9,0xfe6    void USBCtrlTrfSetupHandler(void)                                                E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
000d54   ffe6                                                                                                               
000d56   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
000d58   ffd9                                                                                                               
000d5a   52e6     MOVF      0xe6,0x1,0x0                                                                                    
                                           {                                                                                E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                               byte i;                                                                      E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                                                                                                            E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                               /* Stage 1 */                                                                E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
000d5c   0100     MOVLB     0x0                ctrl_trf_state = WAIT_SETUP;                                                 E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
000d5e   6bf0     CLRF      0xf0,0x1                                                                                        
000d60   6bf1     CLRF      0xf1,0x1           ctrl_trf_session_owner = MUID_NULL;     // Set owner to NULL                 E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
000d62   6bf6     CLRF      0xf6,0x1           wCount._word = 0;                                                            E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
000d64   6bf7     CLRF      0xf7,0x1                                                                                        
                                                                                                                            E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                               /* Stage 2 */                                                                E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
000d66   ec0a     CALL      0xa14,0x0          USBCheckStdRequest();                   // See system\usb9\usb9.c            E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
000d68   f005                                                                                                               
                                                                                                                            E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
000d6a   6adf     CLRF      0xdf,0x0           for(i=0;i < (sizeof(ClassReqHandler)/sizeof(pFunc));i++)                     E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
000d6c   50df     MOVF      0xdf,0x0,0x0                                                                                    
000d6e   6e14     MOVWF     0x14,0x0                                                                                        
000d70   6a15     CLRF      0x15,0x0                                                                                        
000d72   0e01     MOVLW     0x1                                                                                             
000d74   5c14     SUBWF     0x14,0x0,0x0                                                                                    
000d76   0e00     MOVLW     0x0                                                                                             
000d78   5815     SUBWFB    0x15,0x0,0x0                                                                                    
000d7a   e21b     BC        0xdb2                                                                                           
000dae   2adf     INCF      0xdf,0x1,0x0                                                                                    
000db0   d7dd     BRA       0xd6c                                                                                           
                                               {                                                                            E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
000d7c   0100     MOVLB     0x0                    if(ctrl_trf_session_owner != MUID_NULL)break;                            E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
000d7e   51f1     MOVF      0xf1,0x0,0x1                                                                                    
000d80   e001     BZ        0xd84                                                                                           
000d82   d017     BRA       0xdb2                                                                                           
000d84   6af7     CLRF      0xf7,0x0               ClassReqHandler[i]();               // See autofiles\usbdsc.c            E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
000d86   34df     RLCF      0xdf,0x0,0x0                                                                                    
000d88   0bfe     ANDLW     0xfe                                                                                            
000d8a   36f7     RLCF      0xf7,0x1,0x0                                                                                    
000d8c   6ef6     MOVWF     0xf6,0x0                                                                                        
000d8e   0edf     MOVLW     0xdf                                                                                            
000d90   26f6     ADDWF     0xf6,0x1,0x0                                                                                    
000d92   0e13     MOVLW     0x13                                                                                            
000d94   22f7     ADDWFC    0xf7,0x1,0x0                                                                                    
000d96   0009     TBLRDPOSTINC                                                                                              
000d98   cff5     MOVFF     0xff5,0x14                                                                                      
000d9a   f014                                                                                                               
000d9c   0008     TBLRD                                                                                                     
000d9e   cff5     MOVFF     0xff5,0x15                                                                                      
000da0   f015                                                                                                               
000da2   d004     BRA       0xdac                                                                                           
000da4   c015     MOVFF     0x15,0xffa                                                                                      
000da6   fffa                                                                                                               
000da8   5014     MOVF      0x14,0x0,0x0                                                                                    
000daa   6ef9     MOVWF     0xf9,0x0                                                                                        
000dac   dffb     RCALL     0xda4                                                                                           
                                               }//end while                                                                 E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                                                                                                            E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                               /* Stage 3 */                                                                E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
000db2   d8e1     RCALL     0xf76              USBCtrlEPServiceComplete();                                                  E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                                                                                                            E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
000db4   52e5     MOVF      0xe5,0x1,0x0   }//end USBCtrlTrfSetupHandler                                                    E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
000db6   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000db8   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
000dba   ffd9                                                                                                               
000dbc   0012     RETURN    0x0                                                                                             
                                                                                                                            E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                           /******************************************************************************  E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            * Function:        void USBCtrlTrfOutHandler(void)                              E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            * PreCondition:    None                                                         E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            * Input:           None                                                         E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            * Output:          None                                                         E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            * Side Effects:    None                                                         E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            * Overview:        This routine handles an OUT transaction according to         E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  which control transfer state is currently active.            E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            * Note:            Note that if the the control transfer was from               E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  host to device, the session owner should be notified         E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  at the end of each OUT transaction to service the            E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  received data.                                               E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            *****************************************************************************/  E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                           void USBCtrlTrfOutHandler(void)                                                  E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                           {                                                                                E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
000dbe   0e02     MOVLW     0x2                if(ctrl_trf_state == CTRL_TRF_RX)                                            E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
000dc0   0100     MOVLB     0x0                                                                                             
000dc2   5df0     SUBWF     0xf0,0x0,0x1                                                                                    
000dc4   e10a     BNZ       0xdda                                                                                           
                                               {                                                                            E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
000dc6   d898     RCALL     0xef8                  USBCtrlTrfRxService();                                                   E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                                                                                                            E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                                   /*                                                                       E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                                    * Don't have to worry about overwriting _KEEP bit                       E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                                    * because if _KEEP was set, TRNIF would not have been                   E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                                    * generated in the first place.                                         E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                                    */                                                                      E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
000dc8   0104     MOVLB     0x4                    if(ep0Bo.Stat.DTS == 0)                                                  E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
000dca   bd00     BTFSC     0x0,0x6,0x1                                                                                     
000dcc   d003     BRA       0xdd4                                                                                           
000dce   0ec8     MOVLW     0xc8                       ep0Bo.Stat._byte = _USIE|_DAT1|_DTSEN;                               E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
000dd0   6f00     MOVWF     0x0,0x1                                                                                         
000dd2   d002     BRA       0xdd8                  else                                                                     E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
000dd4   0e88     MOVLW     0x88                       ep0Bo.Stat._byte = _USIE|_DAT0|_DTSEN;                               E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
000dd6   6f00     MOVWF     0x0,0x1                                                                                         
                                               }                                                                            E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
000dd8   d001     BRA       0xddc              else    // CTRL_TRF_TX                                                       E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
000dda   d913     RCALL     0x1002                 USBPrepareForNextSetupTrf();                                             E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                                                                                                            E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
000ddc   0012     RETURN    0x0            }//end USBCtrlTrfOutHandler                                                      E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                                                                                                            E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                           /******************************************************************************  E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            * Function:        void USBCtrlTrfInHandler(void)                               E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            * PreCondition:    None                                                         E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            * Input:           None                                                         E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            * Output:          None                                                         E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            * Side Effects:    None                                                         E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            * Overview:        This routine handles an IN transaction according to          E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  which control transfer state is currently active.            E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            * Note:            A Set Address Request must not change the acutal address     E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  of the device until the completion of the control            E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  transfer. The end of the control transfer for Set Address    E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  Request is an IN transaction. Therefore it is necessary      E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  to service this unique situation when the condition is       E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  right. Macro mUSBCheckAdrPendingState is defined in          E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  usb9.h and its function is to specifically service this      E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  event.                                                       E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            *****************************************************************************/  E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                           void USBCtrlTrfInHandler(void)                                                   E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                           {                                                                                E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
000dde   0e04     MOVLW     0x4                mUSBCheckAdrPendingState();         // Must check if in ADR_PENDING_STATE    E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
000de0   0100     MOVLB     0x0                                                                                             
000de2   5df8     SUBWF     0xf8,0x0,0x1                                                                                    
000de4   e10a     BNZ       0xdfa                                                                                           
000de6   c422     MOVFF     0x422,0xf6e                                                                                     
000de8   ff6e                                                                                                               
000dea   506e     MOVF      0x6e,0x0,0x0                                                                                    
000dec   0800     SUBLW     0x0                                                                                             
000dee   e203     BC        0xdf6                                                                                           
000df0   0e05     MOVLW     0x5                                                                                             
000df2   6ff8     MOVWF     0xf8,0x1                                                                                        
000df4   d002     BRA       0xdfa                                                                                           
000df6   0e03     MOVLW     0x3                                                                                             
000df8   6ff8     MOVWF     0xf8,0x1                                                                                        
                                                                                                                            E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
000dfa   0100     MOVLB     0x0                if(ctrl_trf_state == CTRL_TRF_TX)                                            E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
000dfc   05f0     DECF      0xf0,0x0,0x1                                                                                    
000dfe   e10a     BNZ       0xe14                                                                                           
                                               {                                                                            E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
000e00   d80b     RCALL     0xe18                  USBCtrlTrfTxService();                                                   E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                                                                                                            E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
000e02   0104     MOVLB     0x4                    if(ep0Bi.Stat.DTS == 0)                                                  E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
000e04   bd04     BTFSC     0x4,0x6,0x1                                                                                     
000e06   d003     BRA       0xe0e                                                                                           
000e08   0ec8     MOVLW     0xc8                       ep0Bi.Stat._byte = _USIE|_DAT1|_DTSEN;                               E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
000e0a   6f04     MOVWF     0x4,0x1                                                                                         
000e0c   d002     BRA       0xe12                  else                                                                     E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
000e0e   0e88     MOVLW     0x88                       ep0Bi.Stat._byte = _USIE|_DAT0|_DTSEN;                               E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
000e10   6f04     MOVWF     0x4,0x1                                                                                         
                                               }                                                                            E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
000e12   d001     BRA       0xe16              else // CTRL_TRF_RX                                                          E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
000e14   d8f6     RCALL     0x1002                 USBPrepareForNextSetupTrf();                                             E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                                                                                                            E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
000e16   0012     RETURN    0x0            }//end USBCtrlTrfInHandler                                                       E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                                                                                                            E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                           /******************************************************************************  E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            * Function:        void USBCtrlTrfTxService(void)                               E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            * PreCondition:    pSrc, wCount, and usb_stat.ctrl_trf_mem are setup properly.  E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            * Input:           None                                                         E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            * Output:          None                                                         E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            * Side Effects:    None                                                         E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            * Overview:        This routine should be called from only two places.          E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  One from USBCtrlEPServiceComplete() and one from             E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  USBCtrlTrfInHandler(). It takes care of managing a           E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  transfer over multiple USB transactions.                     E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            * Note:            This routine works with isochronous endpoint larger than     E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  256 bytes and is shown here as an example of how to deal     E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  with BC9 and BC8. In reality, a control endpoint can never   E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  be larger than 64 bytes.                                     E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            *****************************************************************************/  E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
000e18   cfd9     MOVFF     0xfd9,0xfe6    void USBCtrlTrfTxService(void)                                                   E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
000e1a   ffe6                                                                                                               
000e1c   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
000e1e   ffd9                                                                                                               
000e20   0e02     MOVLW     0x2                                                                                             
000e22   26e1     ADDWF     0xe1,0x1,0x0                                                                                    
                                           {                                                                                E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                               WORD byte_to_send;                                                           E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                                                                                                            E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                               /*                                                                           E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                                * First, have to figure out how many byte of data to send.                  E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                                */                                                                          E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
000e24   0100     MOVLB     0x0                if(wCount._word < EP0_BUFF_SIZE)                                             E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
000e26   0e08     MOVLW     0x8                                                                                             
000e28   5df6     SUBWF     0xf6,0x0,0x1                                                                                    
000e2a   0e00     MOVLW     0x0                                                                                             
000e2c   59f7     SUBWFB    0xf7,0x0,0x1                                                                                    
000e2e   e205     BC        0xe3a                                                                                           
000e30   c0f6     MOVFF     0xf6,0xfde             byte_to_send._word = wCount._word;                                       E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
000e32   ffde                                                                                                               
000e34   c0f7     MOVFF     0xf7,0xfdd                                                                                      
000e36   ffdd                                                                                                               
000e38   d003     BRA       0xe40              else                                                                         E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
000e3a   0e08     MOVLW     0x8                    byte_to_send._word = EP0_BUFF_SIZE;                                      E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
000e3c   6ede     MOVWF     0xde,0x0                                                                                        
000e3e   6add     CLRF      0xdd,0x0                                                                                        
                                                                                                                            E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                               /*                                                                           E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                                * Next, load the number of bytes to send to BC9..0 in buffer descriptor     E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                                */                                                                          E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
000e40   0104     MOVLB     0x4                ep0Bi.Stat.BC9 = 0;                                                          E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
000e42   9304     BCF       0x4,0x1,0x1                                                                                     
000e44   9104     BCF       0x4,0x0,0x1        ep0Bi.Stat.BC8 = 0;                                                          E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
000e46   0e01     MOVLW     0x1                ep0Bi.Stat._byte |= MSB(byte_to_send);                                       E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
000e48   50db     MOVF      0xdb,0x0,0x0                                                                                    
000e4a   1304     IORWF     0x4,0x1,0x1                                                                                     
000e4c   cfdf     MOVFF     0xfdf,0x405        ep0Bi.Cnt = LSB(byte_to_send);                                               E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
000e4e   f405                                                                                                               
                                                                                                                            E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                               /*                                                                           E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                                * Subtract the number of bytes just about to be sent from the total.        E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                                */                                                                          E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
000e50   0e00     MOVLW     0x0                wCount._word = wCount._word - byte_to_send._word;                            E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
000e52   50db     MOVF      0xdb,0x0,0x0                                                                                    
000e54   0100     MOVLB     0x0                                                                                             
000e56   5ff6     SUBWF     0xf6,0x1,0x1                                                                                    
000e58   0e01     MOVLW     0x1                                                                                             
000e5a   50db     MOVF      0xdb,0x0,0x0                                                                                    
000e5c   5bf7     SUBWFB    0xf7,0x1,0x1                                                                                    
                                                                                                                            E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
000e5e   0e28     MOVLW     0x28               pDst.bRam = (byte*)&CtrlTrfData;        // Set destination pointer           E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
000e60   6ff4     MOVWF     0xf4,0x1                                                                                        
000e62   0e04     MOVLW     0x4                                                                                             
000e64   6ff5     MOVWF     0xf5,0x1                                                                                        
                                                                                                                            E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
000e66   0100     MOVLB     0x0                if(usb_stat.ctrl_trf_mem == _ROM)       // Determine type of memory source   E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
000e68   a3f9     BTFSS     0xf9,0x1,0x1                                                                                    
000e6a   d01e     BRA       0xea8                                                                                           
                                               {                                                                            E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
000e6c   cfd9     MOVFF     0xfd9,0xfe9            while(byte_to_send._word)                                                E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
000e6e   ffe9                                                                                                               
000e70   cfda     MOVFF     0xfda,0xfea                                                                                     
000e72   ffea                                                                                                               
000e74   50ee     MOVF      0xee,0x0,0x0                                                                                    
000e76   10ed     IORWF     0xed,0x0,0x0                                                                                    
000e78   e016     BZ        0xea6                                                                                           
000ea4   d7e3     BRA       0xe6c                                                                                           
                                                   {                                                                        E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
000e7a   c0f2     MOVFF     0xf2,0xff6                 *pDst.bRam = *pSrc.bRom;                                             E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
000e7c   fff6                                                                                                               
000e7e   c0f3     MOVFF     0xf3,0xff7                                                                                      
000e80   fff7                                                                                                               
000e82   0008     TBLRD                                                                                                     
000e84   50f5     MOVF      0xf5,0x0,0x0                                                                                    
000e86   c0f4     MOVFF     0xf4,0xfe9                                                                                      
000e88   ffe9                                                                                                               
000e8a   c0f5     MOVFF     0xf5,0xfea                                                                                      
000e8c   ffea                                                                                                               
000e8e   6eef     MOVWF     0xef,0x0                                                                                        
000e90   0100     MOVLB     0x0                        pDst.bRam++;                                                         E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
000e92   2bf4     INCF      0xf4,0x1,0x1                                                                                    
000e94   0e00     MOVLW     0x0                                                                                             
000e96   23f5     ADDWFC    0xf5,0x1,0x1                                                                                    
000e98   2bf2     INCF      0xf2,0x1,0x1               pSrc.bRom++;                                                         E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
000e9a   23f3     ADDWFC    0xf3,0x1,0x1                                                                                    
000e9c   06df     DECF      0xdf,0x1,0x0               byte_to_send._word--;                                                E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
000e9e   0e01     MOVLW     0x1                                                                                             
000ea0   e201     BC        0xea4                                                                                           
000ea2   06db     DECF      0xdb,0x1,0x0                                                                                    
                                                   }//end while(byte_to_send._word)                                         E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                               }                                                                            E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
000ea6   d01c     BRA       0xee0              else // RAM                                                                  E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                               {                                                                            E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
000ea8   cfd9     MOVFF     0xfd9,0xfe9            while(byte_to_send._word)                                                E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
000eaa   ffe9                                                                                                               
000eac   cfda     MOVFF     0xfda,0xfea                                                                                     
000eae   ffea                                                                                                               
000eb0   50ee     MOVF      0xee,0x0,0x0                                                                                    
000eb2   10ed     IORWF     0xed,0x0,0x0                                                                                    
000eb4   e015     BZ        0xee0                                                                                           
000ede   d7e4     BRA       0xea8                                                                                           
                                                   {                                                                        E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
000eb6   c0f2     MOVFF     0xf2,0xfe9                 *pDst.bRam = *pSrc.bRam;                                             E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
000eb8   ffe9                                                                                                               
000eba   c0f3     MOVFF     0xf3,0xfea                                                                                      
000ebc   ffea                                                                                                               
000ebe   50ef     MOVF      0xef,0x0,0x0                                                                                    
000ec0   c0f4     MOVFF     0xf4,0xfe9                                                                                      
000ec2   ffe9                                                                                                               
000ec4   c0f5     MOVFF     0xf5,0xfea                                                                                      
000ec6   ffea                                                                                                               
000ec8   6eef     MOVWF     0xef,0x0                                                                                        
000eca   0100     MOVLB     0x0                        pDst.bRam++;                                                         E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
000ecc   2bf4     INCF      0xf4,0x1,0x1                                                                                    
000ece   0e00     MOVLW     0x0                                                                                             
000ed0   23f5     ADDWFC    0xf5,0x1,0x1                                                                                    
000ed2   2bf2     INCF      0xf2,0x1,0x1               pSrc.bRam++;                                                         E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
000ed4   23f3     ADDWFC    0xf3,0x1,0x1                                                                                    
000ed6   06df     DECF      0xdf,0x1,0x0               byte_to_send._word--;                                                E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
000ed8   0e01     MOVLW     0x1                                                                                             
000eda   e201     BC        0xede                                                                                           
000edc   06db     DECF      0xdb,0x1,0x0                                                                                    
                                                   }//end while(byte_to_send._word)                                         E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                               }//end if(usb_stat.ctrl_trf_mem == _ROM)                                     E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                                                                                                            E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
000ee0   6ef5     MOVWF     0xf5,0x0       }//end USBCtrlTrfTxService                                                       E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
000ee2   0e02     MOVLW     0x2                                                                                             
000ee4   5ce1     SUBWF     0xe1,0x0,0x0                                                                                    
000ee6   e202     BC        0xeec                                                                                           
000ee8   6ae1     CLRF      0xe1,0x0                                                                                        
000eea   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000eec   6ee1     MOVWF     0xe1,0x0                                                                                        
000eee   50f5     MOVF      0xf5,0x0,0x0                                                                                    
000ef0   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000ef2   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
000ef4   ffd9                                                                                                               
000ef6   0012     RETURN    0x0                                                                                             
                                                                                                                            E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                           /******************************************************************************  E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            * Function:        void USBCtrlTrfRxService(void)                               E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            * PreCondition:    pDst and wCount are setup properly.                          E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  pSrc is always &CtrlTrfData                                  E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  usb_stat.ctrl_trf_mem is always _RAM.                        E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  wCount should be set to 0 at the start of each control       E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  transfer.                                                    E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            * Input:           None                                                         E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            * Output:          None                                                         E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            * Side Effects:    None                                                         E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            * Overview:        *** This routine is only partially complete. Check for       E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  new version of the firmware.                                 E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            * Note:            None                                                         E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            *****************************************************************************/  E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
000ef8   cfd9     MOVFF     0xfd9,0xfe6    void USBCtrlTrfRxService(void)                                                   E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
000efa   ffe6                                                                                                               
000efc   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
000efe   ffd9                                                                                                               
000f00   0e02     MOVLW     0x2                                                                                             
000f02   26e1     ADDWF     0xe1,0x1,0x0                                                                                    
                                           {                                                                                E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                               WORD byte_to_read;                                                           E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                                                                                                            E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
000f04   0e03     MOVLW     0x3                MSB(byte_to_read) = 0x03 & ep0Bo.Stat._byte;    // Filter out last 2 bits    E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
000f06   0104     MOVLB     0x4                                                                                             
000f08   1500     ANDWF     0x0,0x0,0x1                                                                                     
000f0a   6ee7     MOVWF     0xe7,0x0                                                                                        
000f0c   0e01     MOVLW     0x1                                                                                             
000f0e   cfe7     MOVFF     0xfe7,0xfdb                                                                                     
000f10   ffdb                                                                                                               
000f12   c401     MOVFF     0x401,0xfdf        LSB(byte_to_read) = ep0Bo.Cnt;                                               E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
000f14   ffdf                                                                                                               
                                                                                                                            E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                               /*                                                                           E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                                * Accumulate total number of bytes read                                     E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                                */                                                                          E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
000f16   50de     MOVF      0xde,0x0,0x0       wCount._word = wCount._word + byte_to_read._word;                            E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
000f18   0100     MOVLB     0x0                                                                                             
000f1a   27f6     ADDWF     0xf6,0x1,0x1                                                                                    
000f1c   50dd     MOVF      0xdd,0x0,0x0                                                                                    
000f1e   23f7     ADDWFC    0xf7,0x1,0x1                                                                                    
                                                                                                                            E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
000f20   0e28     MOVLW     0x28               pSrc.bRam = (byte*)&CtrlTrfData;                                             E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
000f22   6ff2     MOVWF     0xf2,0x1                                                                                        
000f24   0e04     MOVLW     0x4                                                                                             
000f26   6ff3     MOVWF     0xf3,0x1                                                                                        
                                                                                                                            E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
000f28   cfd9     MOVFF     0xfd9,0xfe9        while(byte_to_read._word)                                                    E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
000f2a   ffe9                                                                                                               
000f2c   cfda     MOVFF     0xfda,0xfea                                                                                     
000f2e   ffea                                                                                                               
000f30   50ee     MOVF      0xee,0x0,0x0                                                                                    
000f32   10ed     IORWF     0xed,0x0,0x0                                                                                    
000f34   e014     BZ        0xf5e                                                                                           
000f5c   d7e5     BRA       0xf28                                                                                           
                                               {                                                                            E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
000f36   c0f2     MOVFF     0xf2,0xfe9             *pDst.bRam = *pSrc.bRam;                                                 E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
000f38   ffe9                                                                                                               
000f3a   c0f3     MOVFF     0xf3,0xfea                                                                                      
000f3c   ffea                                                                                                               
000f3e   50ef     MOVF      0xef,0x0,0x0                                                                                    
000f40   c0f4     MOVFF     0xf4,0xfe9                                                                                      
000f42   ffe9                                                                                                               
000f44   c0f5     MOVFF     0xf5,0xfea                                                                                      
000f46   ffea                                                                                                               
000f48   6eef     MOVWF     0xef,0x0                                                                                        
000f4a   2bf4     INCF      0xf4,0x1,0x1           pDst.bRam++;                                                             E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
000f4c   0e00     MOVLW     0x0                                                                                             
000f4e   23f5     ADDWFC    0xf5,0x1,0x1                                                                                    
000f50   2bf2     INCF      0xf2,0x1,0x1           pSrc.bRam++;                                                             E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
000f52   23f3     ADDWFC    0xf3,0x1,0x1                                                                                    
000f54   06df     DECF      0xdf,0x1,0x0           byte_to_read._word--;                                                    E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
000f56   0e01     MOVLW     0x1                                                                                             
000f58   e201     BC        0xf5c                                                                                           
000f5a   06db     DECF      0xdb,0x1,0x0                                                                                    
                                               }//end while(byte_to_read._word)                                             E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                                                                                                            E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
000f5e   6ef5     MOVWF     0xf5,0x0       }//end USBCtrlTrfRxService                                                       E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
000f60   0e02     MOVLW     0x2                                                                                             
000f62   5ce1     SUBWF     0xe1,0x0,0x0                                                                                    
000f64   e202     BC        0xf6a                                                                                           
000f66   6ae1     CLRF      0xe1,0x0                                                                                        
000f68   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000f6a   6ee1     MOVWF     0xe1,0x0                                                                                        
000f6c   50f5     MOVF      0xf5,0x0,0x0                                                                                    
000f6e   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000f70   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
000f72   ffd9                                                                                                               
000f74   0012     RETURN    0x0                                                                                             
                                                                                                                            E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                           /******************************************************************************  E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            * Function:        void USBCtrlEPServiceComplete(void)                          E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            * PreCondition:    None                                                         E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            * Input:           None                                                         E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            * Output:          None                                                         E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            * Side Effects:    None                                                         E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            * Overview:        This routine wrap up the ramaining tasks in servicing        E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  a Setup Request. Its main task is to set the endpoint        E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  controls appropriately for a given situation. See code       E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  below.                                                       E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  There are three main scenarios:                              E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  a) There was no handler for the Request, in this case        E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            *                     a STALL should be sent out.                               E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  b) The host has requested a read control transfer,           E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            *                     endpoints are required to be setup in a specific way.     E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  c) The host has requested a write control transfer, or       E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            *                     a control data stage is not required, endpoints are       E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            *                     required to be setup in a specific way.                   E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  Packet processing is resumed by clearing PKTDIS bit.         E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            * Note:            None                                                         E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            *****************************************************************************/  E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                           void USBCtrlEPServiceComplete(void)                                              E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                           {                                                                                E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
000f76   0100     MOVLB     0x0                if(ctrl_trf_session_owner == MUID_NULL)                                      E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
000f78   51f1     MOVF      0xf1,0x0,0x1                                                                                    
000f7a   e10c     BNZ       0xf94                                                                                           
                                               {                                                                            E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                                   /*                                                                       E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                                    * If no one knows how to service this request then stall.               E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                                    * Must also prepare EP0 to receive the next SETUP transaction.          E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                                    */                                                                      E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
000f7c   0104     MOVLB     0x4                    ep0Bo.Cnt = EP0_BUFF_SIZE;                                               E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
000f7e   0e08     MOVLW     0x8                                                                                             
000f80   6f01     MOVWF     0x1,0x1                                                                                         
000f82   0e20     MOVLW     0x20                   ep0Bo.ADR = (byte*)&SetupPkt;                                            E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
000f84   6f02     MOVWF     0x2,0x1                                                                                         
000f86   0e04     MOVLW     0x4                                                                                             
000f88   6f03     MOVWF     0x3,0x1                                                                                         
                                                                                                                            E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
000f8a   0e84     MOVLW     0x84                   ep0Bo.Stat._byte = _USIE|_BSTALL;                                        E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
000f8c   6f00     MOVWF     0x0,0x1                                                                                         
000f8e   0104     MOVLB     0x4                    ep0Bi.Stat._byte = _USIE|_BSTALL;                                        E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
000f90   6f04     MOVWF     0x4,0x1                                                                                         
                                               }                                                                            E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
000f92   d035     BRA       0xffe              else    // A module has claimed ownership of the control transfer session.   E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                               {                                                                            E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
000f94   0104     MOVLB     0x4                    if(SetupPkt.DataDir == DEV_TO_HOST)                                      E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
000f96   af20     BTFSS     0x20,0x7,0x1                                                                                    
000f98   d022     BRA       0xfde                                                                                           
                                                   {                                                                        E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
000f9a   0100     MOVLB     0x0                        if(SetupPkt.wLength < wCount._word)                                  E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
000f9c   51f6     MOVF      0xf6,0x0,0x1                                                                                    
000f9e   0104     MOVLB     0x4                                                                                             
000fa0   5d26     SUBWF     0x26,0x0,0x1                                                                                    
000fa2   0100     MOVLB     0x0                                                                                             
000fa4   51f7     MOVF      0xf7,0x0,0x1                                                                                    
000fa6   0104     MOVLB     0x4                                                                                             
000fa8   5927     SUBWFB    0x27,0x0,0x1                                                                                    
000faa   e204     BC        0xfb4                                                                                           
000fac   c426     MOVFF     0x426,0xf6                     wCount._word = SetupPkt.wLength;                                 E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
000fae   f0f6                                                                                                               
000fb0   c427     MOVFF     0x427,0xf7                                                                                      
000fb2   f0f7                                                                                                               
000fb4   df31     RCALL     0xe18                      USBCtrlTrfTxService();                                               E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
000fb6   0100     MOVLB     0x0                        ctrl_trf_state = CTRL_TRF_TX;                                        E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
000fb8   0e01     MOVLW     0x1                                                                                             
000fba   6ff0     MOVWF     0xf0,0x1                                                                                        
                                                       /*                                                                   E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                                        * Control Read:                                                     E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                                        * <SETUP[0]><IN[1]><IN[0]>...<OUT[1]> | <SETUP[0]>                  E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                                        * 1. Prepare OUT EP to respond to early termination                 E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                                        *                                                                   E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                                        * NOTE:                                                             E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                                        * If something went wrong during the control transfer,              E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                                        * the last status stage may not be sent by the host.                E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                                        * When this happens, two different things could happen              E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                                        * depending on the host.                                            E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                                        * a) The host could send out a RESET.                               E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                                        * b) The host could send out a new SETUP transaction                E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                                        *    without sending a RESET first.                                 E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                                        * To properly handle case (b), the OUT EP must be setup             E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                                        * to receive either a zero length OUT transaction, or a             E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                                        * new SETUP transaction.                                            E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                                        *                                                                   E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                                        * Since the SETUP transaction requires the DTS bit to be            E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                                        * DAT0 while the zero length OUT status requires the DTS            E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                                        * bit to be DAT1, the DTS bit check by the hardware should          E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                                        * be disabled. This way the SIE could accept either of              E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                                        * the two transactions.                                             E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                                        *                                                                   E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                                        * Furthermore, the Cnt byte should be set to prepare for            E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                                        * the SETUP data (8-byte or more), and the buffer address           E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                                        * should be pointed to SetupPkt.                                    E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                                        */                                                                  E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
000fbc   0104     MOVLB     0x4                        ep0Bo.Cnt = EP0_BUFF_SIZE;                                           E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
000fbe   0e08     MOVLW     0x8                                                                                             
000fc0   6f01     MOVWF     0x1,0x1                                                                                         
000fc2   0e20     MOVLW     0x20                       ep0Bo.ADR = (byte*)&SetupPkt;                                        E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
000fc4   6f02     MOVWF     0x2,0x1                                                                                         
000fc6   0e04     MOVLW     0x4                                                                                             
000fc8   6f03     MOVWF     0x3,0x1                                                                                         
000fca   0e80     MOVLW     0x80                       ep0Bo.Stat._byte = _USIE;           // Note: DTSEN is 0!             E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
000fcc   6f00     MOVWF     0x0,0x1                                                                                         
                                                                                                                            E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                                       /*                                                                   E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                                        * 2. Prepare IN EP to transfer data, Cnt should have                E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                                        *    been initialized by responsible request owner.                 E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                                        */                                                                  E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
000fce   0104     MOVLB     0x4                        ep0Bi.ADR = (byte*)&CtrlTrfData;                                     E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
000fd0   0e28     MOVLW     0x28                                                                                            
000fd2   6f06     MOVWF     0x6,0x1                                                                                         
000fd4   0e04     MOVLW     0x4                                                                                             
000fd6   6f07     MOVWF     0x7,0x1                                                                                         
000fd8   0ec8     MOVLW     0xc8                       ep0Bi.Stat._byte = _USIE|_DAT1|_DTSEN;                               E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
000fda   6f04     MOVWF     0x4,0x1                                                                                         
                                                   }                                                                        E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
000fdc   d010     BRA       0xffe                  else    // (SetupPkt.DataDir == HOST_TO_DEV)                             E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                                   {                                                                        E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
000fde   0100     MOVLB     0x0                        ctrl_trf_state = CTRL_TRF_RX;                                        E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
000fe0   0e02     MOVLW     0x2                                                                                             
000fe2   6ff0     MOVWF     0xf0,0x1                                                                                        
                                                       /*                                                                   E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                                        * Control Write:                                                    E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                                        * <SETUP[0]><OUT[1]><OUT[0]>...<IN[1]> | <SETUP[0]>                 E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                                        *                                                                   E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                                        * 1. Prepare IN EP to respond to early termination                  E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                                        *                                                                   E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                                        *    This is the same as a Zero Length Packet Response              E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                                        *    for control transfer without a data stage                      E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                                        */                                                                  E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
000fe4   0104     MOVLB     0x4                        ep0Bi.Cnt = 0;                                                       E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
000fe6   6b05     CLRF      0x5,0x1                                                                                         
000fe8   0ec8     MOVLW     0xc8                       ep0Bi.Stat._byte = _USIE|_DAT1|_DTSEN;                               E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
000fea   6f04     MOVWF     0x4,0x1                                                                                         
                                                                                                                            E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                                       /*                                                                   E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                                        * 2. Prepare OUT EP to receive data.                                E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                                        */                                                                  E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
000fec   0104     MOVLB     0x4                        ep0Bo.Cnt = EP0_BUFF_SIZE;                                           E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
000fee   0e08     MOVLW     0x8                                                                                             
000ff0   6f01     MOVWF     0x1,0x1                                                                                         
000ff2   0e28     MOVLW     0x28                       ep0Bo.ADR = (byte*)&CtrlTrfData;                                     E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
000ff4   6f02     MOVWF     0x2,0x1                                                                                         
000ff6   0e04     MOVLW     0x4                                                                                             
000ff8   6f03     MOVWF     0x3,0x1                                                                                         
000ffa   0ec8     MOVLW     0xc8                       ep0Bo.Stat._byte = _USIE|_DAT1|_DTSEN;                               E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
000ffc   6f00     MOVWF     0x0,0x1                                                                                         
                                                   }//end if(SetupPkt.DataDir == DEV_TO_HOST)                               E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                               }//end if(ctrl_trf_session_owner == MUID_NULL)                               E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                                                                                                            E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                               /*                                                                           E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                                * PKTDIS bit is set when a Setup Transaction is received.                   E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                                * Clear to resume packet processing.                                        E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                                */                                                                          E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
000ffe   986d     BCF       0x6d,0x4,0x0       UCONbits.PKTDIS = 0;                                                         E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                                                                                                            E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
001000   0012     RETURN    0x0            }//end USBCtrlEPServiceComplete                                                  E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                                                                                                            E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                           /******************************************************************************  E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            * Function:        void USBPrepareForNextSetupTrf(void)                         E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            * PreCondition:    None                                                         E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            * Input:           None                                                         E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            * Output:          None                                                         E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            * Side Effects:    None                                                         E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            * Overview:        The routine forces EP0 OUT to be ready for a new Setup       E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  transaction, and forces EP0 IN to be owned by CPU.           E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            * Note:            None                                                         E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                            *****************************************************************************/  E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                           void USBPrepareForNextSetupTrf(void)                                             E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                           {                                                                                E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
001002   0100     MOVLB     0x0                ctrl_trf_state = WAIT_SETUP;            // See usbctrltrf.h                  E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
001004   6bf0     CLRF      0xf0,0x1                                                                                        
001006   0104     MOVLB     0x4                ep0Bo.Cnt = EP0_BUFF_SIZE;              // Defined in usbcfg.h               E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
001008   0e08     MOVLW     0x8                                                                                             
00100a   6f01     MOVWF     0x1,0x1                                                                                         
00100c   0e20     MOVLW     0x20               ep0Bo.ADR = (byte*)&SetupPkt;                                                E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
00100e   6f02     MOVWF     0x2,0x1                                                                                         
001010   0e04     MOVLW     0x4                                                                                             
001012   6f03     MOVWF     0x3,0x1                                                                                         
001014   0e88     MOVLW     0x88               ep0Bo.Stat._byte = _USIE|_DAT0|_DTSEN;  // EP0 buff dsc init, see usbmmap.h  E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
001016   6f00     MOVWF     0x0,0x1                                                                                         
001018   0104     MOVLB     0x4                ep0Bi.Stat._byte = _UCPU;               // EP0 IN buffer initialization      E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
00101a   6b04     CLRF      0x4,0x1                                                                                         
00101c   0012     RETURN    0x0            }//end USBPrepareForNextSetupTrf                                                 E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                                                                                                            E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                           /** EOF usbctrltrf.c *********************************************************/  E:\usb20\UIO\system\usb\usbctrltrf\usbctrltrf.c
                                           /*********************************************************************           E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                Microchip USB C18 Firmware Version 1.0                         E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *********************************************************************           E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            * FileName:        usbdrv.c                                                     E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            * Dependencies:    See INCLUDES section below                                   E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            * Processor:       PIC18                                                        E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            * Compiler:        C18 2.30.01+                                                 E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            * Company:         Microchip Technology, Inc.                                   E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            * Software License Agreement                                                    E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            * The software supplied herewith by Microchip Technology Incorporated           E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            * (the 鼎ompany・ for its PICmicroｮ Microcontroller is intended and             E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            * supplied to you, the Company痴 customer, for use solely and                   E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            * exclusively on Microchip PICmicro Microcontroller products. The               E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            * software is owned by the Company and/or its supplier, and is                  E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            * protected under applicable copyright laws. All rights are reserved.           E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            * Any use in violation of the foregoing restrictions may subject the            E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            * user to criminal sanctions under applicable laws, as well as to               E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            * civil liability for the breach of the terms and conditions of this            E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            * license.                                                                      E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            * THIS SOFTWARE IS PROVIDED IN AN 鄭S IS・CONDITION. NO WARRANTIES,             E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            * WHETHER EXPRESS, IMPLIED OR STATUTORY, INCLUDING, BUT NOT LIMITED             E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            * TO, IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A                   E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            * PARTICULAR PURPOSE APPLY TO THIS SOFTWARE. THE COMPANY SHALL NOT,             E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            * IN ANY CIRCUMSTANCES, BE LIABLE FOR SPECIAL, INCIDENTAL OR                    E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            * CONSEQUENTIAL DAMAGES, FOR ANY REASON WHATSOEVER.                             E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            * Author               Date        Comment                                      E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~           E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            * Rawin Rojvanit       11/19/04    Original.                                    E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            ********************************************************************/           E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                           /** I N C L U D E S **********************************************************/  E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                           #include <p18cxxx.h>                                                             E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                           #include "system\typedefs.h"                                                     E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                           #include "system\usb\usb.h"                                                      E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                           #include "io_cfg.h"             // Required for USBCheckBusStatus()              E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                           /** V A R I A B L E S ********************************************************/  E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                           #pragma udata                                                                    E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                           /** P R I V A T E  P R O T O T Y P E S ***************************************/  E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                           void USBModuleEnable(void);                                                      E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                           void USBModuleDisable(void);                                                     E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                           void USBSuspend(void);                                                           E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                           void USBWakeFromSuspend(void);                                                   E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                           void USBProtocolResetHandler(void);                                              E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                           void USB_SOF_Handler(void);                                                      E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                           void USBStallHandler(void);                                                      E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                           void USBErrorHandler(void);                                                      E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                           /** D E C L A R A T I O N S **************************************************/  E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                           #pragma code                                                                     E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                           /******************************************************************************  E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            * Function:        void USBCheckBusStatus(void)                                 E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            * PreCondition:    None                                                         E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            * Input:           None                                                         E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            * Output:          None                                                         E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            * Side Effects:    None                                                         E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            * Overview:        This routine enables/disables the USB module by monitoring   E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                  the USB power signal.                                        E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            * Note:            None                                                         E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *****************************************************************************/  E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                           void USBCheckBusStatus(void)                                                     E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                           {                                                                                E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                               /**************************************************************************  E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                                * Bus Attachment & Detachment Detection                                     E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                                * usb_bus_sense is an i/o pin defined in io_cfg.h                           E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                                *************************************************************************/  E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                               #define USB_BUS_ATTACHED    1                                                E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                               #define USB_BUS_DETACHED    0                                                E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                               if(usb_bus_sense == USB_BUS_ATTACHED)       // Is USB bus attached?          E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                               {                                                                            E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
0011b8   a66d     BTFSS     0x6d,0x3,0x0           if(UCONbits.USBEN == 0)                 // Is the module off?            E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
0011ba   d80f     RCALL     0x11da                     USBModuleEnable();                  // Is off, enable it             E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                               }                                                                            E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
0011bc   d002     BRA       0x11c2             else                                                                         E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                               {                                                                            E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
0011be   b66d     BTFSC     0x6d,0x3,0x0           if(UCONbits.USBEN == 1)                 // Is the module on?             E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
0011c0   d813     RCALL     0x11e8                     USBModuleDisable();                 // Is on, disable it             E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                               }//end if(usb_bus_sense...)                                                  E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                               /*                                                                           E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                                * After enabling the USB module, it takes some time for the voltage         E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                                * on the D+ or D- line to rise high enough to get out of the SE0 condition. E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                                * The USB Reset interrupt should not be unmasked until the SE0 condition is E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                                * cleared. This helps preventing the firmware from misinterpreting this     E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                                * unique event as a USB bus reset from the USB host.                        E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                                */                                                                          E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
0011c2   0100     MOVLB     0x0                if(usb_device_state == ATTACHED_STATE)                                       E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
0011c4   05f8     DECF      0xf8,0x0,0x1                                                                                    
0011c6   e108     BNZ       0x11d8                                                                                          
                                               {                                                                            E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
0011c8   ba6d     BTFSC     0x6d,0x5,0x0           if(!UCONbits.SE0)                                                        E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
0011ca   d006     BRA       0x11d8                                                                                          
                                                   {                                                                        E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
0011cc   6a68     CLRF      0x68,0x0                   UIR = 0;                        // Clear all USB interrupts          E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
0011ce   6a69     CLRF      0x69,0x0                   UIE = 0;                        // Mask all USB interrupts           E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
0011d0   8069     BSF       0x69,0x0,0x0               UIEbits.URSTIE = 1;             // Unmask RESET interrupt            E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
0011d2   8869     BSF       0x69,0x4,0x0               UIEbits.IDLEIE = 1;             // Unmask IDLE interrupt             E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
0011d4   0e02     MOVLW     0x2                        usb_device_state = POWERED_STATE;                                    E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
0011d6   6ff8     MOVWF     0xf8,0x1                                                                                        
                                                   }//end if                           // else wait until SE0 is cleared    E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                               }//end if(usb_device_state == ATTACHED_STATE)                                E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
0011d8   0012     RETURN    0x0            }//end USBCheckBusStatus                                                         E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                           /******************************************************************************  E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            * Function:        void USBModuleEnable(void)                                   E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            * PreCondition:    None                                                         E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            * Input:           None                                                         E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            * Output:          None                                                         E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            * Side Effects:    None                                                         E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            * Overview:        This routine enables the USB module.                         E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                  An end designer should never have to call this routine       E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                  manually. This routine should only be called from            E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                  USBCheckBusStatus().                                         E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            * Note:            See USBCheckBusStatus() for more information.                E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *****************************************************************************/  E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                           void USBModuleEnable(void)                                                       E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                           {                                                                                E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
0011da   6a6d     CLRF      0x6d,0x0           UCON = 0;                                                                    E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
0011dc   6a69     CLRF      0x69,0x0           UIE = 0;                                // Mask all USB interrupts           E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
0011de   866d     BSF       0x6d,0x3,0x0       UCONbits.USBEN = 1;                     // Enable module & attach to bus     E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
0011e0   0100     MOVLB     0x0                usb_device_state = ATTACHED_STATE;      // Defined in usbmmap.c & .h         E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
0011e2   0e01     MOVLW     0x1                                                                                             
0011e4   6ff8     MOVWF     0xf8,0x1                                                                                        
0011e6   0012     RETURN    0x0            }//end USBModuleEnable                                                           E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                           /******************************************************************************  E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            * Function:        void USBModuleDisable(void)                                  E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            * PreCondition:    None                                                         E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            * Input:           None                                                         E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            * Output:          None                                                         E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            * Side Effects:    None                                                         E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            * Overview:        This routine disables the USB module.                        E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                  An end designer should never have to call this routine       E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                  manually. This routine should only be called from            E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                  USBCheckBusStatus().                                         E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            * Note:            See USBCheckBusStatus() for more information.                E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *****************************************************************************/  E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                           void USBModuleDisable(void)                                                      E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                           {                                                                                E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
0011e8   6a6d     CLRF      0x6d,0x0           UCON = 0;                               // Disable module & detach from bus  E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
0011ea   6a69     CLRF      0x69,0x0           UIE = 0;                                // Mask all USB interrupts           E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
0011ec   0100     MOVLB     0x0                usb_device_state = DETACHED_STATE;      // Defined in usbmmap.c & .h         E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
0011ee   6bf8     CLRF      0xf8,0x1                                                                                        
0011f0   0012     RETURN    0x0            }//end USBModuleDisable                                                          E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                           /******************************************************************************  E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            * Function:        void USBSoftDetach(void)                                     E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            * PreCondition:    None                                                         E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            * Input:           None                                                         E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            * Output:          None                                                         E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            * Side Effects:    The device will have to be re-enumerated to function again.  E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            * Overview:        USBSoftDetach electrically disconnects the device from       E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                  the bus. This is done by stop supplying Vusb voltage to      E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                  pull-up resistor. The pull-down resistors on the host        E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                  side will pull both differential signal lines low and        E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                  the host registers the event as a disconnect.                E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                  Since the USB cable is not physically disconnected, the      E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                  power supply through the cable can still be sensed by        E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                  the device. The next time USBCheckBusStatus() function       E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                  is called, it will reconnect the device back to the bus.     E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            * Note:            None                                                         E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *****************************************************************************/  E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                           void USBSoftDetach(void)                                                         E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                           {                                                                                E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
0011f2   eff4     GOTO      0x11e8             USBModuleDisable();                                                          E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
0011f4   f008                                                                                                               
                                           }//end USBSoftDetach                                                             E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                           /******************************************************************************  E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            * Function:        void USBDriverService(void)                                  E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            * PreCondition:    None                                                         E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            * Input:           None                                                         E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            * Output:          None                                                         E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            * Side Effects:    None                                                         E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            * Overview:        This routine is the heart of this firmware. It manages       E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                  all USB interrupts.                                          E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            * Note:            Device state transitions through the following stages:       E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                  DETACHED -> ATTACHED -> POWERED -> DEFAULT ->                E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                  ADDRESS_PENDING -> ADDRESSED -> CONFIGURED -> READY          E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *****************************************************************************/  E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                           void USBDriverService(void)                                                      E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                           {                                                                                E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                               /*                                                                           E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                                * Pointless to continue servicing if USB cable is not even attached.        E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                                */                                                                          E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
0011f6   0100     MOVLB     0x0                if(usb_device_state == DETACHED_STATE) return;                               E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
0011f8   51f8     MOVF      0xf8,0x0,0x1                                                                                    
0011fa   e101     BNZ       0x11fe                                                                                          
0011fc   d03a     BRA       0x1272                                                                                          
                                                                                                                            E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                               /*                                                                           E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                                * Task A: Service USB Activity Interrupt                                    E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                                */                                                                          E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
0011fe   5068     MOVF      0x68,0x0,0x0       if(UIRbits.ACTVIF && UIEbits.ACTVIE)    USBWakeFromSuspend();                E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
001200   0b04     ANDLW     0x4                                                                                             
001202   e004     BZ        0x120c                                                                                          
001204   5069     MOVF      0x69,0x0,0x0                                                                                    
001206   0b04     ANDLW     0x4                                                                                             
001208   e001     BZ        0x120c                                                                                          
00120a   d838     RCALL     0x127c                                                                                          
                                                                                                                            E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                               /*                                                                           E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                                * Pointless to continue servicing if the device is in suspend mode.         E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                                */                                                                          E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
00120c   b26d     BTFSC     0x6d,0x1,0x0       if(UCONbits.SUSPND==1) return;                                               E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
00120e   d031     BRA       0x1272                                                                                          
                                                                                                                            E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                               /*                                                                           E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                                * Task B: Service USB Bus Reset Interrupt.                                  E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                                * When bus reset is received during suspend, ACTVIF will be set first,      E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                                * once the UCONbits.SUSPND is clear, then the URSTIF bit will be asserted.  E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                                * This is why URSTIF is checked after ACTVIF.                               E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                                */                                                                          E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
001210   5068     MOVF      0x68,0x0,0x0       if(UIRbits.URSTIF && UIEbits.URSTIE)    USBProtocolResetHandler();           E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
001212   0b01     ANDLW     0x1                                                                                             
001214   e004     BZ        0x121e                                                                                          
001216   5069     MOVF      0x69,0x0,0x0                                                                                    
001218   0b01     ANDLW     0x1                                                                                             
00121a   e001     BZ        0x121e                                                                                          
00121c   d850     RCALL     0x12be                                                                                          
                                                                                                                            E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                               /*                                                                           E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                                * Task C: Service other USB interrupts                                      E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                                */                                                                          E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
00121e   5068     MOVF      0x68,0x0,0x0       if(UIRbits.IDLEIF && UIEbits.IDLEIE)    USBSuspend();                        E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
001220   0b10     ANDLW     0x10                                                                                            
001222   e004     BZ        0x122c                                                                                          
001224   5069     MOVF      0x69,0x0,0x0                                                                                    
001226   0b10     ANDLW     0x10                                                                                            
001228   e001     BZ        0x122c                                                                                          
00122a   d824     RCALL     0x1274                                                                                          
00122c   5068     MOVF      0x68,0x0,0x0       if(UIRbits.SOFIF && UIEbits.SOFIE)      USB_SOF_Handler();                   E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
00122e   0b40     ANDLW     0x40                                                                                            
001230   e004     BZ        0x123a                                                                                          
001232   5069     MOVF      0x69,0x0,0x0                                                                                    
001234   0b40     ANDLW     0x40                                                                                            
001236   e001     BZ        0x123a                                                                                          
001238   d837     RCALL     0x12a8                                                                                          
00123a   5068     MOVF      0x68,0x0,0x0       if(UIRbits.STALLIF && UIEbits.STALLIE)  USBStallHandler();                   E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
00123c   0b20     ANDLW     0x20                                                                                            
00123e   e004     BZ        0x1248                                                                                          
001240   5069     MOVF      0x69,0x0,0x0                                                                                    
001242   0b20     ANDLW     0x20                                                                                            
001244   e001     BZ        0x1248                                                                                          
001246   d832     RCALL     0x12ac                                                                                          
001248   5068     MOVF      0x68,0x0,0x0       if(UIRbits.UERRIF && UIEbits.UERRIE)    USBErrorHandler();                   E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
00124a   0b02     ANDLW     0x2                                                                                             
00124c   e004     BZ        0x1256                                                                                          
00124e   5069     MOVF      0x69,0x0,0x0                                                                                    
001250   0b02     ANDLW     0x2                                                                                             
001252   e001     BZ        0x1256                                                                                          
001254   d832     RCALL     0x12ba                                                                                          
                                                                                                                            E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                               /*                                                                           E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                                * Pointless to continue servicing if the host has not sent a bus reset.     E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                                * Once bus reset is received, the device transitions into the DEFAULT       E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                                * state and is ready for communication.                                     E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                                */                                                                          E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
001256   0e03     MOVLW     0x3                if(usb_device_state < DEFAULT_STATE) return;                                 E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
001258   0100     MOVLB     0x0                                                                                             
00125a   5df8     SUBWF     0xf8,0x0,0x1                                                                                    
00125c   e201     BC        0x1260                                                                                          
00125e   d009     BRA       0x1272                                                                                          
                                                                                                                            E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                               /*                                                                           E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                                * Task D: Servicing USB Transaction Complete Interrupt                      E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                                */                                                                          E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
001260   5068     MOVF      0x68,0x0,0x0       if(UIRbits.TRNIF && UIEbits.TRNIE)                                           E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
001262   0b08     ANDLW     0x8                                                                                             
001264   e006     BZ        0x1272                                                                                          
001266   5069     MOVF      0x69,0x0,0x0                                                                                    
001268   0b08     ANDLW     0x8                                                                                             
00126a   e003     BZ        0x1272                                                                                          
                                               {                                                                            E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                                   /*                                                                       E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                                    * USBCtrlEPService only services transactions over EP0.                 E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                                    * It ignores all other EP transactions.                                 E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                                    */                                                                      E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
00126c   ec8e     CALL      0xd1c,0x0              USBCtrlEPService();                                                      E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
00126e   f006                                                                                                               
                                                                                                                            E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                                   /*                                                                       E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                                    * Other EP can be serviced later by responsible device class firmware.  E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                                    * Each device driver knows when an OUT or IN transaction is ready by    E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                                    * checking the buffer ownership bit.                                    E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                                    * An OUT EP should always be owned by SIE until the data is ready.      E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                                    * An IN EP should always be owned by CPU until the data is ready.       E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                                    *                                                                       E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                                    * Because of this logic, it is not necessary to save the USTAT value    E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                                    * of non-EP0 transactions.                                              E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                                    */                                                                      E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
001270   9668     BCF       0x68,0x3,0x0           UIRbits.TRNIF = 0;                                                       E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                               }//end if(UIRbits.TRNIF && UIEbits.TRNIE)                                    E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
001272   0012     RETURN    0x0            }//end USBDriverService                                                          E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                           /******************************************************************************  E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            * Function:        void USBSuspend(void)                                        E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            * PreCondition:    None                                                         E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            * Input:           None                                                         E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            * Output:          None                                                         E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            * Side Effects:    None                                                         E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            * Overview:                                                                     E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            * Note:            None                                                         E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *****************************************************************************/  E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                           void USBSuspend(void)                                                            E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                           {                                                                                E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                               /*                                                                           E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                                * NOTE: Do not clear UIRbits.ACTVIF here!                                   E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                                * Reason:                                                                   E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                                * ACTVIF is only generated once an IDLEIF has been generated.               E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                                * This is a 1:1 ratio interrupt generation.                                 E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                                * For every IDLEIF, there will be only one ACTVIF regardless of             E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                                * the number of subsequent bus transitions.                                 E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                                *                                                                           E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                                * If the ACTIF is cleared here, a problem could occur when:                 E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                                * [       IDLE       ][bus activity ->                                      E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                                * <--- 3 ms ----->     ^                                                    E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                                *                ^     ACTVIF=1                                             E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                                *                IDLEIF=1                                                   E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                                *  #           #           #           #   (#=Program polling flags)        E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                                *                          ^                                                E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                                *                          This polling loop will see both                  E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                                *                          IDLEIF=1 and ACTVIF=1.                           E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                                *                          However, the program services IDLEIF first       E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                                *                          because ACTIVIE=0.                               E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                                *                          If this routine clears the only ACTIVIF,         E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                                *                          then it can never get out of the suspend         E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                                *                          mode.                                            E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                                */                                                                          E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
001274   8469     BSF       0x69,0x2,0x0       UIEbits.ACTVIE = 1;                     // Enable bus activity interrupt     E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
001276   9868     BCF       0x68,0x4,0x0       UIRbits.IDLEIF = 0;                                                          E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
001278   826d     BSF       0x6d,0x1,0x0       UCONbits.SUSPND = 1;                    // Put USB module in power conserve  E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                                                                       // mode, SIE clock inactive          E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                               /*                                                                           E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                                * At this point the PIC can go into sleep,idle, or                          E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                                * switch to a slower clock, etc.                                            E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                                */                                                                          E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                               /* Modifiable Section */                                                     E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                               /* End Modifiable Section */                                                 E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
00127a   0012     RETURN    0x0            }//end USBSuspend                                                                E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                           /******************************************************************************  E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            * Function:        void USBWakeFromSuspend(void)                                E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            * PreCondition:    None                                                         E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            * Input:           None                                                         E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            * Output:          None                                                         E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            * Side Effects:    None                                                         E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            * Overview:                                                                     E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            * Note:            None                                                         E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *****************************************************************************/  E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                           void USBWakeFromSuspend(void)                                                    E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                           {                                                                                E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                               /*                                                                           E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                                * If using clock switching, this is the place to restore the                E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                                * original clock frequency.                                                 E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                                */                                                                          E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
00127c   926d     BCF       0x6d,0x1,0x0       UCONbits.SUSPND = 0;                                                         E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
00127e   9469     BCF       0x69,0x2,0x0       UIEbits.ACTVIE = 0;                                                          E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
001280   9468     BCF       0x68,0x2,0x0       UIRbits.ACTVIF = 0;                                                          E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
001282   0012     RETURN    0x0            }//end USBWakeFromSuspend                                                        E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                           /******************************************************************************  E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            * Function:        void USBRemoteWakeup(void)                                   E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            * PreCondition:    None                                                         E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            * Input:           None                                                         E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            * Output:          None                                                         E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            * Side Effects:    None                                                         E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            * Overview:        This function should be called by user when the device       E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                  is waken up by an external stimulus other than ACTIVIF.      E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                  Please read the note below to understand the limitations.    E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            * Note:            The modifiable section in this routine should be changed     E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                  to meet the application needs. Current implementation        E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                  temporary blocks other functions from executing for a        E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                  period of 1-13 ms depending on the core frequency.           E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                  According to USB 2.0 specification section 7.1.7.7,          E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                  "The remote wakeup device must hold the resume signaling     E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                  for at lest 1 ms but for no more than 15 ms."                E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                  The idea here is to use a delay counter loop, using a        E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                  common value that would work over a wide range of core       E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                  frequencies.                                                 E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                  That value selected is 1800. See table below:                E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                  ==========================================================   E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                  Core Freq(MHz)      MIP         RESUME Signal Period (ms)    E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                  ==========================================================   E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                      48              12          1.05                         E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                       4              1           12.6                         E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                  ==========================================================   E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                  * These timing could be incorrect when using code            E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                    optimization or extended instruction mode,                 E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                    or when having other interrupts enabled.                   E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                    Make sure to verify using the MPLAB SIM's Stopwatch        E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *****************************************************************************/  E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                           void USBRemoteWakeup(void)                                                       E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                           {                                                                                E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                               static word delay_count;                                                     E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
001284   0100     MOVLB     0x0                if(usb_stat.RemoteWakeup == 1)          // Check if RemoteWakeup function    E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
001286   a1f9     BTFSS     0xf9,0x0,0x1                                                                                    
001288   d00e     BRA       0x12a6                                                                                          
                                               {                                       // has been enabled by the host.     E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
00128a   dff8     RCALL     0x127c                 USBWakeFromSuspend();               // Unsuspend USB modue               E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
00128c   846d     BSF       0x6d,0x2,0x0           UCONbits.RESUME = 1;                // Start RESUME signaling            E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                                   /* Modifiable Section */                                                 E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
00128e   0100     MOVLB     0x0                    delay_count = 1800U;                // Set RESUME line for 1-13 ms       E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
001290   0e08     MOVLW     0x8                                                                                             
001292   6ffc     MOVWF     0xfc,0x1                                                                                        
001294   0e07     MOVLW     0x7                                                                                             
001296   6ffd     MOVWF     0xfd,0x1                                                                                        
                                                   do                                                                       E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                                   {                                                                        E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
001298   07fc     DECF      0xfc,0x1,0x1               delay_count--;                                                       E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
00129a   0e00     MOVLW     0x0                                                                                             
00129c   5bfd     SUBWFB    0xfd,0x1,0x1                                                                                    
00129e   51fc     MOVF      0xfc,0x0,0x1           }while(delay_count);                                                     E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
0012a0   11fd     IORWF     0xfd,0x0,0x1                                                                                    
0012a2   e1fa     BNZ       0x1298                                                                                          
                                                                                                                            E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                                   /* End Modifiable Section */                                             E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
0012a4   946d     BCF       0x6d,0x2,0x0           UCONbits.RESUME = 0;                                                     E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                               }//endif                                                                     E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
0012a6   0012     RETURN    0x0            }//end USBRemoteWakeup                                                           E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                           /******************************************************************************  E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            * Function:        void USB_SOF_Handler(void)                                   E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            * PreCondition:    None                                                         E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            * Input:           None                                                         E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            * Output:          None                                                         E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            * Side Effects:    None                                                         E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            * Overview:        The USB host sends out a SOF packet to full-speed devices    E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                  every 1 ms. This interrupt may be useful for isochronous     E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                  pipes. End designers should implement callback routine       E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                  as necessary.                                                E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            * Note:            None                                                         E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *****************************************************************************/  E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                           void USB_SOF_Handler(void)                                                       E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                           {                                                                                E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                               /* Callback routine here */                                                  E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
0012a8   9c68     BCF       0x68,0x6,0x0       UIRbits.SOFIF = 0;                                                           E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
0012aa   0012     RETURN    0x0            }//end USB_SOF_Handler                                                           E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                           /******************************************************************************  E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            * Function:        void USBStallHandler(void)                                   E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            * PreCondition:    A STALL packet is sent to the host by the SIE.               E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            * Input:           None                                                         E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            * Output:          None                                                         E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            * Side Effects:    None                                                         E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            * Overview:        The STALLIF is set anytime the SIE sends out a STALL         E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                  packet regardless of which endpoint causes it.               E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                  A Setup transaction overrides the STALL function. A stalled  E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                  endpoint stops stalling once it receives a setup packet.     E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                  In this case, the SIE will accepts the Setup packet and      E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                  set the TRNIF flag to notify the firmware. STALL function    E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                  for that particular endpoint pipe will be automatically      E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                  disabled (direction specific).                               E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                  There are a few reasons for an endpoint to be stalled.       E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                  1. When a non-supported USB request is received.             E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                     Example: GET_DESCRIPTOR(DEVICE_QUALIFIER)                 E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                  2. When an endpoint is currently halted.                     E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                  3. When the device class specifies that an endpoint must     E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                     stall in response to a specific event.                    E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                     Example: Mass Storage Device Class                        E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                              If the CBW is not valid, the device shall        E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                              STALL the Bulk-In pipe.                          E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                              See USB Mass Storage Class Bulk-only Transport   E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                              Specification for more details.                  E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            * Note:            UEPn.EPSTALL can be scanned to see which endpoint causes     E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                  the stall event.                                             E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                  If                                                           E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *****************************************************************************/  E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                           void USBStallHandler(void)                                                       E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                           {                                                                                E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                               /*                                                                           E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                                * Does not really have to do anything here,                                 E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                                * even for the control endpoint.                                            E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                                * All BDs of Endpoint 0 are owned by SIE right now,                         E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                                * but once a Setup Transaction is received, the ownership                   E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                                * for EP0_OUT will be returned to CPU.                                      E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                                * When the Setup Transaction is serviced, the ownership                     E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                                * for EP0_IN will then be forced back to CPU by firmware.                   E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                                *                                                                           E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                                * NOTE: Above description is not quite true at this point.                  E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                                *       It seems the SIE never returns the UOWN bit to CPU,                 E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                                *       and a TRNIF is never generated upon successful                      E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                                *       reception of a SETUP transaction.                                   E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                                *       Firmware work-around is implemented below.                          E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                                */                                                                          E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
0012ac   a070     BTFSS     0x70,0x0,0x0       if(UEP0bits.EPSTALL == 1)                                                    E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
0012ae   d003     BRA       0x12b6                                                                                          
                                               {                                                                            E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
0012b0   ec01     CALL      0x1002,0x0             USBPrepareForNextSetupTrf();        // Firmware Work-Around              E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
0012b2   f008                                                                                                               
0012b4   9070     BCF       0x70,0x0,0x0           UEP0bits.EPSTALL = 0;                                                    E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                               }                                                                            E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
0012b6   9a68     BCF       0x68,0x5,0x0       UIRbits.STALLIF = 0;                                                         E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
0012b8   0012     RETURN    0x0            }//end USBStallHandler                                                           E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                           /******************************************************************************  E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            * Function:        void USBErrorHandler(void)                                   E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            * PreCondition:    None                                                         E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            * Input:           None                                                         E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            * Output:          None                                                         E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            * Side Effects:    None                                                         E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            * Overview:        The purpose of this interrupt is mainly for debugging        E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                  during development. Check UEIR to see which error causes     E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                  the interrupt.                                               E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            * Note:            None                                                         E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *****************************************************************************/  E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                           void USBErrorHandler(void)                                                       E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                           {                                                                                E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
0012ba   9268     BCF       0x68,0x1,0x0       UIRbits.UERRIF = 0;                                                          E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
0012bc   0012     RETURN    0x0            }//end USBErrorHandler                                                           E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                           /******************************************************************************  E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            * Function:        void USBProtocolResetHandler(void)                           E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            * PreCondition:    A USB bus reset is received from the host.                   E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            * Input:           None                                                         E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            * Output:          None                                                         E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            * Side Effects:    Currently, this routine flushes any pending USB              E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                  transactions. It empties out the USTAT FIFO. This action     E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                  might not be desirable in some applications.                 E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            * Overview:        Once a USB bus reset is received from the host, this         E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                  routine should be called. It resets the device address to    E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                  zero, disables all non-EP0 endpoints, initializes EP0 to     E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                  be ready for default communication, clears all USB           E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                  interrupt flags, unmasks applicable USB interrupts, and      E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                  reinitializes internal state-machine variables.              E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            * Note:            None                                                         E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                            *****************************************************************************/  E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                           void USBProtocolResetHandler(void)                                               E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                           {                                                                                E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
0012be   6a6a     CLRF      0x6a,0x0           UEIR = 0;                       // Clear all USB error flags                 E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
0012c0   6a68     CLRF      0x68,0x0           UIR = 0;                        // Clears all USB interrupts                 E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
0012c2   0e9f     MOVLW     0x9f               UEIE = 0b10011111;              // Unmask all USB error interrupts           E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
0012c4   6e6b     MOVWF     0x6b,0x0                                                                                        
0012c6   0e7b     MOVLW     0x7b               UIE = 0b01111011;               // Enable all interrupts except ACTVIE       E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
0012c8   6e69     MOVWF     0x69,0x0                                                                                        
                                                                                                                            E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
0012ca   6a6e     CLRF      0x6e,0x0           UADDR = 0x00;                   // Reset to default address                  E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
0012cc   0e0f     MOVLW     0xf                mDisableEP1to15();              // Reset all non-EP0 UEPn registers          E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
0012ce   6ee6     MOVWF     0xe6,0x0                                                                                        
0012d0   0e71     MOVLW     0x71                                                                                            
0012d2   6ee6     MOVWF     0xe6,0x0                                                                                        
0012d4   0e0f     MOVLW     0xf                                                                                             
0012d6   6ee6     MOVWF     0xe6,0x0                                                                                        
0012d8   d814     RCALL     0x1302                                                                                          
0012da   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0012dc   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0012de   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0012e0   0e16     MOVLW     0x16               UEP0 = EP_CTRL|HSHK_EN;         // Init EP0 as a Ctrl EP, see usbdrv.h       E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
0012e2   6e70     MOVWF     0x70,0x0                                                                                        
                                                                                                                            E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
0012e4   a668     BTFSS     0x68,0x3,0x0       while(UIRbits.TRNIF == 1)       // Flush any pending transactions            E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
0012e6   d002     BRA       0x12ec                                                                                          
0012ea   d7fc     BRA       0x12e4                                                                                          
0012e8   9668     BCF       0x68,0x3,0x0           UIRbits.TRNIF = 0;                                                       E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
0012ec   986d     BCF       0x6d,0x4,0x0       UCONbits.PKTDIS = 0;            // Make sure packet processing is enabled    E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
0012ee   ec01     CALL      0x1002,0x0         USBPrepareForNextSetupTrf();    // Declared in usbctrltrf.c                  E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
0012f0   f008                                                                                                               
                                                                                                                            E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
0012f2   0100     MOVLB     0x0                usb_stat.RemoteWakeup = 0;      // Default status flag to disable            E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
0012f4   91f9     BCF       0xf9,0x0,0x1                                                                                    
0012f6   0100     MOVLB     0x0                usb_active_cfg = 0;             // Clear active configuration                E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
0012f8   6bfa     CLRF      0xfa,0x1                                                                                        
0012fa   0100     MOVLB     0x0                usb_device_state = DEFAULT_STATE;                                            E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
0012fc   0e03     MOVLW     0x3                                                                                             
0012fe   6ff8     MOVWF     0xf8,0x1                                                                                        
001300   0012     RETURN    0x0            }//end USBProtocolResetHandler                                                   E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                           /* Auxiliary Function */                                                         E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
001302   cfd9     MOVFF     0xfd9,0xfe6    void ClearArray(byte* startAdr,byte count)                                       E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
001304   ffe6                                                                                                               
001306   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
001308   ffd9                                                                                                               
                                           {                                                                                E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
00130a   0efd     MOVLW     0xfd               *startAdr;                                                                   E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
00130c   cfdb     MOVFF     0xfdb,0xfe9                                                                                     
00130e   ffe9                                                                                                               
001310   0efe     MOVLW     0xfe                                                                                            
001312   cfdb     MOVFF     0xfdb,0xfea                                                                                     
001314   ffea                                                                                                               
001316   0efc     MOVLW     0xfc               while(count)                                                                 E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
001318   50db     MOVF      0xdb,0x0,0x0                                                                                    
00131a   e004     BZ        0x1324                                                                                          
001322   d7f9     BRA       0x1316                                                                                          
                                               {                                                                            E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                                   _asm                                                                     E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
00131c   6aee     CLRF      0xee,0x0               clrf POSTINC0,0                                                          E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                                   _endasm                                                                  E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
00131e   0efc     MOVLW     0xfc                   count--;                                                                 E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
001320   06db     DECF      0xdb,0x1,0x0                                                                                    
                                               }//end while                                                                 E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
001324   52e5     MOVF      0xe5,0x1,0x0   }//end ClearArray                                                                E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
001326   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
001328   ffd9                                                                                                               
00132a   0012     RETURN    0x0                                                                                             
                                                                                                                            E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                           /** EOF usbdrv.c *************************************************************/  E:\usb20\UIO\system\usb\usbdrv\usbdrv.c
                                           /*********************************************************************           E:\usb20\UIO\system\usb\usbmmap.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbmmap.c
                                            *                Microchip USB C18 Firmware Version 1.0                         E:\usb20\UIO\system\usb\usbmmap.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbmmap.c
                                            *********************************************************************           E:\usb20\UIO\system\usb\usbmmap.c
                                            * FileName:        usbmmap.c                                                    E:\usb20\UIO\system\usb\usbmmap.c
                                            * Dependencies:    See INCLUDES section below                                   E:\usb20\UIO\system\usb\usbmmap.c
                                            * Processor:       PIC18                                                        E:\usb20\UIO\system\usb\usbmmap.c
                                            * Compiler:        C18 2.30.01+                                                 E:\usb20\UIO\system\usb\usbmmap.c
                                            * Company:         Microchip Technology, Inc.                                   E:\usb20\UIO\system\usb\usbmmap.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbmmap.c
                                            * Software License Agreement                                                    E:\usb20\UIO\system\usb\usbmmap.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbmmap.c
                                            * The software supplied herewith by Microchip Technology Incorporated           E:\usb20\UIO\system\usb\usbmmap.c
                                            * (the 鼎ompany) for its PICmicroｮ Microcontroller is intended and             E:\usb20\UIO\system\usb\usbmmap.c
                                            * supplied to you, the Company痴 customer, for use solely and                   E:\usb20\UIO\system\usb\usbmmap.c
                                            * exclusively on Microchip PICmicro Microcontroller products. The               E:\usb20\UIO\system\usb\usbmmap.c
                                            * software is owned by the Company and/or its supplier, and is                  E:\usb20\UIO\system\usb\usbmmap.c
                                            * protected under applicable copyright laws. All rights are reserved.           E:\usb20\UIO\system\usb\usbmmap.c
                                            * Any use in violation of the foregoing restrictions may subject the            E:\usb20\UIO\system\usb\usbmmap.c
                                            * user to criminal sanctions under applicable laws, as well as to               E:\usb20\UIO\system\usb\usbmmap.c
                                            * civil liability for the breach of the terms and conditions of this            E:\usb20\UIO\system\usb\usbmmap.c
                                            * license.                                                                      E:\usb20\UIO\system\usb\usbmmap.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbmmap.c
                                            * THIS SOFTWARE IS PROVIDED IN AN 鄭S IS CONDITION. NO WARRANTIES,             E:\usb20\UIO\system\usb\usbmmap.c
                                            * WHETHER EXPRESS, IMPLIED OR STATUTORY, INCLUDING, BUT NOT LIMITED             E:\usb20\UIO\system\usb\usbmmap.c
                                            * TO, IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A                   E:\usb20\UIO\system\usb\usbmmap.c
                                            * PARTICULAR PURPOSE APPLY TO THIS SOFTWARE. THE COMPANY SHALL NOT,             E:\usb20\UIO\system\usb\usbmmap.c
                                            * IN ANY CIRCUMSTANCES, BE LIABLE FOR SPECIAL, INCIDENTAL OR                    E:\usb20\UIO\system\usb\usbmmap.c
                                            * CONSEQUENTIAL DAMAGES, FOR ANY REASON WHATSOEVER.                             E:\usb20\UIO\system\usb\usbmmap.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbmmap.c
                                            * Author               Date        Comment                                      E:\usb20\UIO\system\usb\usbmmap.c
                                            *~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~           E:\usb20\UIO\system\usb\usbmmap.c
                                            * Rawin Rojvanit       11/19/04    Original.                                    E:\usb20\UIO\system\usb\usbmmap.c
                                            ********************************************************************/           E:\usb20\UIO\system\usb\usbmmap.c
                                                                                                                            E:\usb20\UIO\system\usb\usbmmap.c
                                           /******************************************************************************  E:\usb20\UIO\system\usb\usbmmap.c
                                            * -usbmmap.c-                                                                   E:\usb20\UIO\system\usb\usbmmap.c
                                            * USB Memory Map                                                                E:\usb20\UIO\system\usb\usbmmap.c
                                            * This file is the USB memory manager; it serves as a compile-time memory       E:\usb20\UIO\system\usb\usbmmap.c
                                            * allocator for the USB endpoints. It uses the compile time options passed      E:\usb20\UIO\system\usb\usbmmap.c
                                            * from usbcfg.h to instantiate endpoints and endpoint buffer.                   E:\usb20\UIO\system\usb\usbmmap.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbmmap.c
                                            * Each endpoint requires to have a set of Buffer Descriptor registers(BDT).     E:\usb20\UIO\system\usb\usbmmap.c
                                            * A BDT is 4-byte long and has a specific RAM location for each endpoint.       E:\usb20\UIO\system\usb\usbmmap.c
                                            * The BDT for endpoint 0 out is located at address 0x400 to 0x403.              E:\usb20\UIO\system\usb\usbmmap.c
                                            * The BDT for endpoint 0 in is located at address 0x404 to 0x407.               E:\usb20\UIO\system\usb\usbmmap.c
                                            * The BDT for endpoint 1 out is located at address 0x408 to 0x40B.              E:\usb20\UIO\system\usb\usbmmap.c
                                            * and so on... The above allocation assumes the Ping-Pong Buffer Mode 0 is      E:\usb20\UIO\system\usb\usbmmap.c
                                            * used. These locations are already hard-wired in the silicon. The point        E:\usb20\UIO\system\usb\usbmmap.c
                                            * of doing instantiation, i.e. volatile far BDT ep0Bo;, is to provide the       E:\usb20\UIO\system\usb\usbmmap.c
                                            * C compiler a way to address each variable directly. This is very important    E:\usb20\UIO\system\usb\usbmmap.c
                                            * because when a register can be accessed directly, it saves execution time     E:\usb20\UIO\system\usb\usbmmap.c
                                            * and reduces program size.                                                     E:\usb20\UIO\system\usb\usbmmap.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbmmap.c
                                            * Endpoints are defined using the endpoint number and the direction             E:\usb20\UIO\system\usb\usbmmap.c
                                            * of transfer. For simplicity, usbmmap.c only uses the endpoint number          E:\usb20\UIO\system\usb\usbmmap.c
                                            * in the BDT register allocation scheme. This means if the usbcfg.h states      E:\usb20\UIO\system\usb\usbmmap.c
                                            * that the MAX_EP_NUMBER is number 1, then four BDTs will be                    E:\usb20\UIO\system\usb\usbmmap.c
                                            * instantiated: one each for endpoint0 in and endpoint0 out, which must         E:\usb20\UIO\system\usb\usbmmap.c
                                            * always be instantiated for control transfer by default, and one each sets     E:\usb20\UIO\system\usb\usbmmap.c
                                            * for endpoint1 in and endpoint1 out. The naming convention for instantiating   E:\usb20\UIO\system\usb\usbmmap.c
                                            * BDT is                                                                        E:\usb20\UIO\system\usb\usbmmap.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbmmap.c
                                            * ep<#>B<d>                                                                     E:\usb20\UIO\system\usb\usbmmap.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbmmap.c
                                            * where # is the endpoint number, and d is the direction of                     E:\usb20\UIO\system\usb\usbmmap.c
                                            * transfer, which could be either <i> or <o>.                                   E:\usb20\UIO\system\usb\usbmmap.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbmmap.c
                                            * The USB memory manager uses MAX_EP_NUMBER, as defined in usbcfg.h, to define  E:\usb20\UIO\system\usb\usbmmap.c
                                            * the endpoints to be instantiated. This represents the highest endpoint        E:\usb20\UIO\system\usb\usbmmap.c
                                            * number to be allocated, not how many endpoints are used. Since the BDTs for   E:\usb20\UIO\system\usb\usbmmap.c
                                            * endpoints have hardware-assigned addresses in Bank 4, setting this value too  E:\usb20\UIO\system\usb\usbmmap.c
                                            * high may lead to inefficient use of data RAM. For example, if an application  E:\usb20\UIO\system\usb\usbmmap.c
                                            * uses only endpoints EP0 and EP4, then the MAX_EP_NUMBER is 4, and not 2.      E:\usb20\UIO\system\usb\usbmmap.c
                                            * The in-between endpoint BDTs in this example (EP1, EP2, and EP3) go unused,   E:\usb20\UIO\system\usb\usbmmap.c
                                            * and the 24 bytes of memory associated with them are wasted. It does not make  E:\usb20\UIO\system\usb\usbmmap.c
                                            * much sense to skip endpoints, but the final decision lies with the user.      E:\usb20\UIO\system\usb\usbmmap.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbmmap.c
                                            * The next step is to assign the instantiated BDTs to different                 E:\usb20\UIO\system\usb\usbmmap.c
                                            * USB functions. The firmware framework fundamentally assumes that every USB    E:\usb20\UIO\system\usb\usbmmap.c
                                            * function should know which endpoint it is using, i.e., the default control    E:\usb20\UIO\system\usb\usbmmap.c
                                            * transfer should know that it is using endpoint 0 in and endpoint 0 out.       E:\usb20\UIO\system\usb\usbmmap.c
                                            * A HID class can choose which endpoint it wants to use, but once chosen, it    E:\usb20\UIO\system\usb\usbmmap.c
                                            * should always know the number of the endpoint.                                E:\usb20\UIO\system\usb\usbmmap.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbmmap.c
                                            * The assignment of endpoints to USB functions is managed centrally             E:\usb20\UIO\system\usb\usbmmap.c
                                            * in usbcfg.h. This helps prevent the mistake of having more                    E:\usb20\UIO\system\usb\usbmmap.c
                                            * than one USB function using the same endpoint. The "Endpoint Allocation"      E:\usb20\UIO\system\usb\usbmmap.c
                                            * section in usbcfg.h provides examples for how to map USB endpoints to USB     E:\usb20\UIO\system\usb\usbmmap.c
                                            * functions.                                                                    E:\usb20\UIO\system\usb\usbmmap.c
                                            * Quite a few things can be mapped in that section. There is no                 E:\usb20\UIO\system\usb\usbmmap.c
                                            * one correct way to do the mapping and the user has the choice to              E:\usb20\UIO\system\usb\usbmmap.c
                                            * choose a method that is most suitable to the application.                     E:\usb20\UIO\system\usb\usbmmap.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbmmap.c
                                            * Typically, however, a user will want to map the following for a given         E:\usb20\UIO\system\usb\usbmmap.c
                                            * USB interface function:                                                       E:\usb20\UIO\system\usb\usbmmap.c
                                            * 1. The USB interface ID                                                       E:\usb20\UIO\system\usb\usbmmap.c
                                            * 2. The endpoint control registers (UEPn)                                      E:\usb20\UIO\system\usb\usbmmap.c
                                            * 3. The BDT registers (ep<#>B<d>)                                              E:\usb20\UIO\system\usb\usbmmap.c
                                            * 4. The endpoint size                                                          E:\usb20\UIO\system\usb\usbmmap.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbmmap.c
                                            * Example: Assume a USB device class "foo", which uses one out endpoint         E:\usb20\UIO\system\usb\usbmmap.c
                                            *          of size 64-byte and one in endpoint of size 64-byte, then:           E:\usb20\UIO\system\usb\usbmmap.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbmmap.c
                                            * #define FOO_INTF_ID          0x00                                             E:\usb20\UIO\system\usb\usbmmap.c
                                            * #define FOO_UEP              UEP1                                             E:\usb20\UIO\system\usb\usbmmap.c
                                            * #define FOO_BD_OUT           ep1Bo                                            E:\usb20\UIO\system\usb\usbmmap.c
                                            * #define FOO_BD_IN            ep1Bi                                            E:\usb20\UIO\system\usb\usbmmap.c
                                            * #define FOO_EP_SIZE          64                                               E:\usb20\UIO\system\usb\usbmmap.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbmmap.c
                                            * The mapping above has chosen class "foo" to use endpoint 1.                   E:\usb20\UIO\system\usb\usbmmap.c
                                            * The names are arbitrary and can be anything other than FOO_??????.            E:\usb20\UIO\system\usb\usbmmap.c
                                            * For abstraction, the code for class "foo" should use the abstract             E:\usb20\UIO\system\usb\usbmmap.c
                                            * definitions of FOO_BD_OUT,FOO_BD_IN, and not ep1Bo or ep1Bi.                  E:\usb20\UIO\system\usb\usbmmap.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbmmap.c
                                            * Note that the endpoint size defined in the usbcfg.h file is again             E:\usb20\UIO\system\usb\usbmmap.c
                                            * used in the usbmmap.c file. This shows that the relationship between          E:\usb20\UIO\system\usb\usbmmap.c
                                            * the two files are tightly related.                                            E:\usb20\UIO\system\usb\usbmmap.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbmmap.c
                                            * The endpoint buffer for each USB function must be located in the              E:\usb20\UIO\system\usb\usbmmap.c
                                            * dual-port RAM area and has to come after all the BDTs have been               E:\usb20\UIO\system\usb\usbmmap.c
                                            * instantiated. An example declaration is:                                      E:\usb20\UIO\system\usb\usbmmap.c
                                            * volatile far unsigned char[FOO_EP_SIZE] data;                                 E:\usb20\UIO\system\usb\usbmmap.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbmmap.c
                                            * The 'volatile' keyword tells the compiler not to perform any code             E:\usb20\UIO\system\usb\usbmmap.c
                                            * optimization on this variable because its content could be modified           E:\usb20\UIO\system\usb\usbmmap.c
                                            * by the hardware. The 'far' keyword tells the compiler that this variable      E:\usb20\UIO\system\usb\usbmmap.c
                                            * is not located in the Access RAM area (0x000 - 0x05F).                        E:\usb20\UIO\system\usb\usbmmap.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbmmap.c
                                            * For the variable to be globally accessible by other files, it should be       E:\usb20\UIO\system\usb\usbmmap.c
                                            * declared in the header file usbmmap.h as an extern definition, such as        E:\usb20\UIO\system\usb\usbmmap.c
                                            * extern volatile far unsigned char[FOO_EP_SIZE] data;                          E:\usb20\UIO\system\usb\usbmmap.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbmmap.c
                                            * Conclusion:                                                                   E:\usb20\UIO\system\usb\usbmmap.c
                                            * In a short summary, the dependencies between usbcfg and usbmmap can           E:\usb20\UIO\system\usb\usbmmap.c
                                            * be shown as:                                                                  E:\usb20\UIO\system\usb\usbmmap.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbmmap.c
                                            * usbcfg[MAX_EP_NUMBER] -> usbmmap                                              E:\usb20\UIO\system\usb\usbmmap.c
                                            * usbmmap[ep<#>B<d>] -> usbcfg                                                  E:\usb20\UIO\system\usb\usbmmap.c
                                            * usbcfg[EP size] -> usbmmap                                                    E:\usb20\UIO\system\usb\usbmmap.c
                                            * usbcfg[abstract ep definitions] -> usb9/hid/cdc/etc class code                E:\usb20\UIO\system\usb\usbmmap.c
                                            * usbmmap[endpoint buffer variable] -> usb9/hid/cdc/etc class code              E:\usb20\UIO\system\usb\usbmmap.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbmmap.c
                                            * Data mapping provides a means for direct addressing of BDT and endpoint       E:\usb20\UIO\system\usb\usbmmap.c
                                            * buffer. This means less usage of pointers, which equates to a faster and      E:\usb20\UIO\system\usb\usbmmap.c
                                            * smaller program code.                                                         E:\usb20\UIO\system\usb\usbmmap.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbmmap.c
                                            *****************************************************************************/  E:\usb20\UIO\system\usb\usbmmap.c
                                                                                                                            E:\usb20\UIO\system\usb\usbmmap.c
                                           /** I N C L U D E S **********************************************************/  E:\usb20\UIO\system\usb\usbmmap.c
                                           #include "system\typedefs.h"                                                     E:\usb20\UIO\system\usb\usbmmap.c
                                           #include "system\usb\usb.h"                                                      E:\usb20\UIO\system\usb\usbmmap.c
                                                                                                                            E:\usb20\UIO\system\usb\usbmmap.c
                                           /** U S B  G L O B A L  V A R I A B L E S ************************************/  E:\usb20\UIO\system\usb\usbmmap.c
                                           #pragma udata                                                                    E:\usb20\UIO\system\usb\usbmmap.c
                                           byte usb_device_state;          // Device States: DETACHED, ATTACHED, ...        E:\usb20\UIO\system\usb\usbmmap.c
                                           USB_DEVICE_STATUS usb_stat;     // Global USB flags                              E:\usb20\UIO\system\usb\usbmmap.c
                                           byte usb_active_cfg;            // Value of current configuration                E:\usb20\UIO\system\usb\usbmmap.c
                                           byte usb_alt_intf[MAX_NUM_INT]; // Array to keep track of the current alternate  E:\usb20\UIO\system\usb\usbmmap.c
                                                                           // setting for each interface ID                 E:\usb20\UIO\system\usb\usbmmap.c
                                                                                                                            E:\usb20\UIO\system\usb\usbmmap.c
                                           /** U S B  F I X E D  L O C A T I O N  V A R I A B L E S *********************/  E:\usb20\UIO\system\usb\usbmmap.c
                                           #pragma udata usbram4=0x400     //See Linker Script,usb4:0x400-0x4FF(256-byte)   E:\usb20\UIO\system\usb\usbmmap.c
                                                                                                                            E:\usb20\UIO\system\usb\usbmmap.c
                                           /******************************************************************************  E:\usb20\UIO\system\usb\usbmmap.c
                                            * Section A: Buffer Descriptor Table                                            E:\usb20\UIO\system\usb\usbmmap.c
                                            * - 0x400 - 0x4FF(max)                                                          E:\usb20\UIO\system\usb\usbmmap.c
                                            * - MAX_EP_NUMBER is defined in autofiles\usbcfg.h                              E:\usb20\UIO\system\usb\usbmmap.c
                                            * - BDT data type is defined in system\usb\usbmmap.h                            E:\usb20\UIO\system\usb\usbmmap.c
                                            *****************************************************************************/  E:\usb20\UIO\system\usb\usbmmap.c
                                                                                                                            E:\usb20\UIO\system\usb\usbmmap.c
                                           #if(0 <= MAX_EP_NUMBER)                                                          E:\usb20\UIO\system\usb\usbmmap.c
                                           volatile far BDT ep0Bo;         //Endpoint #0 BD Out                             E:\usb20\UIO\system\usb\usbmmap.c
                                           volatile far BDT ep0Bi;         //Endpoint #0 BD In                              E:\usb20\UIO\system\usb\usbmmap.c
                                           #endif                                                                           E:\usb20\UIO\system\usb\usbmmap.c
                                                                                                                            E:\usb20\UIO\system\usb\usbmmap.c
                                           #if(1 <= MAX_EP_NUMBER)                                                          E:\usb20\UIO\system\usb\usbmmap.c
                                           volatile far BDT ep1Bo;         //Endpoint #1 BD Out                             E:\usb20\UIO\system\usb\usbmmap.c
                                           volatile far BDT ep1Bi;         //Endpoint #1 BD In                              E:\usb20\UIO\system\usb\usbmmap.c
                                           #endif                                                                           E:\usb20\UIO\system\usb\usbmmap.c
                                                                                                                            E:\usb20\UIO\system\usb\usbmmap.c
                                           #if(2 <= MAX_EP_NUMBER)                                                          E:\usb20\UIO\system\usb\usbmmap.c
                                           volatile far BDT ep2Bo;         //Endpoint #2 BD Out                             E:\usb20\UIO\system\usb\usbmmap.c
                                           volatile far BDT ep2Bi;         //Endpoint #2 BD In                              E:\usb20\UIO\system\usb\usbmmap.c
                                           #endif                                                                           E:\usb20\UIO\system\usb\usbmmap.c
                                                                                                                            E:\usb20\UIO\system\usb\usbmmap.c
                                           #if(3 <= MAX_EP_NUMBER)                                                          E:\usb20\UIO\system\usb\usbmmap.c
                                           volatile far BDT ep3Bo;         //Endpoint #3 BD Out                             E:\usb20\UIO\system\usb\usbmmap.c
                                           volatile far BDT ep3Bi;         //Endpoint #3 BD In                              E:\usb20\UIO\system\usb\usbmmap.c
                                           #endif                                                                           E:\usb20\UIO\system\usb\usbmmap.c
                                                                                                                            E:\usb20\UIO\system\usb\usbmmap.c
                                           #if(4 <= MAX_EP_NUMBER)                                                          E:\usb20\UIO\system\usb\usbmmap.c
                                           volatile far BDT ep4Bo;         //Endpoint #4 BD Out                             E:\usb20\UIO\system\usb\usbmmap.c
                                           volatile far BDT ep4Bi;         //Endpoint #4 BD In                              E:\usb20\UIO\system\usb\usbmmap.c
                                           #endif                                                                           E:\usb20\UIO\system\usb\usbmmap.c
                                                                                                                            E:\usb20\UIO\system\usb\usbmmap.c
                                           #if(5 <= MAX_EP_NUMBER)                                                          E:\usb20\UIO\system\usb\usbmmap.c
                                           volatile far BDT ep5Bo;         //Endpoint #5 BD Out                             E:\usb20\UIO\system\usb\usbmmap.c
                                           volatile far BDT ep5Bi;         //Endpoint #5 BD In                              E:\usb20\UIO\system\usb\usbmmap.c
                                           #endif                                                                           E:\usb20\UIO\system\usb\usbmmap.c
                                                                                                                            E:\usb20\UIO\system\usb\usbmmap.c
                                           #if(6 <= MAX_EP_NUMBER)                                                          E:\usb20\UIO\system\usb\usbmmap.c
                                           volatile far BDT ep6Bo;         //Endpoint #6 BD Out                             E:\usb20\UIO\system\usb\usbmmap.c
                                           volatile far BDT ep6Bi;         //Endpoint #6 BD In                              E:\usb20\UIO\system\usb\usbmmap.c
                                           #endif                                                                           E:\usb20\UIO\system\usb\usbmmap.c
                                                                                                                            E:\usb20\UIO\system\usb\usbmmap.c
                                           #if(7 <= MAX_EP_NUMBER)                                                          E:\usb20\UIO\system\usb\usbmmap.c
                                           volatile far BDT ep7Bo;         //Endpoint #7 BD Out                             E:\usb20\UIO\system\usb\usbmmap.c
                                           volatile far BDT ep7Bi;         //Endpoint #7 BD In                              E:\usb20\UIO\system\usb\usbmmap.c
                                           #endif                                                                           E:\usb20\UIO\system\usb\usbmmap.c
                                                                                                                            E:\usb20\UIO\system\usb\usbmmap.c
                                           #if(8 <= MAX_EP_NUMBER)                                                          E:\usb20\UIO\system\usb\usbmmap.c
                                           volatile far BDT ep8Bo;         //Endpoint #8 BD Out                             E:\usb20\UIO\system\usb\usbmmap.c
                                           volatile far BDT ep8Bi;         //Endpoint #8 BD In                              E:\usb20\UIO\system\usb\usbmmap.c
                                           #endif                                                                           E:\usb20\UIO\system\usb\usbmmap.c
                                                                                                                            E:\usb20\UIO\system\usb\usbmmap.c
                                           #if(9 <= MAX_EP_NUMBER)                                                          E:\usb20\UIO\system\usb\usbmmap.c
                                           volatile far BDT ep9Bo;         //Endpoint #9 BD Out                             E:\usb20\UIO\system\usb\usbmmap.c
                                           volatile far BDT ep9Bi;         //Endpoint #9 BD In                              E:\usb20\UIO\system\usb\usbmmap.c
                                           #endif                                                                           E:\usb20\UIO\system\usb\usbmmap.c
                                                                                                                            E:\usb20\UIO\system\usb\usbmmap.c
                                           #if(10 <= MAX_EP_NUMBER)                                                         E:\usb20\UIO\system\usb\usbmmap.c
                                           volatile far BDT ep10Bo;        //Endpoint #10 BD Out                            E:\usb20\UIO\system\usb\usbmmap.c
                                           volatile far BDT ep10Bi;        //Endpoint #10 BD In                             E:\usb20\UIO\system\usb\usbmmap.c
                                           #endif                                                                           E:\usb20\UIO\system\usb\usbmmap.c
                                                                                                                            E:\usb20\UIO\system\usb\usbmmap.c
                                           #if(11 <= MAX_EP_NUMBER)                                                         E:\usb20\UIO\system\usb\usbmmap.c
                                           volatile far BDT ep11Bo;        //Endpoint #11 BD Out                            E:\usb20\UIO\system\usb\usbmmap.c
                                           volatile far BDT ep11Bi;        //Endpoint #11 BD In                             E:\usb20\UIO\system\usb\usbmmap.c
                                           #endif                                                                           E:\usb20\UIO\system\usb\usbmmap.c
                                                                                                                            E:\usb20\UIO\system\usb\usbmmap.c
                                           #if(12 <= MAX_EP_NUMBER)                                                         E:\usb20\UIO\system\usb\usbmmap.c
                                           volatile far BDT ep12Bo;        //Endpoint #12 BD Out                            E:\usb20\UIO\system\usb\usbmmap.c
                                           volatile far BDT ep12Bi;        //Endpoint #12 BD In                             E:\usb20\UIO\system\usb\usbmmap.c
                                           #endif                                                                           E:\usb20\UIO\system\usb\usbmmap.c
                                                                                                                            E:\usb20\UIO\system\usb\usbmmap.c
                                           #if(13 <= MAX_EP_NUMBER)                                                         E:\usb20\UIO\system\usb\usbmmap.c
                                           volatile far BDT ep13Bo;        //Endpoint #13 BD Out                            E:\usb20\UIO\system\usb\usbmmap.c
                                           volatile far BDT ep13Bi;        //Endpoint #13 BD In                             E:\usb20\UIO\system\usb\usbmmap.c
                                           #endif                                                                           E:\usb20\UIO\system\usb\usbmmap.c
                                                                                                                            E:\usb20\UIO\system\usb\usbmmap.c
                                           #if(14 <= MAX_EP_NUMBER)                                                         E:\usb20\UIO\system\usb\usbmmap.c
                                           volatile far BDT ep14Bo;        //Endpoint #14 BD Out                            E:\usb20\UIO\system\usb\usbmmap.c
                                           volatile far BDT ep14Bi;        //Endpoint #14 BD In                             E:\usb20\UIO\system\usb\usbmmap.c
                                           #endif                                                                           E:\usb20\UIO\system\usb\usbmmap.c
                                                                                                                            E:\usb20\UIO\system\usb\usbmmap.c
                                           #if(15 <= MAX_EP_NUMBER)                                                         E:\usb20\UIO\system\usb\usbmmap.c
                                           volatile far BDT ep15Bo;        //Endpoint #15 BD Out                            E:\usb20\UIO\system\usb\usbmmap.c
                                           volatile far BDT ep15Bi;        //Endpoint #15 BD In                             E:\usb20\UIO\system\usb\usbmmap.c
                                           #endif                                                                           E:\usb20\UIO\system\usb\usbmmap.c
                                                                                                                            E:\usb20\UIO\system\usb\usbmmap.c
                                           /******************************************************************************  E:\usb20\UIO\system\usb\usbmmap.c
                                            * Section B: EP0 Buffer Space                                                   E:\usb20\UIO\system\usb\usbmmap.c
                                            ******************************************************************************  E:\usb20\UIO\system\usb\usbmmap.c
                                            * - Two buffer areas are defined:                                               E:\usb20\UIO\system\usb\usbmmap.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbmmap.c
                                            *   A. CTRL_TRF_SETUP                                                           E:\usb20\UIO\system\usb\usbmmap.c
                                            *      - Size = EP0_BUFF_SIZE as defined in autofiles\usbcfg.h                  E:\usb20\UIO\system\usb\usbmmap.c
                                            *      - Detailed data structure allows direct adddressing of bits and bytes.   E:\usb20\UIO\system\usb\usbmmap.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbmmap.c
                                            *   B. CTRL_TRF_DATA                                                            E:\usb20\UIO\system\usb\usbmmap.c
                                            *      - Size = EP0_BUFF_SIZE as defined in autofiles\usbcfg.h                  E:\usb20\UIO\system\usb\usbmmap.c
                                            *      - Data structure allows direct adddressing of the first 8 bytes.         E:\usb20\UIO\system\usb\usbmmap.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbmmap.c
                                            * - Both data types are defined in system\usb\usbdefs\usbdefs_ep0_buff.h        E:\usb20\UIO\system\usb\usbmmap.c
                                            *****************************************************************************/  E:\usb20\UIO\system\usb\usbmmap.c
                                           volatile far CTRL_TRF_SETUP SetupPkt;                                            E:\usb20\UIO\system\usb\usbmmap.c
                                           volatile far CTRL_TRF_DATA CtrlTrfData;                                          E:\usb20\UIO\system\usb\usbmmap.c
                                                                                                                            E:\usb20\UIO\system\usb\usbmmap.c
                                           /******************************************************************************  E:\usb20\UIO\system\usb\usbmmap.c
                                            * Section C: CDC Buffer                                                         E:\usb20\UIO\system\usb\usbmmap.c
                                            ******************************************************************************  E:\usb20\UIO\system\usb\usbmmap.c
                                            *                                                                               E:\usb20\UIO\system\usb\usbmmap.c
                                            *****************************************************************************/  E:\usb20\UIO\system\usb\usbmmap.c
                                           #pragma udata usbram5a=0x500    //See Linker Script,usb5:0x500-...               E:\usb20\UIO\system\usb\usbmmap.c
                                           #if defined(USB_USE_CDC)                                                         E:\usb20\UIO\system\usb\usbmmap.c
                                           volatile far unsigned char cdc_notice[CDC_INT_EP_SIZE];                          E:\usb20\UIO\system\usb\usbmmap.c
                                           volatile far unsigned char cdc_data_rx[CDC_BULK_OUT_EP_SIZE];                    E:\usb20\UIO\system\usb\usbmmap.c
                                           volatile far unsigned char cdc_data_tx[CDC_BULK_IN_EP_SIZE];                     E:\usb20\UIO\system\usb\usbmmap.c
                                           #endif                                                                           E:\usb20\UIO\system\usb\usbmmap.c
                                           #pragma udata                                                                    E:\usb20\UIO\system\usb\usbmmap.c
                                                                                                                            E:\usb20\UIO\system\usb\usbmmap.c
                                           /** EOF usbmmap.c ************************************************************/  E:\usb20\UIO\system\usb\usbmmap.c
