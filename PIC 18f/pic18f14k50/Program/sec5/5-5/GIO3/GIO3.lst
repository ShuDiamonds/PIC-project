MP2COD 4.00, COFF to COD File Converter
Copyright (c) 2005 Microchip Technology Inc.
Listing File Generated: Thu Nov 03 12:41:26 2005


Address  Value    Disassembly              Source                                                                           File
-------  -------  -----------------------  -------------------------------------------------------------------------------  -----
                                           ///////////////////////////////////////////////                                  E:\usb20\GIO3\lcd_lib.c
                                           //  液晶表示器制御ライブラリ　for PIC18Fxxxx                                     E:\usb20\GIO3\lcd_lib.c
                                           //  内蔵関数は以下                                                               E:\usb20\GIO3\lcd_lib.c
                                           //    lcd_init()    ----- 初期化                                                 E:\usb20\GIO3\lcd_lib.c
                                           //    lcd_cmd(cmd)  ----- コマンド出力                                           E:\usb20\GIO3\lcd_lib.c
                                           //    lcd_data(chr) ----- １文字表示出力                                         E:\usb20\GIO3\lcd_lib.c
                                           //    lcd_clear()   ----- 全消去                                                 E:\usb20\GIO3\lcd_lib.c
                                           //////////////////////////////////////////////                                   E:\usb20\GIO3\lcd_lib.c
                                           #include <p18cxxx.h>                                                             E:\usb20\GIO3\lcd_lib.c
                                           #include "io_cfg.h"                                                              E:\usb20\GIO3\lcd_lib.c
                                           #include	"delays.h"                                                              E:\usb20\GIO3\lcd_lib.c
                                           #include "lcd_lib.h"                                                             E:\usb20\GIO3\lcd_lib.c
                                                                                                                            E:\usb20\GIO3\lcd_lib.c
                                           //////// データ出力サブ関数                                                      E:\usb20\GIO3\lcd_lib.c
000d94   cfd9     MOVFF     0xfd9,0xfe6    void lcd_out(char code, char flag)                                               E:\usb20\GIO3\lcd_lib.c
000d96   ffe6                                                                                                               
000d98   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
000d9a   ffd9                                                                                                               
                                           {                                                                                E:\usb20\GIO3\lcd_lib.c
000d9c   0efe     MOVLW     0xfe           	lcd_port = code & 0xF0;                                                         E:\usb20\GIO3\lcd_lib.c
000d9e   50db     MOVF      0xdb,0x0,0x0                                                                                    
000da0   0bf0     ANDLW     0xf0                                                                                            
000da2   6e8a     MOVWF     0x8a,0x0                                                                                        
000da4   0efd     MOVLW     0xfd           	if (flag == 0)                                                                  E:\usb20\GIO3\lcd_lib.c
000da6   50db     MOVF      0xdb,0x0,0x0                                                                                    
000da8   e102     BNZ       0xdae                                                                                           
000daa   848a     BSF       0x8a,0x2,0x0   		lcd_rs = 1;			//表示データの場合                                               E:\usb20\GIO3\lcd_lib.c
000dac   d001     BRA       0xdb0          	else                                                                            E:\usb20\GIO3\lcd_lib.c
000dae   948a     BCF       0x8a,0x2,0x0   		lcd_rs = 0;			//コマンドデータの場合                                           E:\usb20\GIO3\lcd_lib.c
000db0   0000     NOP                      	Delay1TCY();				//NOP		                                                         E:\usb20\GIO3\lcd_lib.c
000db2   868a     BSF       0x8a,0x3,0x0   	lcd_stb = 1;				//strobe out                                                    E:\usb20\GIO3\lcd_lib.c
000db4   0e01     MOVLW     0x1            	Delay10TCYx(1);			//10NOP                                                       E:\usb20\GIO3\lcd_lib.c
000db6   6ee6     MOVWF     0xe6,0x0                                                                                        
000db8   ec74     CALL      0x12e8,0x0                                                                                      
000dba   f009                                                                                                               
000dbc   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000dbe   968a     BCF       0x8a,0x3,0x0   	lcd_stb = 0;				//reset strobe                                                  E:\usb20\GIO3\lcd_lib.c
000dc0   52e5     MOVF      0xe5,0x1,0x0   }                                                                                E:\usb20\GIO3\lcd_lib.c
000dc2   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
000dc4   ffd9                                                                                                               
000dc6   0012     RETURN    0x0                                                                                             
                                           //////// １文字表示関数                                                          E:\usb20\GIO3\lcd_lib.c
000dc8   cfd9     MOVFF     0xfd9,0xfe6    void lcd_data(char asci)                                                         E:\usb20\GIO3\lcd_lib.c
000dca   ffe6                                                                                                               
000dcc   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
000dce   ffd9                                                                                                               
                                           {                                                                                E:\usb20\GIO3\lcd_lib.c
000dd0   6ae6     CLRF      0xe6,0x0       	lcd_out(asci, 0);			//上位４ビット出力                                          E:\usb20\GIO3\lcd_lib.c
000dd2   0efe     MOVLW     0xfe                                                                                            
000dd4   cfdb     MOVFF     0xfdb,0xfe6                                                                                     
000dd6   ffe6                                                                                                               
000dd8   dfdd     RCALL     0xd94                                                                                           
000dda   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000ddc   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000dde   6ae6     CLRF      0xe6,0x0       	lcd_out(asci<<4, 0);		//下位４ビット出力                                        E:\usb20\GIO3\lcd_lib.c
000de0   0efe     MOVLW     0xfe                                                                                            
000de2   38db     SWAPF     0xdb,0x0,0x0                                                                                    
000de4   0bf0     ANDLW     0xf0                                                                                            
000de6   6ee6     MOVWF     0xe6,0x0                                                                                        
000de8   dfd5     RCALL     0xd94                                                                                           
000dea   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000dec   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000dee   0e32     MOVLW     0x32           	Delay10TCYx(50);			//50μsec待ち                                                E:\usb20\GIO3\lcd_lib.c
000df0   6ee6     MOVWF     0xe6,0x0                                                                                        
000df2   ec74     CALL      0x12e8,0x0                                                                                      
000df4   f009                                                                                                               
000df6   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000df8   52e5     MOVF      0xe5,0x1,0x0   }                                                                                E:\usb20\GIO3\lcd_lib.c
000dfa   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
000dfc   ffd9                                                                                                               
000dfe   0012     RETURN    0x0                                                                                             
                                           /////// コマンド出力関数                                                         E:\usb20\GIO3\lcd_lib.c
000e00   cfd9     MOVFF     0xfd9,0xfe6    void lcd_cmd(char cmd)                                                           E:\usb20\GIO3\lcd_lib.c
000e02   ffe6                                                                                                               
000e04   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
000e06   ffd9                                                                                                               
                                           {                                                                                E:\usb20\GIO3\lcd_lib.c
000e08   0e01     MOVLW     0x1            	lcd_out(cmd, 1);			//上位４ビット出力                                           E:\usb20\GIO3\lcd_lib.c
000e0a   6ee6     MOVWF     0xe6,0x0                                                                                        
000e0c   0efe     MOVLW     0xfe                                                                                            
000e0e   cfdb     MOVFF     0xfdb,0xfe6                                                                                     
000e10   ffe6                                                                                                               
000e12   dfc0     RCALL     0xd94                                                                                           
000e14   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000e16   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000e18   0e01     MOVLW     0x1            	lcd_out(cmd<<4, 1);		//下位４ビット出力                                         E:\usb20\GIO3\lcd_lib.c
000e1a   6ee6     MOVWF     0xe6,0x0                                                                                        
000e1c   0efe     MOVLW     0xfe                                                                                            
000e1e   38db     SWAPF     0xdb,0x0,0x0                                                                                    
000e20   0bf0     ANDLW     0xf0                                                                                            
000e22   6ee6     MOVWF     0xe6,0x0                                                                                        
000e24   dfb7     RCALL     0xd94                                                                                           
000e26   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000e28   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000e2a   0efe     MOVLW     0xfe           	if((cmd & 0x03) != 0)                                                           E:\usb20\GIO3\lcd_lib.c
000e2c   50db     MOVF      0xdb,0x0,0x0                                                                                    
000e2e   0b03     ANDLW     0x3                                                                                             
000e30   e006     BZ        0xe3e                                                                                           
000e32   0e02     MOVLW     0x2            		Delay10KTCYx(2);		//2msec待ち                                                  E:\usb20\GIO3\lcd_lib.c
000e34   6ee6     MOVWF     0xe6,0x0                                                                                        
000e36   ec51     CALL      0x12a2,0x0                                                                                      
000e38   f009                                                                                                               
000e3a   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000e3c   d005     BRA       0xe48          	else                                                                            E:\usb20\GIO3\lcd_lib.c
000e3e   0e32     MOVLW     0x32           		Delay10TCYx(50);		//50usec待ち                                                 E:\usb20\GIO3\lcd_lib.c
000e40   6ee6     MOVWF     0xe6,0x0                                                                                        
000e42   ec74     CALL      0x12e8,0x0                                                                                      
000e44   f009                                                                                                               
000e46   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000e48   52e5     MOVF      0xe5,0x1,0x0   }                                                                                E:\usb20\GIO3\lcd_lib.c
000e4a   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
000e4c   ffd9                                                                                                               
000e4e   0012     RETURN    0x0                                                                                             
                                           /////// 全消去関数                                                               E:\usb20\GIO3\lcd_lib.c
                                           void lcd_clear(void)                                                             E:\usb20\GIO3\lcd_lib.c
                                           {                                                                                E:\usb20\GIO3\lcd_lib.c
000e50   0e01     MOVLW     0x1            	lcd_cmd(0x01);			//初期化コマンド出力                                           E:\usb20\GIO3\lcd_lib.c
000e52   6ee6     MOVWF     0xe6,0x0                                                                                        
000e54   dfd5     RCALL     0xe00                                                                                           
000e56   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000e58   0012     RETURN    0x0            }                                                                                E:\usb20\GIO3\lcd_lib.c
                                                                                                                            E:\usb20\GIO3\lcd_lib.c
                                           /////// 文字列出力関数                                                           E:\usb20\GIO3\lcd_lib.c
000e5a   cfd9     MOVFF     0xfd9,0xfe6    void lcd_str(char *str)                                                          E:\usb20\GIO3\lcd_lib.c
000e5c   ffe6                                                                                                               
000e5e   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
000e60   ffd9                                                                                                               
                                           {                                                                                E:\usb20\GIO3\lcd_lib.c
000e62   0efd     MOVLW     0xfd           	while(*str != 0x00)			//文字列の終わり判定                                      E:\usb20\GIO3\lcd_lib.c
000e64   cfdb     MOVFF     0xfdb,0xfe9                                                                                     
000e66   ffe9                                                                                                               
000e68   0efe     MOVLW     0xfe                                                                                            
000e6a   cfdb     MOVFF     0xfdb,0xfea                                                                                     
000e6c   ffea                                                                                                               
000e6e   50ef     MOVF      0xef,0x0,0x0                                                                                    
000e70   e010     BZ        0xe92                                                                                           
000e90   d7e8     BRA       0xe62                                                                                           
                                           	{                                                                               E:\usb20\GIO3\lcd_lib.c
000e72   0efd     MOVLW     0xfd           		lcd_data(*str);			//文字列１文字出力                                           E:\usb20\GIO3\lcd_lib.c
000e74   cfdb     MOVFF     0xfdb,0xfe9                                                                                     
000e76   ffe9                                                                                                               
000e78   0efe     MOVLW     0xfe                                                                                            
000e7a   cfdb     MOVFF     0xfdb,0xfea                                                                                     
000e7c   ffea                                                                                                               
000e7e   50ef     MOVF      0xef,0x0,0x0                                                                                    
000e80   6ee6     MOVWF     0xe6,0x0                                                                                        
000e82   dfa2     RCALL     0xdc8                                                                                           
000e84   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000e86   0efd     MOVLW     0xfd           		str++;					//ポインタ＋１                                                      E:\usb20\GIO3\lcd_lib.c
000e88   2adb     INCF      0xdb,0x1,0x0                                                                                    
000e8a   0efe     MOVLW     0xfe                                                                                            
000e8c   e301     BNC       0xe90                                                                                           
000e8e   2adb     INCF      0xdb,0x1,0x0                                                                                    
                                           	}                                                                               E:\usb20\GIO3\lcd_lib.c
000e92   52e5     MOVF      0xe5,0x1,0x0   }                                                                                E:\usb20\GIO3\lcd_lib.c
000e94   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
000e96   ffd9                                                                                                               
000e98   0012     RETURN    0x0                                                                                             
                                                                                                                            E:\usb20\GIO3\lcd_lib.c
                                           /////// 初期化関数                                                               E:\usb20\GIO3\lcd_lib.c
                                           void lcd_init(void)                                                              E:\usb20\GIO3\lcd_lib.c
                                           {                                                                                E:\usb20\GIO3\lcd_lib.c
000e9a   0e14     MOVLW     0x14           	Delay10KTCYx(20);                                                               E:\usb20\GIO3\lcd_lib.c
000e9c   6ee6     MOVWF     0xe6,0x0                                                                                        
000e9e   ec51     CALL      0x12a2,0x0                                                                                      
000ea0   f009                                                                                                               
000ea2   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000ea4   0e01     MOVLW     0x1            	lcd_out(0x30, 1);			//8bit mode set                                             E:\usb20\GIO3\lcd_lib.c
000ea6   6ee6     MOVWF     0xe6,0x0                                                                                        
000ea8   0e30     MOVLW     0x30                                                                                            
000eaa   6ee6     MOVWF     0xe6,0x0                                                                                        
000eac   df73     RCALL     0xd94                                                                                           
000eae   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000eb0   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000eb2   0e05     MOVLW     0x5            	Delay10KTCYx(5);                                                                E:\usb20\GIO3\lcd_lib.c
000eb4   6ee6     MOVWF     0xe6,0x0                                                                                        
000eb6   ec51     CALL      0x12a2,0x0                                                                                      
000eb8   f009                                                                                                               
000eba   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000ebc   0e01     MOVLW     0x1            	lcd_out(0x30, 1);			//8bit mode set                                             E:\usb20\GIO3\lcd_lib.c
000ebe   6ee6     MOVWF     0xe6,0x0                                                                                        
000ec0   0e30     MOVLW     0x30                                                                                            
000ec2   6ee6     MOVWF     0xe6,0x0                                                                                        
000ec4   df67     RCALL     0xd94                                                                                           
000ec6   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000ec8   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000eca   0e01     MOVLW     0x1            	Delay10KTCYx(1);                                                                E:\usb20\GIO3\lcd_lib.c
000ecc   6ee6     MOVWF     0xe6,0x0                                                                                        
000ece   ec51     CALL      0x12a2,0x0                                                                                      
000ed0   f009                                                                                                               
000ed2   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000ed4   0e01     MOVLW     0x1            	lcd_out(0x30, 1);			//8bit mode set                                             E:\usb20\GIO3\lcd_lib.c
000ed6   6ee6     MOVWF     0xe6,0x0                                                                                        
000ed8   0e30     MOVLW     0x30                                                                                            
000eda   6ee6     MOVWF     0xe6,0x0                                                                                        
000edc   df5b     RCALL     0xd94                                                                                           
000ede   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000ee0   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000ee2   0e01     MOVLW     0x1            	Delay10KTCYx(1);                                                                E:\usb20\GIO3\lcd_lib.c
000ee4   6ee6     MOVWF     0xe6,0x0                                                                                        
000ee6   ec51     CALL      0x12a2,0x0                                                                                      
000ee8   f009                                                                                                               
000eea   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000eec   0e01     MOVLW     0x1            	lcd_out(0x20, 1);			//4bit mode set                                             E:\usb20\GIO3\lcd_lib.c
000eee   6ee6     MOVWF     0xe6,0x0                                                                                        
000ef0   0e20     MOVLW     0x20                                                                                            
000ef2   6ee6     MOVWF     0xe6,0x0                                                                                        
000ef4   df4f     RCALL     0xd94                                                                                           
000ef6   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000ef8   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000efa   0e01     MOVLW     0x1            	Delay10KTCYx(1);                                                                E:\usb20\GIO3\lcd_lib.c
000efc   6ee6     MOVWF     0xe6,0x0                                                                                        
000efe   ec51     CALL      0x12a2,0x0                                                                                      
000f00   f009                                                                                                               
000f02   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000f04   0e2e     MOVLW     0x2e           	lcd_cmd(0x2E);			//DL=0 4bit mode                                               E:\usb20\GIO3\lcd_lib.c
000f06   6ee6     MOVWF     0xe6,0x0                                                                                        
000f08   df7b     RCALL     0xe00                                                                                           
000f0a   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000f0c   0e08     MOVLW     0x8            	lcd_cmd(0x08);			//display off C=D=B=0                                          E:\usb20\GIO3\lcd_lib.c
000f0e   6ee6     MOVWF     0xe6,0x0                                                                                        
000f10   df77     RCALL     0xe00                                                                                           
000f12   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000f14   0e0d     MOVLW     0xd            	lcd_cmd(0x0D);			//display on C=D=1 B=0                                         E:\usb20\GIO3\lcd_lib.c
000f16   6ee6     MOVWF     0xe6,0x0                                                                                        
000f18   df73     RCALL     0xe00                                                                                           
000f1a   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000f1c   0e06     MOVLW     0x6            	lcd_cmd(0x06);			//entry I/D=1 S=0                                              E:\usb20\GIO3\lcd_lib.c
000f1e   6ee6     MOVWF     0xe6,0x0                                                                                        
000f20   df6f     RCALL     0xe00                                                                                           
000f22   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000f24   0e01     MOVLW     0x1            	lcd_cmd(0x01);			//all clear                                                    E:\usb20\GIO3\lcd_lib.c
000f26   6ee6     MOVWF     0xe6,0x0                                                                                        
000f28   df6b     RCALL     0xe00                                                                                           
000f2a   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000f2c   0012     RETURN    0x0            }                                                                                E:\usb20\GIO3\lcd_lib.c
                                           /**************************************************************                  E:\usb20\GIO3\main.c
                                           *                                                                                E:\usb20\GIO3\main.c
                                           *　USB接続 汎用Ｉ／Ｏプログラム                                                  E:\usb20\GIO3\main.c
                                           *   柏野作の汎用USBクラスを使用                                                  E:\usb20\GIO3\main.c
                                           *   各々２つのパイプを持つインターフェースを２つに増やしたバージョン             E:\usb20\GIO3\main.c
                                           *	USBフレ-ムワーク修正情報                                                       E:\usb20\GIO3\main.c
                                           *　　コンフィギュレーションの設定変更                                            E:\usb20\GIO3\main.c
                                           *　　main.c　の変更　初期化削除　IO設定変更                                      E:\usb20\GIO3\main.c
                                           *　　io_cfg.hの変更　LED削除　IOモニタ削除                                       E:\usb20\GIO3\main.c
                                           *　　user.cの変更　　実行内容削除                                                E:\usb20\GIO3\main.c
                                           *　　usbcfg.hの変更　IOモニタ削除                                                E:\usb20\GIO3\main.c
                                           *　　usbdsc.c、usbdsc.h　デスクリプタ変更                                        E:\usb20\GIO3\main.c
                                           *    usbgen.c、usbgen.h　エンドポイント２用追加                                  E:\usb20\GIO3\main.c
                                           *    uabmmap.c、usbmmap.h　USB用バッファの追加　バンク配置変更                   E:\usb20\GIO3\main.c
                                           *                                                                                E:\usb20\GIO3\main.c
                                           ***************************************************************                  E:\usb20\GIO3\main.c
                                                                                                                            E:\usb20\GIO3\main.c
                                           /** I N C L U D E S *******************************************/                 E:\usb20\GIO3\main.c
                                           #include <p18cxxx.h>                                                             E:\usb20\GIO3\main.c
                                           #include "system\typedefs.h"                 // Required                         E:\usb20\GIO3\main.c
                                           #include "system\usb\usb.h"                  // Required                         E:\usb20\GIO3\main.c
                                           #include "io_cfg.h"                          // Required                         E:\usb20\GIO3\main.c
                                                                                                                            E:\usb20\GIO3\main.c
                                           #include "system\usb\usb_compile_time_validation.h"                              E:\usb20\GIO3\main.c
                                           #include	"delays.h"                                                              E:\usb20\GIO3\main.c
                                           #include "lcd_lib.h"                                                             E:\usb20\GIO3\main.c
                                                                                                                            E:\usb20\GIO3\main.c
                                           /** V A R I A B L E S *****************************************/                 E:\usb20\GIO3\main.c
                                           #pragma udata                                                                    E:\usb20\GIO3\main.c
                                           char input_buffer[64];					// USB入力バッファ                                    E:\usb20\GIO3\main.c
                                           char output_buffer[64];					// USB出力バッファ                                   E:\usb20\GIO3\main.c
                                           unsigned int  Pot0;						// 計測データ                                           E:\usb20\GIO3\main.c
                                           unsigned int Counter;						// 折り返し用カウンタ                                 E:\usb20\GIO3\main.c
                                           unsigned int RcvSize;						// 受信データサイズ                                   E:\usb20\GIO3\main.c
                                                                                                                            E:\usb20\GIO3\main.c
                                           char MsgOK[] ="OK";						// OKメッセージ                                         E:\usb20\GIO3\main.c
                                           char MsgPot[] =  "Pot =        \r\n";		// 液晶表示用バッファ                     E:\usb20\GIO3\main.c
                                           char MsgStart[] = "Start!";				// 初期メッセージ                                 E:\usb20\GIO3\main.c
                                           char MsgHello[] = "Welcome        \r\n";	// 折り返し用メッセージ                 E:\usb20\GIO3\main.c
                                           char MsgState[] = " ";					// LED状態                                            E:\usb20\GIO3\main.c
                                           // アナログデータ送信バッファ（８チャネル分×４文字）                            E:\usb20\GIO3\main.c
                                           char MsgAnalog[] = "                                      ";                     E:\usb20\GIO3\main.c
                                           /** P R I V A T E  P R O T O T Y P E S ************************/                 E:\usb20\GIO3\main.c
                                           void ltostring(char digit, unsigned long data, char *buffer);                    E:\usb20\GIO3\main.c
                                           unsigned int AD_input(char chanl);                                               E:\usb20\GIO3\main.c
                                                                                                                            E:\usb20\GIO3\main.c
                                           /** V E C T O R  R E M A P P I N G ****************************/                 E:\usb20\GIO3\main.c
                                           /*                                                                               E:\usb20\GIO3\main.c
                                           extern void _startup (void);        		//                                         E:\usb20\GIO3\main.c
                                           #pragma code _RESET_INTERRUPT_VECTOR = 0x000800                                  E:\usb20\GIO3\main.c
                                           void _reset (void)                                                               E:\usb20\GIO3\main.c
                                           {                                                                                E:\usb20\GIO3\main.c
                                               _asm goto _startup _endasm                                                   E:\usb20\GIO3\main.c
                                           }                                                                                E:\usb20\GIO3\main.c
                                           */                                                                               E:\usb20\GIO3\main.c
                                           #pragma code                                                                     E:\usb20\GIO3\main.c
                                           /****************************************************                            E:\usb20\GIO3\main.c
                                            * Function:        void main(void)                                              E:\usb20\GIO3\main.c
                                            ****************************************************/                           E:\usb20\GIO3\main.c
000038   cfd9     MOVFF     0xfd9,0xfe6    void main(void)                                                                  E:\usb20\GIO3\main.c
00003a   ffe6                                                                                                               
00003c   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
00003e   ffd9                                                                                                               
000040   0e02     MOVLW     0x2                                                                                             
000042   26e1     ADDWF     0xe1,0x1,0x0                                                                                    
                                           {                                                                                E:\usb20\GIO3\main.c
                                           	int	i;                                                                          E:\usb20\GIO3\main.c
                                           	                                                                                E:\usb20\GIO3\main.c
000044   0e07     MOVLW     0x7            	ADCON1 = 0x07;             	// RA,RE全アナログに設定                            E:\usb20\GIO3\main.c
000046   6ec1     MOVWF     0xc1,0x0                                                                                        
000048   0ebb     MOVLW     0xbb           	ADCON2 = 0xBB;				// Right,Tad＝Tcy/16                                          E:\usb20\GIO3\main.c
00004a   6ec0     MOVWF     0xc0,0x0                                                                                        
00004c   0e1d     MOVLW     0x1d           	ADCON0 = 0x1D;				// AD On	                                                     E:\usb20\GIO3\main.c
00004e   6ec2     MOVWF     0xc2,0x0                                                                                        
000050   0e07     MOVLW     0x7            	CMCON = 0x07;					// コンパレータオフ                                           E:\usb20\GIO3\main.c
000052   6eb4     MOVWF     0xb4,0x0                                                                                        
000054   6889     SETF      0x89,0x0        	LATA = 0xFF;					// 初期出力                                                   E:\usb20\GIO3\main.c
000056   6a8a     CLRF      0x8a,0x0          	LATB = 0;					// 液晶表示ポートリセット                                      E:\usb20\GIO3\main.c
000058   6e8b     MOVWF     0x8b,0x0         	LATC = 0x07;					// LED Off                                                   E:\usb20\GIO3\main.c
00005a   6a8c     CLRF      0x8c,0x0         	LATD = 0;                                                                     E:\usb20\GIO3\main.c
00005c   6892     SETF      0x92,0x0        	TRISA = 0xFF;					// アナログ入力                                              E:\usb20\GIO3\main.c
00005e   6a93     CLRF      0x93,0x0       	TRISB = 0x00;					// 液晶表示出力                                               E:\usb20\GIO3\main.c
000060   0eb8     MOVLW     0xb8            	TRISC = 0xB8;					// LED, USART                                                E:\usb20\GIO3\main.c
000062   6e94     MOVWF     0x94,0x0                                                                                        
000064   0ef0     MOVLW     0xf0            	TRISD = 0xF0;					// Universal I/O                                             E:\usb20\GIO3\main.c
000066   6e95     MOVWF     0x95,0x0                                                                                        
000068   6896     SETF      0x96,0x0        	TRISE = 0xFF;					// アナログ入力                                              E:\usb20\GIO3\main.c
                                           	/// USB初期化                                                                   E:\usb20\GIO3\main.c
00006a   0e14     MOVLW     0x14           	mInitializeUSBDriver();        	// See usbdrv.h                                 E:\usb20\GIO3\main.c
00006c   6e6f     MOVWF     0x6f,0x0                                                                                        
00006e   0100     MOVLB     0x0                                                                                             
000070   6bf8     CLRF      0xf8,0x1                                                                                        
000072   0100     MOVLB     0x0                                                                                             
000074   6bf9     CLRF      0xf9,0x1                                                                                        
000076   0100     MOVLB     0x0                                                                                             
000078   6bfa     CLRF      0xfa,0x1                                                                                        
                                           	/// 液晶表示器初期化                                                            E:\usb20\GIO3\main.c
00007a   0100     MOVLB     0x0            	Counter = 0;                                                                    E:\usb20\GIO3\main.c
00007c   6be2     CLRF      0xe2,0x1                                                                                        
00007e   6be3     CLRF      0xe3,0x1                                                                                        
000080   ec4d     CALL      0xe9a,0x0      	lcd_init();					// LCD初期化                                                    E:\usb20\GIO3\main.c
000082   f007                                                                                                               
000084   0e13     MOVLW     0x13           	lcd_str(MsgStart);			// 初期メッセージ表示                                      E:\usb20\GIO3\main.c
000086   6ee6     MOVWF     0xe6,0x0                                                                                        
000088   0e01     MOVLW     0x1                                                                                             
00008a   6ee6     MOVWF     0xe6,0x0                                                                                        
00008c   ec2d     CALL      0xe5a,0x0                                                                                       
00008e   f007                                                                                                               
000090   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000092   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                                                                                                            E:\usb20\GIO3\main.c
                                               /// メインループ                                                             E:\usb20\GIO3\main.c
000416   d63e     BRA       0x94               while(1)                                                                     E:\usb20\GIO3\main.c
                                               {                                                                            E:\usb20\GIO3\main.c
                                           	    /// USBイベントポーリング                                                   E:\usb20\GIO3\main.c
000094   ec97     CALL      0xf2e,0x0          		USBCheckBusStatus();        							// USB接続チェック                      E:\usb20\GIO3\main.c
000096   f007                                                                                                               
000098   be6f     BTFSC     0x6f,0x7,0x0       		if(UCFGbits.UTEYE!=1)									// アイパターンモードオフか                  E:\usb20\GIO3\main.c
00009a   d002     BRA       0xa0                                                                                            
00009c   ecb6     CALL      0xf6c,0x0              		USBDriverService();                                                    E:\usb20\GIO3\main.c
00009e   f007                                                                                                               
                                            		/// 受信データ処理                                                            E:\usb20\GIO3\main.c
0000a0   0e06     MOVLW     0x6            		if((usb_device_state >= CONFIGURED_STATE)&&(UCONbits.SUSPND==0))               E:\usb20\GIO3\main.c
0000a2   0100     MOVLB     0x0                                                                                             
0000a4   5df8     SUBWF     0xf8,0x0,0x1                                                                                    
0000a6   e201     BC        0xaa                                                                                            
0000a8   d1b6     BRA       0x416                                                                                           
0000aa   506d     MOVF      0x6d,0x0,0x0                                                                                    
0000ac   0b02     ANDLW     0x2                                                                                             
0000ae   e001     BZ        0xb2                                                                                            
0000b0   d1b2     BRA       0x416                                                                                           
                                           		{                                                                              E:\usb20\GIO3\main.c
                                           			/// 受信チェック                                                              E:\usb20\GIO3\main.c
0000b2   0e40     MOVLW     0x40           			RcvSize = USBGenRead((byte*)&input_buffer,sizeof(input_buffer));              E:\usb20\GIO3\main.c
0000b4   6ee6     MOVWF     0xe6,0x0                                                                                        
0000b6   0e60     MOVLW     0x60                                                                                            
0000b8   6ee6     MOVWF     0xe6,0x0                                                                                        
0000ba   0e00     MOVLW     0x0                                                                                             
0000bc   6ee6     MOVWF     0xe6,0x0                                                                                        
0000be   ec49     CALL      0xc92,0x0                                                                                       
0000c0   f006                                                                                                               
0000c2   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0000c4   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0000c6   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0000c8   0100     MOVLB     0x0                                                                                             
0000ca   6fe4     MOVWF     0xe4,0x1                                                                                        
0000cc   6be5     CLRF      0xe5,0x1                                                                                        
0000ce   51e4     MOVF      0xe4,0x0,0x1   			if(RcvSize)										// データ受信ありか？                                    E:\usb20\GIO3\main.c
0000d0   11e5     IORWF     0xe5,0x0,0x1                                                                                    
0000d2   e101     BNZ       0xd6                                                                                            
0000d4   d12f     BRA       0x334                                                                                           
                                               			{                                                                         E:\usb20\GIO3\main.c
0000d6   708b     BTG       0x8b,0x0,0x0               		LATCbits.LATC0 = !LATCbits.LATC0;				// LED0反転目印用             E:\usb20\GIO3\main.c
0000d8   5160     MOVF      0x60,0x0,0x1   	    			switch(input_buffer[0])						// 最初の１文字チェック                     E:\usb20\GIO3\main.c
0000da   0a38     XORLW     0x38                                                                                            
0000dc   e101     BNZ       0xe0                                                                                            
0000de   d0ff     BRA       0x2de                                                                                           
0000e0   0a0f     XORLW     0xf                                                                                             
0000e2   e101     BNZ       0xe6                                                                                            
0000e4   d0a8     BRA       0x236                                                                                           
0000e6   0a01     XORLW     0x1                                                                                             
0000e8   e101     BNZ       0xec                                                                                            
0000ea   d092     BRA       0x210                                                                                           
0000ec   0a03     XORLW     0x3                                                                                             
0000ee   e060     BZ        0x1b0                                                                                           
0000f0   0a01     XORLW     0x1                                                                                             
0000f2   e058     BZ        0x1a4                                                                                           
0000f4   0a07     XORLW     0x7                                                                                             
0000f6   e048     BZ        0x188                                                                                           
0000f8   0a01     XORLW     0x1                                                                                             
0000fa   e02d     BZ        0x156                                                                                           
0000fc   0a03     XORLW     0x3                                                                                             
0000fe   e012     BZ        0x124                                                                                           
000100   0a01     XORLW     0x1                                                                                             
000102   e001     BZ        0x106                                                                                           
                                           	    			{                                                                        E:\usb20\GIO3\main.c
                                           		    			case '0':								// メッセージ返送                                      E:\usb20\GIO3\main.c
000106   0104     MOVLB     0x4                     				if(!mUSBGenTxIsBusy())						// 送信レディーか？         			         E:\usb20\GIO3\main.c
000108   bf0c     BTFSC     0xc,0x7,0x1                                                                                     
00010a   d00b     BRA       0x122                                                                                           
00010c   0e03     MOVLW     0x3                       			 		USBGenWrite((byte*)MsgOK, 3);		// 送信実行                      E:\usb20\GIO3\main.c
00010e   6ee6     MOVWF     0xe6,0x0                                                                                        
000110   0e00     MOVLW     0x0                                                                                             
000112   6ee6     MOVWF     0xe6,0x0                                                                                        
000114   0e01     MOVLW     0x1                                                                                             
000116   6ee6     MOVWF     0xe6,0x0                                                                                        
000118   ecd5     CALL      0xbaa,0x0                                                                                       
00011a   f005                                                                                                               
00011c   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00011e   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000120   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000122   d108     BRA       0x334                     			 	break;		    				                                                 E:\usb20\GIO3\main.c
                                           		    			case '1':								//                                                     E:\usb20\GIO3\main.c
000124   728b     BTG       0x8b,0x1,0x0               				LATCbits.LATC1 = !LATCbits.LATC1;		// LED1反転                   E:\usb20\GIO3\main.c
000126   a28b     BTFSS     0x8b,0x1,0x0               				if(LATCbits.LATC1 == 1)                                          E:\usb20\GIO3\main.c
000128   d004     BRA       0x132                                                                                           
00012a   0101     MOVLB     0x1                        					MsgState[0] = '1';				// 現在状態返送                           E:\usb20\GIO3\main.c
00012c   0e31     MOVLW     0x31                                                                                            
00012e   6f2c     MOVWF     0x2c,0x1                                                                                        
000130   d003     BRA       0x138                      				else                                                             E:\usb20\GIO3\main.c
000132   0101     MOVLB     0x1                        					MsgState[0] = '0';                                              E:\usb20\GIO3\main.c
000134   0e30     MOVLW     0x30                                                                                            
000136   6f2c     MOVWF     0x2c,0x1                                                                                        
000138   0104     MOVLB     0x4                    					if(!mUSBGenTxIsBusy())					// 送信レディーか？                      E:\usb20\GIO3\main.c
00013a   bf0c     BTFSC     0xc,0x7,0x1                                                                                     
00013c   d00b     BRA       0x154                                                                                           
00013e   0e01     MOVLW     0x1                    						USBGenWrite((byte*)MsgState, 1);                                   E:\usb20\GIO3\main.c
000140   6ee6     MOVWF     0xe6,0x0                                                                                        
000142   0e2c     MOVLW     0x2c                                                                                            
000144   6ee6     MOVWF     0xe6,0x0                                                                                        
000146   0e01     MOVLW     0x1                                                                                             
000148   6ee6     MOVWF     0xe6,0x0                                                                                        
00014a   ecd5     CALL      0xbaa,0x0                                                                                       
00014c   f005                                                                                                               
00014e   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000150   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000152   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000154   d0ef     BRA       0x334          		    				break;                                                                 E:\usb20\GIO3\main.c
                                           		    			case '2':                                                               E:\usb20\GIO3\main.c
000156   748b     BTG       0x8b,0x2,0x0               				LATCbits.LATC2 = !LATCbits.LATC2;		// LED2反転                   E:\usb20\GIO3\main.c
000158   a48b     BTFSS     0x8b,0x2,0x0                				if(LATCbits.LATC2 == 1)                                         E:\usb20\GIO3\main.c
00015a   d004     BRA       0x164                                                                                           
00015c   0101     MOVLB     0x1                        					MsgState[0] = '1';					// 現在状態返送                          E:\usb20\GIO3\main.c
00015e   0e31     MOVLW     0x31                                                                                            
000160   6f2c     MOVWF     0x2c,0x1                                                                                        
000162   d003     BRA       0x16a                      				else                                                             E:\usb20\GIO3\main.c
000164   0101     MOVLB     0x1                        					MsgState[0] = '0';                                              E:\usb20\GIO3\main.c
000166   0e30     MOVLW     0x30                                                                                            
000168   6f2c     MOVWF     0x2c,0x1                                                                                        
00016a   0104     MOVLB     0x4                    					if(!mUSBGenTxIsBusy())					// 送信レディーか？	                     E:\usb20\GIO3\main.c
00016c   bf0c     BTFSC     0xc,0x7,0x1                                                                                     
00016e   d00b     BRA       0x186                                                                                           
000170   0e01     MOVLW     0x1                    						USBGenWrite((byte*)MsgState, 1);                                   E:\usb20\GIO3\main.c
000172   6ee6     MOVWF     0xe6,0x0                                                                                        
000174   0e2c     MOVLW     0x2c                                                                                            
000176   6ee6     MOVWF     0xe6,0x0                                                                                        
000178   0e01     MOVLW     0x1                                                                                             
00017a   6ee6     MOVWF     0xe6,0x0                                                                                        
00017c   ecd5     CALL      0xbaa,0x0                                                                                       
00017e   f005                                                                                                               
000180   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000182   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000184   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000186   d0d6     BRA       0x334          		    				break;                                                                 E:\usb20\GIO3\main.c
                                           		    			case '3':                                                               E:\usb20\GIO3\main.c
000188   c061     MOVFF     0x61,0xfe6     		    				lcd_cmd(input_buffer[1]);				// 液晶メッセージ表示                     E:\usb20\GIO3\main.c
00018a   ffe6                                                                                                               
00018c   ec00     CALL      0xe00,0x0                                                                                       
00018e   f007                                                                                                               
000190   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000192   0e63     MOVLW     0x63           		    				lcd_str((char *)(&input_buffer[3]));                                   E:\usb20\GIO3\main.c
000194   6ee6     MOVWF     0xe6,0x0                                                                                        
000196   0e00     MOVLW     0x0                                                                                             
000198   6ee6     MOVWF     0xe6,0x0                                                                                        
00019a   ec2d     CALL      0xe5a,0x0                                                                                       
00019c   f007                                                                                                               
00019e   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0001a0   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0001a2   d0c8     BRA       0x334          		    				break;                                                                 E:\usb20\GIO3\main.c
                                           		    			case '4':                                                               E:\usb20\GIO3\main.c
0001a4   ec28     CALL      0xe50,0x0      		    				lcd_clear();							// 液晶消去                                         E:\usb20\GIO3\main.c
0001a6   f007                                                                                                               
0001a8   0100     MOVLB     0x0            		    				Counter = 0;                                                           E:\usb20\GIO3\main.c
0001aa   6be2     CLRF      0xe2,0x1                                                                                        
0001ac   6be3     CLRF      0xe3,0x1                                                                                        
0001ae   d0c2     BRA       0x334          		    				break;                                                                 E:\usb20\GIO3\main.c
                                           		    			case '5':                                                               E:\usb20\GIO3\main.c
0001b0   0e07     MOVLW     0x7            	    					Pot0 = AD_input(7);                                                    E:\usb20\GIO3\main.c
0001b2   6ee6     MOVWF     0xe6,0x0                                                                                        
0001b4   d93d     RCALL     0x430                                                                                           
0001b6   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0001b8   cff3     MOVFF     0xff3,0xe0                                                                                      
0001ba   f0e0                                                                                                               
0001bc   cff4     MOVFF     0xff4,0xe1                                                                                      
0001be   f0e1                                                                                                               
0001c0   0e09     MOVLW     0x9            	    					ltostring(4, Pot0, MsgPot+6);			// 可変抵抗の値送信                    E:\usb20\GIO3\main.c
0001c2   6ee6     MOVWF     0xe6,0x0                                                                                        
0001c4   0e01     MOVLW     0x1                                                                                             
0001c6   6ee6     MOVWF     0xe6,0x0                                                                                        
0001c8   c0e0     MOVFF     0xe0,0x14                                                                                       
0001ca   f014                                                                                                               
0001cc   c0e1     MOVFF     0xe1,0x15                                                                                       
0001ce   f015                                                                                                               
0001d0   6a16     CLRF      0x16,0x0                                                                                        
0001d2   6a17     CLRF      0x17,0x0                                                                                        
0001d4   c014     MOVFF     0x14,0xfe6                                                                                      
0001d6   ffe6                                                                                                               
0001d8   c015     MOVFF     0x15,0xfe6                                                                                      
0001da   ffe6                                                                                                               
0001dc   c016     MOVFF     0x16,0xfe6                                                                                      
0001de   ffe6                                                                                                               
0001e0   c017     MOVFF     0x17,0xfe6                                                                                      
0001e2   ffe6                                                                                                               
0001e4   0e04     MOVLW     0x4                                                                                             
0001e6   6ee6     MOVWF     0xe6,0x0                                                                                        
0001e8   d957     RCALL     0x498                                                                                           
0001ea   6ef5     MOVWF     0xf5,0x0                                                                                        
0001ec   0e07     MOVLW     0x7                                                                                             
0001ee   5ee1     SUBWF     0xe1,0x1,0x0                                                                                    
0001f0   50f5     MOVF      0xf5,0x0,0x0                                                                                    
0001f2   0104     MOVLB     0x4                     				if(!mUSBGenTxIsBusy())					// 送信レディーか？		    					           E:\usb20\GIO3\main.c
0001f4   bf0c     BTFSC     0xc,0x7,0x1                                                                                     
0001f6   d00b     BRA       0x20e                                                                                           
0001f8   0e0f     MOVLW     0xf                       			 		USBGenWrite((byte*)MsgPot, 15);                                 E:\usb20\GIO3\main.c
0001fa   6ee6     MOVWF     0xe6,0x0                                                                                        
0001fc   0e03     MOVLW     0x3                                                                                             
0001fe   6ee6     MOVWF     0xe6,0x0                                                                                        
000200   0e01     MOVLW     0x1                                                                                             
000202   6ee6     MOVWF     0xe6,0x0                                                                                        
000204   ecd5     CALL      0xbaa,0x0                                                                                       
000206   f005                                                                                                               
000208   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00020a   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00020c   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00020e   d092     BRA       0x334          		    				break;                                                                 E:\usb20\GIO3\main.c
                                           		    			case '6':								// PORTDへの出力と入力                                 E:\usb20\GIO3\main.c
000210   c061     MOVFF     0x61,0xf8c     		    				LATD = input_buffer[1];                                                E:\usb20\GIO3\main.c
000212   ff8c                                                                                                               
000214   cf83     MOVFF     0xf83,0x12c    						MsgState[0] = PORTD;                                                       E:\usb20\GIO3\main.c
000216   f12c                                                                                                               
000218   0104     MOVLB     0x4                       				if(!mUSBGenTxIsBusy())					// 送信レディーか？                    E:\usb20\GIO3\main.c
00021a   bf0c     BTFSC     0xc,0x7,0x1                                                                                     
00021c   d00b     BRA       0x234                                                                                           
00021e   0e01     MOVLW     0x1                        					USBGenWrite((byte*)MsgState, 1);                                E:\usb20\GIO3\main.c
000220   6ee6     MOVWF     0xe6,0x0                                                                                        
000222   0e2c     MOVLW     0x2c                                                                                            
000224   6ee6     MOVWF     0xe6,0x0                                                                                        
000226   0e01     MOVLW     0x1                                                                                             
000228   6ee6     MOVWF     0xe6,0x0                                                                                        
00022a   ecd5     CALL      0xbaa,0x0                                                                                       
00022c   f005                                                                                                               
00022e   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000230   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000232   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000234   d07f     BRA       0x334          		    				break;                                                                 E:\usb20\GIO3\main.c
                                           		    			case '7':                                                               E:\usb20\GIO3\main.c
000236   6ade     CLRF      0xde,0x0                				for(i=0; i<8; i++)					// 8チャネル分計測                           E:\usb20\GIO3\main.c
000238   6add     CLRF      0xdd,0x0                                                                                        
00023a   cfde     MOVFF     0xfde,0x14                                                                                      
00023c   f014                                                                                                               
00023e   cfdd     MOVFF     0xfdd,0x15                                                                                      
000240   f015                                                                                                               
000242   90d8     BCF       0xd8,0x0,0x0                                                                                    
000244   5015     MOVF      0x15,0x0,0x0                                                                                    
000246   e604     BN        0x250                                                                                           
000248   0e08     MOVLW     0x8                                                                                             
00024a   5c14     SUBWF     0x14,0x0,0x0                                                                                    
00024c   0e00     MOVLW     0x0                                                                                             
00024e   5815     SUBWFB    0x15,0x0,0x0                                                                                    
000250   e237     BC        0x2c0                                                                                           
0002b6   2adf     INCF      0xdf,0x1,0x0                                                                                    
0002b8   0e01     MOVLW     0x1                                                                                             
0002ba   e301     BNC       0x2be                                                                                           
0002bc   2adb     INCF      0xdb,0x1,0x0                                                                                    
0002be   d7bd     BRA       0x23a                                                                                           
                                           	         			{                                                                   E:\usb20\GIO3\main.c
000252   cfdf     MOVFF     0xfdf,0xfe6    			    				Pot0 = AD_input(i);                                                   E:\usb20\GIO3\main.c
000254   ffe6                                                                                                               
000256   d8ec     RCALL     0x430                                                                                           
000258   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00025a   cff3     MOVFF     0xff3,0xe0                                                                                      
00025c   f0e0                                                                                                               
00025e   cff4     MOVFF     0xff4,0xe1                                                                                      
000260   f0e1                                                                                                               
000262   0e04     MOVLW     0x4            		    					ltostring(4, Pot0, MsgAnalog+4*i);	// 可変抵抗の値編集                E:\usb20\GIO3\main.c
000264   6e06     MOVWF     0x6,0x0                                                                                         
000266   6a07     CLRF      0x7,0x0                                                                                         
000268   cfde     MOVFF     0xfde,0xb                                                                                       
00026a   f00b                                                                                                               
00026c   cfdd     MOVFF     0xfdd,0xc                                                                                       
00026e   f00c                                                                                                               
000270   ec00     CALL      0x1200,0x0                                                                                      
000272   f009                                                                                                               
000274   c004     MOVFF     0x4,0x14                                                                                        
000276   f014                                                                                                               
000278   c005     MOVFF     0x5,0x15                                                                                        
00027a   f015                                                                                                               
00027c   0e2e     MOVLW     0x2e                                                                                            
00027e   2614     ADDWF     0x14,0x1,0x0                                                                                    
000280   0e01     MOVLW     0x1                                                                                             
000282   2215     ADDWFC    0x15,0x1,0x0                                                                                    
000284   c014     MOVFF     0x14,0xfe6                                                                                      
000286   ffe6                                                                                                               
000288   c015     MOVFF     0x15,0xfe6                                                                                      
00028a   ffe6                                                                                                               
00028c   c0e0     MOVFF     0xe0,0x16                                                                                       
00028e   f016                                                                                                               
000290   c0e1     MOVFF     0xe1,0x17                                                                                       
000292   f017                                                                                                               
000294   6a18     CLRF      0x18,0x0                                                                                        
000296   6a19     CLRF      0x19,0x0                                                                                        
000298   c016     MOVFF     0x16,0xfe6                                                                                      
00029a   ffe6                                                                                                               
00029c   c017     MOVFF     0x17,0xfe6                                                                                      
00029e   ffe6                                                                                                               
0002a0   c018     MOVFF     0x18,0xfe6                                                                                      
0002a2   ffe6                                                                                                               
0002a4   c019     MOVFF     0x19,0xfe6                                                                                      
0002a6   ffe6                                                                                                               
0002a8   0e04     MOVLW     0x4                                                                                             
0002aa   6ee6     MOVWF     0xe6,0x0                                                                                        
0002ac   d8f5     RCALL     0x498                                                                                           
0002ae   6ef5     MOVWF     0xf5,0x0                                                                                        
0002b0   0e07     MOVLW     0x7                                                                                             
0002b2   5ee1     SUBWF     0xe1,0x1,0x0                                                                                    
0002b4   50f5     MOVF      0xf5,0x0,0x0                                                                                    
                                                      			 	}                                                                E:\usb20\GIO3\main.c
0002c0   0104     MOVLB     0x4            		    				if(!mUSBGenTxIsBusy())					// 送信レディーか？                         E:\usb20\GIO3\main.c
0002c2   bf0c     BTFSC     0xc,0x7,0x1                                                                                     
0002c4   d00b     BRA       0x2dc                                                                                           
0002c6   0e20     MOVLW     0x20                   			 			USBGenWrite((byte*)MsgAnalog, 32);	// 送信実行                    E:\usb20\GIO3\main.c
0002c8   6ee6     MOVWF     0xe6,0x0                                                                                        
0002ca   0e2e     MOVLW     0x2e                                                                                            
0002cc   6ee6     MOVWF     0xe6,0x0                                                                                        
0002ce   0e01     MOVLW     0x1                                                                                             
0002d0   6ee6     MOVWF     0xe6,0x0                                                                                        
0002d2   ecd5     CALL      0xbaa,0x0                                                                                       
0002d4   f005                                                                                                               
0002d6   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0002d8   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0002da   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0002dc   d02b     BRA       0x334                     			 	break;                                                           E:\usb20\GIO3\main.c
                                                      			 case '8':                                                         E:\usb20\GIO3\main.c
0002de   2be2     INCF      0xe2,0x1,0x1            				Counter++;								// メッセージカウンタ更新                         E:\usb20\GIO3\main.c
0002e0   0e00     MOVLW     0x0                                                                                             
0002e2   23e3     ADDWFC    0xe3,0x1,0x1                                                                                    
0002e4   0e22     MOVLW     0x22                    				ltostring(6, Counter, MsgHello+8);	                                 E:\usb20\GIO3\main.c
0002e6   6ee6     MOVWF     0xe6,0x0                                                                                        
0002e8   0e01     MOVLW     0x1                                                                                             
0002ea   6ee6     MOVWF     0xe6,0x0                                                                                        
0002ec   c0e2     MOVFF     0xe2,0x14                                                                                       
0002ee   f014                                                                                                               
0002f0   c0e3     MOVFF     0xe3,0x15                                                                                       
0002f2   f015                                                                                                               
0002f4   6a16     CLRF      0x16,0x0                                                                                        
0002f6   6a17     CLRF      0x17,0x0                                                                                        
0002f8   c014     MOVFF     0x14,0xfe6                                                                                      
0002fa   ffe6                                                                                                               
0002fc   c015     MOVFF     0x15,0xfe6                                                                                      
0002fe   ffe6                                                                                                               
000300   c016     MOVFF     0x16,0xfe6                                                                                      
000302   ffe6                                                                                                               
000304   c017     MOVFF     0x17,0xfe6                                                                                      
000306   ffe6                                                                                                               
000308   0e06     MOVLW     0x6                                                                                             
00030a   6ee6     MOVWF     0xe6,0x0                                                                                        
00030c   d8c5     RCALL     0x498                                                                                           
00030e   6ef5     MOVWF     0xf5,0x0                                                                                        
000310   0e07     MOVLW     0x7                                                                                             
000312   5ee1     SUBWF     0xe1,0x1,0x0                                                                                    
000314   50f5     MOVF      0xf5,0x0,0x0                                                                                    
000316   0104     MOVLB     0x4                     				if(!mUSBGenTxIsBusy())						// 送信レディーか？         			         E:\usb20\GIO3\main.c
000318   bf0c     BTFSC     0xc,0x7,0x1                                                                                     
00031a   d00b     BRA       0x332                                                                                           
00031c   0e11     MOVLW     0x11                      			 		USBGenWrite((byte*)MsgHello, 17);	// 送信実行           			     E:\usb20\GIO3\main.c
00031e   6ee6     MOVWF     0xe6,0x0                                                                                        
000320   0e1a     MOVLW     0x1a                                                                                            
000322   6ee6     MOVWF     0xe6,0x0                                                                                        
000324   0e01     MOVLW     0x1                                                                                             
000326   6ee6     MOVWF     0xe6,0x0                                                                                        
000328   ecd5     CALL      0xbaa,0x0                                                                                       
00032a   f005                                                                                                               
00032c   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00032e   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000330   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000332   d000     BRA       0x334                     			 	break;                                                           E:\usb20\GIO3\main.c
                                                      			 	                                                                 E:\usb20\GIO3\main.c
000104   d117     BRA       0x334          		    			default: break;                                                         E:\usb20\GIO3\main.c
                                           		    		}                                                                        E:\usb20\GIO3\main.c
                                               			}                                                                         E:\usb20\GIO3\main.c
                                           			/// 受信チェック                                                              E:\usb20\GIO3\main.c
000334   0e40     MOVLW     0x40           			RcvSize = USBIORead((byte*)&input_buffer,sizeof(input_buffer));		if(RcvSize)										// データ受信ありか？ E:\usb20\GIO3\main.c
000336   6ee6     MOVWF     0xe6,0x0                                                                                        
000338   0e60     MOVLW     0x60                                                                                            
00033a   6ee6     MOVWF     0xe6,0x0                                                                                        
00033c   0e00     MOVLW     0x0                                                                                             
00033e   6ee6     MOVWF     0xe6,0x0                                                                                        
000340   ec89     CALL      0xd12,0x0                                                                                       
000342   f006                                                                                                               
000344   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000346   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000348   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00034a   0100     MOVLB     0x0                                                                                             
00034c   6fe4     MOVWF     0xe4,0x1                                                                                        
00034e   6be5     CLRF      0xe5,0x1                                                                                        
000350   51e4     MOVF      0xe4,0x0,0x1                                                                                    
000352   11e5     IORWF     0xe5,0x0,0x1                                                                                    
000354   e060     BZ        0x416                                                                                           
                                               			{                                                                         E:\usb20\GIO3\main.c
000356   708b     BTG       0x8b,0x0,0x0               		LATCbits.LATC0 = !LATCbits.LATC0;				// LED0反転目印用             E:\usb20\GIO3\main.c
000358   5160     MOVF      0x60,0x0,0x1   	    			switch(input_buffer[0])						// 最初の１文字チェック                     E:\usb20\GIO3\main.c
00035a   0a35     XORLW     0x35                                                                                            
00035c   e02d     BZ        0x3b8                                                                                           
00035e   0a04     XORLW     0x4                                                                                             
000360   e012     BZ        0x386                                                                                           
000362   0a01     XORLW     0x1                                                                                             
000364   e001     BZ        0x368                                                                                           
                                           	    			{                                                                        E:\usb20\GIO3\main.c
                                           		    			case '0':								// メッセージ返送                                      E:\usb20\GIO3\main.c
000368   0104     MOVLB     0x4                     				if(!mUSBIOTxIsBusy())						// 送信レディーか？         			          E:\usb20\GIO3\main.c
00036a   bf14     BTFSC     0x14,0x7,0x1                                                                                    
00036c   d00b     BRA       0x384                                                                                           
00036e   0e03     MOVLW     0x3                       			 		USBIOWrite((byte*)MsgOK, 3);		// 送信実行                       E:\usb20\GIO3\main.c
000370   6ee6     MOVWF     0xe6,0x0                                                                                        
000372   0e00     MOVLW     0x0                                                                                             
000374   6ee6     MOVWF     0xe6,0x0                                                                                        
000376   0e01     MOVLW     0x1                                                                                             
000378   6ee6     MOVWF     0xe6,0x0                                                                                        
00037a   ec0f     CALL      0xc1e,0x0                                                                                       
00037c   f006                                                                                                               
00037e   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000380   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000382   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000384   d048     BRA       0x416                     			 	break;		    				                                                 E:\usb20\GIO3\main.c
                                           		    			case '1':								//                                                     E:\usb20\GIO3\main.c
000386   728b     BTG       0x8b,0x1,0x0               				LATCbits.LATC1 = !LATCbits.LATC1;		// LED1反転                   E:\usb20\GIO3\main.c
000388   a28b     BTFSS     0x8b,0x1,0x0               				if(LATCbits.LATC1 == 1)                                          E:\usb20\GIO3\main.c
00038a   d004     BRA       0x394                                                                                           
00038c   0101     MOVLB     0x1                        					MsgState[0] = '1';					// 現在状態返送                          E:\usb20\GIO3\main.c
00038e   0e31     MOVLW     0x31                                                                                            
000390   6f2c     MOVWF     0x2c,0x1                                                                                        
000392   d003     BRA       0x39a                      				else                                                             E:\usb20\GIO3\main.c
000394   0101     MOVLB     0x1                        					MsgState[0] = '0';                                              E:\usb20\GIO3\main.c
000396   0e30     MOVLW     0x30                                                                                            
000398   6f2c     MOVWF     0x2c,0x1                                                                                        
00039a   0104     MOVLB     0x4                    					if(!mUSBIOTxIsBusy())					// 送信レディーか？                       E:\usb20\GIO3\main.c
00039c   bf14     BTFSC     0x14,0x7,0x1                                                                                    
00039e   d00b     BRA       0x3b6                                                                                           
0003a0   0e01     MOVLW     0x1                    						USBIOWrite((byte*)MsgState, 1);                                    E:\usb20\GIO3\main.c
0003a2   6ee6     MOVWF     0xe6,0x0                                                                                        
0003a4   0e2c     MOVLW     0x2c                                                                                            
0003a6   6ee6     MOVWF     0xe6,0x0                                                                                        
0003a8   0e01     MOVLW     0x1                                                                                             
0003aa   6ee6     MOVWF     0xe6,0x0                                                                                        
0003ac   ec0f     CALL      0xc1e,0x0                                                                                       
0003ae   f006                                                                                                               
0003b0   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0003b2   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0003b4   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0003b6   d02f     BRA       0x416          		    				break;                                                                 E:\usb20\GIO3\main.c
                                           		    			case '5':                                                               E:\usb20\GIO3\main.c
0003b8   6ae6     CLRF      0xe6,0x0       	    					Pot0 = AD_input(0);                                                    E:\usb20\GIO3\main.c
0003ba   d83a     RCALL     0x430                                                                                           
0003bc   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0003be   cff3     MOVFF     0xff3,0xe0                                                                                      
0003c0   f0e0                                                                                                               
0003c2   cff4     MOVFF     0xff4,0xe1                                                                                      
0003c4   f0e1                                                                                                               
0003c6   0e09     MOVLW     0x9            	    					ltostring(4, Pot0, MsgPot+6);			// 値送信                              E:\usb20\GIO3\main.c
0003c8   6ee6     MOVWF     0xe6,0x0                                                                                        
0003ca   0e01     MOVLW     0x1                                                                                             
0003cc   6ee6     MOVWF     0xe6,0x0                                                                                        
0003ce   c0e0     MOVFF     0xe0,0x14                                                                                       
0003d0   f014                                                                                                               
0003d2   c0e1     MOVFF     0xe1,0x15                                                                                       
0003d4   f015                                                                                                               
0003d6   6a16     CLRF      0x16,0x0                                                                                        
0003d8   6a17     CLRF      0x17,0x0                                                                                        
0003da   c014     MOVFF     0x14,0xfe6                                                                                      
0003dc   ffe6                                                                                                               
0003de   c015     MOVFF     0x15,0xfe6                                                                                      
0003e0   ffe6                                                                                                               
0003e2   c016     MOVFF     0x16,0xfe6                                                                                      
0003e4   ffe6                                                                                                               
0003e6   c017     MOVFF     0x17,0xfe6                                                                                      
0003e8   ffe6                                                                                                               
0003ea   0e04     MOVLW     0x4                                                                                             
0003ec   6ee6     MOVWF     0xe6,0x0                                                                                        
0003ee   d854     RCALL     0x498                                                                                           
0003f0   6ef5     MOVWF     0xf5,0x0                                                                                        
0003f2   0e07     MOVLW     0x7                                                                                             
0003f4   5ee1     SUBWF     0xe1,0x1,0x0                                                                                    
0003f6   50f5     MOVF      0xf5,0x0,0x0                                                                                    
0003f8   0104     MOVLB     0x4                     				if(!mUSBIOTxIsBusy())						// 送信レディーか？		    					           E:\usb20\GIO3\main.c
0003fa   bf14     BTFSC     0x14,0x7,0x1                                                                                    
0003fc   d00b     BRA       0x414                                                                                           
0003fe   0e0f     MOVLW     0xf                       			 		USBIOWrite((byte*)MsgPot, 15);                                  E:\usb20\GIO3\main.c
000400   6ee6     MOVWF     0xe6,0x0                                                                                        
000402   0e03     MOVLW     0x3                                                                                             
000404   6ee6     MOVWF     0xe6,0x0                                                                                        
000406   0e01     MOVLW     0x1                                                                                             
000408   6ee6     MOVWF     0xe6,0x0                                                                                        
00040a   ec0f     CALL      0xc1e,0x0                                                                                       
00040c   f006                                                                                                               
00040e   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000410   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000412   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000414   d000     BRA       0x416          		    				break;                                                                 E:\usb20\GIO3\main.c
000366   d057     BRA       0x416          					default: break;                                                             E:\usb20\GIO3\main.c
                                           				}                                                                            E:\usb20\GIO3\main.c
                                           			}                                                                             E:\usb20\GIO3\main.c
                                               		}                                                                          E:\usb20\GIO3\main.c
                                                }                                                                           E:\usb20\GIO3\main.c
000418   6ef5     MOVWF     0xf5,0x0       }                                                                                E:\usb20\GIO3\main.c
00041a   0e02     MOVLW     0x2                                                                                             
00041c   5ce1     SUBWF     0xe1,0x0,0x0                                                                                    
00041e   e202     BC        0x424                                                                                           
000420   6ae1     CLRF      0xe1,0x0                                                                                        
000422   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000424   6ee1     MOVWF     0xe1,0x0                                                                                        
000426   50f5     MOVF      0xf5,0x0,0x0                                                                                    
000428   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00042a   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
00042c   ffd9                                                                                                               
00042e   0012     RETURN    0x0                                                                                             
                                                                                                                            E:\usb20\GIO3\main.c
                                           //////// A/D変換読み込み関数                                                     E:\usb20\GIO3\main.c
000430   cfd9     MOVFF     0xfd9,0xfe6    unsigned int AD_input(char chanl)                                                E:\usb20\GIO3\main.c
000432   ffe6                                                                                                               
000434   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
000436   ffd9                                                                                                               
000438   0e02     MOVLW     0x2                                                                                             
00043a   26e1     ADDWF     0xe1,0x1,0x0                                                                                    
                                           {                                                                                E:\usb20\GIO3\main.c
                                               	unsigned int adData;        			// 10ビットモード                            E:\usb20\GIO3\main.c
                                               	                                                                            E:\usb20\GIO3\main.c
00043c   0efe     MOVLW     0xfe           	ADCON0 = 0x01 + (chanl * 4);                                                    E:\usb20\GIO3\main.c
00043e   50db     MOVF      0xdb,0x0,0x0                                                                                    
000440   0d04     MULLW     0x4                                                                                             
000442   28f3     INCF      0xf3,0x0,0x0                                                                                    
000444   6ec2     MOVWF     0xc2,0x0                                                                                        
000446   82c2     BSF       0xc2,0x1,0x0       	ADCON0bits.GO = 1;              		// Start AD conversion                    E:\usb20\GIO3\main.c
000448   b2c2     BTFSC     0xc2,0x1,0x0       	while(ADCON0bits.NOT_DONE);     		// Wait for conversion                    E:\usb20\GIO3\main.c
00044a   d7fe     BRA       0x448                                                                                           
00044c   50c4     MOVF      0xc4,0x0,0x0    	adData = ADRESH * 256 + ADRESL;                                                E:\usb20\GIO3\main.c
00044e   6e16     MOVWF     0x16,0x0                                                                                        
000450   6a17     CLRF      0x17,0x0                                                                                        
000452   c016     MOVFF     0x16,0x17                                                                                       
000454   f017                                                                                                               
000456   6a16     CLRF      0x16,0x0                                                                                        
000458   50c3     MOVF      0xc3,0x0,0x0                                                                                    
00045a   0100     MOVLB     0x0                                                                                             
00045c   2416     ADDWF     0x16,0x0,0x0                                                                                    
00045e   6e14     MOVWF     0x14,0x0                                                                                        
000460   0e00     MOVLW     0x0                                                                                             
000462   2017     ADDWFC    0x17,0x0,0x0                                                                                    
000464   6e15     MOVWF     0x15,0x0                                                                                        
000466   c014     MOVFF     0x14,0xfde                                                                                      
000468   ffde                                                                                                               
00046a   c015     MOVFF     0x15,0xfdd                                                                                      
00046c   ffdd                                                                                                               
00046e   cfde     MOVFF     0xfde,0x14     	return(adData);                   	 	// データ返し                              E:\usb20\GIO3\main.c
000470   f014                                                                                                               
000472   cfdd     MOVFF     0xfdd,0x15                                                                                      
000474   f015                                                                                                               
000476   c014     MOVFF     0x14,0xff3                                                                                      
000478   fff3                                                                                                               
00047a   c015     MOVFF     0x15,0xff4                                                                                      
00047c   fff4                                                                                                               
00047e   6ef5     MOVWF     0xf5,0x0       }                                                                                E:\usb20\GIO3\main.c
000480   0e02     MOVLW     0x2                                                                                             
000482   5ce1     SUBWF     0xe1,0x0,0x0                                                                                    
000484   e203     BC        0x48c                                                                                           
000486   d000     BRA       0x488                                                                                           
000488   6ae1     CLRF      0xe1,0x0                                                                                        
00048a   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00048c   6ee1     MOVWF     0xe1,0x0                                                                                        
00048e   50f5     MOVF      0xf5,0x0,0x0                                                                                    
000490   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000492   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
000494   ffd9                                                                                                               
000496   0012     RETURN    0x0                                                                                             
                                                                                                                            E:\usb20\GIO3\main.c
                                           ///// 数値から文字列に変換                                                       E:\usb20\GIO3\main.c
000498   cfd9     MOVFF     0xfd9,0xfe6    void ltostring(char digit, unsigned long data, char *buffer)                     E:\usb20\GIO3\main.c
00049a   ffe6                                                                                                               
00049c   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
00049e   ffd9                                                                                                               
0004a0   52e6     MOVF      0xe6,0x1,0x0                                                                                    
                                           {                                                                                E:\usb20\GIO3\main.c
                                           	char i;                                                                         E:\usb20\GIO3\main.c
0004a2   0efe     MOVLW     0xfe           	buffer += digit;						// 文字列の最後                                           E:\usb20\GIO3\main.c
0004a4   cfdb     MOVFF     0xfdb,0x14                                                                                      
0004a6   f014                                                                                                               
0004a8   6a15     CLRF      0x15,0x0                                                                                        
0004aa   be14     BTFSC     0x14,0x7,0x0                                                                                    
0004ac   6815     SETF      0x15,0x0                                                                                        
0004ae   50d9     MOVF      0xd9,0x0,0x0                                                                                    
0004b0   0ff8     ADDLW     0xf8                                                                                            
0004b2   6ee9     MOVWF     0xe9,0x0                                                                                        
0004b4   0eff     MOVLW     0xff                                                                                            
0004b6   20da     ADDWFC    0xda,0x0,0x0                                                                                    
0004b8   6eea     MOVWF     0xea,0x0                                                                                        
0004ba   5014     MOVF      0x14,0x0,0x0                                                                                    
0004bc   26ee     ADDWF     0xee,0x1,0x0                                                                                    
0004be   5015     MOVF      0x15,0x0,0x0                                                                                    
0004c0   22ed     ADDWFC    0xed,0x1,0x0                                                                                    
0004c2   0efe     MOVLW     0xfe           	for(i=digit; i>0; i--) {				// 最下位桁から上位へ                               E:\usb20\GIO3\main.c
0004c4   50db     MOVF      0xdb,0x0,0x0                                                                                    
0004c6   6edf     MOVWF     0xdf,0x0                                                                                        
0004c8   cfdf     MOVFF     0xfdf,0x14                                                                                      
0004ca   f014                                                                                                               
0004cc   0e00     MOVLW     0x0                                                                                             
0004ce   6ee7     MOVWF     0xe7,0x0                                                                                        
0004d0   1814     XORWF     0x14,0x0,0x0                                                                                    
0004d2   aee8     BTFSS     0xe8,0x7,0x0                                                                                    
0004d4   d002     BRA       0x4da                                                                                           
0004d6   3414     RLCF      0x14,0x0,0x0                                                                                    
0004d8   d003     BRA       0x4e0                                                                                           
0004da   50e7     MOVF      0xe7,0x0,0x0                                                                                    
0004dc   80d8     BSF       0xd8,0x0,0x0                                                                                    
0004de   5414     SUBFWB    0x14,0x0,0x0                                                                                    
0004e0   e257     BC        0x590                                                                                           
00058c   06df     DECF      0xdf,0x1,0x0                                                                                    
00058e   d79c     BRA       0x4c8                                                                                           
0004e2   0ef8     MOVLW     0xf8           		buffer--;							// ポインター１                                                E:\usb20\GIO3\main.c
0004e4   06db     DECF      0xdb,0x1,0x0                                                                                    
0004e6   0ef9     MOVLW     0xf9                                                                                            
0004e8   e201     BC        0x4ec                                                                                           
0004ea   06db     DECF      0xdb,0x1,0x0                                                                                    
0004ec   0efa     MOVLW     0xfa           		*buffer = (data % 10) + '0';		// その桁数値を文字にして格納                    E:\usb20\GIO3\main.c
0004ee   cfdb     MOVFF     0xfdb,0x14                                                                                      
0004f0   f014                                                                                                               
0004f2   0efb     MOVLW     0xfb                                                                                            
0004f4   cfdb     MOVFF     0xfdb,0x15                                                                                      
0004f6   f015                                                                                                               
0004f8   0efc     MOVLW     0xfc                                                                                            
0004fa   cfdb     MOVFF     0xfdb,0x16                                                                                      
0004fc   f016                                                                                                               
0004fe   0efd     MOVLW     0xfd                                                                                            
000500   cfdb     MOVFF     0xfdb,0x17                                                                                      
000502   f017                                                                                                               
000504   0e0a     MOVLW     0xa                                                                                             
000506   6e09     MOVWF     0x9,0x0                                                                                         
000508   6a0a     CLRF      0xa,0x0                                                                                         
00050a   6a0b     CLRF      0xb,0x0                                                                                         
00050c   6a0c     CLRF      0xc,0x0                                                                                         
00050e   c014     MOVFF     0x14,0x4                                                                                        
000510   f004                                                                                                               
000512   c015     MOVFF     0x15,0x5                                                                                        
000514   f005                                                                                                               
000516   c016     MOVFF     0x16,0x6                                                                                        
000518   f006                                                                                                               
00051a   c017     MOVFF     0x17,0x7                                                                                        
00051c   f007                                                                                                               
00051e   ec2d     CALL      0x125a,0x0                                                                                      
000520   f009                                                                                                               
000522   c000     MOVFF     0x0,0x14                                                                                        
000524   f014                                                                                                               
000526   c001     MOVFF     0x1,0x15                                                                                        
000528   f015                                                                                                               
00052a   c002     MOVFF     0x2,0x16                                                                                        
00052c   f016                                                                                                               
00052e   c003     MOVFF     0x3,0x17                                                                                        
000530   f017                                                                                                               
000532   0e30     MOVLW     0x30                                                                                            
000534   2614     ADDWF     0x14,0x1,0x0                                                                                    
000536   0e00     MOVLW     0x0                                                                                             
000538   2215     ADDWFC    0x15,0x1,0x0                                                                                    
00053a   2216     ADDWFC    0x16,0x1,0x0                                                                                    
00053c   2217     ADDWFC    0x17,0x1,0x0                                                                                    
00053e   0ef8     MOVLW     0xf8                                                                                            
000540   cfdb     MOVFF     0xfdb,0xfe9                                                                                     
000542   ffe9                                                                                                               
000544   0ef9     MOVLW     0xf9                                                                                            
000546   cfdb     MOVFF     0xfdb,0xfea                                                                                     
000548   ffea                                                                                                               
00054a   c014     MOVFF     0x14,0xfef                                                                                      
00054c   ffef                                                                                                               
00054e   0efa     MOVLW     0xfa           		data = data / 10;					// 桁-1                                                  E:\usb20\GIO3\main.c
000550   cfdb     MOVFF     0xfdb,0x4                                                                                       
000552   f004                                                                                                               
000554   0efb     MOVLW     0xfb                                                                                            
000556   cfdb     MOVFF     0xfdb,0x5                                                                                       
000558   f005                                                                                                               
00055a   0efc     MOVLW     0xfc                                                                                            
00055c   cfdb     MOVFF     0xfdb,0x6                                                                                       
00055e   f006                                                                                                               
000560   0efd     MOVLW     0xfd                                                                                            
000562   cfdb     MOVFF     0xfdb,0x7                                                                                       
000564   f007                                                                                                               
000566   0e0a     MOVLW     0xa                                                                                             
000568   6e09     MOVWF     0x9,0x0                                                                                         
00056a   6a0a     CLRF      0xa,0x0                                                                                         
00056c   6a0b     CLRF      0xb,0x0                                                                                         
00056e   6a0c     CLRF      0xc,0x0                                                                                         
000570   ec2d     CALL      0x125a,0x0                                                                                      
000572   f009                                                                                                               
000574   0efa     MOVLW     0xfa                                                                                            
000576   c004     MOVFF     0x4,0xfdb                                                                                       
000578   ffdb                                                                                                               
00057a   0efb     MOVLW     0xfb                                                                                            
00057c   c005     MOVFF     0x5,0xfdb                                                                                       
00057e   ffdb                                                                                                               
000580   0efc     MOVLW     0xfc                                                                                            
000582   c006     MOVFF     0x6,0xfdb                                                                                       
000584   ffdb                                                                                                               
000586   0efd     MOVLW     0xfd                                                                                            
000588   c007     MOVFF     0x7,0xfdb                                                                                       
00058a   ffdb                                                                                                               
                                           	}                                                                               E:\usb20\GIO3\main.c
000590   52e5     MOVF      0xe5,0x1,0x0   }                                                                                E:\usb20\GIO3\main.c
000592   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000594   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
000596   ffd9                                                                                                               
000598   0012     RETURN    0x0                                                                                             
                                                                                                                            E:\usb20\GIO3\main.c
                                           /*********************************************************************           E:\usb20\GIO3\system\usb\usbmmap.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbmmap.c
                                            *                Microchip USB C18 Firmware Version 1.0                         E:\usb20\GIO3\system\usb\usbmmap.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbmmap.c
                                            *********************************************************************           E:\usb20\GIO3\system\usb\usbmmap.c
                                            * FileName:        usbmmap.c                                                    E:\usb20\GIO3\system\usb\usbmmap.c
                                            * Dependencies:    See INCLUDES section below                                   E:\usb20\GIO3\system\usb\usbmmap.c
                                            * Processor:       PIC18                                                        E:\usb20\GIO3\system\usb\usbmmap.c
                                            * Compiler:        C18 2.30.01+                                                 E:\usb20\GIO3\system\usb\usbmmap.c
                                            * Company:         Microchip Technology, Inc.                                   E:\usb20\GIO3\system\usb\usbmmap.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbmmap.c
                                            * Software License Agreement                                                    E:\usb20\GIO3\system\usb\usbmmap.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbmmap.c
                                            * The software supplied herewith by Microchip Technology Incorporated           E:\usb20\GIO3\system\usb\usbmmap.c
                                            * (the 鼎ompany・ for its PICmicroｮ Microcontroller is intended and             E:\usb20\GIO3\system\usb\usbmmap.c
                                            * supplied to you, the Company痴 customer, for use solely and                   E:\usb20\GIO3\system\usb\usbmmap.c
                                            * exclusively on Microchip PICmicro Microcontroller products. The               E:\usb20\GIO3\system\usb\usbmmap.c
                                            * software is owned by the Company and/or its supplier, and is                  E:\usb20\GIO3\system\usb\usbmmap.c
                                            * protected under applicable copyright laws. All rights are reserved.           E:\usb20\GIO3\system\usb\usbmmap.c
                                            * Any use in violation of the foregoing restrictions may subject the            E:\usb20\GIO3\system\usb\usbmmap.c
                                            * user to criminal sanctions under applicable laws, as well as to               E:\usb20\GIO3\system\usb\usbmmap.c
                                            * civil liability for the breach of the terms and conditions of this            E:\usb20\GIO3\system\usb\usbmmap.c
                                            * license.                                                                      E:\usb20\GIO3\system\usb\usbmmap.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbmmap.c
                                            * THIS SOFTWARE IS PROVIDED IN AN 鄭S IS・CONDITION. NO WARRANTIES,             E:\usb20\GIO3\system\usb\usbmmap.c
                                            * WHETHER EXPRESS, IMPLIED OR STATUTORY, INCLUDING, BUT NOT LIMITED             E:\usb20\GIO3\system\usb\usbmmap.c
                                            * TO, IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A                   E:\usb20\GIO3\system\usb\usbmmap.c
                                            * PARTICULAR PURPOSE APPLY TO THIS SOFTWARE. THE COMPANY SHALL NOT,             E:\usb20\GIO3\system\usb\usbmmap.c
                                            * IN ANY CIRCUMSTANCES, BE LIABLE FOR SPECIAL, INCIDENTAL OR                    E:\usb20\GIO3\system\usb\usbmmap.c
                                            * CONSEQUENTIAL DAMAGES, FOR ANY REASON WHATSOEVER.                             E:\usb20\GIO3\system\usb\usbmmap.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbmmap.c
                                            * Author               Date        Comment                                      E:\usb20\GIO3\system\usb\usbmmap.c
                                            *~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~           E:\usb20\GIO3\system\usb\usbmmap.c
                                            * Rawin Rojvanit       11/19/04    Original.                                    E:\usb20\GIO3\system\usb\usbmmap.c
                                            ********************************************************************/           E:\usb20\GIO3\system\usb\usbmmap.c
                                                                                                                            E:\usb20\GIO3\system\usb\usbmmap.c
                                           /******************************************************************************  E:\usb20\GIO3\system\usb\usbmmap.c
                                            * -usbmmap.c-                                                                   E:\usb20\GIO3\system\usb\usbmmap.c
                                            * USB Memory Map                                                                E:\usb20\GIO3\system\usb\usbmmap.c
                                            * This file is the USB memory manager; it serves as a compile-time memory       E:\usb20\GIO3\system\usb\usbmmap.c
                                            * allocator for the USB endpoints. It uses the compile time options passed      E:\usb20\GIO3\system\usb\usbmmap.c
                                            * from usbcfg.h to instantiate endpoints and endpoint buffer.                   E:\usb20\GIO3\system\usb\usbmmap.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbmmap.c
                                            * Each endpoint requires to have a set of Buffer Descriptor registers(BDT).     E:\usb20\GIO3\system\usb\usbmmap.c
                                            * A BDT is 4-byte long and has a specific RAM location for each endpoint.       E:\usb20\GIO3\system\usb\usbmmap.c
                                            * The BDT for endpoint 0 out is located at address 0x400 to 0x403.              E:\usb20\GIO3\system\usb\usbmmap.c
                                            * The BDT for endpoint 0 in is located at address 0x404 to 0x407.               E:\usb20\GIO3\system\usb\usbmmap.c
                                            * The BDT for endpoint 1 out is located at address 0x408 to 0x40B.              E:\usb20\GIO3\system\usb\usbmmap.c
                                            * and so on... The above allocation assumes the Ping-Pong Buffer Mode 0 is      E:\usb20\GIO3\system\usb\usbmmap.c
                                            * used. These locations are already hard-wired in the silicon. The point        E:\usb20\GIO3\system\usb\usbmmap.c
                                            * of doing instantiation, i.e. volatile far BDT ep0Bo;, is to provide the       E:\usb20\GIO3\system\usb\usbmmap.c
                                            * C compiler a way to address each variable directly. This is very important    E:\usb20\GIO3\system\usb\usbmmap.c
                                            * because when a register can be accessed directly, it saves execution time     E:\usb20\GIO3\system\usb\usbmmap.c
                                            * and reduces program size.                                                     E:\usb20\GIO3\system\usb\usbmmap.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbmmap.c
                                            * Endpoints are defined using the endpoint number and the direction             E:\usb20\GIO3\system\usb\usbmmap.c
                                            * of transfer. For simplicity, usbmmap.c only uses the endpoint number          E:\usb20\GIO3\system\usb\usbmmap.c
                                            * in the BDT register allocation scheme. This means if the usbcfg.h states      E:\usb20\GIO3\system\usb\usbmmap.c
                                            * that the MAX_EP_NUMBER is number 1, then four BDTs will be                    E:\usb20\GIO3\system\usb\usbmmap.c
                                            * instantiated: one each for endpoint0 in and endpoint0 out, which must         E:\usb20\GIO3\system\usb\usbmmap.c
                                            * always be instantiated for control transfer by default, and one each sets     E:\usb20\GIO3\system\usb\usbmmap.c
                                            * for endpoint1 in and endpoint1 out. The naming convention for instantiating   E:\usb20\GIO3\system\usb\usbmmap.c
                                            * BDT is                                                                        E:\usb20\GIO3\system\usb\usbmmap.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbmmap.c
                                            * ep<#>B<d>                                                                     E:\usb20\GIO3\system\usb\usbmmap.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbmmap.c
                                            * where # is the endpoint number, and d is the direction of                     E:\usb20\GIO3\system\usb\usbmmap.c
                                            * transfer, which could be either <i> or <o>.                                   E:\usb20\GIO3\system\usb\usbmmap.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbmmap.c
                                            * The USB memory manager uses MAX_EP_NUMBER, as defined in usbcfg.h, to define  E:\usb20\GIO3\system\usb\usbmmap.c
                                            * the endpoints to be instantiated. This represents the highest endpoint        E:\usb20\GIO3\system\usb\usbmmap.c
                                            * number to be allocated, not how many endpoints are used. Since the BDTs for   E:\usb20\GIO3\system\usb\usbmmap.c
                                            * endpoints have hardware-assigned addresses in Bank 4, setting this value too  E:\usb20\GIO3\system\usb\usbmmap.c
                                            * high may lead to inefficient use of data RAM. For example, if an application  E:\usb20\GIO3\system\usb\usbmmap.c
                                            * uses only endpoints EP0 and EP4, then the MAX_EP_NUMBER is 4, and not 2.      E:\usb20\GIO3\system\usb\usbmmap.c
                                            * The in-between endpoint BDTs in this example (EP1, EP2, and EP3) go unused,   E:\usb20\GIO3\system\usb\usbmmap.c
                                            * and the 24 bytes of memory associated with them are wasted. It does not make  E:\usb20\GIO3\system\usb\usbmmap.c
                                            * much sense to skip endpoints, but the final decision lies with the user.      E:\usb20\GIO3\system\usb\usbmmap.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbmmap.c
                                            * The next step is to assign the instantiated BDTs to different                 E:\usb20\GIO3\system\usb\usbmmap.c
                                            * USB functions. The firmware framework fundamentally assumes that every USB    E:\usb20\GIO3\system\usb\usbmmap.c
                                            * function should know which endpoint it is using, i.e., the default control    E:\usb20\GIO3\system\usb\usbmmap.c
                                            * transfer should know that it is using endpoint 0 in and endpoint 0 out.       E:\usb20\GIO3\system\usb\usbmmap.c
                                            * A HID class can choose which endpoint it wants to use, but once chosen, it    E:\usb20\GIO3\system\usb\usbmmap.c
                                            * should always know the number of the endpoint.                                E:\usb20\GIO3\system\usb\usbmmap.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbmmap.c
                                            * The assignment of endpoints to USB functions is managed centrally             E:\usb20\GIO3\system\usb\usbmmap.c
                                            * in usbcfg.h. This helps prevent the mistake of having more                    E:\usb20\GIO3\system\usb\usbmmap.c
                                            * than one USB function using the same endpoint. The "Endpoint Allocation"      E:\usb20\GIO3\system\usb\usbmmap.c
                                            * section in usbcfg.h provides examples for how to map USB endpoints to USB     E:\usb20\GIO3\system\usb\usbmmap.c
                                            * functions.                                                                    E:\usb20\GIO3\system\usb\usbmmap.c
                                            * Quite a few things can be mapped in that section. There is no                 E:\usb20\GIO3\system\usb\usbmmap.c
                                            * one correct way to do the mapping and the user has the choice to              E:\usb20\GIO3\system\usb\usbmmap.c
                                            * choose a method that is most suitable to the application.                     E:\usb20\GIO3\system\usb\usbmmap.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbmmap.c
                                            * Typically, however, a user will want to map the following for a given         E:\usb20\GIO3\system\usb\usbmmap.c
                                            * USB interface function:                                                       E:\usb20\GIO3\system\usb\usbmmap.c
                                            * 1. The USB interface ID                                                       E:\usb20\GIO3\system\usb\usbmmap.c
                                            * 2. The endpoint control registers (UEPn)                                      E:\usb20\GIO3\system\usb\usbmmap.c
                                            * 3. The BDT registers (ep<#>B<d>)                                              E:\usb20\GIO3\system\usb\usbmmap.c
                                            * 4. The endpoint size                                                          E:\usb20\GIO3\system\usb\usbmmap.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbmmap.c
                                            * Example: Assume a USB device class "foo", which uses one out endpoint         E:\usb20\GIO3\system\usb\usbmmap.c
                                            *          of size 64-byte and one in endpoint of size 64-byte, then:           E:\usb20\GIO3\system\usb\usbmmap.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbmmap.c
                                            * #define FOO_INTF_ID          0x00                                             E:\usb20\GIO3\system\usb\usbmmap.c
                                            * #define FOO_UEP              UEP1                                             E:\usb20\GIO3\system\usb\usbmmap.c
                                            * #define FOO_BD_OUT           ep1Bo                                            E:\usb20\GIO3\system\usb\usbmmap.c
                                            * #define FOO_BD_IN            ep1Bi                                            E:\usb20\GIO3\system\usb\usbmmap.c
                                            * #define FOO_EP_SIZE          64                                               E:\usb20\GIO3\system\usb\usbmmap.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbmmap.c
                                            * The mapping above has chosen class "foo" to use endpoint 1.                   E:\usb20\GIO3\system\usb\usbmmap.c
                                            * The names are arbitrary and can be anything other than FOO_??????.            E:\usb20\GIO3\system\usb\usbmmap.c
                                            * For abstraction, the code for class "foo" should use the abstract             E:\usb20\GIO3\system\usb\usbmmap.c
                                            * definitions of FOO_BD_OUT,FOO_BD_IN, and not ep1Bo or ep1Bi.                  E:\usb20\GIO3\system\usb\usbmmap.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbmmap.c
                                            * Note that the endpoint size defined in the usbcfg.h file is again             E:\usb20\GIO3\system\usb\usbmmap.c
                                            * used in the usbmmap.c file. This shows that the relationship between          E:\usb20\GIO3\system\usb\usbmmap.c
                                            * the two files are tightly related.                                            E:\usb20\GIO3\system\usb\usbmmap.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbmmap.c
                                            * The endpoint buffer for each USB function must be located in the              E:\usb20\GIO3\system\usb\usbmmap.c
                                            * dual-port RAM area and has to come after all the BDTs have been               E:\usb20\GIO3\system\usb\usbmmap.c
                                            * instantiated. An example declaration is:                                      E:\usb20\GIO3\system\usb\usbmmap.c
                                            * volatile far unsigned char[FOO_EP_SIZE] data;                                 E:\usb20\GIO3\system\usb\usbmmap.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbmmap.c
                                            * The 'volatile' keyword tells the compiler not to perform any code             E:\usb20\GIO3\system\usb\usbmmap.c
                                            * optimization on this variable because its content could be modified           E:\usb20\GIO3\system\usb\usbmmap.c
                                            * by the hardware. The 'far' keyword tells the compiler that this variable      E:\usb20\GIO3\system\usb\usbmmap.c
                                            * is not located in the Access RAM area (0x000 - 0x05F).                        E:\usb20\GIO3\system\usb\usbmmap.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbmmap.c
                                            * For the variable to be globally accessible by other files, it should be       E:\usb20\GIO3\system\usb\usbmmap.c
                                            * declared in the header file usbmmap.h as an extern definition, such as        E:\usb20\GIO3\system\usb\usbmmap.c
                                            * extern volatile far unsigned char[FOO_EP_SIZE] data;                          E:\usb20\GIO3\system\usb\usbmmap.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbmmap.c
                                            * Conclusion:                                                                   E:\usb20\GIO3\system\usb\usbmmap.c
                                            * In a short summary, the dependencies between usbcfg and usbmmap can           E:\usb20\GIO3\system\usb\usbmmap.c
                                            * be shown as:                                                                  E:\usb20\GIO3\system\usb\usbmmap.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbmmap.c
                                            * usbcfg[MAX_EP_NUMBER] -> usbmmap                                              E:\usb20\GIO3\system\usb\usbmmap.c
                                            * usbmmap[ep<#>B<d>] -> usbcfg                                                  E:\usb20\GIO3\system\usb\usbmmap.c
                                            * usbcfg[EP size] -> usbmmap                                                    E:\usb20\GIO3\system\usb\usbmmap.c
                                            * usbcfg[abstract ep definitions] -> usb9/hid/cdc/etc class code                E:\usb20\GIO3\system\usb\usbmmap.c
                                            * usbmmap[endpoint buffer variable] -> usb9/hid/cdc/etc class code              E:\usb20\GIO3\system\usb\usbmmap.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbmmap.c
                                            * Data mapping provides a means for direct addressing of BDT and endpoint       E:\usb20\GIO3\system\usb\usbmmap.c
                                            * buffer. This means less usage of pointers, which equates to a faster and      E:\usb20\GIO3\system\usb\usbmmap.c
                                            * smaller program code.                                                         E:\usb20\GIO3\system\usb\usbmmap.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbmmap.c
                                            *****************************************************************************/  E:\usb20\GIO3\system\usb\usbmmap.c
                                                                                                                            E:\usb20\GIO3\system\usb\usbmmap.c
                                           /** I N C L U D E S **********************************************************/  E:\usb20\GIO3\system\usb\usbmmap.c
                                           #include "system\typedefs.h"                                                     E:\usb20\GIO3\system\usb\usbmmap.c
                                           #include "system\usb\usb.h"                                                      E:\usb20\GIO3\system\usb\usbmmap.c
                                                                                                                            E:\usb20\GIO3\system\usb\usbmmap.c
                                           /** U S B  G L O B A L  V A R I A B L E S ************************************/  E:\usb20\GIO3\system\usb\usbmmap.c
                                           #pragma udata                                                                    E:\usb20\GIO3\system\usb\usbmmap.c
                                           byte usb_device_state;          // Device States: DETACHED, ATTACHED, ...        E:\usb20\GIO3\system\usb\usbmmap.c
                                           USB_DEVICE_STATUS usb_stat;     // Global USB flags                              E:\usb20\GIO3\system\usb\usbmmap.c
                                           byte usb_active_cfg;            // Value of current configuration                E:\usb20\GIO3\system\usb\usbmmap.c
                                           byte usb_alt_intf[MAX_NUM_INT]; // Array to keep track of the current alternate  E:\usb20\GIO3\system\usb\usbmmap.c
                                                                           // setting for each interface ID                 E:\usb20\GIO3\system\usb\usbmmap.c
                                                                                                                            E:\usb20\GIO3\system\usb\usbmmap.c
                                           /** U S B  F I X E D  L O C A T I O N  V A R I A B L E S *********************/  E:\usb20\GIO3\system\usb\usbmmap.c
                                           #pragma udata usbram4=0x400     //See Linker Script,usb4:0x400-0x4FF(256-byte)   E:\usb20\GIO3\system\usb\usbmmap.c
                                                                                                                            E:\usb20\GIO3\system\usb\usbmmap.c
                                           /******************************************************************************  E:\usb20\GIO3\system\usb\usbmmap.c
                                            * Section A: Buffer Descriptor Table                                            E:\usb20\GIO3\system\usb\usbmmap.c
                                            * - 0x400 - 0x4FF(max)                                                          E:\usb20\GIO3\system\usb\usbmmap.c
                                            * - MAX_EP_NUMBER is defined in autofiles\usbcfg.h                              E:\usb20\GIO3\system\usb\usbmmap.c
                                            * - BDT data type is defined in system\usb\usbmmap.h                            E:\usb20\GIO3\system\usb\usbmmap.c
                                            *****************************************************************************/  E:\usb20\GIO3\system\usb\usbmmap.c
                                                                                                                            E:\usb20\GIO3\system\usb\usbmmap.c
                                           #if(0 <= MAX_EP_NUMBER)                                                          E:\usb20\GIO3\system\usb\usbmmap.c
                                           volatile far BDT ep0Bo;         //Endpoint #0 BD Out                             E:\usb20\GIO3\system\usb\usbmmap.c
                                           volatile far BDT ep0Bi;         //Endpoint #0 BD In                              E:\usb20\GIO3\system\usb\usbmmap.c
                                           #endif                                                                           E:\usb20\GIO3\system\usb\usbmmap.c
                                                                                                                            E:\usb20\GIO3\system\usb\usbmmap.c
                                           #if(1 <= MAX_EP_NUMBER)                                                          E:\usb20\GIO3\system\usb\usbmmap.c
                                           volatile far BDT ep1Bo;         //Endpoint #1 BD Out                             E:\usb20\GIO3\system\usb\usbmmap.c
                                           volatile far BDT ep1Bi;         //Endpoint #1 BD In                              E:\usb20\GIO3\system\usb\usbmmap.c
                                           #endif                                                                           E:\usb20\GIO3\system\usb\usbmmap.c
                                                                                                                            E:\usb20\GIO3\system\usb\usbmmap.c
                                           #if(2 <= MAX_EP_NUMBER)                                                          E:\usb20\GIO3\system\usb\usbmmap.c
                                           volatile far BDT ep2Bo;         //Endpoint #2 BD Out                             E:\usb20\GIO3\system\usb\usbmmap.c
                                           volatile far BDT ep2Bi;         //Endpoint #2 BD In                              E:\usb20\GIO3\system\usb\usbmmap.c
                                           #endif                                                                           E:\usb20\GIO3\system\usb\usbmmap.c
                                                                                                                            E:\usb20\GIO3\system\usb\usbmmap.c
                                           #if(3 <= MAX_EP_NUMBER)                                                          E:\usb20\GIO3\system\usb\usbmmap.c
                                           volatile far BDT ep3Bo;         //Endpoint #3 BD Out                             E:\usb20\GIO3\system\usb\usbmmap.c
                                           volatile far BDT ep3Bi;         //Endpoint #3 BD In                              E:\usb20\GIO3\system\usb\usbmmap.c
                                           #endif                                                                           E:\usb20\GIO3\system\usb\usbmmap.c
                                                                                                                            E:\usb20\GIO3\system\usb\usbmmap.c
                                           #if(4 <= MAX_EP_NUMBER)                                                          E:\usb20\GIO3\system\usb\usbmmap.c
                                           volatile far BDT ep4Bo;         //Endpoint #4 BD Out                             E:\usb20\GIO3\system\usb\usbmmap.c
                                           volatile far BDT ep4Bi;         //Endpoint #4 BD In                              E:\usb20\GIO3\system\usb\usbmmap.c
                                           #endif                                                                           E:\usb20\GIO3\system\usb\usbmmap.c
                                                                                                                            E:\usb20\GIO3\system\usb\usbmmap.c
                                           #if(5 <= MAX_EP_NUMBER)                                                          E:\usb20\GIO3\system\usb\usbmmap.c
                                           volatile far BDT ep5Bo;         //Endpoint #5 BD Out                             E:\usb20\GIO3\system\usb\usbmmap.c
                                           volatile far BDT ep5Bi;         //Endpoint #5 BD In                              E:\usb20\GIO3\system\usb\usbmmap.c
                                           #endif                                                                           E:\usb20\GIO3\system\usb\usbmmap.c
                                                                                                                            E:\usb20\GIO3\system\usb\usbmmap.c
                                           #if(6 <= MAX_EP_NUMBER)                                                          E:\usb20\GIO3\system\usb\usbmmap.c
                                           volatile far BDT ep6Bo;         //Endpoint #6 BD Out                             E:\usb20\GIO3\system\usb\usbmmap.c
                                           volatile far BDT ep6Bi;         //Endpoint #6 BD In                              E:\usb20\GIO3\system\usb\usbmmap.c
                                           #endif                                                                           E:\usb20\GIO3\system\usb\usbmmap.c
                                                                                                                            E:\usb20\GIO3\system\usb\usbmmap.c
                                           #if(7 <= MAX_EP_NUMBER)                                                          E:\usb20\GIO3\system\usb\usbmmap.c
                                           volatile far BDT ep7Bo;         //Endpoint #7 BD Out                             E:\usb20\GIO3\system\usb\usbmmap.c
                                           volatile far BDT ep7Bi;         //Endpoint #7 BD In                              E:\usb20\GIO3\system\usb\usbmmap.c
                                           #endif                                                                           E:\usb20\GIO3\system\usb\usbmmap.c
                                                                                                                            E:\usb20\GIO3\system\usb\usbmmap.c
                                           #if(8 <= MAX_EP_NUMBER)                                                          E:\usb20\GIO3\system\usb\usbmmap.c
                                           volatile far BDT ep8Bo;         //Endpoint #8 BD Out                             E:\usb20\GIO3\system\usb\usbmmap.c
                                           volatile far BDT ep8Bi;         //Endpoint #8 BD In                              E:\usb20\GIO3\system\usb\usbmmap.c
                                           #endif                                                                           E:\usb20\GIO3\system\usb\usbmmap.c
                                                                                                                            E:\usb20\GIO3\system\usb\usbmmap.c
                                           #if(9 <= MAX_EP_NUMBER)                                                          E:\usb20\GIO3\system\usb\usbmmap.c
                                           volatile far BDT ep9Bo;         //Endpoint #9 BD Out                             E:\usb20\GIO3\system\usb\usbmmap.c
                                           volatile far BDT ep9Bi;         //Endpoint #9 BD In                              E:\usb20\GIO3\system\usb\usbmmap.c
                                           #endif                                                                           E:\usb20\GIO3\system\usb\usbmmap.c
                                                                                                                            E:\usb20\GIO3\system\usb\usbmmap.c
                                           #if(10 <= MAX_EP_NUMBER)                                                         E:\usb20\GIO3\system\usb\usbmmap.c
                                           volatile far BDT ep10Bo;        //Endpoint #10 BD Out                            E:\usb20\GIO3\system\usb\usbmmap.c
                                           volatile far BDT ep10Bi;        //Endpoint #10 BD In                             E:\usb20\GIO3\system\usb\usbmmap.c
                                           #endif                                                                           E:\usb20\GIO3\system\usb\usbmmap.c
                                                                                                                            E:\usb20\GIO3\system\usb\usbmmap.c
                                           #if(11 <= MAX_EP_NUMBER)                                                         E:\usb20\GIO3\system\usb\usbmmap.c
                                           volatile far BDT ep11Bo;        //Endpoint #11 BD Out                            E:\usb20\GIO3\system\usb\usbmmap.c
                                           volatile far BDT ep11Bi;        //Endpoint #11 BD In                             E:\usb20\GIO3\system\usb\usbmmap.c
                                           #endif                                                                           E:\usb20\GIO3\system\usb\usbmmap.c
                                                                                                                            E:\usb20\GIO3\system\usb\usbmmap.c
                                           #if(12 <= MAX_EP_NUMBER)                                                         E:\usb20\GIO3\system\usb\usbmmap.c
                                           volatile far BDT ep12Bo;        //Endpoint #12 BD Out                            E:\usb20\GIO3\system\usb\usbmmap.c
                                           volatile far BDT ep12Bi;        //Endpoint #12 BD In                             E:\usb20\GIO3\system\usb\usbmmap.c
                                           #endif                                                                           E:\usb20\GIO3\system\usb\usbmmap.c
                                                                                                                            E:\usb20\GIO3\system\usb\usbmmap.c
                                           #if(13 <= MAX_EP_NUMBER)                                                         E:\usb20\GIO3\system\usb\usbmmap.c
                                           volatile far BDT ep13Bo;        //Endpoint #13 BD Out                            E:\usb20\GIO3\system\usb\usbmmap.c
                                           volatile far BDT ep13Bi;        //Endpoint #13 BD In                             E:\usb20\GIO3\system\usb\usbmmap.c
                                           #endif                                                                           E:\usb20\GIO3\system\usb\usbmmap.c
                                                                                                                            E:\usb20\GIO3\system\usb\usbmmap.c
                                           #if(14 <= MAX_EP_NUMBER)                                                         E:\usb20\GIO3\system\usb\usbmmap.c
                                           volatile far BDT ep14Bo;        //Endpoint #14 BD Out                            E:\usb20\GIO3\system\usb\usbmmap.c
                                           volatile far BDT ep14Bi;        //Endpoint #14 BD In                             E:\usb20\GIO3\system\usb\usbmmap.c
                                           #endif                                                                           E:\usb20\GIO3\system\usb\usbmmap.c
                                                                                                                            E:\usb20\GIO3\system\usb\usbmmap.c
                                           #if(15 <= MAX_EP_NUMBER)                                                         E:\usb20\GIO3\system\usb\usbmmap.c
                                           volatile far BDT ep15Bo;        //Endpoint #15 BD Out                            E:\usb20\GIO3\system\usb\usbmmap.c
                                           volatile far BDT ep15Bi;        //Endpoint #15 BD In                             E:\usb20\GIO3\system\usb\usbmmap.c
                                           #endif                                                                           E:\usb20\GIO3\system\usb\usbmmap.c
                                                                                                                            E:\usb20\GIO3\system\usb\usbmmap.c
                                           /******************************************************************************  E:\usb20\GIO3\system\usb\usbmmap.c
                                            * Section B: EP0 Buffer Space                                                   E:\usb20\GIO3\system\usb\usbmmap.c
                                            ******************************************************************************  E:\usb20\GIO3\system\usb\usbmmap.c
                                            * - Two buffer areas are defined:                                               E:\usb20\GIO3\system\usb\usbmmap.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbmmap.c
                                            *   A. CTRL_TRF_SETUP                                                           E:\usb20\GIO3\system\usb\usbmmap.c
                                            *      - Size = EP0_BUFF_SIZE as defined in autofiles\usbcfg.h                  E:\usb20\GIO3\system\usb\usbmmap.c
                                            *      - Detailed data structure allows direct adddressing of bits and bytes.   E:\usb20\GIO3\system\usb\usbmmap.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbmmap.c
                                            *   B. CTRL_TRF_DATA                                                            E:\usb20\GIO3\system\usb\usbmmap.c
                                            *      - Size = EP0_BUFF_SIZE as defined in autofiles\usbcfg.h                  E:\usb20\GIO3\system\usb\usbmmap.c
                                            *      - Data structure allows direct adddressing of the first 8 bytes.         E:\usb20\GIO3\system\usb\usbmmap.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbmmap.c
                                            * - Both data types are defined in system\usb\usbdefs\usbdefs_ep0_buff.h        E:\usb20\GIO3\system\usb\usbmmap.c
                                            *****************************************************************************/  E:\usb20\GIO3\system\usb\usbmmap.c
                                           volatile far CTRL_TRF_SETUP SetupPkt;                                            E:\usb20\GIO3\system\usb\usbmmap.c
                                           volatile far CTRL_TRF_DATA CtrlTrfData;                                          E:\usb20\GIO3\system\usb\usbmmap.c
                                                                                                                            E:\usb20\GIO3\system\usb\usbmmap.c
                                           /******************************************************************************  E:\usb20\GIO3\system\usb\usbmmap.c
                                            * Section C: Buffer                                                             E:\usb20\GIO3\system\usb\usbmmap.c
                                            ******************************************************************************  E:\usb20\GIO3\system\usb\usbmmap.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbmmap.c
                                            *****************************************************************************/  E:\usb20\GIO3\system\usb\usbmmap.c
                                                                                                                            E:\usb20\GIO3\system\usb\usbmmap.c
                                           //// バンク変更　あらたに追加                                                    E:\usb20\GIO3\system\usb\usbmmap.c
                                           #pragma udata usbram5=0x500     //See Linker Script,usb5:0x500-0x5FF(256-byte)   E:\usb20\GIO3\system\usb\usbmmap.c
                                                                                                                            E:\usb20\GIO3\system\usb\usbmmap.c
                                           volatile far byte usbgen_out[USBGEN_EP_SIZE];                                    E:\usb20\GIO3\system\usb\usbmmap.c
                                           volatile far byte usbgen_in[USBGEN_EP_SIZE];                                     E:\usb20\GIO3\system\usb\usbmmap.c
                                                                                                                            E:\usb20\GIO3\system\usb\usbmmap.c
                                           /// 追加インターフェース用バッファ追加                                           E:\usb20\GIO3\system\usb\usbmmap.c
                                           volatile far byte usbio_out[USBIO_EP_SIZE];                                      E:\usb20\GIO3\system\usb\usbmmap.c
                                           volatile far byte usbio_in[USBIO_EP_SIZE];                                       E:\usb20\GIO3\system\usb\usbmmap.c
                                                                                                                            E:\usb20\GIO3\system\usb\usbmmap.c
                                                                                                                            E:\usb20\GIO3\system\usb\usbmmap.c
                                           #pragma udata                                                                    E:\usb20\GIO3\system\usb\usbmmap.c
                                                                                                                            E:\usb20\GIO3\system\usb\usbmmap.c
                                           /** EOF usbmmap.c ************************************************************/  E:\usb20\GIO3\system\usb\usbmmap.c
                                           /*********************************************************************           E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                Microchip USB C18 Firmware Version 1.0                         E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *********************************************************************           E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            * FileName:        usbdrv.c                                                     E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            * Dependencies:    See INCLUDES section below                                   E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            * Processor:       PIC18                                                        E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            * Compiler:        C18 2.30.01+                                                 E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            * Company:         Microchip Technology, Inc.                                   E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            * Software License Agreement                                                    E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            * The software supplied herewith by Microchip Technology Incorporated           E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            * (the 鼎ompany) for its PICmicroｮ Microcontroller is intended and             E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            * supplied to you, the Company痴 customer, for use solely and                   E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            * exclusively on Microchip PICmicro Microcontroller products. The               E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            * software is owned by the Company and/or its supplier, and is                  E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            * protected under applicable copyright laws. All rights are reserved.           E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            * Any use in violation of the foregoing restrictions may subject the            E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            * user to criminal sanctions under applicable laws, as well as to               E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            * civil liability for the breach of the terms and conditions of this            E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            * license.                                                                      E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            * THIS SOFTWARE IS PROVIDED IN AN 鄭S IS CONDITION. NO WARRANTIES,             E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            * WHETHER EXPRESS, IMPLIED OR STATUTORY, INCLUDING, BUT NOT LIMITED             E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            * TO, IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A                   E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            * PARTICULAR PURPOSE APPLY TO THIS SOFTWARE. THE COMPANY SHALL NOT,             E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            * IN ANY CIRCUMSTANCES, BE LIABLE FOR SPECIAL, INCIDENTAL OR                    E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            * CONSEQUENTIAL DAMAGES, FOR ANY REASON WHATSOEVER.                             E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            * Author               Date        Comment                                      E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~           E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            * Rawin Rojvanit       11/19/04    Original.                                    E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            ********************************************************************/           E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                           /** I N C L U D E S **********************************************************/  E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                           #include <p18cxxx.h>                                                             E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                           #include "system\typedefs.h"                                                     E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                           #include "system\usb\usb.h"                                                      E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                           #include "io_cfg.h"             // Required for USBCheckBusStatus()              E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                           /** V A R I A B L E S ********************************************************/  E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                           #pragma udata                                                                    E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                           /** P R I V A T E  P R O T O T Y P E S ***************************************/  E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                           void USBModuleEnable(void);                                                      E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                           void USBModuleDisable(void);                                                     E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                           void USBSuspend(void);                                                           E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                           void USBWakeFromSuspend(void);                                                   E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                           void USBProtocolResetHandler(void);                                              E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                           void USB_SOF_Handler(void);                                                      E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                           void USBStallHandler(void);                                                      E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                           void USBErrorHandler(void);                                                      E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                           /** D E C L A R A T I O N S **************************************************/  E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                           #pragma code                                                                     E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                           /******************************************************************************  E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            * Function:        void USBCheckBusStatus(void)                                 E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            * PreCondition:    None                                                         E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            * Input:           None                                                         E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            * Output:          None                                                         E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            * Side Effects:    None                                                         E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            * Overview:        This routine enables/disables the USB module by monitoring   E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                  the USB power signal.                                        E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            * Note:            None                                                         E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *****************************************************************************/  E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                           void USBCheckBusStatus(void)                                                     E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                           {                                                                                E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                               /**************************************************************************  E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                                * Bus Attachment & Detachment Detection                                     E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                                * usb_bus_sense is an i/o pin defined in io_cfg.h                           E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                                *************************************************************************/  E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                               #define USB_BUS_ATTACHED    1                                                E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                               #define USB_BUS_DETACHED    0                                                E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                               if(usb_bus_sense == USB_BUS_ATTACHED)       // Is USB bus attached?          E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                               {                                                                            E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
000f2e   a66d     BTFSS     0x6d,0x3,0x0           if(UCONbits.USBEN == 0)                 // Is the module off?            E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
000f30   d80f     RCALL     0xf50                      USBModuleEnable();                  // Is off, enable it             E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                               }                                                                            E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
000f32   d002     BRA       0xf38              else                                                                         E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                               {                                                                            E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
000f34   b66d     BTFSC     0x6d,0x3,0x0           if(UCONbits.USBEN == 1)                 // Is the module on?             E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
000f36   d813     RCALL     0xf5e                      USBModuleDisable();                 // Is on, disable it             E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                               }//end if(usb_bus_sense...)                                                  E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                               /*                                                                           E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                                * After enabling the USB module, it takes some time for the voltage         E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                                * on the D+ or D- line to rise high enough to get out of the SE0 condition. E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                                * The USB Reset interrupt should not be unmasked until the SE0 condition is E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                                * cleared. This helps preventing the firmware from misinterpreting this     E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                                * unique event as a USB bus reset from the USB host.                        E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                                */                                                                          E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
000f38   0100     MOVLB     0x0                if(usb_device_state == ATTACHED_STATE)                                       E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
000f3a   05f8     DECF      0xf8,0x0,0x1                                                                                    
000f3c   e108     BNZ       0xf4e                                                                                           
                                               {                                                                            E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
000f3e   ba6d     BTFSC     0x6d,0x5,0x0           if(!UCONbits.SE0)                                                        E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
000f40   d006     BRA       0xf4e                                                                                           
                                                   {                                                                        E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
000f42   6a68     CLRF      0x68,0x0                   UIR = 0;                        // Clear all USB interrupts          E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
000f44   6a69     CLRF      0x69,0x0                   UIE = 0;                        // Mask all USB interrupts           E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
000f46   8069     BSF       0x69,0x0,0x0               UIEbits.URSTIE = 1;             // Unmask RESET interrupt            E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
000f48   8869     BSF       0x69,0x4,0x0               UIEbits.IDLEIE = 1;             // Unmask IDLE interrupt             E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
000f4a   0e02     MOVLW     0x2                        usb_device_state = POWERED_STATE;                                    E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
000f4c   6ff8     MOVWF     0xf8,0x1                                                                                        
                                                   }//end if                           // else wait until SE0 is cleared    E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                               }//end if(usb_device_state == ATTACHED_STATE)                                E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
000f4e   0012     RETURN    0x0            }//end USBCheckBusStatus                                                         E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                           /******************************************************************************  E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            * Function:        void USBModuleEnable(void)                                   E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            * PreCondition:    None                                                         E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            * Input:           None                                                         E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            * Output:          None                                                         E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            * Side Effects:    None                                                         E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            * Overview:        This routine enables the USB module.                         E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                  An end designer should never have to call this routine       E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                  manually. This routine should only be called from            E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                  USBCheckBusStatus().                                         E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            * Note:            See USBCheckBusStatus() for more information.                E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *****************************************************************************/  E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                           void USBModuleEnable(void)                                                       E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                           {                                                                                E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
000f50   6a6d     CLRF      0x6d,0x0           UCON = 0;                                                                    E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
000f52   6a69     CLRF      0x69,0x0           UIE = 0;                                // Mask all USB interrupts           E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
000f54   866d     BSF       0x6d,0x3,0x0       UCONbits.USBEN = 1;                     // Enable module & attach to bus     E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
000f56   0100     MOVLB     0x0                usb_device_state = ATTACHED_STATE;      // Defined in usbmmap.c & .h         E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
000f58   0e01     MOVLW     0x1                                                                                             
000f5a   6ff8     MOVWF     0xf8,0x1                                                                                        
000f5c   0012     RETURN    0x0            }//end USBModuleEnable                                                           E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                           /******************************************************************************  E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            * Function:        void USBModuleDisable(void)                                  E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            * PreCondition:    None                                                         E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            * Input:           None                                                         E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            * Output:          None                                                         E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            * Side Effects:    None                                                         E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            * Overview:        This routine disables the USB module.                        E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                  An end designer should never have to call this routine       E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                  manually. This routine should only be called from            E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                  USBCheckBusStatus().                                         E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            * Note:            See USBCheckBusStatus() for more information.                E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *****************************************************************************/  E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                           void USBModuleDisable(void)                                                      E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                           {                                                                                E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
000f5e   6a6d     CLRF      0x6d,0x0           UCON = 0;                               // Disable module & detach from bus  E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
000f60   6a69     CLRF      0x69,0x0           UIE = 0;                                // Mask all USB interrupts           E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
000f62   0100     MOVLB     0x0                usb_device_state = DETACHED_STATE;      // Defined in usbmmap.c & .h         E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
000f64   6bf8     CLRF      0xf8,0x1                                                                                        
000f66   0012     RETURN    0x0            }//end USBModuleDisable                                                          E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                           /******************************************************************************  E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            * Function:        void USBSoftDetach(void)                                     E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            * PreCondition:    None                                                         E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            * Input:           None                                                         E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            * Output:          None                                                         E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            * Side Effects:    The device will have to be re-enumerated to function again.  E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            * Overview:        USBSoftDetach electrically disconnects the device from       E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                  the bus. This is done by stop supplying Vusb voltage to      E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                  pull-up resistor. The pull-down resistors on the host        E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                  side will pull both differential signal lines low and        E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                  the host registers the event as a disconnect.                E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                  Since the USB cable is not physically disconnected, the      E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                  power supply through the cable can still be sensed by        E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                  the device. The next time USBCheckBusStatus() function       E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                  is called, it will reconnect the device back to the bus.     E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            * Note:            None                                                         E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *****************************************************************************/  E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                           void USBSoftDetach(void)                                                         E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                           {                                                                                E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
000f68   efaf     GOTO      0xf5e              USBModuleDisable();                                                          E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
000f6a   f007                                                                                                               
                                           }//end USBSoftDetach                                                             E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                           /******************************************************************************  E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            * Function:        void USBDriverService(void)                                  E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            * PreCondition:    None                                                         E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            * Input:           None                                                         E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            * Output:          None                                                         E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            * Side Effects:    None                                                         E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            * Overview:        This routine is the heart of this firmware. It manages       E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                  all USB interrupts.                                          E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            * Note:            Device state transitions through the following stages:       E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                  DETACHED -> ATTACHED -> POWERED -> DEFAULT ->                E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                  ADDRESS_PENDING -> ADDRESSED -> CONFIGURED -> READY          E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *****************************************************************************/  E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                           void USBDriverService(void)                                                      E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                           {                                                                                E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                               /*                                                                           E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                                * Pointless to continue servicing if USB cable is not even attached.        E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                                */                                                                          E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
000f6c   0100     MOVLB     0x0                if(usb_device_state == DETACHED_STATE) return;                               E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
000f6e   51f8     MOVF      0xf8,0x0,0x1                                                                                    
000f70   e101     BNZ       0xf74                                                                                           
000f72   d03a     BRA       0xfe8                                                                                           
                                                                                                                            E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                               /*                                                                           E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                                * Task A: Service USB Activity Interrupt                                    E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                                */                                                                          E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
000f74   5068     MOVF      0x68,0x0,0x0       if(UIRbits.ACTVIF && UIEbits.ACTVIE)    USBWakeFromSuspend();                E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
000f76   0b04     ANDLW     0x4                                                                                             
000f78   e004     BZ        0xf82                                                                                           
000f7a   5069     MOVF      0x69,0x0,0x0                                                                                    
000f7c   0b04     ANDLW     0x4                                                                                             
000f7e   e001     BZ        0xf82                                                                                           
000f80   d838     RCALL     0xff2                                                                                           
                                                                                                                            E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                               /*                                                                           E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                                * Pointless to continue servicing if the device is in suspend mode.         E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                                */                                                                          E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
000f82   b26d     BTFSC     0x6d,0x1,0x0       if(UCONbits.SUSPND==1) return;                                               E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
000f84   d031     BRA       0xfe8                                                                                           
                                                                                                                            E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                               /*                                                                           E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                                * Task B: Service USB Bus Reset Interrupt.                                  E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                                * When bus reset is received during suspend, ACTVIF will be set first,      E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                                * once the UCONbits.SUSPND is clear, then the URSTIF bit will be asserted.  E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                                * This is why URSTIF is checked after ACTVIF.                               E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                                */                                                                          E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
000f86   5068     MOVF      0x68,0x0,0x0       if(UIRbits.URSTIF && UIEbits.URSTIE)    USBProtocolResetHandler();           E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
000f88   0b01     ANDLW     0x1                                                                                             
000f8a   e004     BZ        0xf94                                                                                           
000f8c   5069     MOVF      0x69,0x0,0x0                                                                                    
000f8e   0b01     ANDLW     0x1                                                                                             
000f90   e001     BZ        0xf94                                                                                           
000f92   d850     RCALL     0x1034                                                                                          
                                                                                                                            E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                               /*                                                                           E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                                * Task C: Service other USB interrupts                                      E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                                */                                                                          E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
000f94   5068     MOVF      0x68,0x0,0x0       if(UIRbits.IDLEIF && UIEbits.IDLEIE)    USBSuspend();                        E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
000f96   0b10     ANDLW     0x10                                                                                            
000f98   e004     BZ        0xfa2                                                                                           
000f9a   5069     MOVF      0x69,0x0,0x0                                                                                    
000f9c   0b10     ANDLW     0x10                                                                                            
000f9e   e001     BZ        0xfa2                                                                                           
000fa0   d824     RCALL     0xfea                                                                                           
000fa2   5068     MOVF      0x68,0x0,0x0       if(UIRbits.SOFIF && UIEbits.SOFIE)      USB_SOF_Handler();                   E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
000fa4   0b40     ANDLW     0x40                                                                                            
000fa6   e004     BZ        0xfb0                                                                                           
000fa8   5069     MOVF      0x69,0x0,0x0                                                                                    
000faa   0b40     ANDLW     0x40                                                                                            
000fac   e001     BZ        0xfb0                                                                                           
000fae   d837     RCALL     0x101e                                                                                          
000fb0   5068     MOVF      0x68,0x0,0x0       if(UIRbits.STALLIF && UIEbits.STALLIE)  USBStallHandler();                   E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
000fb2   0b20     ANDLW     0x20                                                                                            
000fb4   e004     BZ        0xfbe                                                                                           
000fb6   5069     MOVF      0x69,0x0,0x0                                                                                    
000fb8   0b20     ANDLW     0x20                                                                                            
000fba   e001     BZ        0xfbe                                                                                           
000fbc   d832     RCALL     0x1022                                                                                          
000fbe   5068     MOVF      0x68,0x0,0x0       if(UIRbits.UERRIF && UIEbits.UERRIE)    USBErrorHandler();                   E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
000fc0   0b02     ANDLW     0x2                                                                                             
000fc2   e004     BZ        0xfcc                                                                                           
000fc4   5069     MOVF      0x69,0x0,0x0                                                                                    
000fc6   0b02     ANDLW     0x2                                                                                             
000fc8   e001     BZ        0xfcc                                                                                           
000fca   d832     RCALL     0x1030                                                                                          
                                                                                                                            E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                               /*                                                                           E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                                * Pointless to continue servicing if the host has not sent a bus reset.     E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                                * Once bus reset is received, the device transitions into the DEFAULT       E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                                * state and is ready for communication.                                     E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                                */                                                                          E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
000fcc   0e03     MOVLW     0x3                if(usb_device_state < DEFAULT_STATE) return;                                 E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
000fce   0100     MOVLB     0x0                                                                                             
000fd0   5df8     SUBWF     0xf8,0x0,0x1                                                                                    
000fd2   e201     BC        0xfd6                                                                                           
000fd4   d009     BRA       0xfe8                                                                                           
                                                                                                                            E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                               /*                                                                           E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                                * Task D: Servicing USB Transaction Complete Interrupt                      E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                                */                                                                          E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
000fd6   5068     MOVF      0x68,0x0,0x0       if(UIRbits.TRNIF && UIEbits.TRNIE)                                           E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
000fd8   0b08     ANDLW     0x8                                                                                             
000fda   e006     BZ        0xfe8                                                                                           
000fdc   5069     MOVF      0x69,0x0,0x0                                                                                    
000fde   0b08     ANDLW     0x8                                                                                             
000fe0   e003     BZ        0xfe8                                                                                           
                                               {                                                                            E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                                   /*                                                                       E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                                    * USBCtrlEPService only services transactions over EP0.                 E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                                    * It ignores all other EP transactions.                                 E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                                    */                                                                      E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
000fe2   ec51     CALL      0x8a2,0x0              USBCtrlEPService();                                                      E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
000fe4   f004                                                                                                               
                                                                                                                            E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                                   /*                                                                       E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                                    * Other EP can be serviced later by responsible device class firmware.  E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                                    * Each device driver knows when an OUT or IN transaction is ready by    E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                                    * checking the buffer ownership bit.                                    E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                                    * An OUT EP should always be owned by SIE until the data is ready.      E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                                    * An IN EP should always be owned by CPU until the data is ready.       E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                                    *                                                                       E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                                    * Because of this logic, it is not necessary to save the USTAT value    E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                                    * of non-EP0 transactions.                                              E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                                    */                                                                      E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
000fe6   9668     BCF       0x68,0x3,0x0           UIRbits.TRNIF = 0;                                                       E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                               }//end if(UIRbits.TRNIF && UIEbits.TRNIE)                                    E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
000fe8   0012     RETURN    0x0            }//end USBDriverService                                                          E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                           /******************************************************************************  E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            * Function:        void USBSuspend(void)                                        E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            * PreCondition:    None                                                         E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            * Input:           None                                                         E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            * Output:          None                                                         E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            * Side Effects:    None                                                         E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            * Overview:                                                                     E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            * Note:            None                                                         E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *****************************************************************************/  E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                           void USBSuspend(void)                                                            E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                           {                                                                                E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                               /*                                                                           E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                                * NOTE: Do not clear UIRbits.ACTVIF here!                                   E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                                * Reason:                                                                   E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                                * ACTVIF is only generated once an IDLEIF has been generated.               E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                                * This is a 1:1 ratio interrupt generation.                                 E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                                * For every IDLEIF, there will be only one ACTVIF regardless of             E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                                * the number of subsequent bus transitions.                                 E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                                *                                                                           E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                                * If the ACTIF is cleared here, a problem could occur when:                 E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                                * [       IDLE       ][bus activity ->                                      E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                                * <--- 3 ms ----->     ^                                                    E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                                *                ^     ACTVIF=1                                             E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                                *                IDLEIF=1                                                   E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                                *  #           #           #           #   (#=Program polling flags)        E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                                *                          ^                                                E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                                *                          This polling loop will see both                  E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                                *                          IDLEIF=1 and ACTVIF=1.                           E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                                *                          However, the program services IDLEIF first       E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                                *                          because ACTIVIE=0.                               E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                                *                          If this routine clears the only ACTIVIF,         E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                                *                          then it can never get out of the suspend         E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                                *                          mode.                                            E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                                */                                                                          E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
000fea   8469     BSF       0x69,0x2,0x0       UIEbits.ACTVIE = 1;                     // Enable bus activity interrupt     E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
000fec   9868     BCF       0x68,0x4,0x0       UIRbits.IDLEIF = 0;                                                          E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
000fee   826d     BSF       0x6d,0x1,0x0       UCONbits.SUSPND = 1;                    // Put USB module in power conserve  E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                                                                       // mode, SIE clock inactive          E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                               /*                                                                           E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                                * At this point the PIC can go into sleep,idle, or                          E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                                * switch to a slower clock, etc.                                            E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                                */                                                                          E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                               /* Modifiable Section */                                                     E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                               /* End Modifiable Section */                                                 E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
000ff0   0012     RETURN    0x0            }//end USBSuspend                                                                E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                           /******************************************************************************  E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            * Function:        void USBWakeFromSuspend(void)                                E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            * PreCondition:    None                                                         E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            * Input:           None                                                         E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            * Output:          None                                                         E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            * Side Effects:    None                                                         E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            * Overview:                                                                     E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            * Note:            None                                                         E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *****************************************************************************/  E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                           void USBWakeFromSuspend(void)                                                    E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                           {                                                                                E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                               /*                                                                           E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                                * If using clock switching, this is the place to restore the                E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                                * original clock frequency.                                                 E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                                */                                                                          E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
000ff2   926d     BCF       0x6d,0x1,0x0       UCONbits.SUSPND = 0;                                                         E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
000ff4   9469     BCF       0x69,0x2,0x0       UIEbits.ACTVIE = 0;                                                          E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
000ff6   9468     BCF       0x68,0x2,0x0       UIRbits.ACTVIF = 0;                                                          E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
000ff8   0012     RETURN    0x0            }//end USBWakeFromSuspend                                                        E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                           /******************************************************************************  E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            * Function:        void USBRemoteWakeup(void)                                   E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            * PreCondition:    None                                                         E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            * Input:           None                                                         E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            * Output:          None                                                         E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            * Side Effects:    None                                                         E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            * Overview:        This function should be called by user when the device       E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                  is waken up by an external stimulus other than ACTIVIF.      E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                  Please read the note below to understand the limitations.    E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            * Note:            The modifiable section in this routine should be changed     E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                  to meet the application needs. Current implementation        E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                  temporary blocks other functions from executing for a        E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                  period of 1-13 ms depending on the core frequency.           E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                  According to USB 2.0 specification section 7.1.7.7,          E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                  "The remote wakeup device must hold the resume signaling     E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                  for at lest 1 ms but for no more than 15 ms."                E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                  The idea here is to use a delay counter loop, using a        E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                  common value that would work over a wide range of core       E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                  frequencies.                                                 E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                  That value selected is 1800. See table below:                E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                  ==========================================================   E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                  Core Freq(MHz)      MIP         RESUME Signal Period (ms)    E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                  ==========================================================   E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                      48              12          1.05                         E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                       4              1           12.6                         E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                  ==========================================================   E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                  * These timing could be incorrect when using code            E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                    optimization or extended instruction mode,                 E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                    or when having other interrupts enabled.                   E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                    Make sure to verify using the MPLAB SIM's Stopwatch        E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *****************************************************************************/  E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                           void USBRemoteWakeup(void)                                                       E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                           {                                                                                E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                               static word delay_count;                                                     E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
000ffa   0100     MOVLB     0x0                if(usb_stat.RemoteWakeup == 1)          // Check if RemoteWakeup function    E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
000ffc   a1f9     BTFSS     0xf9,0x0,0x1                                                                                    
000ffe   d00e     BRA       0x101c                                                                                          
                                               {                                       // has been enabled by the host.     E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
001000   dff8     RCALL     0xff2                  USBWakeFromSuspend();               // Unsuspend USB modue               E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
001002   846d     BSF       0x6d,0x2,0x0           UCONbits.RESUME = 1;                // Start RESUME signaling            E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                                   /* Modifiable Section */                                                 E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
001004   0100     MOVLB     0x0                    delay_count = 1800U;                // Set RESUME line for 1-13 ms       E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
001006   0e08     MOVLW     0x8                                                                                             
001008   6ffe     MOVWF     0xfe,0x1                                                                                        
00100a   0e07     MOVLW     0x7                                                                                             
00100c   6fff     MOVWF     0xff,0x1                                                                                        
                                                   do                                                                       E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                                   {                                                                        E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
00100e   07fe     DECF      0xfe,0x1,0x1               delay_count--;                                                       E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
001010   0e00     MOVLW     0x0                                                                                             
001012   5bff     SUBWFB    0xff,0x1,0x1                                                                                    
001014   51fe     MOVF      0xfe,0x0,0x1           }while(delay_count);                                                     E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
001016   11ff     IORWF     0xff,0x0,0x1                                                                                    
001018   e1fa     BNZ       0x100e                                                                                          
                                                                                                                            E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                                   /* End Modifiable Section */                                             E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
00101a   946d     BCF       0x6d,0x2,0x0           UCONbits.RESUME = 0;                                                     E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                               }//endif                                                                     E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
00101c   0012     RETURN    0x0            }//end USBRemoteWakeup                                                           E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                           /******************************************************************************  E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            * Function:        void USB_SOF_Handler(void)                                   E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            * PreCondition:    None                                                         E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            * Input:           None                                                         E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            * Output:          None                                                         E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            * Side Effects:    None                                                         E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            * Overview:        The USB host sends out a SOF packet to full-speed devices    E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                  every 1 ms. This interrupt may be useful for isochronous     E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                  pipes. End designers should implement callback routine       E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                  as necessary.                                                E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            * Note:            None                                                         E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *****************************************************************************/  E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                           void USB_SOF_Handler(void)                                                       E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                           {                                                                                E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                               /* Callback routine here */                                                  E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
00101e   9c68     BCF       0x68,0x6,0x0       UIRbits.SOFIF = 0;                                                           E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
001020   0012     RETURN    0x0            }//end USB_SOF_Handler                                                           E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                           /******************************************************************************  E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            * Function:        void USBStallHandler(void)                                   E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            * PreCondition:    A STALL packet is sent to the host by the SIE.               E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            * Input:           None                                                         E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            * Output:          None                                                         E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            * Side Effects:    None                                                         E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            * Overview:        The STALLIF is set anytime the SIE sends out a STALL         E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                  packet regardless of which endpoint causes it.               E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                  A Setup transaction overrides the STALL function. A stalled  E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                  endpoint stops stalling once it receives a setup packet.     E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                  In this case, the SIE will accepts the Setup packet and      E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                  set the TRNIF flag to notify the firmware. STALL function    E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                  for that particular endpoint pipe will be automatically      E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                  disabled (direction specific).                               E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                  There are a few reasons for an endpoint to be stalled.       E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                  1. When a non-supported USB request is received.             E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                     Example: GET_DESCRIPTOR(DEVICE_QUALIFIER)                 E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                  2. When an endpoint is currently halted.                     E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                  3. When the device class specifies that an endpoint must     E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                     stall in response to a specific event.                    E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                     Example: Mass Storage Device Class                        E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                              If the CBW is not valid, the device shall        E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                              STALL the Bulk-In pipe.                          E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                              See USB Mass Storage Class Bulk-only Transport   E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                              Specification for more details.                  E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            * Note:            UEPn.EPSTALL can be scanned to see which endpoint causes     E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                  the stall event.                                             E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                  If                                                           E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *****************************************************************************/  E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                           void USBStallHandler(void)                                                       E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                           {                                                                                E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                               /*                                                                           E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                                * Does not really have to do anything here,                                 E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                                * even for the control endpoint.                                            E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                                * All BDs of Endpoint 0 are owned by SIE right now,                         E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                                * but once a Setup Transaction is received, the ownership                   E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                                * for EP0_OUT will be returned to CPU.                                      E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                                * When the Setup Transaction is serviced, the ownership                     E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                                * for EP0_IN will then be forced back to CPU by firmware.                   E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                                *                                                                           E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                                * NOTE: Above description is not quite true at this point.                  E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                                *       It seems the SIE never returns the UOWN bit to CPU,                 E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                                *       and a TRNIF is never generated upon successful                      E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                                *       reception of a SETUP transaction.                                   E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                                *       Firmware work-around is implemented below.                          E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                                */                                                                          E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
001022   a070     BTFSS     0x70,0x0,0x0       if(UEP0bits.EPSTALL == 1)                                                    E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
001024   d003     BRA       0x102c                                                                                          
                                               {                                                                            E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
001026   eca0     CALL      0xb40,0x0              USBPrepareForNextSetupTrf();        // Firmware Work-Around              E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
001028   f005                                                                                                               
00102a   9070     BCF       0x70,0x0,0x0           UEP0bits.EPSTALL = 0;                                                    E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                               }                                                                            E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
00102c   9a68     BCF       0x68,0x5,0x0       UIRbits.STALLIF = 0;                                                         E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
00102e   0012     RETURN    0x0            }//end USBStallHandler                                                           E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                           /******************************************************************************  E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            * Function:        void USBErrorHandler(void)                                   E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            * PreCondition:    None                                                         E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            * Input:           None                                                         E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            * Output:          None                                                         E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            * Side Effects:    None                                                         E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            * Overview:        The purpose of this interrupt is mainly for debugging        E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                  during development. Check UEIR to see which error causes     E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                  the interrupt.                                               E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            * Note:            None                                                         E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *****************************************************************************/  E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                           void USBErrorHandler(void)                                                       E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                           {                                                                                E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
001030   9268     BCF       0x68,0x1,0x0       UIRbits.UERRIF = 0;                                                          E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
001032   0012     RETURN    0x0            }//end USBErrorHandler                                                           E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                           /******************************************************************************  E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            * Function:        void USBProtocolResetHandler(void)                           E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            * PreCondition:    A USB bus reset is received from the host.                   E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            * Input:           None                                                         E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            * Output:          None                                                         E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            * Side Effects:    Currently, this routine flushes any pending USB              E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                  transactions. It empties out the USTAT FIFO. This action     E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                  might not be desirable in some applications.                 E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            * Overview:        Once a USB bus reset is received from the host, this         E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                  routine should be called. It resets the device address to    E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                  zero, disables all non-EP0 endpoints, initializes EP0 to     E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                  be ready for default communication, clears all USB           E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                  interrupt flags, unmasks applicable USB interrupts, and      E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                  reinitializes internal state-machine variables.              E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            * Note:            None                                                         E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                            *****************************************************************************/  E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                           void USBProtocolResetHandler(void)                                               E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                           {                                                                                E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
001034   6a6a     CLRF      0x6a,0x0           UEIR = 0;                       // Clear all USB error flags                 E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
001036   6a68     CLRF      0x68,0x0           UIR = 0;                        // Clears all USB interrupts                 E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
001038   0e9f     MOVLW     0x9f               UEIE = 0b10011111;              // Unmask all USB error interrupts           E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
00103a   6e6b     MOVWF     0x6b,0x0                                                                                        
00103c   0e7b     MOVLW     0x7b               UIE = 0b01111011;               // Enable all interrupts except ACTVIE       E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
00103e   6e69     MOVWF     0x69,0x0                                                                                        
                                                                                                                            E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
001040   6a6e     CLRF      0x6e,0x0           UADDR = 0x00;                   // Reset to default address                  E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
001042   0e0f     MOVLW     0xf                mDisableEP1to15();              // Reset all non-EP0 UEPn registers          E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
001044   6ee6     MOVWF     0xe6,0x0                                                                                        
001046   0e71     MOVLW     0x71                                                                                            
001048   6ee6     MOVWF     0xe6,0x0                                                                                        
00104a   0e0f     MOVLW     0xf                                                                                             
00104c   6ee6     MOVWF     0xe6,0x0                                                                                        
00104e   d814     RCALL     0x1078                                                                                          
001050   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001052   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001054   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001056   0e16     MOVLW     0x16               UEP0 = EP_CTRL|HSHK_EN;         // Init EP0 as a Ctrl EP, see usbdrv.h       E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
001058   6e70     MOVWF     0x70,0x0                                                                                        
                                                                                                                            E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
00105a   a668     BTFSS     0x68,0x3,0x0       while(UIRbits.TRNIF == 1)       // Flush any pending transactions            E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
00105c   d002     BRA       0x1062                                                                                          
001060   d7fc     BRA       0x105a                                                                                          
00105e   9668     BCF       0x68,0x3,0x0           UIRbits.TRNIF = 0;                                                       E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
001062   986d     BCF       0x6d,0x4,0x0       UCONbits.PKTDIS = 0;            // Make sure packet processing is enabled    E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
001064   eca0     CALL      0xb40,0x0          USBPrepareForNextSetupTrf();    // Declared in usbctrltrf.c                  E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
001066   f005                                                                                                               
                                                                                                                            E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
001068   0100     MOVLB     0x0                usb_stat.RemoteWakeup = 0;      // Default status flag to disable            E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
00106a   91f9     BCF       0xf9,0x0,0x1                                                                                    
00106c   0100     MOVLB     0x0                usb_active_cfg = 0;             // Clear active configuration                E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
00106e   6bfa     CLRF      0xfa,0x1                                                                                        
001070   0100     MOVLB     0x0                usb_device_state = DEFAULT_STATE;                                            E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
001072   0e03     MOVLW     0x3                                                                                             
001074   6ff8     MOVWF     0xf8,0x1                                                                                        
001076   0012     RETURN    0x0            }//end USBProtocolResetHandler                                                   E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                                                                                                            E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                           /* Auxiliary Function */                                                         E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
001078   cfd9     MOVFF     0xfd9,0xfe6    void ClearArray(byte* startAdr,byte count)                                       E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
00107a   ffe6                                                                                                               
00107c   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
00107e   ffd9                                                                                                               
                                           {                                                                                E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
001080   0efd     MOVLW     0xfd               *startAdr;                                                                   E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
001082   cfdb     MOVFF     0xfdb,0xfe9                                                                                     
001084   ffe9                                                                                                               
001086   0efe     MOVLW     0xfe                                                                                            
001088   cfdb     MOVFF     0xfdb,0xfea                                                                                     
00108a   ffea                                                                                                               
00108c   0efc     MOVLW     0xfc               while(count)                                                                 E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
00108e   50db     MOVF      0xdb,0x0,0x0                                                                                    
001090   e004     BZ        0x109a                                                                                          
001098   d7f9     BRA       0x108c                                                                                          
                                               {                                                                            E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                                   _asm                                                                     E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
001092   6aee     CLRF      0xee,0x0               clrf POSTINC0,0                                                          E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                                   _endasm                                                                  E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
001094   0efc     MOVLW     0xfc                   count--;                                                                 E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
001096   06db     DECF      0xdb,0x1,0x0                                                                                    
                                               }//end while                                                                 E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
00109a   52e5     MOVF      0xe5,0x1,0x0   }//end ClearArray                                                                E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
00109c   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
00109e   ffd9                                                                                                               
0010a0   0012     RETURN    0x0                                                                                             
                                                                                                                            E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                           /** EOF usbdrv.c *************************************************************/  E:\usb20\GIO3\system\usb\usbdrv\usbdrv.c
                                           /*********************************************************************           E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            *                Microchip USB C18 Firmware Version 1.0                         E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            *********************************************************************           E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            * FileName:        usbctrltrf.c                                                 E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            * Dependencies:    See INCLUDES section below                                   E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            * Processor:       PIC18                                                        E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            * Compiler:        C18 2.30.01+                                                 E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            * Company:         Microchip Technology, Inc.                                   E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            * Software License Agreement                                                    E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            * The software supplied herewith by Microchip Technology Incorporated           E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            * (the 鼎ompany) for its PICmicroｮ Microcontroller is intended and             E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            * supplied to you, the Company痴 customer, for use solely and                   E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            * exclusively on Microchip PICmicro Microcontroller products. The               E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            * software is owned by the Company and/or its supplier, and is                  E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            * protected under applicable copyright laws. All rights are reserved.           E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            * Any use in violation of the foregoing restrictions may subject the            E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            * user to criminal sanctions under applicable laws, as well as to               E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            * civil liability for the breach of the terms and conditions of this            E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            * license.                                                                      E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            * THIS SOFTWARE IS PROVIDED IN AN 鄭S IS CONDITION. NO WARRANTIES,             E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            * WHETHER EXPRESS, IMPLIED OR STATUTORY, INCLUDING, BUT NOT LIMITED             E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            * TO, IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A                   E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            * PARTICULAR PURPOSE APPLY TO THIS SOFTWARE. THE COMPANY SHALL NOT,             E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            * IN ANY CIRCUMSTANCES, BE LIABLE FOR SPECIAL, INCIDENTAL OR                    E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            * CONSEQUENTIAL DAMAGES, FOR ANY REASON WHATSOEVER.                             E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            * Author               Date        Comment                                      E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            *~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~           E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            * Rawin Rojvanit       11/19/04    Original.                                    E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            ********************************************************************/           E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                                                                                                            E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                           /** I N C L U D E S **********************************************************/  E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                           #include <p18cxxx.h>                                                             E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                           #include "system\typedefs.h"                                                     E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                           #include "system\usb\usb.h"                                                      E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                                                                                                            E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                           /** V A R I A B L E S ********************************************************/  E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                           #pragma udata                                                                    E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                           byte ctrl_trf_state;                // Control Transfer State                    E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                           byte ctrl_trf_session_owner;        // Current transfer session owner            E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                                                                                                            E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                           POINTER pSrc;                       // Data source pointer                       E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                           POINTER pDst;                       // Data destination pointer                  E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                           WORD wCount;                        // Data counter                              E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                                                                                                            E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                           /** P R I V A T E  P R O T O T Y P E S ***************************************/  E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                           void USBCtrlTrfSetupHandler(void);                                               E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                           void USBCtrlTrfOutHandler(void);                                                 E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                           void USBCtrlTrfInHandler(void);                                                  E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                                                                                                            E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                           /** D E C L A R A T I O N S **************************************************/  E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                           #pragma code                                                                     E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                           /******************************************************************************  E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            * Function:        void USBCtrlEPService(void)                                  E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            * PreCondition:    USTAT is loaded with a valid endpoint address.               E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            * Input:           None                                                         E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            * Output:          None                                                         E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            * Side Effects:    None                                                         E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            * Overview:        USBCtrlEPService checks for three transaction types that     E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  it knows how to service and services them:                   E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  1. EP0 SETUP                                                 E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  2. EP0 OUT                                                   E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  3. EP0 IN                                                    E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  It ignores all other types (i.e. EP1, EP2, etc.)             E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            * Note:            None                                                         E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            *****************************************************************************/  E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                           void USBCtrlEPService(void)                                                      E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                           {                                                                                E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
0008a2   506c     MOVF      0x6c,0x0,0x0       if(USTAT == EP00_OUT)                                                        E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
0008a4   e002     BZ        0x8aa                                                                                           
0008a6   0e00     MOVLW     0x0                                                                                             
0008a8   d001     BRA       0x8ac                                                                                           
0008aa   0e01     MOVLW     0x1                                                                                             
0008ac   0900     IORLW     0x0                                                                                             
0008ae   e00b     BZ        0x8c6                                                                                           
                                               {                                                                            E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
0008b0   0104     MOVLB     0x4                    if(ep0Bo.Stat.PID == SETUP_TOKEN)           // EP0 SETUP                 E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
0008b2   5100     MOVF      0x0,0x0,0x1                                                                                     
0008b4   0b3c     ANDLW     0x3c                                                                                            
0008b6   42e8     RRNCF     0xe8,0x1,0x0                                                                                    
0008b8   42e8     RRNCF     0xe8,0x1,0x0                                                                                    
0008ba   080d     SUBLW     0xd                                                                                             
0008bc   e102     BNZ       0x8c2                                                                                           
0008be   d80c     RCALL     0x8d8                      USBCtrlTrfSetupHandler();                                            E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
0008c0   d001     BRA       0x8c4                  else                                        // EP0 OUT                   E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
0008c2   d81c     RCALL     0x8fc                      USBCtrlTrfOutHandler();                                              E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                               }                                                                            E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
0008c4   d008     BRA       0x8d6              else if(USTAT == EP00_IN)                       // EP0 IN                    E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
0008c6   506c     MOVF      0x6c,0x0,0x0                                                                                    
0008c8   e002     BZ        0x8ce                                                                                           
0008ca   0e00     MOVLW     0x0                                                                                             
0008cc   d001     BRA       0x8d0                                                                                           
0008ce   0e01     MOVLW     0x1                                                                                             
0008d0   0904     IORLW     0x4                                                                                             
0008d2   e001     BZ        0x8d6                                                                                           
0008d4   d823     RCALL     0x91c                  USBCtrlTrfInHandler();                                                   E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                                                                                                            E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
0008d6   0012     RETURN    0x0            }//end USBCtrlEPService                                                          E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                                                                                                            E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                           /******************************************************************************  E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            * Function:        void USBCtrlTrfSetupHandler(void)                            E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            * PreCondition:    SetupPkt buffer is loaded with valid USB Setup Data          E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            * Input:           None                                                         E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            * Output:          None                                                         E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            * Side Effects:    None                                                         E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            * Overview:        This routine is a task dispatcher and has 3 stages.          E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  1. It initializes the control transfer state machine.        E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  2. It calls on each of the module that may know how to       E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            *                     service the Setup Request from the host.                  E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            *                     Module Example: USB9, HID, CDC, MSD, ...                  E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            *                     As new classes are added, ClassReqHandler table in        E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            *                     usbdsc.c should be updated to call all available          E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            *                     class handlers.                                           E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  3. Once each of the modules has had a chance to check if     E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            *                     it is responsible for servicing the request, stage 3      E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            *                     then checks direction of the transfer to determine how    E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            *                     to prepare EP0 for the control transfer.                  E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            *                     Refer to USBCtrlEPServiceComplete() for more details.     E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            * Note:            Microchip USB Firmware has three different states for        E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  the control transfer state machine:                          E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  1. WAIT_SETUP                                                E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  2. CTRL_TRF_TX                                               E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  3. CTRL_TRF_RX                                               E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  Refer to firmware manual to find out how one state           E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  is transitioned to another.                                  E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  A Control Transfer is composed of many USB transactions.     E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  When transferring data over multiple transactions,           E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  it is important to keep track of data source, data           E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  destination, and data count. These three parameters are      E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  stored in pSrc,pDst, and wCount. A flag is used to           E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  note if the data source is from ROM or RAM.                  E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            *****************************************************************************/  E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
0008d8   cfd9     MOVFF     0xfd9,0xfe6    void USBCtrlTrfSetupHandler(void)                                                E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
0008da   ffe6                                                                                                               
0008dc   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
0008de   ffd9                                                                                                               
0008e0   52e6     MOVF      0xe6,0x1,0x0                                                                                    
                                           {                                                                                E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                               byte i;                                                                      E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                                                                                                            E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                               /* Stage 1 */                                                                E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
0008e2   0100     MOVLB     0x0                ctrl_trf_state = WAIT_SETUP;                                                 E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
0008e4   6bf0     CLRF      0xf0,0x1                                                                                        
0008e6   6bf1     CLRF      0xf1,0x1           ctrl_trf_session_owner = MUID_NULL;     // Set owner to NULL                 E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
0008e8   6bf6     CLRF      0xf6,0x1           wCount._word = 0;                                                            E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
0008ea   6bf7     CLRF      0xf7,0x1                                                                                        
                                                                                                                            E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                               /* Stage 2 */                                                                E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
0008ec   eccd     CALL      0x59a,0x0          USBCheckStdRequest();                   // See system\usb9\usb9.c            E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
0008ee   f002                                                                                                               
                                                                                                                            E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                               /* Modifiable Section */                                                     E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                               // Insert other USB Device Class Request Handlers here                       E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                               /* End Modifiable Section */                                                 E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                                                                                                            E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                               /* Stage 3 */                                                                E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
0008f0   d8e1     RCALL     0xab4              USBCtrlEPServiceComplete();                                                  E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                                                                                                            E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
0008f2   52e5     MOVF      0xe5,0x1,0x0   }//end USBCtrlTrfSetupHandler                                                    E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
0008f4   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0008f6   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
0008f8   ffd9                                                                                                               
0008fa   0012     RETURN    0x0                                                                                             
                                                                                                                            E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                           /******************************************************************************  E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            * Function:        void USBCtrlTrfOutHandler(void)                              E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            * PreCondition:    None                                                         E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            * Input:           None                                                         E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            * Output:          None                                                         E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            * Side Effects:    None                                                         E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            * Overview:        This routine handles an OUT transaction according to         E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  which control transfer state is currently active.            E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            * Note:            Note that if the the control transfer was from               E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  host to device, the session owner should be notified         E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  at the end of each OUT transaction to service the            E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  received data.                                               E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            *****************************************************************************/  E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                           void USBCtrlTrfOutHandler(void)                                                  E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                           {                                                                                E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
0008fc   0e02     MOVLW     0x2                if(ctrl_trf_state == CTRL_TRF_RX)                                            E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
0008fe   0100     MOVLB     0x0                                                                                             
000900   5df0     SUBWF     0xf0,0x0,0x1                                                                                    
000902   e10a     BNZ       0x918                                                                                           
                                               {                                                                            E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
000904   d898     RCALL     0xa36                  USBCtrlTrfRxService();                                                   E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                                                                                                            E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                                   /*                                                                       E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                                    * Don't have to worry about overwriting _KEEP bit                       E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                                    * because if _KEEP was set, TRNIF would not have been                   E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                                    * generated in the first place.                                         E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                                    */                                                                      E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
000906   0104     MOVLB     0x4                    if(ep0Bo.Stat.DTS == 0)                                                  E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
000908   bd00     BTFSC     0x0,0x6,0x1                                                                                     
00090a   d003     BRA       0x912                                                                                           
00090c   0ec8     MOVLW     0xc8                       ep0Bo.Stat._byte = _USIE|_DAT1|_DTSEN;                               E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
00090e   6f00     MOVWF     0x0,0x1                                                                                         
000910   d002     BRA       0x916                  else                                                                     E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
000912   0e88     MOVLW     0x88                       ep0Bo.Stat._byte = _USIE|_DAT0|_DTSEN;                               E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
000914   6f00     MOVWF     0x0,0x1                                                                                         
                                               }                                                                            E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
000916   d001     BRA       0x91a              else    // CTRL_TRF_TX                                                       E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
000918   d913     RCALL     0xb40                  USBPrepareForNextSetupTrf();                                             E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                                                                                                            E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
00091a   0012     RETURN    0x0            }//end USBCtrlTrfOutHandler                                                      E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                                                                                                            E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                           /******************************************************************************  E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            * Function:        void USBCtrlTrfInHandler(void)                               E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            * PreCondition:    None                                                         E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            * Input:           None                                                         E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            * Output:          None                                                         E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            * Side Effects:    None                                                         E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            * Overview:        This routine handles an IN transaction according to          E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  which control transfer state is currently active.            E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            * Note:            A Set Address Request must not change the acutal address     E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  of the device until the completion of the control            E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  transfer. The end of the control transfer for Set Address    E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  Request is an IN transaction. Therefore it is necessary      E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  to service this unique situation when the condition is       E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  right. Macro mUSBCheckAdrPendingState is defined in          E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  usb9.h and its function is to specifically service this      E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  event.                                                       E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            *****************************************************************************/  E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                           void USBCtrlTrfInHandler(void)                                                   E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                           {                                                                                E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
00091c   0e04     MOVLW     0x4                mUSBCheckAdrPendingState();         // Must check if in ADR_PENDING_STATE    E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
00091e   0100     MOVLB     0x0                                                                                             
000920   5df8     SUBWF     0xf8,0x0,0x1                                                                                    
000922   e10a     BNZ       0x938                                                                                           
000924   c41a     MOVFF     0x41a,0xf6e                                                                                     
000926   ff6e                                                                                                               
000928   506e     MOVF      0x6e,0x0,0x0                                                                                    
00092a   0800     SUBLW     0x0                                                                                             
00092c   e203     BC        0x934                                                                                           
00092e   0e05     MOVLW     0x5                                                                                             
000930   6ff8     MOVWF     0xf8,0x1                                                                                        
000932   d002     BRA       0x938                                                                                           
000934   0e03     MOVLW     0x3                                                                                             
000936   6ff8     MOVWF     0xf8,0x1                                                                                        
                                                                                                                            E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
000938   0100     MOVLB     0x0                if(ctrl_trf_state == CTRL_TRF_TX)                                            E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
00093a   05f0     DECF      0xf0,0x0,0x1                                                                                    
00093c   e10a     BNZ       0x952                                                                                           
                                               {                                                                            E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
00093e   d80b     RCALL     0x956                  USBCtrlTrfTxService();                                                   E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                                                                                                            E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
000940   0104     MOVLB     0x4                    if(ep0Bi.Stat.DTS == 0)                                                  E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
000942   bd04     BTFSC     0x4,0x6,0x1                                                                                     
000944   d003     BRA       0x94c                                                                                           
000946   0ec8     MOVLW     0xc8                       ep0Bi.Stat._byte = _USIE|_DAT1|_DTSEN;                               E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
000948   6f04     MOVWF     0x4,0x1                                                                                         
00094a   d002     BRA       0x950                  else                                                                     E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
00094c   0e88     MOVLW     0x88                       ep0Bi.Stat._byte = _USIE|_DAT0|_DTSEN;                               E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
00094e   6f04     MOVWF     0x4,0x1                                                                                         
                                               }                                                                            E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
000950   d001     BRA       0x954              else // CTRL_TRF_RX                                                          E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
000952   d8f6     RCALL     0xb40                  USBPrepareForNextSetupTrf();                                             E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                                                                                                            E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
000954   0012     RETURN    0x0            }//end USBCtrlTrfInHandler                                                       E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                                                                                                            E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                           /******************************************************************************  E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            * Function:        void USBCtrlTrfTxService(void)                               E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            * PreCondition:    pSrc, wCount, and usb_stat.ctrl_trf_mem are setup properly.  E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            * Input:           None                                                         E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            * Output:          None                                                         E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            * Side Effects:    None                                                         E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            * Overview:        This routine should be called from only two places.          E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  One from USBCtrlEPServiceComplete() and one from             E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  USBCtrlTrfInHandler(). It takes care of managing a           E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  transfer over multiple USB transactions.                     E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            * Note:            This routine works with isochronous endpoint larger than     E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  256 bytes and is shown here as an example of how to deal     E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  with BC9 and BC8. In reality, a control endpoint can never   E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  be larger than 64 bytes.                                     E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            *****************************************************************************/  E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
000956   cfd9     MOVFF     0xfd9,0xfe6    void USBCtrlTrfTxService(void)                                                   E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
000958   ffe6                                                                                                               
00095a   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
00095c   ffd9                                                                                                               
00095e   0e02     MOVLW     0x2                                                                                             
000960   26e1     ADDWF     0xe1,0x1,0x0                                                                                    
                                           {                                                                                E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                               WORD byte_to_send;                                                           E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                                                                                                            E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                               /*                                                                           E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                                * First, have to figure out how many byte of data to send.                  E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                                */                                                                          E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
000962   0100     MOVLB     0x0                if(wCount._word < EP0_BUFF_SIZE)                                             E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
000964   0e08     MOVLW     0x8                                                                                             
000966   5df6     SUBWF     0xf6,0x0,0x1                                                                                    
000968   0e00     MOVLW     0x0                                                                                             
00096a   59f7     SUBWFB    0xf7,0x0,0x1                                                                                    
00096c   e205     BC        0x978                                                                                           
00096e   c0f6     MOVFF     0xf6,0xfde             byte_to_send._word = wCount._word;                                       E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
000970   ffde                                                                                                               
000972   c0f7     MOVFF     0xf7,0xfdd                                                                                      
000974   ffdd                                                                                                               
000976   d003     BRA       0x97e              else                                                                         E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
000978   0e08     MOVLW     0x8                    byte_to_send._word = EP0_BUFF_SIZE;                                      E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
00097a   6ede     MOVWF     0xde,0x0                                                                                        
00097c   6add     CLRF      0xdd,0x0                                                                                        
                                                                                                                            E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                               /*                                                                           E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                                * Next, load the number of bytes to send to BC9..0 in buffer descriptor     E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                                */                                                                          E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
00097e   0104     MOVLB     0x4                ep0Bi.Stat.BC9 = 0;                                                          E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
000980   9304     BCF       0x4,0x1,0x1                                                                                     
000982   9104     BCF       0x4,0x0,0x1        ep0Bi.Stat.BC8 = 0;                                                          E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
000984   0e01     MOVLW     0x1                ep0Bi.Stat._byte |= MSB(byte_to_send);                                       E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
000986   50db     MOVF      0xdb,0x0,0x0                                                                                    
000988   1304     IORWF     0x4,0x1,0x1                                                                                     
00098a   cfdf     MOVFF     0xfdf,0x405        ep0Bi.Cnt = LSB(byte_to_send);                                               E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
00098c   f405                                                                                                               
                                                                                                                            E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                               /*                                                                           E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                                * Subtract the number of bytes just about to be sent from the total.        E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                                */                                                                          E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
00098e   0e00     MOVLW     0x0                wCount._word = wCount._word - byte_to_send._word;                            E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
000990   50db     MOVF      0xdb,0x0,0x0                                                                                    
000992   0100     MOVLB     0x0                                                                                             
000994   5ff6     SUBWF     0xf6,0x1,0x1                                                                                    
000996   0e01     MOVLW     0x1                                                                                             
000998   50db     MOVF      0xdb,0x0,0x0                                                                                    
00099a   5bf7     SUBWFB    0xf7,0x1,0x1                                                                                    
                                                                                                                            E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
00099c   0e20     MOVLW     0x20               pDst.bRam = (byte*)&CtrlTrfData;        // Set destination pointer           E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
00099e   6ff4     MOVWF     0xf4,0x1                                                                                        
0009a0   0e04     MOVLW     0x4                                                                                             
0009a2   6ff5     MOVWF     0xf5,0x1                                                                                        
                                                                                                                            E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
0009a4   0100     MOVLB     0x0                if(usb_stat.ctrl_trf_mem == _ROM)       // Determine type of memory source   E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
0009a6   a3f9     BTFSS     0xf9,0x1,0x1                                                                                    
0009a8   d01e     BRA       0x9e6                                                                                           
                                               {                                                                            E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
0009aa   cfd9     MOVFF     0xfd9,0xfe9            while(byte_to_send._word)                                                E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
0009ac   ffe9                                                                                                               
0009ae   cfda     MOVFF     0xfda,0xfea                                                                                     
0009b0   ffea                                                                                                               
0009b2   50ee     MOVF      0xee,0x0,0x0                                                                                    
0009b4   10ed     IORWF     0xed,0x0,0x0                                                                                    
0009b6   e016     BZ        0x9e4                                                                                           
0009e2   d7e3     BRA       0x9aa                                                                                           
                                                   {                                                                        E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
0009b8   c0f2     MOVFF     0xf2,0xff6                 *pDst.bRam = *pSrc.bRom;                                             E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
0009ba   fff6                                                                                                               
0009bc   c0f3     MOVFF     0xf3,0xff7                                                                                      
0009be   fff7                                                                                                               
0009c0   0008     TBLRD                                                                                                     
0009c2   50f5     MOVF      0xf5,0x0,0x0                                                                                    
0009c4   c0f4     MOVFF     0xf4,0xfe9                                                                                      
0009c6   ffe9                                                                                                               
0009c8   c0f5     MOVFF     0xf5,0xfea                                                                                      
0009ca   ffea                                                                                                               
0009cc   6eef     MOVWF     0xef,0x0                                                                                        
0009ce   0100     MOVLB     0x0                        pDst.bRam++;                                                         E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
0009d0   2bf4     INCF      0xf4,0x1,0x1                                                                                    
0009d2   0e00     MOVLW     0x0                                                                                             
0009d4   23f5     ADDWFC    0xf5,0x1,0x1                                                                                    
0009d6   2bf2     INCF      0xf2,0x1,0x1               pSrc.bRom++;                                                         E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
0009d8   23f3     ADDWFC    0xf3,0x1,0x1                                                                                    
0009da   06df     DECF      0xdf,0x1,0x0               byte_to_send._word--;                                                E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
0009dc   0e01     MOVLW     0x1                                                                                             
0009de   e201     BC        0x9e2                                                                                           
0009e0   06db     DECF      0xdb,0x1,0x0                                                                                    
                                                   }//end while(byte_to_send._word)                                         E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                               }                                                                            E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
0009e4   d01c     BRA       0xa1e              else // RAM                                                                  E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                               {                                                                            E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
0009e6   cfd9     MOVFF     0xfd9,0xfe9            while(byte_to_send._word)                                                E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
0009e8   ffe9                                                                                                               
0009ea   cfda     MOVFF     0xfda,0xfea                                                                                     
0009ec   ffea                                                                                                               
0009ee   50ee     MOVF      0xee,0x0,0x0                                                                                    
0009f0   10ed     IORWF     0xed,0x0,0x0                                                                                    
0009f2   e015     BZ        0xa1e                                                                                           
000a1c   d7e4     BRA       0x9e6                                                                                           
                                                   {                                                                        E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
0009f4   c0f2     MOVFF     0xf2,0xfe9                 *pDst.bRam = *pSrc.bRam;                                             E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
0009f6   ffe9                                                                                                               
0009f8   c0f3     MOVFF     0xf3,0xfea                                                                                      
0009fa   ffea                                                                                                               
0009fc   50ef     MOVF      0xef,0x0,0x0                                                                                    
0009fe   c0f4     MOVFF     0xf4,0xfe9                                                                                      
000a00   ffe9                                                                                                               
000a02   c0f5     MOVFF     0xf5,0xfea                                                                                      
000a04   ffea                                                                                                               
000a06   6eef     MOVWF     0xef,0x0                                                                                        
000a08   0100     MOVLB     0x0                        pDst.bRam++;                                                         E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
000a0a   2bf4     INCF      0xf4,0x1,0x1                                                                                    
000a0c   0e00     MOVLW     0x0                                                                                             
000a0e   23f5     ADDWFC    0xf5,0x1,0x1                                                                                    
000a10   2bf2     INCF      0xf2,0x1,0x1               pSrc.bRam++;                                                         E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
000a12   23f3     ADDWFC    0xf3,0x1,0x1                                                                                    
000a14   06df     DECF      0xdf,0x1,0x0               byte_to_send._word--;                                                E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
000a16   0e01     MOVLW     0x1                                                                                             
000a18   e201     BC        0xa1c                                                                                           
000a1a   06db     DECF      0xdb,0x1,0x0                                                                                    
                                                   }//end while(byte_to_send._word)                                         E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                               }//end if(usb_stat.ctrl_trf_mem == _ROM)                                     E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                                                                                                            E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
000a1e   6ef5     MOVWF     0xf5,0x0       }//end USBCtrlTrfTxService                                                       E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
000a20   0e02     MOVLW     0x2                                                                                             
000a22   5ce1     SUBWF     0xe1,0x0,0x0                                                                                    
000a24   e202     BC        0xa2a                                                                                           
000a26   6ae1     CLRF      0xe1,0x0                                                                                        
000a28   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000a2a   6ee1     MOVWF     0xe1,0x0                                                                                        
000a2c   50f5     MOVF      0xf5,0x0,0x0                                                                                    
000a2e   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000a30   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
000a32   ffd9                                                                                                               
000a34   0012     RETURN    0x0                                                                                             
                                                                                                                            E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                           /******************************************************************************  E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            * Function:        void USBCtrlTrfRxService(void)                               E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            * PreCondition:    pDst and wCount are setup properly.                          E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  pSrc is always &CtrlTrfData                                  E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  usb_stat.ctrl_trf_mem is always _RAM.                        E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  wCount should be set to 0 at the start of each control       E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  transfer.                                                    E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            * Input:           None                                                         E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            * Output:          None                                                         E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            * Side Effects:    None                                                         E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            * Overview:        *** This routine is only partially complete. Check for       E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  new version of the firmware.                                 E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            * Note:            None                                                         E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            *****************************************************************************/  E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
000a36   cfd9     MOVFF     0xfd9,0xfe6    void USBCtrlTrfRxService(void)                                                   E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
000a38   ffe6                                                                                                               
000a3a   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
000a3c   ffd9                                                                                                               
000a3e   0e02     MOVLW     0x2                                                                                             
000a40   26e1     ADDWF     0xe1,0x1,0x0                                                                                    
                                           {                                                                                E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                               WORD byte_to_read;                                                           E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                                                                                                            E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
000a42   0e03     MOVLW     0x3                MSB(byte_to_read) = 0x03 & ep0Bo.Stat._byte;    // Filter out last 2 bits    E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
000a44   0104     MOVLB     0x4                                                                                             
000a46   1500     ANDWF     0x0,0x0,0x1                                                                                     
000a48   6ee7     MOVWF     0xe7,0x0                                                                                        
000a4a   0e01     MOVLW     0x1                                                                                             
000a4c   cfe7     MOVFF     0xfe7,0xfdb                                                                                     
000a4e   ffdb                                                                                                               
000a50   c401     MOVFF     0x401,0xfdf        LSB(byte_to_read) = ep0Bo.Cnt;                                               E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
000a52   ffdf                                                                                                               
                                                                                                                            E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                               /*                                                                           E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                                * Accumulate total number of bytes read                                     E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                                */                                                                          E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
000a54   50de     MOVF      0xde,0x0,0x0       wCount._word = wCount._word + byte_to_read._word;                            E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
000a56   0100     MOVLB     0x0                                                                                             
000a58   27f6     ADDWF     0xf6,0x1,0x1                                                                                    
000a5a   50dd     MOVF      0xdd,0x0,0x0                                                                                    
000a5c   23f7     ADDWFC    0xf7,0x1,0x1                                                                                    
                                                                                                                            E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
000a5e   0e20     MOVLW     0x20               pSrc.bRam = (byte*)&CtrlTrfData;                                             E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
000a60   6ff2     MOVWF     0xf2,0x1                                                                                        
000a62   0e04     MOVLW     0x4                                                                                             
000a64   6ff3     MOVWF     0xf3,0x1                                                                                        
                                                                                                                            E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
000a66   cfd9     MOVFF     0xfd9,0xfe9        while(byte_to_read._word)                                                    E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
000a68   ffe9                                                                                                               
000a6a   cfda     MOVFF     0xfda,0xfea                                                                                     
000a6c   ffea                                                                                                               
000a6e   50ee     MOVF      0xee,0x0,0x0                                                                                    
000a70   10ed     IORWF     0xed,0x0,0x0                                                                                    
000a72   e014     BZ        0xa9c                                                                                           
000a9a   d7e5     BRA       0xa66                                                                                           
                                               {                                                                            E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
000a74   c0f2     MOVFF     0xf2,0xfe9             *pDst.bRam = *pSrc.bRam;                                                 E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
000a76   ffe9                                                                                                               
000a78   c0f3     MOVFF     0xf3,0xfea                                                                                      
000a7a   ffea                                                                                                               
000a7c   50ef     MOVF      0xef,0x0,0x0                                                                                    
000a7e   c0f4     MOVFF     0xf4,0xfe9                                                                                      
000a80   ffe9                                                                                                               
000a82   c0f5     MOVFF     0xf5,0xfea                                                                                      
000a84   ffea                                                                                                               
000a86   6eef     MOVWF     0xef,0x0                                                                                        
000a88   2bf4     INCF      0xf4,0x1,0x1           pDst.bRam++;                                                             E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
000a8a   0e00     MOVLW     0x0                                                                                             
000a8c   23f5     ADDWFC    0xf5,0x1,0x1                                                                                    
000a8e   2bf2     INCF      0xf2,0x1,0x1           pSrc.bRam++;                                                             E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
000a90   23f3     ADDWFC    0xf3,0x1,0x1                                                                                    
000a92   06df     DECF      0xdf,0x1,0x0           byte_to_read._word--;                                                    E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
000a94   0e01     MOVLW     0x1                                                                                             
000a96   e201     BC        0xa9a                                                                                           
000a98   06db     DECF      0xdb,0x1,0x0                                                                                    
                                               }//end while(byte_to_read._word)                                             E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                                                                                                            E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
000a9c   6ef5     MOVWF     0xf5,0x0       }//end USBCtrlTrfRxService                                                       E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
000a9e   0e02     MOVLW     0x2                                                                                             
000aa0   5ce1     SUBWF     0xe1,0x0,0x0                                                                                    
000aa2   e202     BC        0xaa8                                                                                           
000aa4   6ae1     CLRF      0xe1,0x0                                                                                        
000aa6   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000aa8   6ee1     MOVWF     0xe1,0x0                                                                                        
000aaa   50f5     MOVF      0xf5,0x0,0x0                                                                                    
000aac   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000aae   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
000ab0   ffd9                                                                                                               
000ab2   0012     RETURN    0x0                                                                                             
                                                                                                                            E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                           /******************************************************************************  E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            * Function:        void USBCtrlEPServiceComplete(void)                          E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            * PreCondition:    None                                                         E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            * Input:           None                                                         E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            * Output:          None                                                         E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            * Side Effects:    None                                                         E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            * Overview:        This routine wrap up the ramaining tasks in servicing        E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  a Setup Request. Its main task is to set the endpoint        E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  controls appropriately for a given situation. See code       E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  below.                                                       E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  There are three main scenarios:                              E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  a) There was no handler for the Request, in this case        E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            *                     a STALL should be sent out.                               E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  b) The host has requested a read control transfer,           E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            *                     endpoints are required to be setup in a specific way.     E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  c) The host has requested a write control transfer, or       E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            *                     a control data stage is not required, endpoints are       E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            *                     required to be setup in a specific way.                   E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  Packet processing is resumed by clearing PKTDIS bit.         E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            * Note:            None                                                         E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            *****************************************************************************/  E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                           void USBCtrlEPServiceComplete(void)                                              E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                           {                                                                                E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
000ab4   0100     MOVLB     0x0                if(ctrl_trf_session_owner == MUID_NULL)                                      E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
000ab6   51f1     MOVF      0xf1,0x0,0x1                                                                                    
000ab8   e10c     BNZ       0xad2                                                                                           
                                               {                                                                            E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                                   /*                                                                       E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                                    * If no one knows how to service this request then stall.               E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                                    * Must also prepare EP0 to receive the next SETUP transaction.          E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                                    */                                                                      E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
000aba   0104     MOVLB     0x4                    ep0Bo.Cnt = EP0_BUFF_SIZE;                                               E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
000abc   0e08     MOVLW     0x8                                                                                             
000abe   6f01     MOVWF     0x1,0x1                                                                                         
000ac0   0e18     MOVLW     0x18                   ep0Bo.ADR = (byte*)&SetupPkt;                                            E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
000ac2   6f02     MOVWF     0x2,0x1                                                                                         
000ac4   0e04     MOVLW     0x4                                                                                             
000ac6   6f03     MOVWF     0x3,0x1                                                                                         
                                                                                                                            E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
000ac8   0e84     MOVLW     0x84                   ep0Bo.Stat._byte = _USIE|_BSTALL;                                        E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
000aca   6f00     MOVWF     0x0,0x1                                                                                         
000acc   0104     MOVLB     0x4                    ep0Bi.Stat._byte = _USIE|_BSTALL;                                        E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
000ace   6f04     MOVWF     0x4,0x1                                                                                         
                                               }                                                                            E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
000ad0   d035     BRA       0xb3c              else    // A module has claimed ownership of the control transfer session.   E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                               {                                                                            E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
000ad2   0104     MOVLB     0x4                    if(SetupPkt.DataDir == DEV_TO_HOST)                                      E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
000ad4   af18     BTFSS     0x18,0x7,0x1                                                                                    
000ad6   d022     BRA       0xb1c                                                                                           
                                                   {                                                                        E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
000ad8   0100     MOVLB     0x0                        if(SetupPkt.wLength < wCount._word)                                  E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
000ada   51f6     MOVF      0xf6,0x0,0x1                                                                                    
000adc   0104     MOVLB     0x4                                                                                             
000ade   5d1e     SUBWF     0x1e,0x0,0x1                                                                                    
000ae0   0100     MOVLB     0x0                                                                                             
000ae2   51f7     MOVF      0xf7,0x0,0x1                                                                                    
000ae4   0104     MOVLB     0x4                                                                                             
000ae6   591f     SUBWFB    0x1f,0x0,0x1                                                                                    
000ae8   e204     BC        0xaf2                                                                                           
000aea   c41e     MOVFF     0x41e,0xf6                     wCount._word = SetupPkt.wLength;                                 E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
000aec   f0f6                                                                                                               
000aee   c41f     MOVFF     0x41f,0xf7                                                                                      
000af0   f0f7                                                                                                               
000af2   df31     RCALL     0x956                      USBCtrlTrfTxService();                                               E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
000af4   0100     MOVLB     0x0                        ctrl_trf_state = CTRL_TRF_TX;                                        E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
000af6   0e01     MOVLW     0x1                                                                                             
000af8   6ff0     MOVWF     0xf0,0x1                                                                                        
                                                       /*                                                                   E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                                        * Control Read:                                                     E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                                        * <SETUP[0]><IN[1]><IN[0]>...<OUT[1]> | <SETUP[0]>                  E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                                        * 1. Prepare OUT EP to respond to early termination                 E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                                        *                                                                   E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                                        * NOTE:                                                             E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                                        * If something went wrong during the control transfer,              E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                                        * the last status stage may not be sent by the host.                E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                                        * When this happens, two different things could happen              E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                                        * depending on the host.                                            E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                                        * a) The host could send out a RESET.                               E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                                        * b) The host could send out a new SETUP transaction                E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                                        *    without sending a RESET first.                                 E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                                        * To properly handle case (b), the OUT EP must be setup             E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                                        * to receive either a zero length OUT transaction, or a             E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                                        * new SETUP transaction.                                            E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                                        *                                                                   E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                                        * Since the SETUP transaction requires the DTS bit to be            E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                                        * DAT0 while the zero length OUT status requires the DTS            E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                                        * bit to be DAT1, the DTS bit check by the hardware should          E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                                        * be disabled. This way the SIE could accept either of              E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                                        * the two transactions.                                             E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                                        *                                                                   E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                                        * Furthermore, the Cnt byte should be set to prepare for            E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                                        * the SETUP data (8-byte or more), and the buffer address           E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                                        * should be pointed to SetupPkt.                                    E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                                        */                                                                  E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
000afa   0104     MOVLB     0x4                        ep0Bo.Cnt = EP0_BUFF_SIZE;                                           E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
000afc   0e08     MOVLW     0x8                                                                                             
000afe   6f01     MOVWF     0x1,0x1                                                                                         
000b00   0e18     MOVLW     0x18                       ep0Bo.ADR = (byte*)&SetupPkt;                                        E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
000b02   6f02     MOVWF     0x2,0x1                                                                                         
000b04   0e04     MOVLW     0x4                                                                                             
000b06   6f03     MOVWF     0x3,0x1                                                                                         
000b08   0e80     MOVLW     0x80                       ep0Bo.Stat._byte = _USIE;           // Note: DTSEN is 0!             E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
000b0a   6f00     MOVWF     0x0,0x1                                                                                         
                                                                                                                            E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                                       /*                                                                   E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                                        * 2. Prepare IN EP to transfer data, Cnt should have                E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                                        *    been initialized by responsible request owner.                 E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                                        */                                                                  E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
000b0c   0104     MOVLB     0x4                        ep0Bi.ADR = (byte*)&CtrlTrfData;                                     E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
000b0e   0e20     MOVLW     0x20                                                                                            
000b10   6f06     MOVWF     0x6,0x1                                                                                         
000b12   0e04     MOVLW     0x4                                                                                             
000b14   6f07     MOVWF     0x7,0x1                                                                                         
000b16   0ec8     MOVLW     0xc8                       ep0Bi.Stat._byte = _USIE|_DAT1|_DTSEN;                               E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
000b18   6f04     MOVWF     0x4,0x1                                                                                         
                                                   }                                                                        E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
000b1a   d010     BRA       0xb3c                  else    // (SetupPkt.DataDir == HOST_TO_DEV)                             E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                                   {                                                                        E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
000b1c   0100     MOVLB     0x0                        ctrl_trf_state = CTRL_TRF_RX;                                        E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
000b1e   0e02     MOVLW     0x2                                                                                             
000b20   6ff0     MOVWF     0xf0,0x1                                                                                        
                                                       /*                                                                   E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                                        * Control Write:                                                    E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                                        * <SETUP[0]><OUT[1]><OUT[0]>...<IN[1]> | <SETUP[0]>                 E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                                        *                                                                   E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                                        * 1. Prepare IN EP to respond to early termination                  E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                                        *                                                                   E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                                        *    This is the same as a Zero Length Packet Response              E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                                        *    for control transfer without a data stage                      E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                                        */                                                                  E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
000b22   0104     MOVLB     0x4                        ep0Bi.Cnt = 0;                                                       E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
000b24   6b05     CLRF      0x5,0x1                                                                                         
000b26   0ec8     MOVLW     0xc8                       ep0Bi.Stat._byte = _USIE|_DAT1|_DTSEN;                               E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
000b28   6f04     MOVWF     0x4,0x1                                                                                         
                                                                                                                            E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                                       /*                                                                   E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                                        * 2. Prepare OUT EP to receive data.                                E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                                        */                                                                  E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
000b2a   0104     MOVLB     0x4                        ep0Bo.Cnt = EP0_BUFF_SIZE;                                           E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
000b2c   0e08     MOVLW     0x8                                                                                             
000b2e   6f01     MOVWF     0x1,0x1                                                                                         
000b30   0e20     MOVLW     0x20                       ep0Bo.ADR = (byte*)&CtrlTrfData;                                     E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
000b32   6f02     MOVWF     0x2,0x1                                                                                         
000b34   0e04     MOVLW     0x4                                                                                             
000b36   6f03     MOVWF     0x3,0x1                                                                                         
000b38   0ec8     MOVLW     0xc8                       ep0Bo.Stat._byte = _USIE|_DAT1|_DTSEN;                               E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
000b3a   6f00     MOVWF     0x0,0x1                                                                                         
                                                   }//end if(SetupPkt.DataDir == DEV_TO_HOST)                               E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                               }//end if(ctrl_trf_session_owner == MUID_NULL)                               E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                                                                                                            E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                               /*                                                                           E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                                * PKTDIS bit is set when a Setup Transaction is received.                   E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                                * Clear to resume packet processing.                                        E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                                */                                                                          E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
000b3c   986d     BCF       0x6d,0x4,0x0       UCONbits.PKTDIS = 0;                                                         E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                                                                                                            E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
000b3e   0012     RETURN    0x0            }//end USBCtrlEPServiceComplete                                                  E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                                                                                                            E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                           /******************************************************************************  E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            * Function:        void USBPrepareForNextSetupTrf(void)                         E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            * PreCondition:    None                                                         E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            * Input:           None                                                         E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            * Output:          None                                                         E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            * Side Effects:    None                                                         E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            * Overview:        The routine forces EP0 OUT to be ready for a new Setup       E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            *                  transaction, and forces EP0 IN to be owned by CPU.           E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            * Note:            None                                                         E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                            *****************************************************************************/  E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                           void USBPrepareForNextSetupTrf(void)                                             E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                           {                                                                                E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
000b40   0100     MOVLB     0x0                ctrl_trf_state = WAIT_SETUP;            // See usbctrltrf.h                  E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
000b42   6bf0     CLRF      0xf0,0x1                                                                                        
000b44   0104     MOVLB     0x4                ep0Bo.Cnt = EP0_BUFF_SIZE;              // Defined in usbcfg.h               E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
000b46   0e08     MOVLW     0x8                                                                                             
000b48   6f01     MOVWF     0x1,0x1                                                                                         
000b4a   0e18     MOVLW     0x18               ep0Bo.ADR = (byte*)&SetupPkt;                                                E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
000b4c   6f02     MOVWF     0x2,0x1                                                                                         
000b4e   0e04     MOVLW     0x4                                                                                             
000b50   6f03     MOVWF     0x3,0x1                                                                                         
000b52   0e88     MOVLW     0x88               ep0Bo.Stat._byte = _USIE|_DAT0|_DTSEN;  // EP0 buff dsc init, see usbmmap.h  E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
000b54   6f00     MOVWF     0x0,0x1                                                                                         
000b56   0104     MOVLB     0x4                ep0Bi.Stat._byte = _UCPU;               // EP0 IN buffer initialization      E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
000b58   6b04     CLRF      0x4,0x1                                                                                         
000b5a   0012     RETURN    0x0            }//end USBPrepareForNextSetupTrf                                                 E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                                                                                                            E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                           /** EOF usbctrltrf.c *********************************************************/  E:\usb20\GIO3\system\usb\usbctrltrf\usbctrltrf.c
                                           /*********************************************************************           E:\usb20\GIO3\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usb9\usb9.c
                                            *                Microchip USB C18 Firmware Version 1.0                         E:\usb20\GIO3\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usb9\usb9.c
                                            *********************************************************************           E:\usb20\GIO3\system\usb\usb9\usb9.c
                                            * FileName:        usb9.c                                                       E:\usb20\GIO3\system\usb\usb9\usb9.c
                                            * Dependencies:    See INCLUDES section below                                   E:\usb20\GIO3\system\usb\usb9\usb9.c
                                            * Processor:       PIC18                                                        E:\usb20\GIO3\system\usb\usb9\usb9.c
                                            * Compiler:        C18 2.30.01+                                                 E:\usb20\GIO3\system\usb\usb9\usb9.c
                                            * Company:         Microchip Technology, Inc.                                   E:\usb20\GIO3\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usb9\usb9.c
                                            * Software License Agreement                                                    E:\usb20\GIO3\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usb9\usb9.c
                                            * The software supplied herewith by Microchip Technology Incorporated           E:\usb20\GIO3\system\usb\usb9\usb9.c
                                            * (the 鼎ompany) for its PICmicroｮ Microcontroller is intended and             E:\usb20\GIO3\system\usb\usb9\usb9.c
                                            * supplied to you, the Company痴 customer, for use solely and                   E:\usb20\GIO3\system\usb\usb9\usb9.c
                                            * exclusively on Microchip PICmicro Microcontroller products. The               E:\usb20\GIO3\system\usb\usb9\usb9.c
                                            * software is owned by the Company and/or its supplier, and is                  E:\usb20\GIO3\system\usb\usb9\usb9.c
                                            * protected under applicable copyright laws. All rights are reserved.           E:\usb20\GIO3\system\usb\usb9\usb9.c
                                            * Any use in violation of the foregoing restrictions may subject the            E:\usb20\GIO3\system\usb\usb9\usb9.c
                                            * user to criminal sanctions under applicable laws, as well as to               E:\usb20\GIO3\system\usb\usb9\usb9.c
                                            * civil liability for the breach of the terms and conditions of this            E:\usb20\GIO3\system\usb\usb9\usb9.c
                                            * license.                                                                      E:\usb20\GIO3\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usb9\usb9.c
                                            * THIS SOFTWARE IS PROVIDED IN AN 鄭S IS CONDITION. NO WARRANTIES,             E:\usb20\GIO3\system\usb\usb9\usb9.c
                                            * WHETHER EXPRESS, IMPLIED OR STATUTORY, INCLUDING, BUT NOT LIMITED             E:\usb20\GIO3\system\usb\usb9\usb9.c
                                            * TO, IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A                   E:\usb20\GIO3\system\usb\usb9\usb9.c
                                            * PARTICULAR PURPOSE APPLY TO THIS SOFTWARE. THE COMPANY SHALL NOT,             E:\usb20\GIO3\system\usb\usb9\usb9.c
                                            * IN ANY CIRCUMSTANCES, BE LIABLE FOR SPECIAL, INCIDENTAL OR                    E:\usb20\GIO3\system\usb\usb9\usb9.c
                                            * CONSEQUENTIAL DAMAGES, FOR ANY REASON WHATSOEVER.                             E:\usb20\GIO3\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usb9\usb9.c
                                            * Author               Date        Comment                                      E:\usb20\GIO3\system\usb\usb9\usb9.c
                                            *~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~           E:\usb20\GIO3\system\usb\usb9\usb9.c
                                            * Rawin Rojvanit       11/19/04    Original.                                    E:\usb20\GIO3\system\usb\usb9\usb9.c
                                            ********************************************************************/           E:\usb20\GIO3\system\usb\usb9\usb9.c
                                                                                                                            E:\usb20\GIO3\system\usb\usb9\usb9.c
                                           /** I N C L U D E S **********************************************************/  E:\usb20\GIO3\system\usb\usb9\usb9.c
                                           #include <p18cxxx.h>                                                             E:\usb20\GIO3\system\usb\usb9\usb9.c
                                           #include "system\typedefs.h"                                                     E:\usb20\GIO3\system\usb\usb9\usb9.c
                                           #include "system\usb\usb.h"                                                      E:\usb20\GIO3\system\usb\usb9\usb9.c
                                           #include "io_cfg.h"                     // Required for self_power status        E:\usb20\GIO3\system\usb\usb9\usb9.c
                                                                                                                            E:\usb20\GIO3\system\usb\usb9\usb9.c
                                           /** V A R I A B L E S ********************************************************/  E:\usb20\GIO3\system\usb\usb9\usb9.c
                                           #pragma udata                                                                    E:\usb20\GIO3\system\usb\usb9\usb9.c
                                                                                                                            E:\usb20\GIO3\system\usb\usb9\usb9.c
                                           /** P R I V A T E  P R O T O T Y P E S ***************************************/  E:\usb20\GIO3\system\usb\usb9\usb9.c
                                           void USBStdGetDscHandler(void);                                                  E:\usb20\GIO3\system\usb\usb9\usb9.c
                                           void USBStdSetCfgHandler(void);                                                  E:\usb20\GIO3\system\usb\usb9\usb9.c
                                           void USBStdGetStatusHandler(void);                                               E:\usb20\GIO3\system\usb\usb9\usb9.c
                                           void USBStdFeatureReqHandler(void);                                              E:\usb20\GIO3\system\usb\usb9\usb9.c
                                                                                                                            E:\usb20\GIO3\system\usb\usb9\usb9.c
                                           /** D E C L A R A T I O N S **************************************************/  E:\usb20\GIO3\system\usb\usb9\usb9.c
                                           #pragma code                                                                     E:\usb20\GIO3\system\usb\usb9\usb9.c
                                           /******************************************************************************  E:\usb20\GIO3\system\usb\usb9\usb9.c
                                            * Function:        void USBCheckStdRequest(void)                                E:\usb20\GIO3\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usb9\usb9.c
                                            * PreCondition:    None                                                         E:\usb20\GIO3\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usb9\usb9.c
                                            * Input:           None                                                         E:\usb20\GIO3\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usb9\usb9.c
                                            * Output:          None                                                         E:\usb20\GIO3\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usb9\usb9.c
                                            * Side Effects:    None                                                         E:\usb20\GIO3\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usb9\usb9.c
                                            * Overview:        This routine checks the setup data packet to see if it       E:\usb20\GIO3\system\usb\usb9\usb9.c
                                            *                  knows how to handle it                                       E:\usb20\GIO3\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usb9\usb9.c
                                            * Note:            None                                                         E:\usb20\GIO3\system\usb\usb9\usb9.c
                                            *****************************************************************************/  E:\usb20\GIO3\system\usb\usb9\usb9.c
                                           void USBCheckStdRequest(void)                                                    E:\usb20\GIO3\system\usb\usb9\usb9.c
                                           {                                                                                E:\usb20\GIO3\system\usb\usb9\usb9.c
00059a   0104     MOVLB     0x4                if(SetupPkt.RequestType != STANDARD) return;                                 E:\usb20\GIO3\system\usb\usb9\usb9.c
00059c   5118     MOVF      0x18,0x0,0x1                                                                                    
00059e   0b60     ANDLW     0x60                                                                                            
0005a0   42e8     RRNCF     0xe8,0x1,0x0                                                                                    
0005a2   42e8     RRNCF     0xe8,0x1,0x0                                                                                    
0005a4   42e8     RRNCF     0xe8,0x1,0x0                                                                                    
0005a6   42e8     RRNCF     0xe8,0x1,0x0                                                                                    
0005a8   42e8     RRNCF     0xe8,0x1,0x0                                                                                    
0005aa   0900     IORLW     0x0                                                                                             
0005ac   e001     BZ        0x5b0                                                                                           
0005ae   d055     BRA       0x65a                                                                                           
                                                                                                                            E:\usb20\GIO3\system\usb\usb9\usb9.c
0005b0   5119     MOVF      0x19,0x0,0x1       switch(SetupPkt.bRequest)                                                    E:\usb20\GIO3\system\usb\usb9\usb9.c
0005b2   0a07     XORLW     0x7                                                                                             
0005b4   e051     BZ        0x658                                                                                           
0005b6   0a0b     XORLW     0xb                                                                                             
0005b8   e04f     BZ        0x658                                                                                           
0005ba   0a07     XORLW     0x7                                                                                             
0005bc   e040     BZ        0x63e                                                                                           
0005be   0a01     XORLW     0x1                                                                                             
0005c0   e02c     BZ        0x61a                                                                                           
0005c2   0a0b     XORLW     0xb                                                                                             
0005c4   e028     BZ        0x616                                                                                           
0005c6   0a02     XORLW     0x2                                                                                             
0005c8   e026     BZ        0x616                                                                                           
0005ca   0a03     XORLW     0x3                                                                                             
0005cc   e022     BZ        0x612                                                                                           
0005ce   0a08     XORLW     0x8                                                                                             
0005d0   e012     BZ        0x5f6                                                                                           
0005d2   0a01     XORLW     0x1                                                                                             
0005d4   e00e     BZ        0x5f2                                                                                           
0005d6   0a0f     XORLW     0xf                                                                                             
0005d8   e00a     BZ        0x5ee                                                                                           
0005da   0a03     XORLW     0x3                                                                                             
0005dc   e001     BZ        0x5e0                                                                                           
0005de   d03c     BRA       0x658                                                                                           
                                               {                                                                            E:\usb20\GIO3\system\usb\usb9\usb9.c
                                                   case SET_ADR:                                                            E:\usb20\GIO3\system\usb\usb9\usb9.c
0005e0   0100     MOVLB     0x0                        ctrl_trf_session_owner = MUID_USB9;                                  E:\usb20\GIO3\system\usb\usb9\usb9.c
0005e2   0e01     MOVLW     0x1                                                                                             
0005e4   6ff1     MOVWF     0xf1,0x1                                                                                        
0005e6   0100     MOVLB     0x0                        usb_device_state = ADR_PENDING_STATE;       // Update state only     E:\usb20\GIO3\system\usb\usb9\usb9.c
0005e8   0e04     MOVLW     0x4                                                                                             
0005ea   6ff8     MOVWF     0xf8,0x1                                                                                        
                                                       /* See USBCtrlTrfInHandler() in usbctrltrf.c for the next step */    E:\usb20\GIO3\system\usb\usb9\usb9.c
0005ec   d036     BRA       0x65a                      break;                                                               E:\usb20\GIO3\system\usb\usb9\usb9.c
                                                   case GET_DSC:                                                            E:\usb20\GIO3\system\usb\usb9\usb9.c
0005ee   d836     RCALL     0x65c                      USBStdGetDscHandler();                                               E:\usb20\GIO3\system\usb\usb9\usb9.c
0005f0   d034     BRA       0x65a                      break;                                                               E:\usb20\GIO3\system\usb\usb9\usb9.c
                                                   case SET_CFG:                                                            E:\usb20\GIO3\system\usb\usb9\usb9.c
0005f2   d890     RCALL     0x714                      USBStdSetCfgHandler();                                               E:\usb20\GIO3\system\usb\usb9\usb9.c
0005f4   d032     BRA       0x65a                      break;                                                               E:\usb20\GIO3\system\usb\usb9\usb9.c
                                                   case GET_CFG:                                                            E:\usb20\GIO3\system\usb\usb9\usb9.c
0005f6   0100     MOVLB     0x0                        ctrl_trf_session_owner = MUID_USB9;                                  E:\usb20\GIO3\system\usb\usb9\usb9.c
0005f8   0e01     MOVLW     0x1                                                                                             
0005fa   6ff1     MOVWF     0xf1,0x1                                                                                        
0005fc   0100     MOVLB     0x0                        pSrc.bRam = (byte*)&usb_active_cfg;         // Set Source            E:\usb20\GIO3\system\usb\usb9\usb9.c
0005fe   0efa     MOVLW     0xfa                                                                                            
000600   6ff2     MOVWF     0xf2,0x1                                                                                        
000602   0e00     MOVLW     0x0                                                                                             
000604   6ff3     MOVWF     0xf3,0x1                                                                                        
000606   0100     MOVLB     0x0                        usb_stat.ctrl_trf_mem = _RAM;               // Set memory type       E:\usb20\GIO3\system\usb\usb9\usb9.c
000608   93f9     BCF       0xf9,0x1,0x1                                                                                    
00060a   0100     MOVLB     0x0                        LSB(wCount) = 1;                            // Set data count        E:\usb20\GIO3\system\usb\usb9\usb9.c
00060c   0e01     MOVLW     0x1                                                                                             
00060e   6ff6     MOVWF     0xf6,0x1                                                                                        
000610   d024     BRA       0x65a                      break;                                                               E:\usb20\GIO3\system\usb\usb9\usb9.c
                                                   case GET_STATUS:                                                         E:\usb20\GIO3\system\usb\usb9\usb9.c
000612   d8a8     RCALL     0x764                      USBStdGetStatusHandler();                                            E:\usb20\GIO3\system\usb\usb9\usb9.c
000614   d022     BRA       0x65a                      break;                                                               E:\usb20\GIO3\system\usb\usb9\usb9.c
                                                   case CLR_FEATURE:                                                        E:\usb20\GIO3\system\usb\usb9\usb9.c
                                                   case SET_FEATURE:                                                        E:\usb20\GIO3\system\usb\usb9\usb9.c
000616   d8f4     RCALL     0x800                      USBStdFeatureReqHandler();                                           E:\usb20\GIO3\system\usb\usb9\usb9.c
000618   d020     BRA       0x65a                      break;                                                               E:\usb20\GIO3\system\usb\usb9\usb9.c
                                                   case GET_INTF:                                                           E:\usb20\GIO3\system\usb\usb9\usb9.c
00061a   0100     MOVLB     0x0                        ctrl_trf_session_owner = MUID_USB9;                                  E:\usb20\GIO3\system\usb\usb9\usb9.c
00061c   0e01     MOVLW     0x1                                                                                             
00061e   6ff1     MOVWF     0xf1,0x1                                                                                        
000620   0104     MOVLB     0x4                        pSrc.bRam = (byte*)&usb_alt_intf+SetupPkt.bIntfID;  // Set source    E:\usb20\GIO3\system\usb\usb9\usb9.c
000622   511c     MOVF      0x1c,0x0,0x1                                                                                    
000624   0100     MOVLB     0x0                                                                                             
000626   6ff2     MOVWF     0xf2,0x1                                                                                        
000628   6bf3     CLRF      0xf3,0x1                                                                                        
00062a   0efb     MOVLW     0xfb                                                                                            
00062c   27f2     ADDWF     0xf2,0x1,0x1                                                                                    
00062e   0e00     MOVLW     0x0                                                                                             
000630   23f3     ADDWFC    0xf3,0x1,0x1                                                                                    
000632   0100     MOVLB     0x0                        usb_stat.ctrl_trf_mem = _RAM;               // Set memory type       E:\usb20\GIO3\system\usb\usb9\usb9.c
000634   93f9     BCF       0xf9,0x1,0x1                                                                                    
000636   0100     MOVLB     0x0                        LSB(wCount) = 1;                            // Set data count        E:\usb20\GIO3\system\usb\usb9\usb9.c
000638   0e01     MOVLW     0x1                                                                                             
00063a   6ff6     MOVWF     0xf6,0x1                                                                                        
00063c   d00e     BRA       0x65a                      break;                                                               E:\usb20\GIO3\system\usb\usb9\usb9.c
                                                   case SET_INTF:                                                           E:\usb20\GIO3\system\usb\usb9\usb9.c
00063e   0100     MOVLB     0x0                        ctrl_trf_session_owner = MUID_USB9;                                  E:\usb20\GIO3\system\usb\usb9\usb9.c
000640   0e01     MOVLW     0x1                                                                                             
000642   6ff1     MOVWF     0xf1,0x1                                                                                        
000644   0104     MOVLB     0x4                        usb_alt_intf[SetupPkt.bIntfID] = SetupPkt.bAltID;                    E:\usb20\GIO3\system\usb\usb9\usb9.c
000646   511c     MOVF      0x1c,0x0,0x1                                                                                    
000648   6aea     CLRF      0xea,0x0                                                                                        
00064a   0ffb     ADDLW     0xfb                                                                                            
00064c   6ee9     MOVWF     0xe9,0x0                                                                                        
00064e   0e00     MOVLW     0x0                                                                                             
000650   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
000652   c41a     MOVFF     0x41a,0xfef                                                                                     
000654   ffef                                                                                                               
000656   d001     BRA       0x65a                      break;                                                               E:\usb20\GIO3\system\usb\usb9\usb9.c
                                                   case SET_DSC:                                                            E:\usb20\GIO3\system\usb\usb9\usb9.c
                                                   case SYNCH_FRAME:                                                        E:\usb20\GIO3\system\usb\usb9\usb9.c
                                                   default:                                                                 E:\usb20\GIO3\system\usb\usb9\usb9.c
000658   d000     BRA       0x65a                      break;                                                               E:\usb20\GIO3\system\usb\usb9\usb9.c
                                               }//end switch                                                                E:\usb20\GIO3\system\usb\usb9\usb9.c
                                                                                                                            E:\usb20\GIO3\system\usb\usb9\usb9.c
00065a   0012     RETURN    0x0            }//end USBCheckStdRequest                                                        E:\usb20\GIO3\system\usb\usb9\usb9.c
                                                                                                                            E:\usb20\GIO3\system\usb\usb9\usb9.c
                                           /******************************************************************************  E:\usb20\GIO3\system\usb\usb9\usb9.c
                                            * Function:        void USBStdGetDscHandler(void)                               E:\usb20\GIO3\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usb9\usb9.c
                                            * PreCondition:    None                                                         E:\usb20\GIO3\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usb9\usb9.c
                                            * Input:           None                                                         E:\usb20\GIO3\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usb9\usb9.c
                                            * Output:          None                                                         E:\usb20\GIO3\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usb9\usb9.c
                                            * Side Effects:    None                                                         E:\usb20\GIO3\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usb9\usb9.c
                                            * Overview:        This routine handles the standard GET_DESCRIPTOR request.    E:\usb20\GIO3\system\usb\usb9\usb9.c
                                            *                  It utilizes tables dynamically looks up descriptor size.     E:\usb20\GIO3\system\usb\usb9\usb9.c
                                            *                  This routine should never have to be modified if the tables  E:\usb20\GIO3\system\usb\usb9\usb9.c
                                            *                  in usbdsc.c are declared correctly.                          E:\usb20\GIO3\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usb9\usb9.c
                                            * Note:            None                                                         E:\usb20\GIO3\system\usb\usb9\usb9.c
                                            *****************************************************************************/  E:\usb20\GIO3\system\usb\usb9\usb9.c
                                           void USBStdGetDscHandler(void)                                                   E:\usb20\GIO3\system\usb\usb9\usb9.c
                                           {                                                                                E:\usb20\GIO3\system\usb\usb9\usb9.c
00065c   0e80     MOVLW     0x80               if(SetupPkt.bmRequestType == 0x80)                                           E:\usb20\GIO3\system\usb\usb9\usb9.c
00065e   0104     MOVLB     0x4                                                                                             
000660   5d18     SUBWF     0x18,0x0,0x1                                                                                    
000662   e157     BNZ       0x712                                                                                           
                                               {                                                                            E:\usb20\GIO3\system\usb\usb9\usb9.c
000664   511b     MOVF      0x1b,0x0,0x1           switch(SetupPkt.bDscType)                                                E:\usb20\GIO3\system\usb\usb9\usb9.c
000666   0a03     XORLW     0x3                                                                                             
000668   e034     BZ        0x6d2                                                                                           
00066a   0a01     XORLW     0x1                                                                                             
00066c   e010     BZ        0x68e                                                                                           
00066e   0a03     XORLW     0x3                                                                                             
000670   e001     BZ        0x674                                                                                           
000672   d04d     BRA       0x70e                                                                                           
                                                   {                                                                        E:\usb20\GIO3\system\usb\usb9\usb9.c
                                                       case DSC_DEV:                                                        E:\usb20\GIO3\system\usb\usb9\usb9.c
000674   0100     MOVLB     0x0                            ctrl_trf_session_owner = MUID_USB9;                              E:\usb20\GIO3\system\usb\usb9\usb9.c
000676   0e01     MOVLW     0x1                                                                                             
000678   6ff1     MOVWF     0xf1,0x1                                                                                        
00067a   0100     MOVLB     0x0                            pSrc.bRom = (rom byte*)&device_dsc;                              E:\usb20\GIO3\system\usb\usb9\usb9.c
00067c   0ea2     MOVLW     0xa2                                                                                            
00067e   6ff2     MOVWF     0xf2,0x1                                                                                        
000680   0e10     MOVLW     0x10                                                                                            
000682   6ff3     MOVWF     0xf3,0x1                                                                                        
000684   0e12     MOVLW     0x12                           wCount._word = sizeof(device_dsc);          // Set data count    E:\usb20\GIO3\system\usb\usb9\usb9.c
000686   0100     MOVLB     0x0                                                                                             
000688   6ff6     MOVWF     0xf6,0x1                                                                                        
00068a   6bf7     CLRF      0xf7,0x1                                                                                        
00068c   d040     BRA       0x70e                          break;                                                           E:\usb20\GIO3\system\usb\usb9\usb9.c
                                                       case DSC_CFG:                                                        E:\usb20\GIO3\system\usb\usb9\usb9.c
00068e   0100     MOVLB     0x0                            ctrl_trf_session_owner = MUID_USB9;                              E:\usb20\GIO3\system\usb\usb9\usb9.c
000690   0e01     MOVLW     0x1                                                                                             
000692   6ff1     MOVWF     0xf1,0x1                                                                                        
000694   0104     MOVLB     0x4                            pSrc.bRom = *(USB_CD_Ptr+SetupPkt.bDscIndex);                    E:\usb20\GIO3\system\usb\usb9\usb9.c
000696   511a     MOVF      0x1a,0x0,0x1                                                                                    
000698   6ef6     MOVWF     0xf6,0x0                                                                                        
00069a   6af7     CLRF      0xf7,0x0                                                                                        
00069c   90d8     BCF       0xd8,0x0,0x0                                                                                    
00069e   36f6     RLCF      0xf6,0x1,0x0                                                                                    
0006a0   36f7     RLCF      0xf7,0x1,0x0                                                                                    
0006a2   0e57     MOVLW     0x57                                                                                            
0006a4   26f6     ADDWF     0xf6,0x1,0x0                                                                                    
0006a6   0e11     MOVLW     0x11                                                                                            
0006a8   22f7     ADDWFC    0xf7,0x1,0x0                                                                                    
0006aa   0009     TBLRDPOSTINC                                                                                              
0006ac   cff5     MOVFF     0xff5,0xf2                                                                                      
0006ae   f0f2                                                                                                               
0006b0   000a     TBLRDPOSTDEC                                                                                              
0006b2   cff5     MOVFF     0xff5,0xf3                                                                                      
0006b4   f0f3                                                                                                               
0006b6   0e02     MOVLW     0x2                            wCount._word = *(pSrc.wRom+1);              // Set data count    E:\usb20\GIO3\system\usb\usb9\usb9.c
0006b8   0100     MOVLB     0x0                                                                                             
0006ba   6af7     CLRF      0xf7,0x0                                                                                        
0006bc   25f2     ADDWF     0xf2,0x0,0x1                                                                                    
0006be   6ef6     MOVWF     0xf6,0x0                                                                                        
0006c0   51f3     MOVF      0xf3,0x0,0x1                                                                                    
0006c2   22f7     ADDWFC    0xf7,0x1,0x0                                                                                    
0006c4   0009     TBLRDPOSTINC                                                                                              
0006c6   cff5     MOVFF     0xff5,0xf6                                                                                      
0006c8   f0f6                                                                                                               
0006ca   000a     TBLRDPOSTDEC                                                                                              
0006cc   cff5     MOVFF     0xff5,0xf7                                                                                      
0006ce   f0f7                                                                                                               
0006d0   d01e     BRA       0x70e                          break;                                                           E:\usb20\GIO3\system\usb\usb9\usb9.c
                                                       case DSC_STR:                                                        E:\usb20\GIO3\system\usb\usb9\usb9.c
0006d2   0100     MOVLB     0x0                            ctrl_trf_session_owner = MUID_USB9;                              E:\usb20\GIO3\system\usb\usb9\usb9.c
0006d4   0e01     MOVLW     0x1                                                                                             
0006d6   6ff1     MOVWF     0xf1,0x1                                                                                        
0006d8   0104     MOVLB     0x4                            pSrc.bRom = *(USB_SD_Ptr+SetupPkt.bDscIndex);                    E:\usb20\GIO3\system\usb\usb9\usb9.c
0006da   511a     MOVF      0x1a,0x0,0x1                                                                                    
0006dc   6ef6     MOVWF     0xf6,0x0                                                                                        
0006de   6af7     CLRF      0xf7,0x0                                                                                        
0006e0   90d8     BCF       0xd8,0x0,0x0                                                                                    
0006e2   36f6     RLCF      0xf6,0x1,0x0                                                                                    
0006e4   36f7     RLCF      0xf7,0x1,0x0                                                                                    
0006e6   0e5b     MOVLW     0x5b                                                                                            
0006e8   26f6     ADDWF     0xf6,0x1,0x0                                                                                    
0006ea   0e11     MOVLW     0x11                                                                                            
0006ec   22f7     ADDWFC    0xf7,0x1,0x0                                                                                    
0006ee   0009     TBLRDPOSTINC                                                                                              
0006f0   cff5     MOVFF     0xff5,0xf2                                                                                      
0006f2   f0f2                                                                                                               
0006f4   000a     TBLRDPOSTDEC                                                                                              
0006f6   cff5     MOVFF     0xff5,0xf3                                                                                      
0006f8   f0f3                                                                                                               
0006fa   c0f2     MOVFF     0xf2,0xff6                     wCount._word = *pSrc.bRom;                  // Set data count    E:\usb20\GIO3\system\usb\usb9\usb9.c
0006fc   fff6                                                                                                               
0006fe   c0f3     MOVFF     0xf3,0xff7                                                                                      
000700   fff7                                                                                                               
000702   0008     TBLRD                                                                                                     
000704   50f5     MOVF      0xf5,0x0,0x0                                                                                    
000706   0100     MOVLB     0x0                                                                                             
000708   6ff6     MOVWF     0xf6,0x1                                                                                        
00070a   6bf7     CLRF      0xf7,0x1                                                                                        
00070c   d000     BRA       0x70e                          break;                                                           E:\usb20\GIO3\system\usb\usb9\usb9.c
                                                   }//end switch                                                            E:\usb20\GIO3\system\usb\usb9\usb9.c
                                                                                                                            E:\usb20\GIO3\system\usb\usb9\usb9.c
00070e   0100     MOVLB     0x0                    usb_stat.ctrl_trf_mem = _ROM;                       // Set memory type   E:\usb20\GIO3\system\usb\usb9\usb9.c
000710   83f9     BSF       0xf9,0x1,0x1                                                                                    
                                               }//end if                                                                    E:\usb20\GIO3\system\usb\usb9\usb9.c
000712   0012     RETURN    0x0            }//end USBStdGetDscHandler                                                       E:\usb20\GIO3\system\usb\usb9\usb9.c
                                                                                                                            E:\usb20\GIO3\system\usb\usb9\usb9.c
                                           /******************************************************************************  E:\usb20\GIO3\system\usb\usb9\usb9.c
                                            * Function:        void USBStdSetCfgHandler(void)                               E:\usb20\GIO3\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usb9\usb9.c
                                            * PreCondition:    None                                                         E:\usb20\GIO3\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usb9\usb9.c
                                            * Input:           None                                                         E:\usb20\GIO3\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usb9\usb9.c
                                            * Output:          None                                                         E:\usb20\GIO3\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usb9\usb9.c
                                            * Side Effects:    None                                                         E:\usb20\GIO3\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usb9\usb9.c
                                            * Overview:        This routine first disables all endpoints by clearing        E:\usb20\GIO3\system\usb\usb9\usb9.c
                                            *                  UEP registers. It then configures (initializes) endpoints    E:\usb20\GIO3\system\usb\usb9\usb9.c
                                            *                  specified in the modifiable section.                         E:\usb20\GIO3\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usb9\usb9.c
                                            * Note:            None                                                         E:\usb20\GIO3\system\usb\usb9\usb9.c
                                            *****************************************************************************/  E:\usb20\GIO3\system\usb\usb9\usb9.c
                                           void USBStdSetCfgHandler(void)                                                   E:\usb20\GIO3\system\usb\usb9\usb9.c
                                           {                                                                                E:\usb20\GIO3\system\usb\usb9\usb9.c
000714   0100     MOVLB     0x0                ctrl_trf_session_owner = MUID_USB9;                                          E:\usb20\GIO3\system\usb\usb9\usb9.c
000716   0e01     MOVLW     0x1                                                                                             
000718   6ff1     MOVWF     0xf1,0x1                                                                                        
00071a   0e0f     MOVLW     0xf                mDisableEP1to15();                          // See usbdrv.h                  E:\usb20\GIO3\system\usb\usb9\usb9.c
00071c   6ee6     MOVWF     0xe6,0x0                                                                                        
00071e   0e71     MOVLW     0x71                                                                                            
000720   6ee6     MOVWF     0xe6,0x0                                                                                        
000722   0e0f     MOVLW     0xf                                                                                             
000724   6ee6     MOVWF     0xe6,0x0                                                                                        
000726   ec3c     CALL      0x1078,0x0                                                                                      
000728   f008                                                                                                               
00072a   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00072c   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00072e   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000730   0e01     MOVLW     0x1                ClearArray((byte*)&usb_alt_intf,MAX_NUM_INT);                                E:\usb20\GIO3\system\usb\usb9\usb9.c
000732   6ee6     MOVWF     0xe6,0x0                                                                                        
000734   0efb     MOVLW     0xfb                                                                                            
000736   6ee6     MOVWF     0xe6,0x0                                                                                        
000738   0e00     MOVLW     0x0                                                                                             
00073a   6ee6     MOVWF     0xe6,0x0                                                                                        
00073c   ec3c     CALL      0x1078,0x0                                                                                      
00073e   f008                                                                                                               
000740   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000742   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000744   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000746   c41a     MOVFF     0x41a,0xfa         usb_active_cfg = SetupPkt.bCfgValue;                                         E:\usb20\GIO3\system\usb\usb9\usb9.c
000748   f0fa                                                                                                               
00074a   0104     MOVLB     0x4                if(SetupPkt.bCfgValue == 0)                                                  E:\usb20\GIO3\system\usb\usb9\usb9.c
00074c   511a     MOVF      0x1a,0x0,0x1                                                                                    
00074e   e104     BNZ       0x758                                                                                           
000750   0100     MOVLB     0x0                    usb_device_state = ADDRESS_STATE;                                        E:\usb20\GIO3\system\usb\usb9\usb9.c
000752   0e05     MOVLW     0x5                                                                                             
000754   6ff8     MOVWF     0xf8,0x1                                                                                        
000756   d005     BRA       0x762              else                                                                         E:\usb20\GIO3\system\usb\usb9\usb9.c
                                               {                                                                            E:\usb20\GIO3\system\usb\usb9\usb9.c
000758   0100     MOVLB     0x0                    usb_device_state = CONFIGURED_STATE;                                     E:\usb20\GIO3\system\usb\usb9\usb9.c
00075a   0e06     MOVLW     0x6                                                                                             
00075c   6ff8     MOVWF     0xf8,0x1                                                                                        
                                                                                                                            E:\usb20\GIO3\system\usb\usb9\usb9.c
                                                   /* Modifiable Section */                                                 E:\usb20\GIO3\system\usb\usb9\usb9.c
                                                                                                                            E:\usb20\GIO3\system\usb\usb9\usb9.c
                                                   #if defined(USB_USE_GEN)                // See autofiles\usbcfg.h        E:\usb20\GIO3\system\usb\usb9\usb9.c
00075e   ecae     CALL      0xb5c,0x0              USBGenInitEP();                                                          E:\usb20\GIO3\system\usb\usb9\usb9.c
000760   f005                                                                                                               
                                                   #endif                                                                   E:\usb20\GIO3\system\usb\usb9\usb9.c
                                                                                                                            E:\usb20\GIO3\system\usb\usb9\usb9.c
                                                   /* End modifiable section */                                             E:\usb20\GIO3\system\usb\usb9\usb9.c
                                                                                                                            E:\usb20\GIO3\system\usb\usb9\usb9.c
                                               }//end if(SetupPkt.bcfgValue == 0)                                           E:\usb20\GIO3\system\usb\usb9\usb9.c
000762   0012     RETURN    0x0            }//end USBStdSetCfgHandler                                                       E:\usb20\GIO3\system\usb\usb9\usb9.c
                                                                                                                            E:\usb20\GIO3\system\usb\usb9\usb9.c
                                           /******************************************************************************  E:\usb20\GIO3\system\usb\usb9\usb9.c
                                            * Function:        void USBStdGetStatusHandler(void)                            E:\usb20\GIO3\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usb9\usb9.c
                                            * PreCondition:    None                                                         E:\usb20\GIO3\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usb9\usb9.c
                                            * Input:           None                                                         E:\usb20\GIO3\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usb9\usb9.c
                                            * Output:          None                                                         E:\usb20\GIO3\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usb9\usb9.c
                                            * Side Effects:    None                                                         E:\usb20\GIO3\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usb9\usb9.c
                                            * Overview:        This routine handles the standard GET_STATUS request         E:\usb20\GIO3\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usb9\usb9.c
                                            * Note:            None                                                         E:\usb20\GIO3\system\usb\usb9\usb9.c
                                            *****************************************************************************/  E:\usb20\GIO3\system\usb\usb9\usb9.c
                                           void USBStdGetStatusHandler(void)                                                E:\usb20\GIO3\system\usb\usb9\usb9.c
                                           {                                                                                E:\usb20\GIO3\system\usb\usb9\usb9.c
000764   0104     MOVLB     0x4                CtrlTrfData._byte0 = 0;                         // Initialize content        E:\usb20\GIO3\system\usb\usb9\usb9.c
000766   6b20     CLRF      0x20,0x1                                                                                        
000768   6b21     CLRF      0x21,0x1           CtrlTrfData._byte1 = 0;                                                      E:\usb20\GIO3\system\usb\usb9\usb9.c
                                                                                                                            E:\usb20\GIO3\system\usb\usb9\usb9.c
00076a   0104     MOVLB     0x4                switch(SetupPkt.Recipient)                                                   E:\usb20\GIO3\system\usb\usb9\usb9.c
00076c   5118     MOVF      0x18,0x0,0x1                                                                                    
00076e   0b1f     ANDLW     0x1f                                                                                            
000770   0a02     XORLW     0x2                                                                                             
000772   e014     BZ        0x79c                                                                                           
000774   0a03     XORLW     0x3                                                                                             
000776   e00e     BZ        0x794                                                                                           
000778   0a01     XORLW     0x1                                                                                             
00077a   e001     BZ        0x77e                                                                                           
00077c   d033     BRA       0x7e4                                                                                           
                                               {                                                                            E:\usb20\GIO3\system\usb\usb9\usb9.c
                                                   case RCPT_DEV:                                                           E:\usb20\GIO3\system\usb\usb9\usb9.c
00077e   0100     MOVLB     0x0                        ctrl_trf_session_owner = MUID_USB9;                                  E:\usb20\GIO3\system\usb\usb9\usb9.c
000780   0e01     MOVLW     0x1                                                                                             
000782   6ff1     MOVWF     0xf1,0x1                                                                                        
                                                       /*                                                                   E:\usb20\GIO3\system\usb\usb9\usb9.c
                                                        * _byte0: bit0: Self-Powered Status [0] Bus-Powered [1] Self-Powered E:\usb20\GIO3\system\usb\usb9\usb9.c
                                                        *         bit1: RemoteWakeup        [0] Disabled    [1] Enabled     E:\usb20\GIO3\system\usb\usb9\usb9.c
                                                        */                                                                  E:\usb20\GIO3\system\usb\usb9\usb9.c
                                                       if(self_power == 1)                     // self_power defined in io_cfg.h E:\usb20\GIO3\system\usb\usb9\usb9.c
000784   0104     MOVLB     0x4                            CtrlTrfData._byte0|=0b000000001;    // Set bit0                  E:\usb20\GIO3\system\usb\usb9\usb9.c
000786   8120     BSF       0x20,0x0,0x1                                                                                    
                                                                                                                            E:\usb20\GIO3\system\usb\usb9\usb9.c
000788   0100     MOVLB     0x0                        if(usb_stat.RemoteWakeup == 1)          // usb_stat defined in usbmmap.c E:\usb20\GIO3\system\usb\usb9\usb9.c
00078a   a1f9     BTFSS     0xf9,0x0,0x1                                                                                    
00078c   d002     BRA       0x792                                                                                           
00078e   0104     MOVLB     0x4                            CtrlTrfData._byte0|=0b00000010;     // Set bit1                  E:\usb20\GIO3\system\usb\usb9\usb9.c
000790   8320     BSF       0x20,0x1,0x1                                                                                    
000792   d028     BRA       0x7e4                      break;                                                               E:\usb20\GIO3\system\usb\usb9\usb9.c
                                                   case RCPT_INTF:                                                          E:\usb20\GIO3\system\usb\usb9\usb9.c
000794   0100     MOVLB     0x0                        ctrl_trf_session_owner = MUID_USB9;     // No data to update         E:\usb20\GIO3\system\usb\usb9\usb9.c
000796   0e01     MOVLW     0x1                                                                                             
000798   6ff1     MOVWF     0xf1,0x1                                                                                        
00079a   d024     BRA       0x7e4                      break;                                                               E:\usb20\GIO3\system\usb\usb9\usb9.c
                                                   case RCPT_EP:                                                            E:\usb20\GIO3\system\usb\usb9\usb9.c
00079c   0100     MOVLB     0x0                        ctrl_trf_session_owner = MUID_USB9;                                  E:\usb20\GIO3\system\usb\usb9\usb9.c
00079e   0e01     MOVLW     0x1                                                                                             
0007a0   6ff1     MOVWF     0xf1,0x1                                                                                        
                                                       /*                                                                   E:\usb20\GIO3\system\usb\usb9\usb9.c
                                                        * _byte0: bit0: Halt Status [0] Not Halted [1] Halted               E:\usb20\GIO3\system\usb\usb9\usb9.c
                                                        */                                                                  E:\usb20\GIO3\system\usb\usb9\usb9.c
0007a2   0104     MOVLB     0x4                        pDst.bRam = (byte*)&ep0Bo+(SetupPkt.EPNum*8)+(SetupPkt.EPDir*4);     E:\usb20\GIO3\system\usb\usb9\usb9.c
0007a4   511c     MOVF      0x1c,0x0,0x1                                                                                    
0007a6   0b0f     ANDLW     0xf                                                                                             
0007a8   0d08     MULLW     0x8                                                                                             
0007aa   50f3     MOVF      0xf3,0x0,0x0                                                                                    
0007ac   6a15     CLRF      0x15,0x0                                                                                        
0007ae   0f00     ADDLW     0x0                                                                                             
0007b0   6e14     MOVWF     0x14,0x0                                                                                        
0007b2   0e04     MOVLW     0x4                                                                                             
0007b4   2215     ADDWFC    0x15,0x1,0x0                                                                                    
0007b6   511c     MOVF      0x1c,0x0,0x1                                                                                    
0007b8   0b80     ANDLW     0x80                                                                                            
0007ba   e001     BZ        0x7be                                                                                           
0007bc   0e01     MOVLW     0x1                                                                                             
0007be   0d04     MULLW     0x4                                                                                             
0007c0   50f3     MOVF      0xf3,0x0,0x0                                                                                    
0007c2   0100     MOVLB     0x0                                                                                             
0007c4   2414     ADDWF     0x14,0x0,0x0                                                                                    
0007c6   6ff4     MOVWF     0xf4,0x1                                                                                        
0007c8   0e00     MOVLW     0x0                                                                                             
0007ca   2015     ADDWFC    0x15,0x0,0x0                                                                                    
0007cc   6ff5     MOVWF     0xf5,0x1                                                                                        
0007ce   c0f4     MOVFF     0xf4,0xfe9                 if(*pDst.bRam & _BSTALL)    // Use _BSTALL as a bit mask             E:\usb20\GIO3\system\usb\usb9\usb9.c
0007d0   ffe9                                                                                                               
0007d2   c0f5     MOVFF     0xf5,0xfea                                                                                      
0007d4   ffea                                                                                                               
0007d6   50ef     MOVF      0xef,0x0,0x0                                                                                    
0007d8   0b04     ANDLW     0x4                                                                                             
0007da   e003     BZ        0x7e2                                                                                           
0007dc   0104     MOVLB     0x4                            CtrlTrfData._byte0=0x01;// Set bit0                              E:\usb20\GIO3\system\usb\usb9\usb9.c
0007de   0e01     MOVLW     0x1                                                                                             
0007e0   6f20     MOVWF     0x20,0x1                                                                                        
0007e2   d000     BRA       0x7e4                      break;                                                               E:\usb20\GIO3\system\usb\usb9\usb9.c
                                               }//end switch                                                                E:\usb20\GIO3\system\usb\usb9\usb9.c
                                                                                                                            E:\usb20\GIO3\system\usb\usb9\usb9.c
0007e4   0100     MOVLB     0x0                if(ctrl_trf_session_owner == MUID_USB9)                                      E:\usb20\GIO3\system\usb\usb9\usb9.c
0007e6   05f1     DECF      0xf1,0x0,0x1                                                                                    
0007e8   e10a     BNZ       0x7fe                                                                                           
                                               {                                                                            E:\usb20\GIO3\system\usb\usb9\usb9.c
0007ea   0100     MOVLB     0x0                    pSrc.bRam = (byte*)&CtrlTrfData;            // Set Source                E:\usb20\GIO3\system\usb\usb9\usb9.c
0007ec   0e20     MOVLW     0x20                                                                                            
0007ee   6ff2     MOVWF     0xf2,0x1                                                                                        
0007f0   0e04     MOVLW     0x4                                                                                             
0007f2   6ff3     MOVWF     0xf3,0x1                                                                                        
0007f4   0100     MOVLB     0x0                    usb_stat.ctrl_trf_mem = _RAM;               // Set memory type           E:\usb20\GIO3\system\usb\usb9\usb9.c
0007f6   93f9     BCF       0xf9,0x1,0x1                                                                                    
0007f8   0100     MOVLB     0x0                    LSB(wCount) = 2;                            // Set data count            E:\usb20\GIO3\system\usb\usb9\usb9.c
0007fa   0e02     MOVLW     0x2                                                                                             
0007fc   6ff6     MOVWF     0xf6,0x1                                                                                        
                                               }//end if(...)                                                               E:\usb20\GIO3\system\usb\usb9\usb9.c
0007fe   0012     RETURN    0x0            }//end USBStdGetStatusHandler                                                    E:\usb20\GIO3\system\usb\usb9\usb9.c
                                                                                                                            E:\usb20\GIO3\system\usb\usb9\usb9.c
                                           /******************************************************************************  E:\usb20\GIO3\system\usb\usb9\usb9.c
                                            * Function:        void USBStdFeatureReqHandler(void)                           E:\usb20\GIO3\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usb9\usb9.c
                                            * PreCondition:    None                                                         E:\usb20\GIO3\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usb9\usb9.c
                                            * Input:           None                                                         E:\usb20\GIO3\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usb9\usb9.c
                                            * Output:          None                                                         E:\usb20\GIO3\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usb9\usb9.c
                                            * Side Effects:    None                                                         E:\usb20\GIO3\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usb9\usb9.c
                                            * Overview:        This routine handles the standard SET & CLEAR FEATURES       E:\usb20\GIO3\system\usb\usb9\usb9.c
                                            *                  requests                                                     E:\usb20\GIO3\system\usb\usb9\usb9.c
                                            *                                                                               E:\usb20\GIO3\system\usb\usb9\usb9.c
                                            * Note:            None                                                         E:\usb20\GIO3\system\usb\usb9\usb9.c
                                            *****************************************************************************/  E:\usb20\GIO3\system\usb\usb9\usb9.c
                                           void USBStdFeatureReqHandler(void)                                               E:\usb20\GIO3\system\usb\usb9\usb9.c
                                           {                                                                                E:\usb20\GIO3\system\usb\usb9\usb9.c
000800   0104     MOVLB     0x4                if((SetupPkt.bFeature == DEVICE_REMOTE_WAKEUP)&&                             E:\usb20\GIO3\system\usb\usb9\usb9.c
000802   051a     DECF      0x1a,0x0,0x1                                                                                    
000804   e110     BNZ       0x826                 (SetupPkt.Recipient == RCPT_DEV))                                         E:\usb20\GIO3\system\usb\usb9\usb9.c
000806   5118     MOVF      0x18,0x0,0x1                                                                                    
000808   0b1f     ANDLW     0x1f                                                                                            
00080a   0900     IORLW     0x0                                                                                             
00080c   e10c     BNZ       0x826                                                                                           
                                               {                                                                            E:\usb20\GIO3\system\usb\usb9\usb9.c
00080e   0100     MOVLB     0x0                    ctrl_trf_session_owner = MUID_USB9;                                      E:\usb20\GIO3\system\usb\usb9\usb9.c
000810   0e01     MOVLW     0x1                                                                                             
000812   6ff1     MOVWF     0xf1,0x1                                                                                        
000814   0e03     MOVLW     0x3                    if(SetupPkt.bRequest == SET_FEATURE)                                     E:\usb20\GIO3\system\usb\usb9\usb9.c
000816   0104     MOVLB     0x4                                                                                             
000818   5d19     SUBWF     0x19,0x0,0x1                                                                                    
00081a   e103     BNZ       0x822                                                                                           
00081c   0100     MOVLB     0x0                        usb_stat.RemoteWakeup = 1;                                           E:\usb20\GIO3\system\usb\usb9\usb9.c
00081e   81f9     BSF       0xf9,0x0,0x1                                                                                    
000820   d002     BRA       0x826                  else                                                                     E:\usb20\GIO3\system\usb\usb9\usb9.c
000822   0100     MOVLB     0x0                        usb_stat.RemoteWakeup = 0;                                           E:\usb20\GIO3\system\usb\usb9\usb9.c
000824   91f9     BCF       0xf9,0x0,0x1                                                                                    
                                               }//end if                                                                    E:\usb20\GIO3\system\usb\usb9\usb9.c
                                                                                                                            E:\usb20\GIO3\system\usb\usb9\usb9.c
000826   0104     MOVLB     0x4                if((SetupPkt.bFeature == ENDPOINT_HALT)&&                                    E:\usb20\GIO3\system\usb\usb9\usb9.c
000828   511a     MOVF      0x1a,0x0,0x1                                                                                    
00082a   e13a     BNZ       0x8a0                 (SetupPkt.Recipient == RCPT_EP)&&                                         E:\usb20\GIO3\system\usb\usb9\usb9.c
00082c   5118     MOVF      0x18,0x0,0x1                                                                                    
00082e   0b1f     ANDLW     0x1f                                                                                            
000830   0802     SUBLW     0x2                                                                                             
000832   e136     BNZ       0x8a0                                                                                           
000834   511c     MOVF      0x1c,0x0,0x1          (SetupPkt.EPNum != 0))                                                    E:\usb20\GIO3\system\usb\usb9\usb9.c
000836   0b0f     ANDLW     0xf                                                                                             
000838   0900     IORLW     0x0                                                                                             
00083a   e032     BZ        0x8a0                                                                                           
                                               {                                                                            E:\usb20\GIO3\system\usb\usb9\usb9.c
00083c   0100     MOVLB     0x0                    ctrl_trf_session_owner = MUID_USB9;                                      E:\usb20\GIO3\system\usb\usb9\usb9.c
00083e   0e01     MOVLW     0x1                                                                                             
000840   6ff1     MOVWF     0xf1,0x1                                                                                        
                                                   /* Must do address calculation here */                                   E:\usb20\GIO3\system\usb\usb9\usb9.c
000842   0104     MOVLB     0x4                    pDst.bRam = (byte*)&ep0Bo+(SetupPkt.EPNum*8)+(SetupPkt.EPDir*4);         E:\usb20\GIO3\system\usb\usb9\usb9.c
000844   511c     MOVF      0x1c,0x0,0x1                                                                                    
000846   0b0f     ANDLW     0xf                                                                                             
000848   0d08     MULLW     0x8                                                                                             
00084a   50f3     MOVF      0xf3,0x0,0x0                                                                                    
00084c   6a15     CLRF      0x15,0x0                                                                                        
00084e   0f00     ADDLW     0x0                                                                                             
000850   6e14     MOVWF     0x14,0x0                                                                                        
000852   0e04     MOVLW     0x4                                                                                             
000854   2215     ADDWFC    0x15,0x1,0x0                                                                                    
000856   511c     MOVF      0x1c,0x0,0x1                                                                                    
000858   0b80     ANDLW     0x80                                                                                            
00085a   e001     BZ        0x85e                                                                                           
00085c   0e01     MOVLW     0x1                                                                                             
00085e   0d04     MULLW     0x4                                                                                             
000860   50f3     MOVF      0xf3,0x0,0x0                                                                                    
000862   0100     MOVLB     0x0                                                                                             
000864   2414     ADDWF     0x14,0x0,0x0                                                                                    
000866   6ff4     MOVWF     0xf4,0x1                                                                                        
000868   0e00     MOVLW     0x0                                                                                             
00086a   2015     ADDWFC    0x15,0x0,0x0                                                                                    
00086c   6ff5     MOVWF     0xf5,0x1                                                                                        
                                                                                                                            E:\usb20\GIO3\system\usb\usb9\usb9.c
00086e   0e03     MOVLW     0x3                    if(SetupPkt.bRequest == SET_FEATURE)                                     E:\usb20\GIO3\system\usb\usb9\usb9.c
000870   0104     MOVLB     0x4                                                                                             
000872   5d19     SUBWF     0x19,0x0,0x1                                                                                    
000874   e107     BNZ       0x884                                                                                           
000876   0e84     MOVLW     0x84                       *pDst.bRam = _USIE|_BSTALL;                                          E:\usb20\GIO3\system\usb\usb9\usb9.c
000878   c0f4     MOVFF     0xf4,0xfe9                                                                                      
00087a   ffe9                                                                                                               
00087c   c0f5     MOVFF     0xf5,0xfea                                                                                      
00087e   ffea                                                                                                               
000880   6eef     MOVWF     0xef,0x0                                                                                        
000882   d00e     BRA       0x8a0                  else                                                                     E:\usb20\GIO3\system\usb\usb9\usb9.c
                                                   {                                                                        E:\usb20\GIO3\system\usb\usb9\usb9.c
000884   af1c     BTFSS     0x1c,0x7,0x1               if(SetupPkt.EPDir == 1) // IN                                        E:\usb20\GIO3\system\usb\usb9\usb9.c
000886   d006     BRA       0x894                                                                                           
000888   c0f4     MOVFF     0xf4,0xfe9                     *pDst.bRam = _UCPU;                                              E:\usb20\GIO3\system\usb\usb9\usb9.c
00088a   ffe9                                                                                                               
00088c   c0f5     MOVFF     0xf5,0xfea                                                                                      
00088e   ffea                                                                                                               
000890   6aef     CLRF      0xef,0x0                                                                                        
000892   d006     BRA       0x8a0                      else                                                                 E:\usb20\GIO3\system\usb\usb9\usb9.c
000894   0e88     MOVLW     0x88                           *pDst.bRam = _USIE|_DAT0|_DTSEN;                                 E:\usb20\GIO3\system\usb\usb9\usb9.c
000896   c0f4     MOVFF     0xf4,0xfe9                                                                                      
000898   ffe9                                                                                                               
00089a   c0f5     MOVFF     0xf5,0xfea                                                                                      
00089c   ffea                                                                                                               
00089e   6eef     MOVWF     0xef,0x0                                                                                        
                                                   }//end if                                                                E:\usb20\GIO3\system\usb\usb9\usb9.c
                                               }//end if                                                                    E:\usb20\GIO3\system\usb\usb9\usb9.c
0008a0   0012     RETURN    0x0            }//end USBStdFeatureReqHandler                                                   E:\usb20\GIO3\system\usb\usb9\usb9.c
                                                                                                                            E:\usb20\GIO3\system\usb\usb9\usb9.c
                                           /** EOF usb9.c ***************************************************************/  E:\usb20\GIO3\system\usb\usb9\usb9.c
                                           /*********************************************************************           E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                            *                                                                               E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                            *             Microchip USB C18 Firmware -  Generic                             E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                            *                                                                               E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                            *********************************************************************           E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                            * FileName:        usbgen.c                                                     E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                            * Dependencies:    See INCLUDES section below                                   E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                            * Processor:       PIC18                                                        E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                            * Compiler:        C18 2.30.01+                                                 E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                            * Company:         Microchip Technology, Inc.                                   E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                            *                                                                               E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                            * Software License Agreement                                                    E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                            *                                                                               E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                            * The software supplied herewith by Microchip Technology Incorporated           E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                            * (the 鼎ompany・ for its PICmicroｮ Microcontroller is intended and             E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                            * supplied to you, the Company痴 customer, for use solely and                   E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                            * exclusively on Microchip PICmicro Microcontroller products. The               E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                            * software is owned by the Company and/or its supplier, and is                  E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                            * protected under applicable copyright laws. All rights are reserved.           E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                            * Any use in violation of the foregoing restrictions may subject the            E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                            * user to criminal sanctions under applicable laws, as well as to               E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                            * civil liability for the breach of the terms and conditions of this            E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                            * license.                                                                      E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                            *                                                                               E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                            * THIS SOFTWARE IS PROVIDED IN AN 鄭S IS・CONDITION. NO WARRANTIES,             E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                            * WHETHER EXPRESS, IMPLIED OR STATUTORY, INCLUDING, BUT NOT LIMITED             E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                            * TO, IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A                   E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                            * PARTICULAR PURPOSE APPLY TO THIS SOFTWARE. THE COMPANY SHALL NOT,             E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                            * IN ANY CIRCUMSTANCES, BE LIABLE FOR SPECIAL, INCIDENTAL OR                    E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                            * CONSEQUENTIAL DAMAGES, FOR ANY REASON WHATSOEVER.                             E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                            *                                                                               E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                            * Author               Date        Comment                                      E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                            *~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~           E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                            * Rawin Rojvanit       11/19/04    Original.                                    E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                            ********************************************************************/           E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                                                                                                            E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                           /** I N C L U D E S **********************************************************/  E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                           #include <p18cxxx.h>                                                             E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                           #include "system\typedefs.h"                                                     E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                           #include "system\usb\usb.h"                                                      E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                                                                                                            E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                           #ifdef USB_USE_GEN                                                               E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                                                                                                            E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                           /** V A R I A B L E S ********************************************************/  E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                           #pragma udata                                                                    E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                           byte usbgen_rx_len;                                                              E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                           /// 新規インターフェース用追加                                                   E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                           byte usbio_io_len;                                                               E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                                                                                                            E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                           /** P R I V A T E  P R O T O T Y P E S ***************************************/  E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                                                                                                            E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                           /** D E C L A R A T I O N S **************************************************/  E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                           #pragma code                                                                     E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                                                                                                            E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                           /** U S E R  A P I ***********************************************************/  E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                                                                                                            E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                           /******************************************************************************  E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                            * Function:        void USBGenInitEP(void)                                      E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                            *                                                                               E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                            * PreCondition:    None                                                         E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                            *                                                                               E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                            * Input:           None                                                         E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                            *                                                                               E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                            * Output:          None                                                         E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                            *                                                                               E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                            * Side Effects:    None                                                         E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                            *                                                                               E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                            * Overview:        USBGenInitEP initializes generic endpoints, buffer           E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                            *                  descriptors, internal state-machine, and variables.          E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                            *                  It should be called after the USB host has sent out a        E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                            *                  SET_CONFIGURATION request.                                   E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                            *                  See USBStdSetCfgHandler() in usb9.c for examples.            E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                            *                                                                               E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                            * Note:            None                                                         E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                            *****************************************************************************/  E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                           void USBGenInitEP(void)                                                          E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                           {                                                                                E:\usb20\GIO3\system\usb\class\generic\usbgen.c
000b5c   0100     MOVLB     0x0                	usbgen_rx_len = 0;                                                          E:\usb20\GIO3\system\usb\class\generic\usbgen.c
000b5e   6bfc     CLRF      0xfc,0x1                                                                                        
                                           	/// 新規インターフェース用追加                                                  E:\usb20\GIO3\system\usb\class\generic\usbgen.c
000b60   6bfd     CLRF      0xfd,0x1       	usbio_io_len = 0;                                                               E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                                                                                                            E:\usb20\GIO3\system\usb\class\generic\usbgen.c
000b62   0e1e     MOVLW     0x1e               	USBGEN_UEP = EP_OUT_IN|HSHK_EN;             // Enable 2 data pipes          E:\usb20\GIO3\system\usb\class\generic\usbgen.c
000b64   6e71     MOVWF     0x71,0x0                                                                                        
                                           	/// 新規インターフェース用追加                                                  E:\usb20\GIO3\system\usb\class\generic\usbgen.c
000b66   6e72     MOVWF     0x72,0x0       	USBIO_UEP2= EP_OUT_IN|HSHK_EN;                                                  E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                                                                                                            E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                               /*                                                                           E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                                * Do not have to init Cnt of IN pipes here.                                 E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                                * Reason:  Number of bytes to send to the host                              E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                                *          varies from one transaction to                                   E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                                *          another. Cnt should equal the exact                              E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                                *          number of bytes to transmit for                                  E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                                *          a given IN transaction.                                          E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                                *          This number of bytes will only                                   E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                                *          be known right before the data is                                E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                                *          sent.                                                            E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                                */                                                                          E:\usb20\GIO3\system\usb\class\generic\usbgen.c
000b68   0104     MOVLB     0x4                USBGEN_BD_OUT.Cnt = sizeof(usbgen_out);     	// Set buffer size              E:\usb20\GIO3\system\usb\class\generic\usbgen.c
000b6a   0e40     MOVLW     0x40                                                                                            
000b6c   6f09     MOVWF     0x9,0x1                                                                                         
000b6e   0e00     MOVLW     0x0                USBGEN_BD_OUT.ADR = (byte*)&usbgen_out;     	// Set buffer address           E:\usb20\GIO3\system\usb\class\generic\usbgen.c
000b70   6f0a     MOVWF     0xa,0x1                                                                                         
000b72   0e05     MOVLW     0x5                                                                                             
000b74   6f0b     MOVWF     0xb,0x1                                                                                         
000b76   0e88     MOVLW     0x88               USBGEN_BD_OUT.Stat._byte = _USIE|_DAT0|_DTSEN;// Set status                  E:\usb20\GIO3\system\usb\class\generic\usbgen.c
000b78   6f08     MOVWF     0x8,0x1                                                                                         
                                                                                                                            E:\usb20\GIO3\system\usb\class\generic\usbgen.c
000b7a   0104     MOVLB     0x4                USBGEN_BD_IN.ADR = (byte*)&usbgen_in;      	// Set buffer address            E:\usb20\GIO3\system\usb\class\generic\usbgen.c
000b7c   0e40     MOVLW     0x40                                                                                            
000b7e   6f0e     MOVWF     0xe,0x1                                                                                         
000b80   0e05     MOVLW     0x5                                                                                             
000b82   6f0f     MOVWF     0xf,0x1                                                                                         
000b84   0e40     MOVLW     0x40               USBGEN_BD_IN.Stat._byte = _UCPU|_DAT1;      	// Set buffer status            E:\usb20\GIO3\system\usb\class\generic\usbgen.c
000b86   6f0c     MOVWF     0xc,0x1                                                                                         
                                                                                                                            E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                           	/// 新規インターフェース用追加                                                  E:\usb20\GIO3\system\usb\class\generic\usbgen.c
000b88   0104     MOVLB     0x4            	USBIO_IO_OUT.Cnt = sizeof(usbio_out);                                           E:\usb20\GIO3\system\usb\class\generic\usbgen.c
000b8a   0e20     MOVLW     0x20                                                                                            
000b8c   6f11     MOVWF     0x11,0x1                                                                                        
000b8e   0e80     MOVLW     0x80           	USBIO_IO_OUT.ADR = (byte*)&usbio_out;                                           E:\usb20\GIO3\system\usb\class\generic\usbgen.c
000b90   6f12     MOVWF     0x12,0x1                                                                                        
000b92   0e05     MOVLW     0x5                                                                                             
000b94   6f13     MOVWF     0x13,0x1                                                                                        
000b96   0e88     MOVLW     0x88           	USBIO_IO_OUT.Stat._byte = _USIE|_DAT0|_DTSEN;                                   E:\usb20\GIO3\system\usb\class\generic\usbgen.c
000b98   6f10     MOVWF     0x10,0x1                                                                                        
                                                                                                                            E:\usb20\GIO3\system\usb\class\generic\usbgen.c
000b9a   0104     MOVLB     0x4            	USBIO_IO_IN.ADR = (byte*)&usbio_in;                                             E:\usb20\GIO3\system\usb\class\generic\usbgen.c
000b9c   0ea0     MOVLW     0xa0                                                                                            
000b9e   6f16     MOVWF     0x16,0x1                                                                                        
000ba0   0e05     MOVLW     0x5                                                                                             
000ba2   6f17     MOVWF     0x17,0x1                                                                                        
000ba4   0e40     MOVLW     0x40           	USBIO_IO_IN.Stat._byte = _UCPU|_DAT1;                                           E:\usb20\GIO3\system\usb\class\generic\usbgen.c
000ba6   6f14     MOVWF     0x14,0x1                                                                                        
                                                                                                                            E:\usb20\GIO3\system\usb\class\generic\usbgen.c
000ba8   0012     RETURN    0x0            }//end USBGenInitEP                                                              E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                                                                                                            E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                           /******************************************************************************  E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                            * Function:        void USBGenWrite(byte *buffer, byte len)                     E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                            *                                                                               E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                            * PreCondition:    mUSBGenTxIsBusy() must return false.                         E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                            *                                                                               E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                            *                  Value of 'len' must be equal to or smaller than              E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                            *                  USBGEN_EP_SIZE                                               E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                            *                  For an interrupt/bulk endpoint, the largest buffer size is   E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                            *                  64 bytes.                                                    E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                            *                                                                               E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                            * Input:           buffer  : Pointer to the starting location of data bytes     E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                            *                  len     : Number of bytes to be transferred                  E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                            *                                                                               E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                            * Output:          None                                                         E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                            *                                                                               E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                            * Side Effects:    None                                                         E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                            *                                                                               E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                            * Overview:        Use this macro to transfer data located in data memory.      E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                            *                                                                               E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                            *                  Remember: mUSBGenTxIsBusy() must return false before user    E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                            *                  can call this function.                                      E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                            *                  Unexpected behavior will occur if this function is called    E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                            *                  when mUSBGenTxIsBusy() != 0                                  E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                            *                                                                               E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                            *                  Typical Usage:                                               E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                            *                  if(!mUSBGenTxIsBusy())                                       E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                            *                      USBGenWrite(buffer, 3);                                  E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                            *                                                                               E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                            * Note:            None                                                         E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                            *****************************************************************************/  E:\usb20\GIO3\system\usb\class\generic\usbgen.c
000baa   cfd9     MOVFF     0xfd9,0xfe6    void USBGenWrite(byte *buffer, byte len)                                         E:\usb20\GIO3\system\usb\class\generic\usbgen.c
000bac   ffe6                                                                                                               
000bae   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
000bb0   ffd9                                                                                                               
000bb2   52e6     MOVF      0xe6,0x1,0x0                                                                                    
                                           {                                                                                E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                           	byte i;                                                                         E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                           	                                                                                E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                               /*                                                                           E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                                * Value of len should be equal to or smaller than USBGEN_EP_SIZE.           E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                                * This check forces the value of len to meet the precondition.              E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                                */                                                                          E:\usb20\GIO3\system\usb\class\generic\usbgen.c
000bb4   0efc     MOVLW     0xfc           	if(len > USBGEN_EP_SIZE)                                                        E:\usb20\GIO3\system\usb\class\generic\usbgen.c
000bb6   50db     MOVF      0xdb,0x0,0x0                                                                                    
000bb8   0840     SUBLW     0x40                                                                                            
000bba   e205     BC        0xbc6                                                                                           
000bbc   0e40     MOVLW     0x40           	    len = USBGEN_EP_SIZE;                                                       E:\usb20\GIO3\system\usb\class\generic\usbgen.c
000bbe   6ef3     MOVWF     0xf3,0x0                                                                                        
000bc0   0efc     MOVLW     0xfc                                                                                            
000bc2   cff3     MOVFF     0xff3,0xfdb                                                                                     
000bc4   ffdb                                                                                                               
                                                                                                                            E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                              /*                                                                            E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                               * Copy data from user's buffer to dual-ram buffer                            E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                               */                                                                           E:\usb20\GIO3\system\usb\class\generic\usbgen.c
000bc6   6adf     CLRF      0xdf,0x0           for (i = 0; i < len; i++)                                                    E:\usb20\GIO3\system\usb\class\generic\usbgen.c
000bc8   0efc     MOVLW     0xfc                                                                                            
000bca   50db     MOVF      0xdb,0x0,0x0                                                                                    
000bcc   5cdf     SUBWF     0xdf,0x0,0x0                                                                                    
000bce   e219     BC        0xc02                                                                                           
000bfe   2adf     INCF      0xdf,0x1,0x0                                                                                    
000c00   d7e3     BRA       0xbc8                                                                                           
000bd0   50df     MOVF      0xdf,0x0,0x0       	usbgen_in[i] = buffer[i];                                                   E:\usb20\GIO3\system\usb\class\generic\usbgen.c
000bd2   6ee7     MOVWF     0xe7,0x0                                                                                        
000bd4   0efd     MOVLW     0xfd                                                                                            
000bd6   cfdb     MOVFF     0xfdb,0xfe9                                                                                     
000bd8   ffe9                                                                                                               
000bda   0efe     MOVLW     0xfe                                                                                            
000bdc   cfdb     MOVFF     0xfdb,0xfea                                                                                     
000bde   ffea                                                                                                               
000be0   50e7     MOVF      0xe7,0x0,0x0                                                                                    
000be2   26e9     ADDWF     0xe9,0x1,0x0                                                                                    
000be4   0e00     MOVLW     0x0                                                                                             
000be6   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
000be8   50ef     MOVF      0xef,0x0,0x0                                                                                    
000bea   6ee6     MOVWF     0xe6,0x0                                                                                        
000bec   50df     MOVF      0xdf,0x0,0x0                                                                                    
000bee   6aea     CLRF      0xea,0x0                                                                                        
000bf0   0f40     ADDLW     0x40                                                                                            
000bf2   6ee9     MOVWF     0xe9,0x0                                                                                        
000bf4   0e05     MOVLW     0x5                                                                                             
000bf6   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
000bf8   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000bfa   50e7     MOVF      0xe7,0x0,0x0                                                                                    
000bfc   6eef     MOVWF     0xef,0x0                                                                                        
                                                                                                                            E:\usb20\GIO3\system\usb\class\generic\usbgen.c
000c02   0efc     MOVLW     0xfc               USBGEN_BD_IN.Cnt = len;                                                      E:\usb20\GIO3\system\usb\class\generic\usbgen.c
000c04   cfdb     MOVFF     0xfdb,0x40d                                                                                     
000c06   f40d                                                                                                               
000c08   0e40     MOVLW     0x40               mUSBBufferReady(USBGEN_BD_IN);                                               E:\usb20\GIO3\system\usb\class\generic\usbgen.c
000c0a   0104     MOVLB     0x4                                                                                             
000c0c   170c     ANDWF     0xc,0x1,0x1                                                                                     
000c0e   7d0c     BTG       0xc,0x6,0x1                                                                                     
000c10   0e88     MOVLW     0x88                                                                                            
000c12   130c     IORWF     0xc,0x1,0x1                                                                                     
                                                                                                                            E:\usb20\GIO3\system\usb\class\generic\usbgen.c
000c14   52e5     MOVF      0xe5,0x1,0x0   }//end USBGenWrite                                                               E:\usb20\GIO3\system\usb\class\generic\usbgen.c
000c16   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000c18   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
000c1a   ffd9                                                                                                               
000c1c   0012     RETURN    0x0                                                                                             
                                                                                                                            E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                                                                                                            E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                           ///                                                                              E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                           /// 新規インターフェース用Write関数追加                                          E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                           ///                                                                              E:\usb20\GIO3\system\usb\class\generic\usbgen.c
000c1e   cfd9     MOVFF     0xfd9,0xfe6    void USBIOWrite(byte *buffer, byte len)                                          E:\usb20\GIO3\system\usb\class\generic\usbgen.c
000c20   ffe6                                                                                                               
000c22   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
000c24   ffd9                                                                                                               
000c26   52e6     MOVF      0xe6,0x1,0x0                                                                                    
                                           {                                                                                E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                           	byte i;                                                                         E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                           	                                                                                E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                               /*                                                                           E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                                * Value of len should be equal to or smaller than USBGEN_EP_SIZE.           E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                                * This check forces the value of len to meet the precondition.              E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                                */                                                                          E:\usb20\GIO3\system\usb\class\generic\usbgen.c
000c28   0efc     MOVLW     0xfc           	if(len > USBIO_EP_SIZE)                                                         E:\usb20\GIO3\system\usb\class\generic\usbgen.c
000c2a   50db     MOVF      0xdb,0x0,0x0                                                                                    
000c2c   0820     SUBLW     0x20                                                                                            
000c2e   e205     BC        0xc3a                                                                                           
000c30   0e20     MOVLW     0x20           	    len = USBIO_EP_SIZE;                                                        E:\usb20\GIO3\system\usb\class\generic\usbgen.c
000c32   6ef3     MOVWF     0xf3,0x0                                                                                        
000c34   0efc     MOVLW     0xfc                                                                                            
000c36   cff3     MOVFF     0xff3,0xfdb                                                                                     
000c38   ffdb                                                                                                               
                                                                                                                            E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                              /*                                                                            E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                               * Copy data from user's buffer to dual-ram buffer                            E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                               */                                                                           E:\usb20\GIO3\system\usb\class\generic\usbgen.c
000c3a   6adf     CLRF      0xdf,0x0           for (i = 0; i < len; i++)                                                    E:\usb20\GIO3\system\usb\class\generic\usbgen.c
000c3c   0efc     MOVLW     0xfc                                                                                            
000c3e   50db     MOVF      0xdb,0x0,0x0                                                                                    
000c40   5cdf     SUBWF     0xdf,0x0,0x0                                                                                    
000c42   e219     BC        0xc76                                                                                           
000c72   2adf     INCF      0xdf,0x1,0x0                                                                                    
000c74   d7e3     BRA       0xc3c                                                                                           
000c44   50df     MOVF      0xdf,0x0,0x0       	usbio_in[i] = buffer[i];                                                    E:\usb20\GIO3\system\usb\class\generic\usbgen.c
000c46   6ee7     MOVWF     0xe7,0x0                                                                                        
000c48   0efd     MOVLW     0xfd                                                                                            
000c4a   cfdb     MOVFF     0xfdb,0xfe9                                                                                     
000c4c   ffe9                                                                                                               
000c4e   0efe     MOVLW     0xfe                                                                                            
000c50   cfdb     MOVFF     0xfdb,0xfea                                                                                     
000c52   ffea                                                                                                               
000c54   50e7     MOVF      0xe7,0x0,0x0                                                                                    
000c56   26e9     ADDWF     0xe9,0x1,0x0                                                                                    
000c58   0e00     MOVLW     0x0                                                                                             
000c5a   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
000c5c   50ef     MOVF      0xef,0x0,0x0                                                                                    
000c5e   6ee6     MOVWF     0xe6,0x0                                                                                        
000c60   50df     MOVF      0xdf,0x0,0x0                                                                                    
000c62   6aea     CLRF      0xea,0x0                                                                                        
000c64   0fa0     ADDLW     0xa0                                                                                            
000c66   6ee9     MOVWF     0xe9,0x0                                                                                        
000c68   0e05     MOVLW     0x5                                                                                             
000c6a   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
000c6c   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000c6e   50e7     MOVF      0xe7,0x0,0x0                                                                                    
000c70   6eef     MOVWF     0xef,0x0                                                                                        
                                                                                                                            E:\usb20\GIO3\system\usb\class\generic\usbgen.c
000c76   0efc     MOVLW     0xfc               USBIO_IO_IN.Cnt = len;                                                       E:\usb20\GIO3\system\usb\class\generic\usbgen.c
000c78   cfdb     MOVFF     0xfdb,0x415                                                                                     
000c7a   f415                                                                                                               
000c7c   0e40     MOVLW     0x40               mUSBBufferReady(USBIO_IO_IN);                                                E:\usb20\GIO3\system\usb\class\generic\usbgen.c
000c7e   0104     MOVLB     0x4                                                                                             
000c80   1714     ANDWF     0x14,0x1,0x1                                                                                    
000c82   7d14     BTG       0x14,0x6,0x1                                                                                    
000c84   0e88     MOVLW     0x88                                                                                            
000c86   1314     IORWF     0x14,0x1,0x1                                                                                    
                                                                                                                            E:\usb20\GIO3\system\usb\class\generic\usbgen.c
000c88   52e5     MOVF      0xe5,0x1,0x0   }//end USBIOWrite                                                                E:\usb20\GIO3\system\usb\class\generic\usbgen.c
000c8a   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000c8c   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
000c8e   ffd9                                                                                                               
000c90   0012     RETURN    0x0                                                                                             
                                                                                                                            E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                                                                                                            E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                           /******************************************************************************  E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                            * Function:        byte USBGenRead(byte *buffer, byte len)                      E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                            *                                                                               E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                            * PreCondition:    Value of input argument 'len' should be smaller than the     E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                            *                  maximum endpoint size responsible for receiving report       E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                            *                  data from USB host for HID class.                            E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                            *                  Input argument 'buffer' should point to a buffer area that   E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                            *                  is bigger or equal to the size specified by 'len'.           E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                            *                                                                               E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                            * Input:           buffer  : Pointer to where received bytes are to be stored   E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                            *                  len     : The number of bytes expected.                      E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                            *                                                                               E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                            * Output:          The number of bytes copied to buffer.                        E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                            *                                                                               E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                            * Side Effects:    Publicly accessible variable usbgen_rx_len is updated        E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                            *                  with the number of bytes copied to buffer.                   E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                            *                  Once USBGenRead is called, subsequent retrieval of           E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                            *                  usbgen_rx_len can be done by calling macro                   E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                            *                  mUSBGenGetRxLength().                                        E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                            *                                                                               E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                            * Overview:        USBGenRead copies a string of bytes received through         E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                            *                  the OUT endpoint to a user's specified location.             E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                            *                  It is a non-blocking function. It does not wait              E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                            *                  for data if there is no data available. Instead it returns   E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                            *                  '0' to notify the caller that there is no data available.    E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                            *                                                                               E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                            * Note:            If the actual number of bytes received is larger than the    E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                            *                  number of bytes expected (len), only the expected number     E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                            *                  of bytes specified will be copied to buffer.                 E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                            *                  If the actual number of bytes received is smaller than the   E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                            *                  number of bytes expected (len), only the actual number       E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                            *                  of bytes received will be copied to buffer.                  E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                            *****************************************************************************/  E:\usb20\GIO3\system\usb\class\generic\usbgen.c
000c92   cfd9     MOVFF     0xfd9,0xfe6    byte USBGenRead(byte *buffer, byte len)                                          E:\usb20\GIO3\system\usb\class\generic\usbgen.c
000c94   ffe6                                                                                                               
000c96   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
000c98   ffd9                                                                                                               
                                           {                                                                                E:\usb20\GIO3\system\usb\class\generic\usbgen.c
000c9a   0100     MOVLB     0x0                usbgen_rx_len = 0;                                                           E:\usb20\GIO3\system\usb\class\generic\usbgen.c
000c9c   6bfc     CLRF      0xfc,0x1                                                                                        
                                                                                                                            E:\usb20\GIO3\system\usb\class\generic\usbgen.c
000c9e   0104     MOVLB     0x4                if(!mUSBGenRxIsBusy())                                                       E:\usb20\GIO3\system\usb\class\generic\usbgen.c
000ca0   bf08     BTFSC     0x8,0x7,0x1                                                                                     
000ca2   d030     BRA       0xd04                                                                                           
                                               {                                                                            E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                                   /*                                                                       E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                                    * Adjust the expected number of bytes to equal                          E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                                    * the actual number of bytes received.                                  E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                                    */                                                                      E:\usb20\GIO3\system\usb\class\generic\usbgen.c
000ca4   0efc     MOVLW     0xfc                   if(len > USBGEN_BD_OUT.Cnt)                                              E:\usb20\GIO3\system\usb\class\generic\usbgen.c
000ca6   cfdb     MOVFF     0xfdb,0x14                                                                                      
000ca8   f014                                                                                                               
000caa   5109     MOVF      0x9,0x0,0x1                                                                                     
000cac   80d8     BSF       0xd8,0x0,0x0                                                                                    
000cae   5414     SUBFWB    0x14,0x0,0x0                                                                                    
000cb0   e203     BC        0xcb8                                                                                           
000cb2   0efc     MOVLW     0xfc                       len = USBGEN_BD_OUT.Cnt;                                             E:\usb20\GIO3\system\usb\class\generic\usbgen.c
000cb4   c409     MOVFF     0x409,0xfdb                                                                                     
000cb6   ffdb                                                                                                               
                                                                                                                            E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                                   /*                                                                       E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                                    * Copy data from dual-ram buffer to user's buffer                       E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                                    */                                                                      E:\usb20\GIO3\system\usb\class\generic\usbgen.c
000cb8   0100     MOVLB     0x0                    for(usbgen_rx_len = 0; usbgen_rx_len < len; usbgen_rx_len++)             E:\usb20\GIO3\system\usb\class\generic\usbgen.c
000cba   6bfc     CLRF      0xfc,0x1                                                                                        
000cbc   0efc     MOVLW     0xfc                                                                                            
000cbe   50db     MOVF      0xdb,0x0,0x0                                                                                    
000cc0   5dfc     SUBWF     0xfc,0x0,0x1                                                                                    
000cc2   e219     BC        0xcf6                                                                                           
000cf2   2bfc     INCF      0xfc,0x1,0x1                                                                                    
000cf4   d7e3     BRA       0xcbc                                                                                           
000cc4   51fc     MOVF      0xfc,0x0,0x1               buffer[usbgen_rx_len] = usbgen_out[usbgen_rx_len];                   E:\usb20\GIO3\system\usb\class\generic\usbgen.c
000cc6   6aea     CLRF      0xea,0x0                                                                                        
000cc8   0f00     ADDLW     0x0                                                                                             
000cca   6ee9     MOVWF     0xe9,0x0                                                                                        
000ccc   0e05     MOVLW     0x5                                                                                             
000cce   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
000cd0   50ef     MOVF      0xef,0x0,0x0                                                                                    
000cd2   6ee6     MOVWF     0xe6,0x0                                                                                        
000cd4   51fc     MOVF      0xfc,0x0,0x1                                                                                    
000cd6   6ee7     MOVWF     0xe7,0x0                                                                                        
000cd8   0efd     MOVLW     0xfd                                                                                            
000cda   cfdb     MOVFF     0xfdb,0xfe9                                                                                     
000cdc   ffe9                                                                                                               
000cde   0efe     MOVLW     0xfe                                                                                            
000ce0   cfdb     MOVFF     0xfdb,0xfea                                                                                     
000ce2   ffea                                                                                                               
000ce4   50e7     MOVF      0xe7,0x0,0x0                                                                                    
000ce6   26e9     ADDWF     0xe9,0x1,0x0                                                                                    
000ce8   0e00     MOVLW     0x0                                                                                             
000cea   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
000cec   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000cee   50e7     MOVF      0xe7,0x0,0x0                                                                                    
000cf0   6eef     MOVWF     0xef,0x0                                                                                        
                                                                                                                            E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                                   /*                                                                       E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                                    * Prepare dual-ram buffer for next OUT transaction                      E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                                    */                                                                      E:\usb20\GIO3\system\usb\class\generic\usbgen.c
000cf6   0104     MOVLB     0x4                    USBGEN_BD_OUT.Cnt = sizeof(usbgen_out);                                  E:\usb20\GIO3\system\usb\class\generic\usbgen.c
000cf8   0e40     MOVLW     0x40                                                                                            
000cfa   6f09     MOVWF     0x9,0x1                                                                                         
000cfc   1708     ANDWF     0x8,0x1,0x1            mUSBBufferReady(USBGEN_BD_OUT);                                          E:\usb20\GIO3\system\usb\class\generic\usbgen.c
000cfe   7d08     BTG       0x8,0x6,0x1                                                                                     
000d00   0e88     MOVLW     0x88                                                                                            
000d02   1308     IORWF     0x8,0x1,0x1                                                                                     
                                               }//end if                                                                    E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                                                                                                            E:\usb20\GIO3\system\usb\class\generic\usbgen.c
000d04   0100     MOVLB     0x0                return usbgen_rx_len;                                                        E:\usb20\GIO3\system\usb\class\generic\usbgen.c
000d06   51fc     MOVF      0xfc,0x0,0x1                                                                                    
000d08   d000     BRA       0xd0a                                                                                           
                                                                                                                            E:\usb20\GIO3\system\usb\class\generic\usbgen.c
000d0a   52e5     MOVF      0xe5,0x1,0x0   }//end USBGenRead                                                                E:\usb20\GIO3\system\usb\class\generic\usbgen.c
000d0c   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
000d0e   ffd9                                                                                                               
000d10   0012     RETURN    0x0                                                                                             
                                                                                                                            E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                           ///                                                                              E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                           /// 新規インターフェース用Read関数追加                                           E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                           ///                                                                              E:\usb20\GIO3\system\usb\class\generic\usbgen.c
000d12   cfd9     MOVFF     0xfd9,0xfe6    byte USBIORead(byte *buffer, byte len)                                           E:\usb20\GIO3\system\usb\class\generic\usbgen.c
000d14   ffe6                                                                                                               
000d16   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
000d18   ffd9                                                                                                               
                                           {                                                                                E:\usb20\GIO3\system\usb\class\generic\usbgen.c
000d1a   0100     MOVLB     0x0                usbio_io_len = 0;                                                            E:\usb20\GIO3\system\usb\class\generic\usbgen.c
000d1c   6bfd     CLRF      0xfd,0x1                                                                                        
                                                                                                                            E:\usb20\GIO3\system\usb\class\generic\usbgen.c
000d1e   0104     MOVLB     0x4                if(!mUSBIORxIsBusy())                                                        E:\usb20\GIO3\system\usb\class\generic\usbgen.c
000d20   bf10     BTFSC     0x10,0x7,0x1                                                                                    
000d22   d031     BRA       0xd86                                                                                           
                                               {                                                                            E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                                   /*                                                                       E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                                    * Adjust the expected number of bytes to equal                          E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                                    * the actual number of bytes received.                                  E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                                    */                                                                      E:\usb20\GIO3\system\usb\class\generic\usbgen.c
000d24   0efc     MOVLW     0xfc                   if(len > USBIO_IO_OUT.Cnt)                                               E:\usb20\GIO3\system\usb\class\generic\usbgen.c
000d26   cfdb     MOVFF     0xfdb,0x14                                                                                      
000d28   f014                                                                                                               
000d2a   5111     MOVF      0x11,0x0,0x1                                                                                    
000d2c   80d8     BSF       0xd8,0x0,0x0                                                                                    
000d2e   5414     SUBFWB    0x14,0x0,0x0                                                                                    
000d30   e203     BC        0xd38                                                                                           
000d32   0efc     MOVLW     0xfc                       len = USBIO_IO_OUT.Cnt;                                              E:\usb20\GIO3\system\usb\class\generic\usbgen.c
000d34   c411     MOVFF     0x411,0xfdb                                                                                     
000d36   ffdb                                                                                                               
                                                                                                                            E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                                   /*                                                                       E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                                    * Copy data from dual-ram buffer to user's buffer                       E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                                    */                                                                      E:\usb20\GIO3\system\usb\class\generic\usbgen.c
000d38   0100     MOVLB     0x0                    for(usbio_io_len = 0; usbio_io_len < len; usbio_io_len++)                E:\usb20\GIO3\system\usb\class\generic\usbgen.c
000d3a   6bfd     CLRF      0xfd,0x1                                                                                        
000d3c   0efc     MOVLW     0xfc                                                                                            
000d3e   50db     MOVF      0xdb,0x0,0x0                                                                                    
000d40   5dfd     SUBWF     0xfd,0x0,0x1                                                                                    
000d42   e219     BC        0xd76                                                                                           
000d72   2bfd     INCF      0xfd,0x1,0x1                                                                                    
000d74   d7e3     BRA       0xd3c                                                                                           
000d44   51fd     MOVF      0xfd,0x0,0x1               buffer[usbio_io_len] = usbio_out[usbio_io_len];                      E:\usb20\GIO3\system\usb\class\generic\usbgen.c
000d46   6aea     CLRF      0xea,0x0                                                                                        
000d48   0f80     ADDLW     0x80                                                                                            
000d4a   6ee9     MOVWF     0xe9,0x0                                                                                        
000d4c   0e05     MOVLW     0x5                                                                                             
000d4e   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
000d50   50ef     MOVF      0xef,0x0,0x0                                                                                    
000d52   6ee6     MOVWF     0xe6,0x0                                                                                        
000d54   51fd     MOVF      0xfd,0x0,0x1                                                                                    
000d56   6ee7     MOVWF     0xe7,0x0                                                                                        
000d58   0efd     MOVLW     0xfd                                                                                            
000d5a   cfdb     MOVFF     0xfdb,0xfe9                                                                                     
000d5c   ffe9                                                                                                               
000d5e   0efe     MOVLW     0xfe                                                                                            
000d60   cfdb     MOVFF     0xfdb,0xfea                                                                                     
000d62   ffea                                                                                                               
000d64   50e7     MOVF      0xe7,0x0,0x0                                                                                    
000d66   26e9     ADDWF     0xe9,0x1,0x0                                                                                    
000d68   0e00     MOVLW     0x0                                                                                             
000d6a   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
000d6c   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000d6e   50e7     MOVF      0xe7,0x0,0x0                                                                                    
000d70   6eef     MOVWF     0xef,0x0                                                                                        
                                                                                                                            E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                                   /*                                                                       E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                                    * Prepare dual-ram buffer for next OUT transaction                      E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                                    */                                                                      E:\usb20\GIO3\system\usb\class\generic\usbgen.c
000d76   0104     MOVLB     0x4                    USBIO_IO_OUT.Cnt = sizeof(usbio_out);                                    E:\usb20\GIO3\system\usb\class\generic\usbgen.c
000d78   0e20     MOVLW     0x20                                                                                            
000d7a   6f11     MOVWF     0x11,0x1                                                                                        
000d7c   0e40     MOVLW     0x40                   mUSBBufferReady(USBIO_IO_OUT);                                           E:\usb20\GIO3\system\usb\class\generic\usbgen.c
000d7e   1710     ANDWF     0x10,0x1,0x1                                                                                    
000d80   7d10     BTG       0x10,0x6,0x1                                                                                    
000d82   0e88     MOVLW     0x88                                                                                            
000d84   1310     IORWF     0x10,0x1,0x1                                                                                    
                                               }//end if                                                                    E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                                                                                                            E:\usb20\GIO3\system\usb\class\generic\usbgen.c
000d86   0100     MOVLB     0x0                return usbio_io_len;                                                         E:\usb20\GIO3\system\usb\class\generic\usbgen.c
000d88   51fd     MOVF      0xfd,0x0,0x1                                                                                    
000d8a   d000     BRA       0xd8c                                                                                           
                                                                                                                            E:\usb20\GIO3\system\usb\class\generic\usbgen.c
000d8c   52e5     MOVF      0xe5,0x1,0x0   }//end USBIORead                                                                 E:\usb20\GIO3\system\usb\class\generic\usbgen.c
000d8e   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
000d90   ffd9                                                                                                               
000d92   0012     RETURN    0x0                                                                                             
                                           #endif //def USB_USE_GEN                                                         E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                                                                                                            E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                           /** EOF usbgen.c *************************************************************/  E:\usb20\GIO3\system\usb\class\generic\usbgen.c
                                           /*********************************************************************           E:\usb20\GIO3\autofiles\usbdsc.c
                                            *                                                                               E:\usb20\GIO3\autofiles\usbdsc.c
                                            *                Microchip USB C18 Firmware Version 1.0                         E:\usb20\GIO3\autofiles\usbdsc.c
                                            *                                                                               E:\usb20\GIO3\autofiles\usbdsc.c
                                            *********************************************************************           E:\usb20\GIO3\autofiles\usbdsc.c
                                            * FileName:        usbdsc.c                                                     E:\usb20\GIO3\autofiles\usbdsc.c
                                            * Dependencies:    See INCLUDES section below                                   E:\usb20\GIO3\autofiles\usbdsc.c
                                            * Processor:       PIC18                                                        E:\usb20\GIO3\autofiles\usbdsc.c
                                            * Compiler:        C18 2.30.01+                                                 E:\usb20\GIO3\autofiles\usbdsc.c
                                            * Company:         Microchip Technology, Inc.                                   E:\usb20\GIO3\autofiles\usbdsc.c
                                            *                                                                               E:\usb20\GIO3\autofiles\usbdsc.c
                                            * Software License Agreement                                                    E:\usb20\GIO3\autofiles\usbdsc.c
                                            *                                                                               E:\usb20\GIO3\autofiles\usbdsc.c
                                            * The software supplied herewith by Microchip Technology Incorporated           E:\usb20\GIO3\autofiles\usbdsc.c
                                            * (the 鼎ompany・ for its PICmicroｮ Microcontroller is intended and             E:\usb20\GIO3\autofiles\usbdsc.c
                                            * supplied to you, the Company痴 customer, for use solely and                   E:\usb20\GIO3\autofiles\usbdsc.c
                                            * exclusively on Microchip PICmicro Microcontroller products. The               E:\usb20\GIO3\autofiles\usbdsc.c
                                            * software is owned by the Company and/or its supplier, and is                  E:\usb20\GIO3\autofiles\usbdsc.c
                                            * protected under applicable copyright laws. All rights are reserved.           E:\usb20\GIO3\autofiles\usbdsc.c
                                            * Any use in violation of the foregoing restrictions may subject the            E:\usb20\GIO3\autofiles\usbdsc.c
                                            * user to criminal sanctions under applicable laws, as well as to               E:\usb20\GIO3\autofiles\usbdsc.c
                                            * civil liability for the breach of the terms and conditions of this            E:\usb20\GIO3\autofiles\usbdsc.c
                                            * license.                                                                      E:\usb20\GIO3\autofiles\usbdsc.c
                                            *                                                                               E:\usb20\GIO3\autofiles\usbdsc.c
                                            * THIS SOFTWARE IS PROVIDED IN AN 鄭S IS・CONDITION. NO WARRANTIES,             E:\usb20\GIO3\autofiles\usbdsc.c
                                            * WHETHER EXPRESS, IMPLIED OR STATUTORY, INCLUDING, BUT NOT LIMITED             E:\usb20\GIO3\autofiles\usbdsc.c
                                            * TO, IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A                   E:\usb20\GIO3\autofiles\usbdsc.c
                                            * PARTICULAR PURPOSE APPLY TO THIS SOFTWARE. THE COMPANY SHALL NOT,             E:\usb20\GIO3\autofiles\usbdsc.c
                                            * IN ANY CIRCUMSTANCES, BE LIABLE FOR SPECIAL, INCIDENTAL OR                    E:\usb20\GIO3\autofiles\usbdsc.c
                                            * CONSEQUENTIAL DAMAGES, FOR ANY REASON WHATSOEVER.                             E:\usb20\GIO3\autofiles\usbdsc.c
                                            *                                                                               E:\usb20\GIO3\autofiles\usbdsc.c
                                            ********************************************************************/           E:\usb20\GIO3\autofiles\usbdsc.c
                                                                                                                            E:\usb20\GIO3\autofiles\usbdsc.c
                                           /*********************************************************************           E:\usb20\GIO3\autofiles\usbdsc.c
                                            * -usbdsc.c-                                                                    E:\usb20\GIO3\autofiles\usbdsc.c
                                            * This file contains the USB descriptor information. It is used                 E:\usb20\GIO3\autofiles\usbdsc.c
                                            * in conjunction with the usbdsc.h file. When a descriptor is added             E:\usb20\GIO3\autofiles\usbdsc.c
                                            * or removed from the main configuration descriptor, i.e. CFG01,                E:\usb20\GIO3\autofiles\usbdsc.c
                                            * the user must also change the descriptor structure defined in                 E:\usb20\GIO3\autofiles\usbdsc.c
                                            * the usbdsc.h file. The structure is used to calculate the                     E:\usb20\GIO3\autofiles\usbdsc.c
                                            * descriptor size, i.e. sizeof(CFG01).                                          E:\usb20\GIO3\autofiles\usbdsc.c
                                            *                                                                               E:\usb20\GIO3\autofiles\usbdsc.c
                                            * A typical configuration descriptor consists of:                               E:\usb20\GIO3\autofiles\usbdsc.c
                                            * At least one configuration descriptor (USB_CFG_DSC)                           E:\usb20\GIO3\autofiles\usbdsc.c
                                            * One or more interface descriptors (USB_INTF_DSC)                              E:\usb20\GIO3\autofiles\usbdsc.c
                                            * One or more endpoint descriptors (USB_EP_DSC)                                 E:\usb20\GIO3\autofiles\usbdsc.c
                                            *                                                                               E:\usb20\GIO3\autofiles\usbdsc.c
                                            * Naming Convention:                                                            E:\usb20\GIO3\autofiles\usbdsc.c
                                            * To resolve ambiguity, the naming convention are as followed:                  E:\usb20\GIO3\autofiles\usbdsc.c
                                            * - USB_CFG_DSC type should be named cdxx, where xx is the                      E:\usb20\GIO3\autofiles\usbdsc.c
                                            *   configuration number. This number should match the actual                   E:\usb20\GIO3\autofiles\usbdsc.c
                                            *   index value of this configuration.                                          E:\usb20\GIO3\autofiles\usbdsc.c
                                            * - USB_INTF_DSC type should be named i<yy>a<zz>, where yy is the               E:\usb20\GIO3\autofiles\usbdsc.c
                                            *   interface number and zz is the alternate interface number.                  E:\usb20\GIO3\autofiles\usbdsc.c
                                            * - USB_EP_DSC type should be named ep<##><d>_i<yy>a<zz>, where                 E:\usb20\GIO3\autofiles\usbdsc.c
                                            *   ## is the endpoint number and d is the direction of transfer.               E:\usb20\GIO3\autofiles\usbdsc.c
                                            *   The interface name should also be listed as a suffix to identify            E:\usb20\GIO3\autofiles\usbdsc.c
                                            *   which interface does the endpoint belong to.                                E:\usb20\GIO3\autofiles\usbdsc.c
                                            *                                                                               E:\usb20\GIO3\autofiles\usbdsc.c
                                            * Example:                                                                      E:\usb20\GIO3\autofiles\usbdsc.c
                                            * If a device has one configuration, two interfaces; interface 0                E:\usb20\GIO3\autofiles\usbdsc.c
                                            * has two endpoints (in and out), and interface 1 has one endpoint(in).         E:\usb20\GIO3\autofiles\usbdsc.c
                                            * Then the CFG01 structure in the usbdsc.h should be:                           E:\usb20\GIO3\autofiles\usbdsc.c
                                            *                                                                               E:\usb20\GIO3\autofiles\usbdsc.c
                                            * #define CFG01 rom struct                            \                         E:\usb20\GIO3\autofiles\usbdsc.c
                                            * {   USB_CFG_DSC             cd01;                   \                         E:\usb20\GIO3\autofiles\usbdsc.c
                                            *     USB_INTF_DSC            i00a00;                 \                         E:\usb20\GIO3\autofiles\usbdsc.c
                                            *     USB_EP_DSC              ep01o_i00a00;           \                         E:\usb20\GIO3\autofiles\usbdsc.c
                                            *     USB_EP_DSC              ep01i_i00a00;           \                         E:\usb20\GIO3\autofiles\usbdsc.c
                                            *     USB_INTF_DSC            i01a00;                 \                         E:\usb20\GIO3\autofiles\usbdsc.c
                                            *     USB_EP_DSC              ep02i_i01a00;           \                         E:\usb20\GIO3\autofiles\usbdsc.c
                                            * } cfg01                                                                       E:\usb20\GIO3\autofiles\usbdsc.c
                                            *                                                                               E:\usb20\GIO3\autofiles\usbdsc.c
                                            * Note the hierarchy of the descriptors above, it follows the USB               E:\usb20\GIO3\autofiles\usbdsc.c
                                            * specification requirement. All endpoints belonging to an interface            E:\usb20\GIO3\autofiles\usbdsc.c
                                            * should be listed immediately after that interface.                            E:\usb20\GIO3\autofiles\usbdsc.c
                                            *                                                                               E:\usb20\GIO3\autofiles\usbdsc.c
                                            * -------------------------------------------------------------------           E:\usb20\GIO3\autofiles\usbdsc.c
                                            * Filling in the descriptor values in the usbdsc.c file:                        E:\usb20\GIO3\autofiles\usbdsc.c
                                            * -------------------------------------------------------------------           E:\usb20\GIO3\autofiles\usbdsc.c
                                            * Most items should be self-explanatory, however, a few will be                 E:\usb20\GIO3\autofiles\usbdsc.c
                                            * explained for clarification.                                                  E:\usb20\GIO3\autofiles\usbdsc.c
                                            *                                                                               E:\usb20\GIO3\autofiles\usbdsc.c
                                            * [Configuration Descriptor(USB_CFG_DSC)]                                       E:\usb20\GIO3\autofiles\usbdsc.c
                                            * The configuration attribute must always have the _DEFAULT                     E:\usb20\GIO3\autofiles\usbdsc.c
                                            * definition at the minimum. Additional options can be ORed                     E:\usb20\GIO3\autofiles\usbdsc.c
                                            * to the _DEFAULT attribute. Available options are _SELF and _RWU.              E:\usb20\GIO3\autofiles\usbdsc.c
                                            * These definitions are defined in the usbdefs_std_dsc.h file. The              E:\usb20\GIO3\autofiles\usbdsc.c
                                            * _SELF tells the USB host that this device is self-powered. The                E:\usb20\GIO3\autofiles\usbdsc.c
                                            * _RWU tells the USB host that this device supports Remote Wakeup.              E:\usb20\GIO3\autofiles\usbdsc.c
                                            *                                                                               E:\usb20\GIO3\autofiles\usbdsc.c
                                            * [Endpoint Descriptor(USB_EP_DSC)]                                             E:\usb20\GIO3\autofiles\usbdsc.c
                                            * Assume the following example:                                                 E:\usb20\GIO3\autofiles\usbdsc.c
                                            * sizeof(USB_EP_DSC),DSC_EP,_EP01_OUT,_BULK,64,0x00                             E:\usb20\GIO3\autofiles\usbdsc.c
                                            *                                                                               E:\usb20\GIO3\autofiles\usbdsc.c
                                            * The first two parameters are self-explanatory. They specify the               E:\usb20\GIO3\autofiles\usbdsc.c
                                            * length of this endpoint descriptor (7) and the descriptor type.               E:\usb20\GIO3\autofiles\usbdsc.c
                                            * The next parameter identifies the endpoint, the definitions are               E:\usb20\GIO3\autofiles\usbdsc.c
                                            * defined in usbdefs_std_dsc.h and has the following naming                     E:\usb20\GIO3\autofiles\usbdsc.c
                                            * convention:                                                                   E:\usb20\GIO3\autofiles\usbdsc.c
                                            * _EP<##>_<dir>                                                                 E:\usb20\GIO3\autofiles\usbdsc.c
                                            * where ## is the endpoint number and dir is the direction of                   E:\usb20\GIO3\autofiles\usbdsc.c
                                            * transfer. The dir has the value of either 'OUT' or 'IN'.                      E:\usb20\GIO3\autofiles\usbdsc.c
                                            * The next parameter identifies the type of the endpoint. Available             E:\usb20\GIO3\autofiles\usbdsc.c
                                            * options are _BULK, _INT, _ISO, and _CTRL. The _CTRL is not                    E:\usb20\GIO3\autofiles\usbdsc.c
                                            * typically used because the default control transfer endpoint is               E:\usb20\GIO3\autofiles\usbdsc.c
                                            * not defined in the USB descriptors. When _ISO option is used,                 E:\usb20\GIO3\autofiles\usbdsc.c
                                            * addition options can be ORed to _ISO. Example:                                E:\usb20\GIO3\autofiles\usbdsc.c
                                            * _ISO|_AD|_FE                                                                  E:\usb20\GIO3\autofiles\usbdsc.c
                                            * This describes the endpoint as an isochronous pipe with adaptive              E:\usb20\GIO3\autofiles\usbdsc.c
                                            * and feedback attributes. See usbdefs_std_dsc.h and the USB                    E:\usb20\GIO3\autofiles\usbdsc.c
                                            * specification for details. The next parameter defines the size of             E:\usb20\GIO3\autofiles\usbdsc.c
                                            * the endpoint. The last parameter in the polling interval.                     E:\usb20\GIO3\autofiles\usbdsc.c
                                            *                                                                               E:\usb20\GIO3\autofiles\usbdsc.c
                                            * -------------------------------------------------------------------           E:\usb20\GIO3\autofiles\usbdsc.c
                                            * Adding a USB String                                                           E:\usb20\GIO3\autofiles\usbdsc.c
                                            * -------------------------------------------------------------------           E:\usb20\GIO3\autofiles\usbdsc.c
                                            * A string descriptor array should have the following format:                   E:\usb20\GIO3\autofiles\usbdsc.c
                                            *                                                                               E:\usb20\GIO3\autofiles\usbdsc.c
                                            * rom struct{byte bLength;byte bDscType;word string[size];}sdxxx={              E:\usb20\GIO3\autofiles\usbdsc.c
                                            * sizeof(sdxxx),DSC_STR,<text>};                                                E:\usb20\GIO3\autofiles\usbdsc.c
                                            *                                                                               E:\usb20\GIO3\autofiles\usbdsc.c
                                            * The above structure provides a means for the C compiler to                    E:\usb20\GIO3\autofiles\usbdsc.c
                                            * calculate the length of string descriptor sdxxx, where xxx is the             E:\usb20\GIO3\autofiles\usbdsc.c
                                            * index number. The first two bytes of the descriptor are descriptor            E:\usb20\GIO3\autofiles\usbdsc.c
                                            * length and type. The rest <text> are string texts which must be               E:\usb20\GIO3\autofiles\usbdsc.c
                                            * in the unicode format. The unicode format is achieved by declaring            E:\usb20\GIO3\autofiles\usbdsc.c
                                            * each character as a word type. The whole text string is declared              E:\usb20\GIO3\autofiles\usbdsc.c
                                            * as a word array with the number of characters equals to <size>.               E:\usb20\GIO3\autofiles\usbdsc.c
                                            * <size> has to be manually counted and entered into the array                  E:\usb20\GIO3\autofiles\usbdsc.c
                                            * declaration. Let's study this through an example:                             E:\usb20\GIO3\autofiles\usbdsc.c
                                            * if the string is "USB" , then the string descriptor should be:                E:\usb20\GIO3\autofiles\usbdsc.c
                                            * (Using index 02)                                                              E:\usb20\GIO3\autofiles\usbdsc.c
                                            * rom struct{byte bLength;byte bDscType;word string[3];}sd002={                 E:\usb20\GIO3\autofiles\usbdsc.c
                                            * sizeof(sd002),DSC_STR,'U','S','B'};                                           E:\usb20\GIO3\autofiles\usbdsc.c
                                            *                                                                               E:\usb20\GIO3\autofiles\usbdsc.c
                                            * A USB project may have multiple strings and the firmware supports             E:\usb20\GIO3\autofiles\usbdsc.c
                                            * the management of multiple strings through a look-up table.                   E:\usb20\GIO3\autofiles\usbdsc.c
                                            * The look-up table is defined as:                                              E:\usb20\GIO3\autofiles\usbdsc.c
                                            * rom const unsigned char *rom USB_SD_Ptr[]={&sd000,&sd001,&sd002};             E:\usb20\GIO3\autofiles\usbdsc.c
                                            *                                                                               E:\usb20\GIO3\autofiles\usbdsc.c
                                            * The above declaration has 3 strings, sd000, sd001, and sd002.                 E:\usb20\GIO3\autofiles\usbdsc.c
                                            * Strings can be removed or added. sd000 is a specialized string                E:\usb20\GIO3\autofiles\usbdsc.c
                                            * descriptor. It defines the language code, usually this is                     E:\usb20\GIO3\autofiles\usbdsc.c
                                            * US English (0x0409). The index of the string must match the index             E:\usb20\GIO3\autofiles\usbdsc.c
                                            * position of the USB_SD_Ptr array, &sd000 must be in position                  E:\usb20\GIO3\autofiles\usbdsc.c
                                            * USB_SD_Ptr[0], &sd001 must be in position USB_SD_Ptr[1] and so on.            E:\usb20\GIO3\autofiles\usbdsc.c
                                            * The look-up table USB_SD_Ptr is used by the get string handler                E:\usb20\GIO3\autofiles\usbdsc.c
                                            * function in usb9.c.                                                           E:\usb20\GIO3\autofiles\usbdsc.c
                                            *                                                                               E:\usb20\GIO3\autofiles\usbdsc.c
                                            * -------------------------------------------------------------------           E:\usb20\GIO3\autofiles\usbdsc.c
                                            *                                                                               E:\usb20\GIO3\autofiles\usbdsc.c
                                            * The look-up table scheme also applies to the configuration                    E:\usb20\GIO3\autofiles\usbdsc.c
                                            * descriptor. A USB device may have multiple configuration                      E:\usb20\GIO3\autofiles\usbdsc.c
                                            * descriptors, i.e. CFG01, CFG02, etc. To add a configuration                   E:\usb20\GIO3\autofiles\usbdsc.c
                                            * descriptor, user must implement a structure similar to CFG01.                 E:\usb20\GIO3\autofiles\usbdsc.c
                                            * The next step is to add the configuration descriptor name, i.e.               E:\usb20\GIO3\autofiles\usbdsc.c
                                            * cfg01, cfg02,.., to the look-up table USB_CD_Ptr. USB_CD_Ptr[0]               E:\usb20\GIO3\autofiles\usbdsc.c
                                            * is a dummy place holder since configuration 0 is the un-configured            E:\usb20\GIO3\autofiles\usbdsc.c
                                            * state according to the definition in the USB specification.                   E:\usb20\GIO3\autofiles\usbdsc.c
                                            *                                                                               E:\usb20\GIO3\autofiles\usbdsc.c
                                            ********************************************************************/           E:\usb20\GIO3\autofiles\usbdsc.c
                                                                                                                            E:\usb20\GIO3\autofiles\usbdsc.c
                                           /*********************************************************************           E:\usb20\GIO3\autofiles\usbdsc.c
                                            * Descriptor specific type definitions are defined in:                          E:\usb20\GIO3\autofiles\usbdsc.c
                                            * system\usb\usbdefs\usbdefs_std_dsc.h                                          E:\usb20\GIO3\autofiles\usbdsc.c
                                            *                                                                               E:\usb20\GIO3\autofiles\usbdsc.c
                                            * Configuration information is defined in:                                      E:\usb20\GIO3\autofiles\usbdsc.c
                                            * autofiles\usbcfg.h                                                            E:\usb20\GIO3\autofiles\usbdsc.c
                                            ********************************************************************/           E:\usb20\GIO3\autofiles\usbdsc.c
                                                                                                                            E:\usb20\GIO3\autofiles\usbdsc.c
                                           /** I N C L U D E S *************************************************/           E:\usb20\GIO3\autofiles\usbdsc.c
                                           #include "system\typedefs.h"                                                     E:\usb20\GIO3\autofiles\usbdsc.c
                                           #include "system\usb\usb.h"                                                      E:\usb20\GIO3\autofiles\usbdsc.c
                                                                                                                            E:\usb20\GIO3\autofiles\usbdsc.c
                                           /** C O N S T A N T S ************************************************/          E:\usb20\GIO3\autofiles\usbdsc.c
                                           #pragma romdata                                                                  E:\usb20\GIO3\autofiles\usbdsc.c
                                                                                                                            E:\usb20\GIO3\autofiles\usbdsc.c
                                           /* Device Descriptor */                                                          E:\usb20\GIO3\autofiles\usbdsc.c
                                           rom USB_DEV_DSC device_dsc=                                                      E:\usb20\GIO3\autofiles\usbdsc.c
                                           {                                                                                E:\usb20\GIO3\autofiles\usbdsc.c
                                               sizeof(USB_DEV_DSC),    // Size of this descriptor in bytes                  E:\usb20\GIO3\autofiles\usbdsc.c
                                               DSC_DEV,                // DEVICE descriptor type                            E:\usb20\GIO3\autofiles\usbdsc.c
                                               0x0200,                 // USB Spec Release Number in BCD format             E:\usb20\GIO3\autofiles\usbdsc.c
                                               0x00,                   // Class Code                                        E:\usb20\GIO3\autofiles\usbdsc.c
                                               0x00,                   // Subclass code                                     E:\usb20\GIO3\autofiles\usbdsc.c
                                               0x00,                   // Protocol code                                     E:\usb20\GIO3\autofiles\usbdsc.c
                                               EP0_BUFF_SIZE,          // Max packet size for EP0, see usbcfg.h             E:\usb20\GIO3\autofiles\usbdsc.c
                                               0x09B9,                 // Vendor ID                                         E:\usb20\GIO3\autofiles\usbdsc.c
                                               0x0048,                 // Product ID: PICDEM FS USB (DEMO Mode)             E:\usb20\GIO3\autofiles\usbdsc.c
                                               0x0000,                 // Device release number in BCD format               E:\usb20\GIO3\autofiles\usbdsc.c
                                               0x01,                   // Manufacturer string index                         E:\usb20\GIO3\autofiles\usbdsc.c
                                               0x02,                   // Product string index                              E:\usb20\GIO3\autofiles\usbdsc.c
                                               0x00,                   // Device serial number string index                 E:\usb20\GIO3\autofiles\usbdsc.c
                                               0x01                    // Number of possible configurations                 E:\usb20\GIO3\autofiles\usbdsc.c
                                           };                                                                               E:\usb20\GIO3\autofiles\usbdsc.c
                                                                                                                            E:\usb20\GIO3\autofiles\usbdsc.c
                                           /* Configuration 1 Descriptor */                                                 E:\usb20\GIO3\autofiles\usbdsc.c
                                           CFG01=                                                                           E:\usb20\GIO3\autofiles\usbdsc.c
                                           {                                                                                E:\usb20\GIO3\autofiles\usbdsc.c
                                               /* Configuration Descriptor */                                               E:\usb20\GIO3\autofiles\usbdsc.c
                                               sizeof(USB_CFG_DSC),    // Size of this descriptor in bytes                  E:\usb20\GIO3\autofiles\usbdsc.c
                                               DSC_CFG,                // CONFIGURATION descriptor type                     E:\usb20\GIO3\autofiles\usbdsc.c
                                               sizeof(cfg01),          // Total length of data for this cfg                 E:\usb20\GIO3\autofiles\usbdsc.c
                                               2,                      // Number of interfaces in this cfg　                E:\usb20\GIO3\autofiles\usbdsc.c
                                               1,                      // Index value of this configuration                 E:\usb20\GIO3\autofiles\usbdsc.c
                                               0,                      // Configuration string index                        E:\usb20\GIO3\autofiles\usbdsc.c
                                               _DEFAULT,               // Attributes, see usbdefs_std_dsc.h                 E:\usb20\GIO3\autofiles\usbdsc.c
                                               50,                     // Max power consumption (2X mA)                     E:\usb20\GIO3\autofiles\usbdsc.c
                                                                                                                            E:\usb20\GIO3\autofiles\usbdsc.c
                                               /* Interface Descriptor */                                                   E:\usb20\GIO3\autofiles\usbdsc.c
                                               sizeof(USB_INTF_DSC),   // Size of this descriptor in bytes                  E:\usb20\GIO3\autofiles\usbdsc.c
                                               DSC_INTF,               // INTERFACE descriptor type                         E:\usb20\GIO3\autofiles\usbdsc.c
                                               0,                      // Interface Number                                  E:\usb20\GIO3\autofiles\usbdsc.c
                                               0,                      // Alternate Setting Number                          E:\usb20\GIO3\autofiles\usbdsc.c
                                               2,                      // Number of endpoints in this intf                  E:\usb20\GIO3\autofiles\usbdsc.c
                                               0x00,                   // Class code                                        E:\usb20\GIO3\autofiles\usbdsc.c
                                               0x00,                   // Subclass code                                     E:\usb20\GIO3\autofiles\usbdsc.c
                                               0x00,                   // Protocol code                                     E:\usb20\GIO3\autofiles\usbdsc.c
                                               0,                      // Interface string index                            E:\usb20\GIO3\autofiles\usbdsc.c
                                                                                                                            E:\usb20\GIO3\autofiles\usbdsc.c
                                               /* Endpoint Descriptors */                                                   E:\usb20\GIO3\autofiles\usbdsc.c
                                               sizeof(USB_EP_DSC),DSC_EP,_EP01_OUT,_BULK,USBGEN_EP_SIZE,32,                 E:\usb20\GIO3\autofiles\usbdsc.c
                                               sizeof(USB_EP_DSC),DSC_EP,_EP01_IN,_BULK,USBGEN_EP_SIZE,32,                  E:\usb20\GIO3\autofiles\usbdsc.c
                                                                                                                            E:\usb20\GIO3\autofiles\usbdsc.c
                                                                                                                            E:\usb20\GIO3\autofiles\usbdsc.c
                                           	/// 新規インターフェース用追加                                                  E:\usb20\GIO3\autofiles\usbdsc.c
                                               /* Interface Descriptor */                                                   E:\usb20\GIO3\autofiles\usbdsc.c
                                               sizeof(USB_INTF_DSC),   // Size of this descriptor in bytes                  E:\usb20\GIO3\autofiles\usbdsc.c
                                               DSC_INTF,               // INTERFACE descriptor type                         E:\usb20\GIO3\autofiles\usbdsc.c
                                               1,                      // Interface Number                                  E:\usb20\GIO3\autofiles\usbdsc.c
                                               0,                      // Alternate Setting Number                          E:\usb20\GIO3\autofiles\usbdsc.c
                                               2,                      // Number of endpoints in this intf                  E:\usb20\GIO3\autofiles\usbdsc.c
                                               0x00,                   // Class code                                        E:\usb20\GIO3\autofiles\usbdsc.c
                                               0x00,                   // Subclass code                                     E:\usb20\GIO3\autofiles\usbdsc.c
                                               0x00,                   // Protocol code                                     E:\usb20\GIO3\autofiles\usbdsc.c
                                               0,                      // Interface string index                            E:\usb20\GIO3\autofiles\usbdsc.c
                                           	/// 新規インターフェース用追加                                                  E:\usb20\GIO3\autofiles\usbdsc.c
                                               /* Endpoint Descriptors */                                                   E:\usb20\GIO3\autofiles\usbdsc.c
                                               sizeof(USB_EP_DSC),DSC_EP,_EP02_OUT,_INT,USBIO_EP_SIZE,32,                   E:\usb20\GIO3\autofiles\usbdsc.c
                                               sizeof(USB_EP_DSC),DSC_EP,_EP02_IN,_INT,USBIO_EP_SIZE,32                     E:\usb20\GIO3\autofiles\usbdsc.c
                                           };                                                                               E:\usb20\GIO3\autofiles\usbdsc.c
                                                                                                                            E:\usb20\GIO3\autofiles\usbdsc.c
                                           rom struct{byte bLength;byte bDscType;word string[1];}sd000={                    E:\usb20\GIO3\autofiles\usbdsc.c
                                           sizeof(sd000),DSC_STR,0x0409};                                                   E:\usb20\GIO3\autofiles\usbdsc.c
                                                                                                                            E:\usb20\GIO3\autofiles\usbdsc.c
                                           rom struct{byte bLength;byte bDscType;word string[20];}sd001={                   E:\usb20\GIO3\autofiles\usbdsc.c
                                           sizeof(sd001),DSC_STR,                                                           E:\usb20\GIO3\autofiles\usbdsc.c
                                           'M','i','c','r','o','c','h','i','p',' ',                                         E:\usb20\GIO3\autofiles\usbdsc.c
                                           'D','e','s','i','g','n',' ','L','a','b'};                                        E:\usb20\GIO3\autofiles\usbdsc.c
                                                                                                                            E:\usb20\GIO3\autofiles\usbdsc.c
                                           rom struct{byte bLength;byte bDscType;word string[30];}sd002={                   E:\usb20\GIO3\autofiles\usbdsc.c
                                           sizeof(sd002),DSC_STR,                                                           E:\usb20\GIO3\autofiles\usbdsc.c
                                           'G','e','n','e','r','a','l',' ','I','/','O',' ',                                 E:\usb20\GIO3\autofiles\usbdsc.c
                                           'D','e','m','o',' ','G','e','n','e','r','i','c',' ','C',                         E:\usb20\GIO3\autofiles\usbdsc.c
                                           'l','a','s','s'};                                                                E:\usb20\GIO3\autofiles\usbdsc.c
                                                                                                                            E:\usb20\GIO3\autofiles\usbdsc.c
                                           rom const unsigned char *rom USB_CD_Ptr[]={&cfg01,&cfg01};                       E:\usb20\GIO3\autofiles\usbdsc.c
                                           rom const unsigned char *rom USB_SD_Ptr[]={&sd000,&sd001,&sd002};                E:\usb20\GIO3\autofiles\usbdsc.c
                                                                                                                            E:\usb20\GIO3\autofiles\usbdsc.c
                                                                                                                            E:\usb20\GIO3\autofiles\usbdsc.c
                                           #pragma code                                                                     E:\usb20\GIO3\autofiles\usbdsc.c
                                                                                                                            E:\usb20\GIO3\autofiles\usbdsc.c
                                           /** EOF usbdsc.c ****************************************************/           E:\usb20\GIO3\autofiles\usbdsc.c
